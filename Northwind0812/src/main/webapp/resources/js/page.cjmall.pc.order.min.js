function initRequest(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):void 0}function sendRequest(e){req01_AJAX=null,(req01_AJAX=initRequest())&&(req01_AJAX.onreadystatechange=process_AJAX,req01_AJAX.open("POST",e,!0),req01_AJAX.send(null))}function kcp_AJAX(){if(ajax_flag){var e=document.order_info;sendRequest("order_approval.jsp"+("?site_cd="+e.site_cd.value+"&ordr_idxx="+e.ordr_idxx.value+"&good_mny="+e.good_mny.value+"&pay_method="+e.pay_method.value+"&escw_used="+e.escw_used.value+"&good_name="+e.good_name.value+"&response_type="+e.response_type.value+"&Ret_URL="+e.Ret_URL.value)),ajax_flag=!1}else alert("통신 중입니다. 잠시만 기다려 주세요.")}function process_AJAX(){if(4==req01_AJAX.readyState)if(200==req01_AJAX.status){if(null!=req01_AJAX.responseText)try{var e=document.order_info;"JSON"==e.response_type.value?StateChangeForJSON(req01_AJAX):"XML"==e.response_type.value?StateChangeForXML(req01_AJAX):"TEXT"!=e.response_type.value&&""!=e.response_type.value||StateChangeForText(req01_AJAX)}catch(t){StateChangeForText(req01_AJAX)}}else ajax_flag=!0,alert(req01_AJAX.responseJSON)}function StateChangeForText(e){var t=req01_AJAX.responseText.split(":");if("0000"==t[0].replace(/^\s*/,"").replace(/\s*$/,""))document.getElementById("approval").value=t[1].replace(/^\s*/,"").replace(/\s*$/,""),alert("성공적으로 거래가 등록 되었습니다."),PayUrl=decodeURIComponent(t[2].replace(/^\s*/,"").replace(/\s*$/,"")),document.getElementById("traceNo").value=t[3].replace(/^\s*/,"").replace(/\s*$/,""),6==t.length&&(document.getElementById("PayUrl").value=t[5].replace(/^\s*/,"").replace(/\s*$/,"")),call_pay_form();else{var r=t[2].replace(/^\s*/,"").replace(/\s*$/,"");ajax_flag=!0,alert("실패 되었습니다.["+r+"]")}}function StateChangeForXML(e){var t=(new DOMParser).parseFromString(e.responseText.replace(/^\s*/,"").replace(/\s*$/,""),"text/xml").documentElement,r=t.getElementsByTagName("data");if("0000"==r[0].getElementsByTagName("Code")[0].childNodes[0].nodeValue){document.getElementById("approval").value=r[0].getElementsByTagName("approvalKey")[0].childNodes[0].nodeValue,alert("성공적으로 거래가 등록 되었습니다."),PayUrl=r[0].getElementsByTagName("PayUrl")[0].childNodes[0].nodeValue,document.getElementById("traceNo").value=r[0].getElementsByTagName("traceNo")[0].childNodes[0].nodeValue;try{document.getElementById("PayUrl").value=r[0].getElementsByTagName("request_URI")[0].childNodes[0].nodeValue}catch(o){}call_pay_form()}else ajax_flag=!0,alert("실패 되었습니다.["+r[0].getElementsByTagName("Message")[0].childNodes[0].nodeValue+"]")}function StateChangeForJSON(xmlHttpRequest){var json=eval("("+xmlHttpRequest.responseText+")");"0000"==json.Code?(document.getElementById("approval").value=json.approvalKey,alert("성공적으로 거래가 등록 되었습니다."),PayUrl=json.PayUrl,document.getElementById("PayUrl").value=json.request_URI,document.getElementById("traceNo").value=json.traceNo,call_pay_form()):(ajax_flag=!0,alert("실패 되었습니다.["+json.Message+"]"))}define("page/cjmall/order/approval/view/orderApprovalMainView",["common/cjos/util/appInterfaceUtil","common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/advertise/util/advertiseUtil","common/cjos/advertise/models/advertiseConstantsModel","common/cjos/advertise/models/advertiseItemModel","common/cjos/inflowInfo/inflowInfo","common/cjos/logger/utils/loggerUtil","common/cjos/logger/models/fdsConstantsModel","common/cjos/util/callTimerUtil","page/cjmall/order/sheet/helper/payTypeHelper"],function(e,t,r,o,n,l,i,a,d,s,c){return Backbone.View.extend({initialize:function(){var e=this;e.partnerCd=i.get(i.PARTNER_CODE);var r=(e.$el,!1);if(e.orderCheck()){r=o.isPlayDSearchAd(e),r?(s.start(),s.gueranteeTime=3e3):(s.start(),s.gueranteeTime=2e3);try{var n=t.get("orderInfoExternalUseJson");n&&(e.setAdvertiseKey(),e.setAdvertiseValue($.parseJSON(n)),e.setLoggerKey(),e.setLoggerValue($.parseJSON(n)))}catch(u){cjosLogUtil.log("[제휴 advertiseItemModel set]",u)}try{switch(i.get(i.APPLICATION_TYPE)){case"p":break;case"m":e.callToApplicationForGetCartCount()}}catch(u){cjosLogUtil.log("[장바구니 개수 갱신]",u)}s.stop(e.orderApproval,e)}else{var l=t.get("errorCode"),a=t.get("errorMessage"),d=t.get("payType");if("NAVERPAY"==d&&"apicancel"==l)return void location.replace(t.get("ecDisplayUrl")+"/"+i.get(i.APPLICATION_TYPE)+"/main");"MSG_ORDCHK_VAL_022"!=l&&(a=a||"죄송합니다. 정보 오류입니다. 고객센터 1644-2525로 문의하시기 바랍니다.",a=a.replace("\\\\\\\\n","\n"),a=a.replace("\\\\n","\n"),_.defer(function(){alert(a)})),_.defer(function(){c.isIspCard(d)&&i.userAgent.get(i.userAgent.IS_OSHOPPING_APP)?location.replace("/m/order/sheet/"+t.get("tempOrderNo")):location.replace("/"+i.get(i.APPLICATION_TYPE)+"/order/sheet/"+t.get("tempOrderNo"))})}},setAdvertiseKey:function(){o.advertiseSetKey(n.ORD_NO),o.advertiseSetKey(n.DELIVERY_FEE),o.advertiseSetKey(n.PAGE_TYPE),o.advertiseSetKey(n.ITEM_ARRAY),o.advertiseSetKey(n.ORD_TOTAL_PRICE),o.advertiseSetKey(n.ORD_PAYMENT_TYPE),o.advertiseSetKey(n.ORD_PAYMENT_GROUP_TYPE)},setAdvertiseValue:function(e){for(var r=e?e.orderNo:"",i=e?e.deliveryFee:"",a=e?e.totalPrice:"",d=e?e.listOrderItem:[],s=[],u=t.get("payType"),p=0;p<d.length;p++){var m=new l,f=d[p];m.set(n.ITEM.ITEM_CODE,f.itemCode),m.set(n.ITEM.ITEM_NAME,f.itemName),m.set(n.ITEM.ITEM_CHANNEL_CODE,f.channelCode),m.set(n.ITEM.ITEM_CATEGORY_CODE,f.category),m.set(n.ITEM.UNIT_CODE,f.unitCode),m.set(n.ITEM.UNIT_QTY,f.unitQty),m.set(n.ITEM.UNIT_PRICE,f.unitPrice),m.set(n.ITEM.ITEM_IMG_URL,f.itemImgUrl),m.set(n.ITEM.ITEM_LINK_URL,f.itemDetailUrl),s.push(m)}o.advertiseSetValue(n.ORD_NO,r),o.advertiseSetValue(n.DELIVERY_FEE,i),o.advertiseSetValue(n.PAGE_TYPE,"purchase"),o.advertiseSetValue(n.ITEM_ARRAY,s),o.advertiseSetValue(n.ORD_TOTAL_PRICE,a),o.advertiseSetValue(n.ORD_PAYMENT_TYPE,u),o.advertiseSetValue(n.ORD_PAYMENT_GROUP_TYPE,c.getPayGroupType(u))},setLoggerKey:function(){a.setSplunkKey("customPI"),a.setSplunkKey("orderAmount"),a.setSplunkKey("orderProductCode"),a.setSplunkKey("orderProductName"),a.setSplunkKey("orderProductUnitCode"),a.setSplunkKey("orderProductCount"),a.setSplunkKey("productType"),a.setSplunkKey("shopCode"),a.setSplunkKey("mdCode"),a.setSplunkKey("searchWord"),a.setSplunkKey("ordNo"),a.setSplunkKey("gCateCd"),a.setSplunkKey("lCateCd"),a.setSplunkKey("mCateCd"),a.setSplunkKey("sCateCd"),a.setSplunkKey("pgmCd"),a.setSplunkKey("IpgmCd"),a.setSplunkKey("partnerCd"),a.setSplunkKey("orderFormType")},setLoggerValue:function(e){for(var r=this,o=e?e.keyword:"",n=(e&&e.orderFormType,e?e.listOrderItem:[]),l=e?e.orderFormType:"",i="",d="",s="",c="",u="",p="",m="",f="",g="",v="",y="",h="",_="",C="",P="",A="",T=0;T<n.length;T++)0==T?(i=n[T].itemCode,d=n[T].itemName,s=n[T].unitCode,c=n[T].unitQty,g=n[T].shopId,u=n[T].unitOriginalPrice,f=n[T].mdCode,v=r.getStringValue(n[T].programCode),y=r.getStringValue(n[T].internetLiveProgramCode),h=n[T].mainVenCode,_=r.getStringValue(n[T].llargeCategoryId),C=r.getStringValue(n[T].largeCategoryId),P=r.getStringValue(n[T].middleCategoryId),A=r.getStringValue(n[T].smallCategoryId),m="50001001"==n[T].channelCode||"30001003"==n[T].channelCode||"50014002"==n[T].channelCode||"30002003"==n[T].channelCode||"50001010"==n[T].channelCode||"30001022"==n[T].channelCode?"ETV":"NML"):(i=i+";"+n[T].itemCode,d=d+";"+n[T].itemName,s=s+";"+n[T].unitCode,c=c+";"+n[T].unitQty,g=g+";"+n[T].shopId,u=u+";"+n[T].unitOriginalPrice,f=f+";"+n[T].mdCode,v=v+";"+r.getStringValue(n[T].programCode),y=y+";"+r.getStringValue(n[T].internetLiveProgramCode),h=h+";"+n[T].mainVenCode,_=_+";"+r.getStringValue(n[T].llargeCategoryId),C=C+";"+r.getStringValue(n[T].largeCategoryId),P=P+";"+r.getStringValue(n[T].middleCategoryId),A=A+";"+r.getStringValue(n[T].smallCategoryId),"50001001"==n[T].channelCode||"30001003"==n[T].channelCode||"50014002"==n[T].channelCode||"30002003"==n[T].channelCode||"50001010"==n[T].channelCode||"30001022"==n[T].channelCode?m+=";ETV":m+=";NML");p=t.get("orderNo"),a.setSplunkValue("customPI","ODR"),a.setSplunkValue("orderAmount",u),a.setSplunkValue("orderProductCode",i),a.setSplunkValue("orderProductName",d),a.setSplunkValue("orderProductUnitCode",s),a.setSplunkValue("orderProductCount",c),a.setSplunkValue("productType",m),a.setSplunkValue("shopCode",g),a.setSplunkValue("mdCode",f),a.setSplunkValue("searchWord",o),a.setSplunkValue("ordNo",p),a.setSplunkValue("gCateCd",_),a.setSplunkValue("lCateCd",C),a.setSplunkValue("mCateCd",P),a.setSplunkValue("sCateCd",A),a.setSplunkValue("pgmCd",v),a.setSplunkValue("IpgmCd",y),a.setSplunkValue("partnerCd",h),a.setSplunkValue("orderFormType",l)},getStringValue:function(e){var t="";return _.isEmpty(e)||(t=e),t},orderCheck:function(){var e=this;e.$el;return"false"!=t.get("isSuccess")},orderApproval:function(){var e=this,o=(e.$el,{}),n=t.get("noneCustInfo");"true"==t.get("isDownloadAmazingCoupon")&&(o.isDownloadAmazingCoupon=!0);var l=t.get("rPIC");l!==undefined&&null!==l&&""!==l&&(o.rPIC=l),"true"==t.get("isHanssemDeliveryMessage")&&(o.isHanssemDeliveryMessage=!0);var a=t.get("orderEndRedirectForm"),d=_.isUndefined(a)?"":$.parseJSON(a);d&&!0===d.isExposeButton&&d.buttonTitle&&d.orderEndRedirectTypeCode&&(o.isExposeButton=d.isExposeButton,o.buttonTitle=d.buttonTitle,o.orderEndRedirectTypeCode=d.orderEndRedirectTypeCode,o.redirectUrl=_.isEmpty(d.redirectUrl)?t.get("ecDisplayUrl")+"/"+i.get(i.APPLICATION_TYPE)+"/main":d.redirectUrl);var s=t.get("ecBaseSslUrl")+"/"+i.get(i.APPLICATION_TYPE)+"/order/end/"+t.get("orderNo");if(_.isEmpty(o)||(s=s+"?"+r.hashToQuery(o)),n){var c=$("<form></form>");c.append($("<input>").attr("type","hidden").attr("name","noneCustInfo").val(n)),c.attr({action:s,method:"post",id:"orderEndForm"}),$("#container").append(c),c.submit()}else location.replace(s)},callToApplicationForGetCartCount:function(){var r=t.get("ecBaseSslUrl")+"/c/rest/cart/cartListCount";$.ajax({async:!1,url:r,type:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},data:"",xhrFields:{withCredentials:!0},success:function(t){if(1==t.code){var r=t.result;e.setCartCount(r.siteType,r.customerNo,r.cartCount)}},error:function(e,t,r){cjosLogUtil.log("장바구니 개수 조회 실패 : response ",e)}})}})}),define("page/cjmall/order/bulk/collections/bulkItemCollection",["page/cjmall/order/bulk/models/bulkItemModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(e){}})}),define("page/cjmall/order/bulk/models/bulkItemModel",[],function(){return Backbone.Model.extend({defualts:{bulkItemNo:null,itemCode:null,itemName:null,channelCode:null,unitCode:null,unitName:null,orderQuantity:null,standardPrice:null,_emptyImageUrl:"http://itemimage.cjmall.com/goods_images/imageL.jpg"},initialize:function(e){}})}),define("page/cjmall/order/bulk/models/bulkSheetModel",["common/cjos/util/configUtil","page/cjmall/order/bulk/collections/bulkItemCollection"],function(e,t){"use strict";return Backbone.Model.extend({url:"",defaults:{custNm:null,representTelNo1:null,representTelNo2:null,eMail:null,bulkOrderNo:null,itemCode:null,itemName:null,channelCode:null,itemCollection:t},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/bulk/getSheetInfo"},parse:function(e){var r=this;if(e.errorCode!=undefined&&null!==e.errorCode)return alert(e.message),void history.back();var o=e.result;return o===undefined&&(alert("정상적인 접근이 아닙니다."),history.back()),null===o?(alert("대량 주문 상품이 아닙니다."),history.back()):null===o.custNm||null===o.itemList||o.itemList.length<1?(alert("대량 주문 상품이 아닙니다."),history.back()):r.set({custNm:o.custNm,representTelNo1:o.representTelNo1,representTelNo2:o.representTelNo2,eMail:o.email,bulkOrderNo:o.bulkOrderNo,itemCode:o.itemCode,itemName:o.itemName,channelCode:o.channelCode,bulkItemImageUrl:o.bulkItemImageUrl,itemCollection:new t(o.itemList)}),r}})}),define("page/cjmall/order/bulk/view/bulkItemInfoView",["common/cjmall/util/cjmallUtil","common/cjos/util/configUtil"],function(e,t){return Backbone.View.extend({className:"prd_order_info",model:null,events:{"keyup ._orderQuantity":"keyUpOrdQty"},template:{},initialize:function(){this.template=Handlebars.compile($("#itemTemplate").html())},render:function(){var e=this,t=e.$el,r=e.model.toJSON();return t.append(e.template(r)),e},keyUpOrdQty:function(e){e.preventDefault();this.noNumberFilter("._orderQuantity")},noNumberFilter:function(e){var t=this,r=$.trim(t.$el.find(e).val()),o=t.commonKeyUpHandler(r);null!=o?(t.$el.find(e).val(o),t.$el.find(e).focus(),t.model.set("newOrderQuantity",o)):t.model.set("newOrderQuantity",r)},commonKeyUpHandler:function(e){if(""!==e){if(/[^0-9]/g.test(e)){alert("숫자만 입력 가능합니다.");return e.replace(/[^0-9]/g,"")}}return null}})}),define("page/cjmall/order/bulk/view/bulkOrderInfoView",["common/cjmall/util/cjmallUtil","common/cjos/util/configUtil","page/cjmall/order/bulk/view/bulkItemInfoView"],function(e,t,r){return Backbone.View.extend({el:"._orderArea",model:null,events:{},template:{},initialize:function(){var e=this;e.template=Handlebars.compile($("#orderTemplate").html()),e.itemTemplate=Handlebars.compile($("#itemTemplate").html())},render:function(){var t=this,o=t.$el,n=t.model.get("itemCode"),l=t.model.get("channelCode"),i=t.model.get("bulkItemImageUrl");t.model.set("itemImageUrl",i);var a=e.getLinkUrl(n,l);t.model.set("itemDetailUrl",a);var d=t.model.toJSON();o.html(t.template(d));for(var s=t.model.get("itemCollection"),c=0;c<s.size();c++){var u=s.models[c];t.itemInfoView=new r({model:u}),o.find("._itemArea").append(t.itemInfoView.render().$el)}return t}})}),define("page/cjmall/order/bulk/view/bulkUserInfoView",["common/cjmall/util/cjmallUtil","common/cjos/util/configUtil"],function(e,t){return Backbone.View.extend({className:"._inputFrom",model:null,events:{"keyup ._cellno2":"keyUpTelNo","keyup ._eMail":"keyUpEMail","keyup ._inputDomain":"keyUpDomain","change ._eMailDomain":"changeEMailDomain"},template:{},initialize:function(){this.template=Handlebars.compile($("#userInfoTemplate").html())},render:function(){var e=this,t=e.$el;Handlebars.registerHelper("ifStringCompare",function(e,t,r){return e===t?r.fn(this):r.inverse(this)});var r,o=e.model.get("eMail");o===undefined||null===o||""===o?(e.model.set("eMailId",""),e.model.set("eMailDomain",""),e.model.set("inputDomain","@")):(r=o.split("@"),e.model.set("eMailId",r[0]),"naver.com"===r[1]||"hanmail.net"===r[1]||"nate.com"===r[1]||"gmail.com"===r[1]?(e.model.set("eMailDomain","@"+r[1]),e.model.set("inputDomain","@")):(e.model.set("eMailDomain","custom"),e.model.set("inputDomain","@"+r[1])));var n=e.model.toJSON();return t.html(e.template(n)),t.find("._cellNo1").val(e.model.get("representTelNo1")),e.changeEMailDomain(),e},keyUpTelNo:function(e){e.preventDefault();var t=this,r=/[^0-9]/g;t.commonKeyUpHandler("._cellno2",r,"숫자만 입력 가능합니다.")},commonKeyUpHandler:function(e,t,r){var o=this;if(""!==e){var n=$.trim(o.$el.find(e).val());if(""===n)return;if(t.test(n)){alert(r);var l=n.replace(t,"");null!=l&&(o.$el.find(e).val(l),o.$el.find(e).focus())}}return null},changeEMailDomain:function(){var e=this;"custom"===e.$el.find("._eMailDomain option:selected").val()?e.$el.find("._eMailArea").addClass("self"):e.$el.find("._eMailArea").removeClass("self")}})}),define("page/cjmall/order/bulk/view/m/mobileBulkView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/bulk/models/bulkSheetModel","page/cjmall/order/bulk/view/bulkUserInfoView","page/cjmall/order/bulk/view/bulkOrderInfoView"],function(e,t,r,o,n){return Backbone.View.extend({el:".wrap_order",model:null,events:{"click ._submit":"clickSubmitHandler",'click input[name="rdbx"]':"clickOneDeliveryAddress",'change input[name="multiDeliveryCount"]':"changeMultiDeliveryCount"},initialize:function(){var e=this;e.$el;e.createMainModel(),e.getSheetInfo()},createMainModel:function(){var e=this,t=new r;e.model=t},getSheetInfo:function(){var t=this,r=e.get("bulkOrderNo");""!==r&&null!==r||(alert("대량주문 주문번호가 없습니다."),history.back());var o={bulkOrderNo:r};t.model.fetch({data:o,type:"GET",dataType:"json",success:function(e,r,o){cjosLogUtil.log("[pcBulkView] fetch success"),t.model=e,t.render()},error:function(e,t,r){cjosLogUtil.log("[pcBulkView] fetch error")}})},render:function(){var e=this,t=e.$el;e.model;e.userInfoView=new o({model:e.model}),t.find("._inputArea").append(e.userInfoView.render().$el),e.orderInfoView=new n({model:e.model}),t.find("._orderArea").append(e.orderInfoView.render().$el)},clickOneDeliveryAddress:function(e){var t=$(e.target).attr("id"),r=$(e.target).parents(),o=r.find("#multiDeliveryCountArea"),n=r.find("input[name='multiDeliveryCount']");"rdbx1"===t?(n.val(1),o.addClass("disabled"),n.prop("disabled",!0)):(n.val(2),o.removeClass("disabled"),n.prop("disabled",!1))},changeMultiDeliveryCount:function(e){e.preventDefault();var t=this,r=$(e.target),o=r.val(),n=Number(o);!1===t.checkMultiDeliveryCountValidation(n)&&r.val(2)},checkOneDeliveryCountValidation:function(e){return!(_.isNaN(e)||_.isUndefined(e)||_.isNull(e)||1!==e)||(alert("단일 배송지의 배송지 개수는 1개로 설정해야합니다."),!1)},checkMultiDeliveryCountValidation:function(e){return!(_.isNaN(e)||_.isUndefined(e)||_.isNull(e)||e<2||e>100)||(alert("복수 배송지는 최소 2개이상 최대 100개 이하로 설정 가능합니다."),!1)},getOneDeliveryAddress:function(){var e=this;$multiDeliveryRadio=e.$el.find('input[name="rdbx"]');var t=$multiDeliveryRadio.eq(0).prop("checked");$multiDeliveryRadio.eq(1).prop("checked");return!0===t},clickSubmitHandler:function(t){t.preventDefault();var r=this;if(!1!==r.checkNameValidation()&&!1!==r.checkCellNoValidation()&&!1!==r.checkEmailValidation()&&!1!==r.checkMessageValidation()&&!1!==r.checkRecommanderValidation()){var o=r.$el.find("._eMail").val().trim(),n=r.$el.find("._eMailDomain option:selected").val();"custom"===n&&(n=r.$el.find("._inputDomain").val().trim());var l="";l=r.$el.find("._message").val().trim();var i=r.$el.find("._recommender").val().trim();""!==i&&(l+="\n\n# 추천인 : "+i);var a=r.getOneDeliveryAddress();$multiDevliveryCount=r.$el.find('input[name="multiDeliveryCount"]');var d=Number($multiDevliveryCount.val());if(!0===a){if(!1===r.checkOneDeliveryCountValidation(d))return}else if(!1===r.checkMultiDeliveryCountValidation(d))return;for(var s=r.model.get("itemCollection"),c=new Array,u=0;u<s.length;u++){var p=s.models[u],m=p.get("orderQuantity"),f=p.get("newOrderQuantity"),g=p.get("standardPrice");if(f===undefined||null===f||""===f){if(m<10)return void alert("대량구매는 최소 10개 이상 가능합니다.(CJ CUP 티켓은 최소 30개입니다.)");if(m*g<5e5)return void alert("대량구매 신청은 판매가 기준 50만원 이상인 경우 접수가능합니다.");var v={bulkItemNo:p.get("bulkItemNo"),orderUnitCode:p.get("unitCode"),orderQuantity:m};c.push(v)}else{if(f<10)return void alert("대량구매는 최소 10개 이상 가능합니다.(CJ CUP 티켓은 최소 30개입니다.)");if(f*g<5e5)return void alert("대량구매 신청은 판매가 기준 50만원 이상인 경우 접수가능합니다.");var v={bulkItemNo:p.get("bulkItemNo"),orderUnitCode:p.get("unitCode"),orderQuantity:f};c.push(v)}}var y={bulkOrderNo:e.get("bulkOrderNo"),custNm:r.$el.find("._name").val().trim(),cellNo1:r.$el.find("._cellno1").val().trim(),cellNo2:r.$el.find("._cellno2").val().trim(),email:o+n,message:l,updateBulkItems:c,isOneDeliveryAddress:a,deliveryCount:d};r.createRentalOrder(y)}},checkNameValidation:function(){var e=this,t=e.$el.find("._name"),r=t===undefined||null===t||t.val()===undefined||null===t.val()?"":t.val();return""===t.val()?(alert("신청자명과 연락처를 정확히 입력해주세요."),t.focus(),!1):!(r.length>10)||(alert("신청자명은 최대 10자까지 입력할 수 있습니다."),t.focus(),!1)},checkCellNoValidation:function(){var e=this,t=(e.$el.find("._cellno1").val(),e.$el.find("._cellno2").val());return 0===t.length||t.length<7?(alert("연락처를 정확히 입력해주세요."),e.$el.find("._cellno2").focus(),!1):!(t.length>8)||(alert("전화번호는 최대 8자까지 입력할 수 있습니다."),!1)},checkEmailValidation:function(){var e=this,t=e.$el.find("._eMail").val().trim();if(""===t)return alert("이메일을 입력해주십시오."),!1;var r=e.$el.find("._eMailDomain option:selected").val();return""===r?(alert("이메일을 입력해주십시오."),!1):("custom"===r&&(r=e.$el.find("._inputDomain").val().trim()),t+=r,!!/^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i.test(t)||(alert("이메일을 확인해주세요."),!1))},checkMessageValidation:function(){return!(this.$el.find("._message").val().length>200&&(alert("상담메시지는 최대 200자까지 입력할 수 있습니다."),1))},checkRecommanderValidation:function(){return!(this.$el.find("._recommender").val().length>100&&(alert("추천인은 최대 100자까지 입력할 수 있습니다."),1))},createRentalOrder:function(r){var o=this;$.ajax({type:"post",datatype:"json",async:!1,url:e.get("ecBaseSslUrl")+"/c/rest/order/bulk/update",cache:!1,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",xhrFields:{withCredentials:!0},success:function(r){if(r.result!==undefined&&null!==r.result&&""!==r.result&&"00"===r.result){alert("대량구매 신청이 완료되었습니다.\n상담원이 휴대폰으로 연락드리겠습니다.\n감사합니다.");var n=o.model.get("itemCode"),l=t.get(t.APPLICATION_TYPE),i=e.get("ecDisplayUrl");i+="p"===l?"/p":"/m",i+="/item/"+n+"?isMyzone=true",window.location.replace(i)}else{var a="";r.message!==undefined&&null!==r.message&&""!==r.message&&(a="\n\n[사유 : "+r.message+"]"),alert("저장에 실패했습니다.\n다시 시도해주세요."+a)}},error:function(e,t,r){var o="\n\n[사유 : 서버와의 통신이 실패했습니다.\njqXHR: "+e+"\ntextStatus: "+t+"\nerrorThrown: "+r+"]";alert("저장에 실패했습니다.\n다시 시도해주세요."+o)}})}})}),define("page/cjmall/order/bulk/view/p/pcBulkView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/bulk/models/bulkSheetModel","page/cjmall/order/bulk/view/bulkUserInfoView","page/cjmall/order/bulk/view/bulkOrderInfoView"],function(e,t,r,o,n){return Backbone.View.extend({el:".wrap_order",model:null,events:{"click ._submit":"clickSubmitHandler",'click input[name="rdbx"]':"clickOneDeliveryAddress",'change input[name="multiDeliveryCount"]':"changeMultiDeliveryCount"},initialize:function(){var e=this;e.$el;e.createMainModel(),e.getSheetInfo()},createMainModel:function(){var e=this,t=new r;e.model=t},getSheetInfo:function(){var t=this,r=e.get("bulkOrderNo");""!==r&&null!==r||(alert("대량주문 주문번호가 없습니다."),history.back());var o={bulkOrderNo:r};t.model.fetch({data:o,type:"GET",dataType:"json",success:function(e,r,o){cjosLogUtil.log("[pcBulkView] fetch success"),t.model=e,t.render()},error:function(e,t,r){cjosLogUtil.log("[pcBulkView] fetch error")}})},render:function(){var e=this,t=e.$el;e.model;e.userInfoView=new o({model:e.model}),t.find("._inputArea").append(e.userInfoView.render().$el),e.orderInfoView=new n({model:e.model}),t.find("._orderArea").append(e.orderInfoView.render().$el)},clickOneDeliveryAddress:function(e){var t=$(e.target).attr("id"),r=$(e.target).parents(),o=r.find("#multiDeliveryCountArea"),n=r.find("input[name='multiDeliveryCount']");"rdbx1"===t?(n.val(1),o.addClass("disabled"),n.prop("disabled",!0)):(n.val(2),o.removeClass("disabled"),n.prop("disabled",!1))},changeMultiDeliveryCount:function(e){e.preventDefault();var t=this,r=$(e.target),o=r.val(),n=Number(o);!1===t.checkMultiDeliveryCountValidation(n)&&r.val(2)},checkOneDeliveryCountValidation:function(e){return!(_.isNaN(e)||_.isUndefined(e)||_.isNull(e)||1!==e)||(alert("단일 배송지의 배송지 개수는 1개로 설정해야합니다."),!1)},checkMultiDeliveryCountValidation:function(e){return!(_.isNaN(e)||_.isUndefined(e)||_.isNull(e)||e<2||e>100)||(alert("복수 배송지는 최소 2개이상 최대 100개 이하로 설정 가능합니다."),!1)},getOneDeliveryAddress:function(){var e=this;$multiDeliveryRadio=e.$el.find('input[name="rdbx"]');var t=$multiDeliveryRadio.eq(0).prop("checked");$multiDeliveryRadio.eq(1).prop("checked");return!0===t},clickSubmitHandler:function(t){t.preventDefault();var r=this;if(!1!==r.checkNameValidation()&&!1!==r.checkCellNoValidation()&&!1!==r.checkEmailValidation()&&!1!==r.checkMessageValidation()&&!1!==r.checkRecommanderValidation()){var o=r.$el.find("._eMail").val().trim(),n=r.$el.find("._eMailDomain option:selected").val();"custom"===n&&(n=r.$el.find("._inputDomain").val().trim());var l="";l=r.$el.find("._message").val().trim();var i=r.$el.find("._recommender").val().trim();""!==i&&(l+="\n\n#추천인 : "+i);var a=r.getOneDeliveryAddress();$multiDevliveryCount=r.$el.find('input[name="multiDeliveryCount"]');var d=Number($multiDevliveryCount.val());if(!0===a){if(!1===r.checkOneDeliveryCountValidation(d))return}else if(!1===r.checkMultiDeliveryCountValidation(d))return;for(var s=r.model.get("itemCollection"),c=new Array,u=0;u<s.length;u++){var p=s.models[u],m=p.get("orderQuantity"),f=p.get("newOrderQuantity"),g=p.get("standardPrice");if(f===undefined||null===f||""===f){if(m<10)return void alert("대량구매는 최소 10개 이상 가능합니다.(CJ CUP 티켓은 최소 30개입니다.)");if(m*g<5e5)return void alert("대량구매 신청은 판매가 기준 50만원 이상인 경우 접수가능합니다.");var v={bulkItemNo:p.get("bulkItemNo"),orderUnitCode:p.get("unitCode"),orderQuantity:m};c.push(v)}else{if(f<10)return void alert("대량구매는 최소 10개 이상 가능합니다.(CJ CUP 티켓은 최소 30개입니다.)");if(f*g<5e5)return void alert("대량구매 신청은 판매가 기준 50만원 이상인 경우 접수가능합니다.");var v={bulkItemNo:p.get("bulkItemNo"),orderUnitCode:p.get("unitCode"),orderQuantity:f};c.push(v)}}var y={bulkOrderNo:e.get("bulkOrderNo"),custNm:r.$el.find("._name").val().trim(),cellNo1:r.$el.find("._cellno1").val().trim(),cellNo2:r.$el.find("._cellno2").val().trim(),email:o+n,message:l,updateBulkItems:c,isOneDeliveryAddress:a,deliveryCount:d};r.createRentalOrder(y)}},checkNameValidation:function(){var e=this,t=e.$el.find("._name"),r=t===undefined||null===t||t.val()===undefined||null===t.val()?"":t.val();return""===t.val()?(alert("신청자명과 연락처를 정확히 입력해주세요."),t.focus(),!1):!(r.length>10)||(alert("신청자명은 최대 10자까지 입력할 수 있습니다."),t.focus(),!1)},checkCellNoValidation:function(){var e=this,t=(e.$el.find("._cellno1").val(),e.$el.find("._cellno2").val());return 0===t.length||t.length<7?(alert("연락처를 정확히 입력해주세요."),e.$el.find("._cellno2").focus(),!1):!(t.length>8)||(alert("전화번호는 최대 8자까지 입력할 수 있습니다."),!1)},checkEmailValidation:function(){var e=this,t=e.$el.find("._eMail").val().trim();if(""===t)return alert("이메일을 입력해주십시오."),!1;var r=e.$el.find("._eMailDomain option:selected").val();return""===r?(alert("이메일을 입력해주십시오."),!1):("custom"===r&&(r=e.$el.find("._inputDomain").val().trim()),t+=r,!!/^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i.test(t)||(alert("이메일을 확인해주세요."),!1))},checkMessageValidation:function(){return!(this.$el.find("._message").val().length>200&&(alert("상담메시지는 최대 200자까지 입력할 수 있습니다."),1))},checkRecommanderValidation:function(){return!(this.$el.find("._recommender").val().length>100&&(alert("추천인은 최대 100자까지 입력할 수 있습니다."),1))},createRentalOrder:function(r){var o=this;$.ajax({type:"post",datatype:"json",async:!1,url:e.get("ecBaseSslUrl")+"/c/rest/order/bulk/update",cache:!1,data:JSON.stringify(r),contentType:"application/json; charset=UTF-8",xhrFields:{withCredentials:!0},success:function(r){if(r.result!==undefined&&null!==r.result&&""!==r.result&&"00"===r.result){alert("대량구매 신청이 완료되었습니다.\n상담원이 휴대폰으로 연락드리겠습니다.\n감사합니다.");var n=o.model.get("itemCode"),l=t.get(t.APPLICATION_TYPE),i=e.get("ecDisplayUrl");i+="p"===l?"/p":"/m",i+="/item/"+n+"?isMyzone=true",window.location.replace(i)}else{var a="";r.message!==undefined&&null!==r.message&&""!==r.message&&(a="\n\n[사유 : "+r.message+"]"),alert("저장에 실패했습니다.\n다시 시도해주세요."+a)}},error:function(e,t,r){var o="\n\n[사유 : 서버와의 통신이 실패했습니다.\njqXHR: "+e+"\ntextStatus: "+t+"\nerrorThrown: "+r+"]";alert("저장에 실패했습니다.\n다시 시도해주세요."+o)}})}})}),define("page/cjmall/order/cart/cartAllPurchaseTaxPopupView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/util/deliveryUtils","page/cjmall/order/cart/util/cartOrderUtils"],function(e,t,r,o,n){"use strict";return Backbone.View.extend({el:"._tax_notice_basket",model:null,orderProcessType:null,events:{"click ._tax_btn":"taxHandler","click ._tax_cancel_btn":"cancelTaxHandler"},initialize:function(e){var t=this;t.orderProcessType=e,t.render()},render:function(e){var r=this,o=r.$el,n=o.find(".ly_msgct"),l="";switch(e!=undefined&&(r.orderProcessType=e),t.get(t.APPLICATION_TYPE)){case"p":l="ALL"===r.orderProcessType?"<p>도서공연비 소득공제 상품과 일반 상품을 한 번에<br>결제하실 경우 도서공연비 소득공제를 받으실 수 없습니다.<br>(매진/단독주문 상품 제외 후 주문서 이동)</p>":"<p>도서공연비 소득공제 상품과 일반 상품을 한 번에<br>결제하실 경우 도서공연비 소득공제를 받으실 수 없습니다.</p>";break;case"m":l="ALL"===r.orderProcessType?"<p>도서공연비 소득공제 상품과<br>일반 상품을 한 번에 결제하실 경우<br>도서공연비 소득공제를 받으실 수 없습니다.<br>(매진/단독주문 상품 제외 후 주문서 이동)</p>":"<p>도서공연비 소득공제 상품과<br>일반 상품을 한 번에 결제하실 경우<br>도서공연비 소득공제를 받으실 수 없습니다.</p>"}n.html("<h3>결제하시겠습니까?</h3>"+l),this.$el.show()},cancelTaxHandler:function(){var e=this,t=e.$el;e.$el.hide();for(var n=$(document).find("input:checkbox[class=_itemCheckBox]"),l=0;l<n.length;l++){var i=$(n[l]),a=e.deliveryPolicyModel,d=r.get("totalOrderPriceInfoModel").cartListCollection,s=r.get("totalOrderPriceInfoModel").deliveryPolicyCollection,c=r.get("deliveryPolicyCollection"),a=null;if(i.is(":checked")){var u=t.parents().find("input:checkbox[class=_allCheckBox]");if(i.attr("disabled"))return;for(var p=i.attr("id"),m=r.get("cartListCollection").get(p),f=m.get("itemBasicInfo").unitCode,g=0;g<c.length;g++)for(var v=c.at(g).get("unitCodeList"),y=0;y<v.length;y++)if(f===v[y]){a=c.at(g);var h=a.get("incomeDedYn");"0"===h&&(d.remove(m),o.removeOrderUnitCodeToDeliveryPolicyModel(m,a),0===a.get("orderUnitCodeList").length&&s.remove(a),o.resetDeliveryPolicyModel(m,a,a.get("orderUnitCodeList"),!1),i.prop("checked",!1),m.set("checked",""),u.is(":checked")&&u.prop("checked",!1))}}else{var p=i.attr("id"),m=r.get("cartListCollection").get(p),f=m.get("itemBasicInfo").unitCode,_=m.get("isSoloOrder"),C=m.get("unitStockQuantity"),P=m.get("itemBasicInfo").itemStatus.code;if(_||"S"===P||C<=0)continue;for(var g=0;g<c.length;g++)for(var v=c.at(g).get("unitCodeList"),y=0;y<v.length;y++)if(f===v[y]){a=c.at(g);var h=a.get("incomeDedYn");"1"===h&&(d.add(m),o.addOrderUnitCodeToDeliveryPolicyModel(m,a),s.add(a),o.resetDeliveryPolicyModel(m,a,a.get("orderUnitCodeList"),!0),i.prop("checked",!0),m.set("checked","checked"))}}}e.trigger("reRenderCartGroupView",{cartItemView:e,cartItemModel:m,deliveryPolicyModel:a}),r.trigger("requsetResetTotalOrderPrice",{})},taxHandler:function(){this.$el.hide();var e=n.getOrderItemFormsForCJmall();n.requestOrder(e)}})}),define("page/cjmall/order/cart/cartGroupView",["page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/cartItemView"],function(e,t){return Backbone.View.extend({className:"lst_item_wrap _groupViewContainer",template:Handlebars.compile($("#groupViewTemplate").html()),deliveryPolicyModel:null,topCartInsertDate:0,cartItemViewArray:{},data:{},model:"",isOlive:!1,isCookit:!1,isDawn:!1,groupViewType:null,groupViewEl:null,initialize:function(e){var t=this;t.deliveryPolicyModel=t.model,t.isOlive=!!e.isOlive,t.isCookit=!!e.isCookit,t.isDawn=!!e.isDawn,t.groupViewType=e.groupViewType,t.groupViewEl=e.groupViewEl,1==t.isOlive&&0==t.isCookit&&0==t.isDawn?$(t.$el).addClass("_oliveGroup"):0==t.isOlive&&1==t.isCookit&&0==t.isDawn?$(t.$el).addClass("_cookitGroup"):0==t.isOlive&&0==t.isCookit&&1==t.isDawn?$(t.$el).addClass("_dawnGroup"):$(t.$el).addClass("_cjmallGroup"),t.setData(),t.initRender()},initRender:function(){var e=this,t=e.data,r=e.$el;if(r.html(e.template(t)),null!=t&&"undefined"!=typeof t.fastDeliveryHeader&&"undefined"!=typeof t.fastDeliveryMessage){r.find("._fastDeliveryText").show()}e.render()},setData:function(){var e=this,t=(e.$el,e.deliveryPolicyModel),r=t.get("fastDeliveryAddPrice");if(null!=r){var o=r.fastDeliveryMessageInfo;if(null!=o){var n="["+o.data.header+"]",l=o.data.deadline+" "+o.data.payment+" "+o.data.footer,i={fastDeliveryHeader:n,fastDeliveryMessage:l};e.data=i}}},render:function(){var r=this,o=r.deliveryPolicyModel.get("unitCodeList"),n=e.get("cartListCollection"),l=[];if(0==o.length)return void cjosLogUtil.log("[CartGroupView] unitCodeList.length is 0.");for(var i=0;i<o.length;i++)for(var a=o[i],d=0;d<n.length;d++)if(n.at(d).get("itemBasicInfo").unitCode==a&&!n.at(d).get("isSelected")){var s=n.at(d);if(s.get("isOlive")!=r.isOlive||s.get("isCookit")!=r.isCookit||s.get("isDawn")!=r.isDawn)continue;s.set("deliveryPolicyModel",r.deliveryPolicyModel),s.set("isSelected",!0);var c=new t({model:s});r.listenTo(c,"deletedItemModel",r.deletedItemViewHandler),r.listenTo(c,"reRenderCartGroupView",r.renderItemViewHandler),
l.push(c),r.compareTopInsertDate(s.get("cartInsertDate"));break}r.sortingRender(l)},renderItemViewHandler:function(e){var t=this,r=t.cartItemViewArray,o=e.deliveryPolicyModel;if(r.length>1)for(var n=!1,l=r.length-1;l>=0;l--){var i=r[l];i.deliveryPolicyModel=o,0==n&&"checked"===i.cartItemModel.get("checked")?(i.cartItemModel.set("firstRow",!0),n=!0):i.cartItemModel.set("firstRow",!1),i.promotionAndNoticeChecker()}},sortingRender:function(e){var t=this,r=t.$el;e.sort(t.cartItemSortFunction);for(var o=0;o<e.length;o++)r.prepend(e[o].$el),o===e.length-1?e[o].cartItemModel.set("firstRow",!0):e[o].cartItemModel.set("firstRow",!1);t.cartItemViewArray=e},deletedItemViewHandler:function(t){var r=this,o=r.cartItemViewArray,n=t.cartItemView,l=(t.cartItemModel,t.deliveryPolicyModel);if(0===l.get("unitCodeList").length)r.$el.remove(),r.trigger("deletedGroupView",{groupView:r,deliveryPolicyModel:l});else{var i=o.indexOf(n);i>-1&&o.splice(i,1);for(var a=0;a<o.length;a++){var d=o[a];d.deliveryPolicyModel=l,d.promotionAndNoticeChecker()}e.trigger("requsetResetTotalOrderPrice",{})}},cartItemSortFunction:function(e,t){var r=e.cartItemModel.get("cartInsertDate"),o=t.cartItemModel.get("cartInsertDate");if(r==o){var n=e.cartItemModel.get("itemPriceInfo").salePrice,l=t.cartItemModel.get("itemPriceInfo").salePrice;if(n==l){var i=e.cartItemModel.get("itemCode"),a=t.cartItemModel.get("itemCode");if(i==a){var d=e.cartItemModel.get("itemBasicInfo").unitCode,s=t.cartItemModel.get("itemBasicInfo").unitCode;return d==s?0:d<s?1:-1}return i<a?1:-1}return n<l?-1:1}return r<o?-1:1},priceCompareSortFunction:function(e,t){var r=this,o=e.cartItemModel.get("itemPriceInfo").salePrice,n=t.cartItemModel.get("itemPriceInfo").salePrice;return o==n?r.itemCodeCompareSortFunction(e,t):o<n?-1:1},itemCodeCompareSortFunction:function(e,t){var r=this,o=e.cartItemModel.get("itemCode"),n=t.cartItemModel.get("itemCode");return o==n?r.unitCodeCompareSortFunction(e,t):o<n?1:-1},unitCodeCompareSortFunction:function(e,t){var r=e.cartItemModel.get("itemBasicInfo").unitCode,o=t.cartItemModel.get("itemBasicInfo").unitCode;return r==o?0:r<o?1:-1},compareTopInsertDate:function(e){var t=this;t.topCartInsertDate<e&&(t.topCartInsertDate=e)}})}),define("page/cjmall/order/cart/cartItemView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/appInterfaceUtil","common/cjmall/util/cjmallUtil","common/cjos/util/eventProxyManager","common/cjos/util/eventProxyTypes","common/cjos/util/urlUtil","page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/util/deliveryUtils","page/cjmall/order/cart/util/cartOrderUtils","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l,i,a,d,s,c){return Backbone.View.extend({className:"lst_item _itemViewContainer",template:Handlebars.compile($("#itemViewTemplate").html()),cartItemModel:null,deliveryPolicyModel:null,soldOutApproachingNumber:10,isOptionDivOpen:!1,deliveryTypeNames:{COLLECT:"배송비 착불",FREE:"배송비 무료",NONE:"배송 없음",PAYMENT:"유료배송",FAST:"빠른배송",IMMEDIATE:"바로사용",FREE_CONDITION:"배송비 무료"},data:{},model:"",events:{"click ._itemCheckDom":"checkBoxHandler","keypress ._itemCheckDom":"keyPressCheckBoxHandler","click ._itemDeleteButton":"deleteHandler","click #_optionChangeButton":"optionChangeHandler","click #_reCartButton":"reCartHandler","click #_itemBuyButton":"itemBuyHandler","click #_optionQuantityIncrementButton":"optionQuantityIncrementHandler","click #_optionQuantityDecrementButton":"optionQuantityDecrementHandler","click #_optionChangeCancelButton":"optionChangeCancelHandler","click #_optionChangeSubmitButton":"optionChangeSubmitHandler","keyup #_quantityInput":"optionQuantitySetting","click #_itemOptionSelector":"optionSelectorClickHn","change #_itemOptionSelector":"optionSelectorChangeHn","click .goods_info":"goodsInfoHandler"},goodsInfoHandler:function(e){this.setSplunkEventLog("CART____product__prd__")},setSplunkEventLog:function(e){var t,r,o,n,l=this,i=l.cartItemModel,a=l.getStringValue(i.get("pgmCd")),d=l.getStringValue(i.get("IpgmCd")),s=i.get("itemCode"),u=i.get("itemBasicInfo").unitCode,p=i.get("itemBasicInfo").mainVenCd,m=i.get("categoryInfo");t=l.getStringValue(m.llargeCategoryId),r=l.getStringValue(m.largeCategoryId),o=l.getStringValue(m.middleCategoryId),n=l.getStringValue(m.smallCategoryId),c.splunkEventLog("click",e,{gCateCd:t,lCateCd:r,mCateCd:o,sCateCd:n,pgmCd:a,IpgmCd:d,productId:s,productUnitCode:u,partnerCd:p})},getStringValue:function(e){var t="";return _.isEmpty(e)||(t=e),t},initialize:function(){var e=this;e.cartItemModel=e.model,e.setData(),e.render()},setData:function(){for(var e=this,t=e.cartItemModel,r=t.get("itemBasicInfo").unitCode,n=a.get("deliveryPolicyCollection"),l=null,i=0;i<n.length;i++){for(var d=n.at(i).get("unitCodeList"),c=0;c<d.length;c++)if(r===d[c]){l=n.at(i);break}if(null!=l)break}e.deliveryPolicyModel=l;var u=(t.get("itemCode"),t.get("itemImageUrl")),p=t.get("channelCode"),m=o.getLinkUrl(t.get("itemCode"),p),f=t.get("itemPriceInfo").customerPrice;null==f&&(f=t.get("itemPriceInfo").salePrice*t.get("quantity"));var g=!1;f>1e8&&(g=!0);var v=l.get("deliveryPrice"),y=t.get("itemDeliveryInfo").deliveryTypeName,h=e.deliveryTypeNames[y],C=[];t.get("itemDiscountInfo")&&(C=t.get("itemDiscountInfo").discountDetails);var P;if(!_.isEmpty(C))for(var i=0;i<C.length;i++){var A=C[i].category;"LUMP_SUM"===A&&(P=C[i].lumpSumMonth)}var T=t.get("itemDeliveryInfo").deliveryPossibleDay,I="";_.isEmpty(T)||(I=T.finalResToDate);var w=t.get("itemBasicInfo").displayUnitName;"없음"===w&&(w="단일상품");var k=[],b=[],D=[],M=t.get("totalGiftInfo");if(!_.isEmpty(M))for(var i=0;i<M.length;i++){var O=M[i],S=O.itemEtcType,N=O.giftUnitName;null==N&&(N=O.itemName,O.giftUnitName=N);var j=t.get("quantity"),$=O.payQty;if(!_.isNull(j)&&!_.isNull($)){var E=Number(j)*Number($);O.giftUnitName+=" | "+E+"개"}switch(S){case"ONE_GIFT":k.push(O);break;case"ADD_GIFT":b.push(O);break;case"LINK_GIFT":D.push(O)}}var L=t.get("isCookit"),V="";L&&(V=s.getCookitSupplyPlanText(t));var x=new Backbone.Model({id:t.get("id"),displayItemName:t.get("itemBasicInfo").itemNm,displayUnitName:w,quantity:t.get("quantity"),unitStockQuantity:t.get("unitStockQuantity"),itemPrice:f,overItemPriceCheck:g,deliveryPrice:v,finalResToDate:I,itemDetailImgUrl:u,itemDetailUrl:m,lumpSumMonth:P,deliveryTypeName:h,giftItems:k,linkGiftItems:D,addGiftItems:b,checked:t.get("checked"),isReCart:t.get("isReCart"),isCookit:L,cookitsupplyPlanText:V,isInstallationDelivery:t.get("isInstallationDelivery")});e.data=x.toJSON()},render:function(){var e=this,t=e.$el;Handlebars.registerHelper({isShowLinkGiftItem:e.isShowLinkGiftItem,isSoldOutLinkGiftItems:e.isSoldOutLinkGiftItems,isSoldOutGiftItem:e.isSoldOutGiftItem,isSoldOutOption:e.isSoldOutOption}),t.html(e.template(e.data)),e.checker()},isSoldOutOption:function(e){var t=this.saleType,r=this.stock;return"A"===t&&r>0?e.inverse(this):e.fn(this)},buyMinQty:function(){return this.cartItemModel.get("itemBasicInfo").orderMinQty},isShowLinkGiftItem:function(e){var t=this.linkGiftItems;return _.isEmpty(t)?e.inverse(this):e.fn(this)},isSoldOutGiftItem:function(e){var t=this,r=t.stock;return"A"===t.slCls&&r>0?e.inverse(this):e.fn(this)},isSoldOutLinkGiftItems:function(e){for(var t=this,r=t.linkGiftItems,o=0,n=0;n<r.length;n++){"A"!=r[n].giftSlCls&&o++}if(r.length===o)return e.fn(this)},checker:function(){var e=this;e.promotionAndNoticeChecker(),e.itemSoldOutChecker()},recartChecker:function(){var e=this;e.cartItemModel.get("isReCart")&&e.changeNotOrderView()},itemSoldOutChecker:function(){var e=this,r=e.cartItemModel,o=r.get("itemSaleCls").code;if(r.get("isReCart"))e.recartChecker();else if("S"===o){r.set("isSoldOut",!0);var n=e.$el,l=n.find(".tit_goods").parents(".lst_item"),i=n.find(".lst_opt"),a=n.find(".goods_order"),d=(n.find(".btn_buy"),n.find("#_unitSoldOutLabel"));switch(e.changeNotOrderView(),a.hide(),l.addClass("sold_out"),i.addClass("sold_out"),d.show(),t.get(t.APPLICATION_TYPE)){case"p":d.html("<span>매진</span>");break;case"m":d.html("매진")}}else e.unitSoldOutChecker()},unitSoldOutChecker:function(){var e=this,t=e.$el,r=(t.find(".tit_goods").parents(".lst_item"),e.cartItemModel),o=r.get("unitStockQuantity");if("S"===r.get("itemBasicInfo").itemStatus.code||o<=0){r.set("isSoldOut",!0);var n=t.find(".lst_opt"),l=t.find(".btn_buy"),i=n.find("> .flag_soldout");e.changeNotOrderView(),l.hide(),n.addClass("sold_out"),i.removeAttr("style")}else if(o<e.soldOutApproachingNumber){var n=t.find(".lst_opt"),i=n.find("> .flag_soldout"),a=n.find("> .current_ea");i.show(),a.show()}e.giftUnitSoldOutChecker()},giftUnitSoldOutChecker:function(){var e=this,t=e.$el,r=(t.find(".tit_goods").parents(".lst_item"),e.cartItemModel),o=r.get("totalGiftInfo");if(!_.isEmpty(o))for(var n=0;n<o.length;n++){var l=o[n].slCls.code;if("A"!=o[n].giftSlCls||"A"!=l){var i=t.find(".expatiate");if("ONE_GIFT"==o[n].itemEtcType)i=t.find("#_giftItemContainer");else if("ADD_GIFT"==o[n].itemEtcType)i=t.find("#_addGiftItemContainer");else{if("LINK_GIFT"!=o[n].itemEtcType)break;i=t.find("#_linkGiftItemContainer")}var a=t.find(".btn_buy");i.find("> .flag_soldout");e.changeNotOrderView(),a.hide(),i.addClass("sold_out")}}},changeNotOrderView:function(){var e=this,t=e.$el,r=e.cartItemModel,o="#"+r.cid,n=t.find(".price"),l=t.find(".bundle_sales"),i=t.find("_booksOrder"),s=t.find("._interestFree"),c=t.find(".tit_goods").find(o);n.hide(),l.hide(),i.hide(),s.hide(),c.prop("checked",!1),c.attr("disabled",!0);var u=e.deliveryPolicyModel,p=a.get("totalOrderPriceInfoModel").cartListCollection,m=a.get("totalOrderPriceInfoModel").deliveryPolicyCollection;p.remove(r),d.removeOrderUnitCodeToDeliveryPolicyModel(r,u),0===u.get("orderUnitCodeList").length&&m.remove(u),d.resetDeliveryPolicyModel(r,u,u.get("orderUnitCodeList"),!1),a.trigger("requsetResetTotalOrderPrice",{})},promotionAndNoticeChecker:function(){var e=this,t=e.cartItemModel,r=e.deliveryPolicyModel,o=e.$el,n=o.find("._deliveryPriceText"),l=o.find("._deliveryFreeText"),i=o.find("._groupDeliveryPromotion"),a=r.get("unitCodeList"),d=t.get("itemBasicInfo").unitCode,s=o.find("input:checkbox[class=_itemCheckBox]"),c=s.is(":checked");a.length>1&&(a=r.has("orderUnitCodeList")?r.get("orderUnitCodeList"):r.get("unitCodeList"));var u=t.get("itemDeliveryInfo").deliveryTypeName;"FREE"===u||"COLLECT"===u||"NONE"===u?(n.hide(),l.show()):(n.show(),l.hide());var p=t.get("itemDeliveryInfo").cancelLine;p?(n.hide(),l.show()):n.removeClass("free"),a.length>1&&_.contains(a,d)?r.get("freeDelivery")&&0==t.get("itemDeliveryInfo").orderDeliveryPrice||p||(!1===c?(n.removeClass("free"),i.hide()):r.get("bundleSale")?(n.addClass("free"),i.show()):(r.get("groupDeliveryPrice")>0&&!0===t.get("firstRow")?n.removeClass("free"):n.addClass("free"),!0===t.get("firstRow")?i.hide():i.show())):i.hide(),e.reservationMessageChecker(),e.freeItemChecker();var m=[];if(t.get("itemDiscountInfo")&&(m=t.get("itemDiscountInfo").discountDetails),!_.isEmpty(m))for(var f=0;f<m.length;f++){var g=m[f].category;if("LUMP_SUM"===g){var v=m[f].lumpSumMonth;if(0!=v){var y=o.find("._interestFree");y.show()}}}if("1"===t.get("incomeDedYn")){o.find("._taxCredit").show()}},reservationMessageChecker:function(){var e=this,t=e.cartItemModel,r=t.get("itemDeliveryInfo").deliveryPossibleDay;if(!_.isEmpty(r)&&r.deliveryPossible){e.$el.find("._booksOrder").show()}},freeItemChecker:function(){var e=this,t=e.cartItemModel,r=e.$el,o=t.get("isCellPhone"),n=t.get("itemPriceInfo").salePrice;if(o){var l=r.find("._deliveryPriceText"),i=r.find("._deliveryFreeText"),a=r.find("._noPayText");l.hide(),i.show(),0==Number(n)&&a.show()}},deleteHandler:function(e){var t,r=this,o=r.cartItemModel,i=r.deliveryPolicyModel;if(o.get("isSoldOut")){var s=o.get("itemSaleCls").code;o.get("unitStockQuantity"),o.get("itemBasicInfo").itemStatus.code;t="S"===s?"CART____product__solddelete2__":"CART____product__solddelete1__"}else t="CART____product__delete__";e&&e.originalEvent&&r.setSplunkEventLog(t);var c=[],u={grpCode:o.get("groupCode"),cartSeq:o.get("cartSequence")};c.push(u);var p=JSON.stringify({cartKeyCriterias:c});r.$el.find("._itemDeleteButton").attr("disabled","disabled"),o.destroy({headers:{Accept:"application/json","Content-Type":"application/json"},data:p,xhrFields:{withCredentials:!0},success:function(e,t){if(1!=t.code)return alert("잠시 후 다시 시도해주세요."),void r.$el.find("._itemDeleteButton").removeAttr("disabled");var s=a.get("totalOrderPriceInfoModel").deliveryPolicyCollection;r.$el.remove(),d.removeUnitCodeToDeliveryPolicyModel(o,i),d.removeOrderUnitCodeToDeliveryPolicyModel(o,i),0===i.get("orderUnitCodeList").length?s.remove(i):d.resetDeliveryPolicyModel(o,i,i.get("orderUnitCodeList"),!1),r.trigger("deletedItemModel",{cartItemView:r,cartItemModel:o,deliveryPolicyModel:i}),r.trigger("reRenderCartGroupView",{cartItemView:r,cartItemModel:o,deliveryPolicyModel:i}),n.trigger(l.CART.UPDATED)},error:function(e,t){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("삭제 실패 모델 : ",e),cjosLogUtil.log("삭제 실패 응답 : ",t),r.$el.find("._itemDeleteButton").removeAttr("disabled")}})},reCartHandler:function(e){var t=this;e&&(e.originalEvent&&t.setSplunkEventLog("CART____product__recart__"),e.preventDefault());var r=t.cartItemModel;t.deliveryPolicyModel;alert("장바구니에 담은 시점과 상품정보가 달라졌습니다.\n확인 후 다시 담아주세요.\n장바구니에서 삭제하고 상품상세로 이동합니다.");var i=[],a={grpCode:r.get("groupCode"),cartSeq:r.get("cartSequence")};i.push(a);var d=JSON.stringify({cartKeyCriterias:i});r.destroy({headers:{Accept:"application/json","Content-Type":"application/json"},data:d,xhrFields:{withCredentials:!0},success:function(e,t){if(1!=t.code)return void alert("잠시 후 다시 시도해주세요.");n.trigger(l.CART.UPDATED),cjosLogUtil.log("상품상세로 이동",r.get("itemDetailUrl")),location.href=o.getLinkUrl(r.get("itemCode"),r.get("channelCode"))},error:function(e,t){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("삭제 실패 응답 : ",t)}})},keyPressCheckBoxHandler:function(e){e.preventDefault();var t=this;32===e.keyCode&&t.checkBoxHandler(e)},checkBoxHandler:function(e){e.preventDefault();var t,r=this,o=r.cartItemModel,n=r.deliveryPolicyModel,l=(a.get("totalOrderPriceInfoModel").cartListCollection,a.get("totalOrderPriceInfoModel").deliveryPolicyCollection,o.get("isSoloOrder")),i=o.get("isCookit"),d=o.get("isDawn"),c=o.get("isOlive"),u="";i?u="cookit_all":d?u="dawn_all":c&&(u="olive_all");var p=r.$el,m=$("#"+u),f=p.find("input:checkbox[class=_itemCheckBox]");if(!f.attr("disabled")){if(f.is(":checked"))t="CART____product__selectoff__",s.removeSelectedItemOrderList(f),m.is(":checked")&&m.prop("checked",!1);else{if(t="CART____product__selecton__",l){var g=o.get("itemBasicInfo").itemNm,v="상품명: "+g+" 선택하신 상품은 단독주문만 가능합니다. 선택하시겠습니까?";if(!confirm(v))return;s.resetTotalCheckboxItemOrderList(f)}else{if(a.soloOrderFlag){var y="상품명 : "+a.soloOrderItemName+"위 상품은 단독주문만 가능합니다. 불편하시더라도 따로 주문해주세요.";return void alert(y)}if(i){var h=o.get("cookitSupplyPlanList");if(_.isEmpty(h))return void alert("배송 가능한 일자가 없습니다.")}}s.addSelectedItemOrderList(f)}r.trigger("reRenderCartGroupView",{cartItemView:r,cartItemModel:o,deliveryPolicyModel:n}),e.originalEvent&&r.setSplunkEventLog(t),a.trigger("requsetResetTotalOrderPrice",{})}},itemBuyHandler:function(r){r.preventDefault();var o=this,n=o.cartItemModel;if(n.get("isCookit")&&null==n.get("cookitSupplyPlanList"))return alert("CJ COOKIT 주문 가능한 날짜가 없습니다."),!1;var l=[];l.push(n.makeOrderItemForm());var i=JSON.stringify({orderFormType:"CART",orderItemForms:l}),a=e.get("ecBaseSslUrl")+"/c/rest/order/tempOrder",d="";switch(t.get(t.APPLICATION_TYPE)){case"p":d=e.get("ecBaseSslUrl")+"/p/order/sheet/";break;case"m":d=e.get("ecBaseSslUrl")+"/m/order/sheet/"}o.setSplunkEventLog("CART____product__prdpay__"),$.ajax({url:a,type:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:i,xhrFields:{withCredentials:!0},success:function(e){if(1!=e.code)return void alert("잠시 후 다시 시도해주세요.");var t=e.result,r=d+t;location.href=r},error:function(e,t,r){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("구매하기 실패 : response ",e)}})},optionChangeHandler:function(t){var r,o=this,n=o.$el,l=n.find("#_optionDiv"),i=o.cartItemModel,a=n.find("#_optionChangeButtonClickCheck");if(r=i.get("isSoldOut")?"CART____product__optmodisold__":"CART____product__optmodi__",t&&t.originalEvent&&o.setSplunkEventLog(r),o.isOptionDivOpen)return o.isOptionDivOpen=!1,void o.optionChangeCancelHandler();if("1"!=a.val()){a.val("1");var d=i.get("itemCode"),s=i.get("itemBasicInfo").unitCode,c=i.get("channelCode"),u=e.get("ecBaseSslUrl")+"/c/rest/item/"+d+"/oldOptions.json?channelCode="+c,p=$.ajax({url:u,type:"GET",data:""}),m=e.get("ecBaseSslUrl")+"/c/rest/cart/giftItemOption?itemCode="+d+"&unitCode="+s+"&channelCode="+c,f=$.ajax({url:m,type:"GET",data:""});$.when(p,f).done(function(e,t){var r=e[0],n=t[0];if(1!=r.code)return cjosLogUtil.log("상품 옵션 리스트 로딩 불가."),void a.val("0");var i=r.result.unitItems;if(i.length>200)for(var d=0;d<i.length;d++)i[d].stock=99999;if(i.length>0?o.optionTemplateRender(i):cjosLogUtil.log("상품 옵션 리스트가 없습니다."),1!=n.code)return cjosLogUtil.log("사은품 옵션 리스트 로딩 불가"),void a.val("0");var s=n.result,c=[],u=[];if(null!=s&&s.length>0){for(var p=0,m=0;m<s.length;m++)for(var f=s[m],g=f.slCls.code,v=0;v<f.giftUnitItems.length;v++){var y=f.giftUnitItems[v];"A"==g&&"A"==y.slCls&&y.stock>0&&(p+=y.stock)}var h=f.qtyLimitCd;if(p<=0&&"2"!==h)return cjosLogUtil.log("이 상품에 제공되는 사은품이 전체 매진 상태로  변경할 수 있는 상품이 없습니다"),alert("이 상품에 제공되는 사은품이 전체 매진 상태로  변경할 수 있는 상품이 없습니다"),void a.val("0")}for(var m=0;m<s.length;m++){var f=s[m],C=f.itemEtcType,h=f.qtyLimitCd;switch(C){case"ONE_GIFT":if("2"===h)break;c.push(f);break;case"ADD_GIFT":u.push(f)}}if(!_.isEmpty(c)){var P=o.getIsUnitMappYn();o.giftItemOptionTemplateRender(c,P)}_.isEmpty(u)||o.addGiftItemOptionTemplateRender(u),l.show(),o.isOptionDivOpen=!0,a.val("0")})}},optionTemplateRender:function(e){var t=this,r=t.$el,o=r.find("#_optionDiv"),n=o.find("#_itemOption"),l={unitItems:e},i=Handlebars.compile($("#optionTemplate").html());n.append(i(l));var a=t.cartItemModel.get("itemBasicInfo").unitCode;n.find("option[id="+a+"]").prop("selected",!0)},giftItemOptionTemplateRender:function(e,t){for(var r=this,o=r.$el,n=o.find("#_optionDiv"),l=n.find("#_giftItemOption"),i=0;i<e.length;i++){var a={giftItems:[]},d=e[i],s=d.giftItemName,c=d.giftUnitItems;if(!_.isEmpty(c))for(var u=0;u<c.length;u++){var p=c[u],m=p.itemName,f=s+":"+m,g={itemCode:p.itemCode,unitCode:p.unitCode,itemName:f,stock:p.stock,slCls:p.slCls};a.giftItems.push(g)}var v=Handlebars.compile($("#giftItemTemplate").html());!_.isUndefined(t)&&t?(l.empty(),_.each(a.giftItems,function(e){var t={giftItems:[]};t.giftItems.push(e),l.append(v(t))})):l.append(v(a));var y=r.cartItemModel.get("totalGiftInfo");if(!_.isEmpty(y))for(var h=0;h<y.length;h++){var C=y[h],P=C.giftUnitCode,A=C.itemEtcType;if("ONE_GIFT"==A){var T=n.find(".giftItemOptionSelectorClass"),I=$(T[h]);I.data("giftcartSeq",C.giftcartSeq),I.data("promotionNo",C.tpromofferEntityKey.promNo),I.data("promotionSeq",C.tpromofferEntityKey.promSeq),I.data("offerSeq",C.tpromofferEntityKey.offerSeq)}var w=l.find("option[id="+P+"]");w.prop("selected",!0)}}},addGiftItemOptionTemplateRender:function(e){for(var t=this,r=t.$el,o=r.find("#_optionDiv"),n=o.find("#_addGiftItemOption"),l=0;l<e.length;l++){var i={addGiftItems:[]},a=e[l],d=a.giftItemName,s=a.giftUnitItems;if(!_.isEmpty(s))for(var c=0;c<s.length;c++){var u=s[c],p=u.itemName,m=d+":"+p,f={itemCode:u.itemCode,unitCode:u.unitCode,itemName:m};i.addGiftItems.push(f)}var g=Handlebars.compile($("#addGiftItemTemplate").html());n.append(g(i));var v=t.cartItemModel.get("totalGiftInfo");if(!_.isEmpty(v))for(var y=0;y<v.length;y++){var h=v[y],C=h.giftUnitCode,P=h.itemEtcType;if("ADD_GIFT"==P){var A=o.find(".giftItemOptionSelectorClass"),T=A.length,I=o.find(".addGiftItemOptionSelectorClass"),w=$(I[y-T]);w.data("giftcartSeq",h.giftcartSeq),w.data("promotionNo",h.tpromofferEntityKey.promNo),w.data("promotionSeq",h.tpromofferEntityKey.promSeq),w.data("offerSeq",h.tpromofferEntityKey.offerSeq)}var k=n.find("option[id="+C+"]");k.prop("selected",!0)}}},optionQuantityIncrementHandler:function(e){var t=this,r=t.cartItemModel,o=r.get("itemBasicInfo").orderMaxQty;if(void 0===o||null===o){o=r.get("itemPriceInfo").salePrice>=1e7?10:99}var n=t.$el,l=n.find("#_optionDiv"),i=l.find("#_quantityInput"),a=i.val(),d=Number(a)+1;o<d&&(alert("상품구매 최대 수량을 초과하였습니다.1회당 최대 "+o+"개 구매가능합니다."),d=o),i.val(d)},optionQuantityDecrementHandler:function(e){var t=this,r=t.cartItemModel,o=r.get("itemBasicInfo").orderMinQty;void 0!==o&&null!==o||(o=1);var n=t.$el,l=n.find("#_optionDiv"),i=l.find("#_quantityInput"),a=i.val(),d=Number(a)-1;d<o&&(1!=o?(alert("최소 "+o+"개 이상 구매만 가능합니다.수량을 조정해주세요."),d=o):d=o),i.val(d)},optionChangeCancelHandler:function(e){var t=this,r=t.$el;e&&e.originalEvent&&t.setSplunkEventLog("CART____product__optcan__");var o=r.find("#_optionDiv"),n=o.find("#_itemOption"),l=o.find("#_quantityInput"),i=t.cartItemModel,a=i.get("totalGiftInfo"),d=i.get("itemBasicInfo").unitCode,s=o.find("#_giftItemOption"),c=o.find("#_addGiftItemOption");if(n.find("option[id="+d+"]").prop("selected",!0),!_.isEmpty(a))for(var u=0;u<a.length;u++){var p=a[u],m=p.giftUnitCode,f=p.itemEtcType;if("ONE_GIFT"==f){var g=s.find("option[id="+m+"]");g.prop("selected",!0)}else if("ADD_GIFT"==f){var g=c.find("option[id="+m+"]");g.prop("selected",!0)}}l.val(i.get("quantity")),n.empty(),s.empty(),c.empty(),o.hide(),t.isOptionDivOpen=!1},optionChangeSubmitHandler:function(e){var t=this;e&&e.originalEvent&&t.setSplunkEventLog("CART____product__modiok__");for(var r=t.cartItemModel,o=r.url,n=t.$el,l=n.find("#_optionDiv"),i=l.find("#_itemOption"),a={grpCode:r.get("groupCode"),cartSeq:r.get("cartSequence")},d=r.get("itemCode"),s=i.find("option:selected"),c=s.attr("id"),u=r.get("itemBasicInfo").unitCode,p=r.get("channelCode"),m=l.find("#_quantityInput"),f=m.val(),g=s.val(),v=[],y=l.find(".giftItemOptionSelectorClass"),h=y.length,C=0;C<h;C++){var P=$(y[C]),A={},T=P.data("giftcartSeq"),I=P.find("option:selected"),w=I.val(),k=I.attr("id"),b={grpCode:r.get("groupCode"),cartSeq:r.get("cartSequence"),giftCartSeq:T},D=P.data("promotionNo"),M=P.data("promotionSeq"),O=P.data("offerSeq"),A={};A.giftCartKeyCriteria=b,A.giftItemCode=w,A.giftUnitCode=k,A.promotionNo=D,A.promotionSeq=M,A.offerSeq=O,v.push(A)}for(var S=l.find(".addGiftItemOptionSelectorClass"),N=S.length,C=0;C<N;C++){var j=$(S[C]),A={},T=j.data("giftcartSeq"),I=j.find("option:selected"),w=I.val(),k=I.attr("id"),b={grpCode:r.get("groupCode"),cartSeq:r.get("cartSequence"),giftCartSeq:T},D=j.data("promotionNo"),M=j.data("promotionSeq"),O=j.data("offerSeq"),A={};A.giftCartKeyCriteria=b,A.giftItemCode=w,A.giftUnitCode=k,A.promotionNo=D,A.promotionSeq=M,A.offerSeq=O,v.push(A)}_.isEmpty(v)&&(v=null);var E=t.getIsUnitMappYn(),L=_.size(t.model.get("totalGiftInfo")),V=_.size(v);if(E&&L!==V)return alert("사은품정보가 변경되어 옵션변경이 불가합니다."),cjosLogUtil.log("[단품사은품매핑 사은품 종류변경]"),cjosLogUtil.log("기 장바구니 담긴 사은품 데이터",L),cjosLogUtil.log("본품의 단품 변경시 조회된 사은품 데이터",v),!1;var x={cartKeyCriteria:a,itemCode:d,oldUnitCode:u,unitCode:c,channelCode:p,quantity:f,unitPrice:g,modifyGiftCartForms:v},U=JSON.stringify(x);$.ajax({url:o,type:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},data:U,xhrFields:{withCredentials:!0},success:function(e){if(1!=e.code)return void alert(e.resMsg);alert("정상적으로 변경되었습니다."),window.location.reload(!0)},error:function(e,t,r){cjosLogUtil.log("장바구니 옵션변경 실패",e)}})},optionQuantitySetting:function(e){var t=this,r=t.$el,o=t.cartItemModel,n=o.get("itemBasicInfo").orderMaxQty,l=o.get("itemBasicInfo").orderMinQty,i=r.find("#_quantityInput"),a=i.val();if(void 0===n||null===n){n=o.get("itemPriceInfo").salePrice>=1e7?10:99}return void 0!==l&&null!==l||(l=1),""!=a&&l>a?(alert("장바구니에 담을 수 있는 상품의 수량은 "+l+"개 이상 이어야 합니다."),void r.find("#_quantityInput").val(l)):""!=a&&n<a?(alert("상품구매 최대 수량을 초과하였습니다.1회당 최대 "+n+"개 구매가능합니다."),void r.find("#_quantityInput").val(n)):void 0},optionSelectorClickHn:function(e){var t=this;e&&e.originalEvent&&t.setSplunkEventLog("CART____product__optsel__")},optionSelectorChangeHn:function(e){var t=this,r=$(e.currentTarget),o=t.model.get("itemCode"),n=r.find("option:selected").attr("id"),l=t.model.get("channelCode");t.model.get("totalGiftInfo");t.getIsUnitMappYn()&&t.getGiftItemsMappedByProductUnitCode(o,n,l),$("#_itemOptionSelector").focus()},getGiftItemsMappedByProductUnitCode:function(t,r,o){var n=this;if(!_.isEmpty(t)&&!_.isEmpty(r)&&!_.isNull(o)){var l=e.get("ecBaseSslUrl")+"/c/rest/cart/giftItemOption?itemCode="+t+"&unitCode="+r+"&channelCode="+o,i=$.ajax({url:l,type:"GET",data:""});$.when(i).done(function(e){var t=e;if(1!=t.code)return cjosLogUtil.log("사은품 옵션 리스트 로딩 불가"),void $optionClickCheck.val("0");var r=t.result,o=[];if(null!=r&&r.length>0){for(var l=0,i=0;i<r.length;i++)for(var a=r[i],d=a.slCls.code,s=0;s<a.giftUnitItems.length;s++){var c=a.giftUnitItems[s];"A"==d&&"A"==c.slCls&&c.stock>0&&(l+=c.stock)}var u=a.qtyLimitCd;if(l<=0&&"2"!==u)return cjosLogUtil.log("이 상품에 제공되는 사은품이 전체 매진 상태로  변경할 수 있는 상품이 없습니다"),alert("이 상품에 제공되는 사은품이 전체 매진 상태로  변경할 수 있는 상품이 없습니다"),void $optionClickCheck.val("0")}for(var i=0;i<r.length;i++){var a=r[i],p=a.itemEtcType,u=a.qtyLimitCd;switch(p){case"ONE_GIFT":if("2"===u)break;o.push(a)}}_.isEmpty(o)||n.giftItemOptionTemplateRender(o,!0)})}},getIsUnitMappYn:function(){var e=this,t=!1,r=e.model.get("totalGiftInfo");if(_.size(r)>0){"1"===r[0].unitMappYn&&(t=!0)}return t}})}),define("page/cjmall/order/cart/cartListView",["page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/models/deliveryPolicyModel","common/cjmall/util/cjmallUtil","common/cjos/advertise/util/advertiseUtil","common/cjos/advertise/models/advertiseConstantsModel","common/cjos/advertise/models/advertiseItemModel","common/cjos/advertise/advertiseCoreModule","page/cjmall/order/cart/cartGroupView","page/cjmall/order/cart/util/deliveryUtils","page/cjmall/order/cart/util/cartOrderUtils","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l,i,a,d,s,c){return Backbone.View.extend({el:"._cartListViewContainer",template:Handlebars.compile($("#groupViewTemplate").html()),deliveryPolicyCollection:null,allGroupViewArray:[],mallGroupViewArray:[],oliveGroupViewArray:[],cookitGroupViewArray:[],dawnGroupViewArray:[],mallViewArray:[],oliveViewArray:[],cookitViewArray:[],dawnViewArray:[],initialize:function(){var t=this;t.deliveryPolicyCollection=e.get("deliveryPolicyCollection"),null==t.deliveryPolicyCollection?(cjosLogUtil.log("[CartListView] s.deliveryPolicyCollection is null."),t.trigger("emptyCart",{cartListView:t})):t.render(),t.setAdvertiseKey(),t.setLoggerValue(),t.listenTo(e,"reRenderGroupView",t.reRenderGroupView),t.listenTo(e,"selectAllForCartGroup",t.selectAllForCartGroup)},events:{"click #cjmall_all":"allCheckHandler","click #olive_all":"allCheckHandler","click #cookit_all":"allCheckHandler","click #dawn_all":"allCheckHandler"},reRenderGroupView:function(){var e=this;e.mallViewArray.length>0&&e.mallViewArray.forEach(function(e){e.cartItemViewArray.forEach(function(t){var r=t.cartItemModel.get("itemBasicInfo").unitCode,o=d.getDeliveryPolicyModel(r);e.renderItemViewHandler({deliveryPolicyModel:o})})}),e.oliveViewArray.length>0&&e.oliveViewArray.forEach(function(e){e.cartItemViewArray.forEach(function(t){var r=t.cartItemModel.get("itemBasicInfo").unitCode,o=d.getDeliveryPolicyModel(r);e.renderItemViewHandler({deliveryPolicyModel:o})})}),e.cookitViewArray.length>0&&e.cookitViewArray.forEach(function(e){e.cartItemViewArray.forEach(function(t){var r=t.cartItemModel.get("itemBasicInfo").unitCode,o=d.getDeliveryPolicyModel(r);e.renderItemViewHandler({deliveryPolicyModel:o})})}),e.dawnViewArray.length>0&&e.dawnViewArray.forEach(function(e){e.cartItemViewArray.forEach(function(t){var r=t.cartItemModel.get("itemBasicInfo").unitCode,o=d.getDeliveryPolicyModel(r);e.renderItemViewHandler({deliveryPolicyModel:o})})})},allCheckHandler:function(e){var t=this,r=$(e.currentTarget);t.selectAllForCartGroup(r,"SELECT_ALL")},selectAllForCartGroup:function(t,r){var o=this,n=null;t!=undefined&&t.length>1?(n=t[0],r=t[1]):n=t;var l=n.data("groupclass"),i=$("."+l).find("input:checkbox[class=_itemCheckBox]"),a=(i.length,0),c=0,u=s.isBNPItemExistsInCart(),p=s.getItemCountForCJmall(),m=p>0,f=(s.isOliveItemExistsInCart(),s.isSoloOrderItemExistsInCart());"_cjmallGroup"==l&&(a=s.getItemCountForOlive());var g="한번에 주문 불가한 상품이 있어 제외하고 나머지를 전체 선택했습니다.";if("FULL_ORDER"==r&&(g="장바구니에 담긴 상품 중 단독주문 또는 매진상품을 제외하고 주문서로 이동합니다."),!0===n.is(":checked")){if(e.soloOrderFlag&&"_cjmallGroup"!=l){var v="상품명 : "+e.soloOrderItemName+"위 상품은 단독주문만 가능합니다. 불편하시더라도 따로 주문해주세요.";return alert(v),void n.prop("checked",!1)}var y=0;if("_cjmallGroup"==l&&m&&f)if(y=s.getSoloOrderItemCount(),"FULL_ORDER"!=r){if(p>1&&p==y)return alert("주문 상품이 모두 단독 주문 상품입니다. 단독 주문 상품은 하나씩 주문이 가능합니다."),void n.prop("checked",!1)}else if(p>1&&p==y&&0==a)return alert("주문 상품이 모두 단독 주문 상품입니다. 단독 주문 상품은 하나씩 주문이 가능합니다."),void n.prop("checked",!1);i.not(":disabled").each(function(){var t=$(this).attr("id"),o=e.get("cartListCollection").get(t),n=o.get("isSoldOut"),u=o.get("isSoloOrder"),p=o.get("itemBasicInfo").unitCode,m=d.getDeliveryPolicyModel(p),f=o.get("isCookit"),g=o.get("cookitSupplyPlanList"),v=!1;f&&_.isEmpty(g)&&(v=!0);var h=!1;if((u||n||v||null==m)&&(h="FULL_ORDER"!=r?"_cjmallGroup"!=l||!u||1!=i.size():"_cjmallGroup"!=l||!u||1!=i.size()||0!=a),h)s.removeSelectedItemOrderList(this),y++;else{if("FULL_ORDER"!=r&&"_cjmallGroup"==l&&u&&1==i.size()){var C=o.get("itemBasicInfo").itemNm,P="상품명: "+C+" 선택하신 상품은 단독주문만 가능합니다. 선택하시겠습니까?";confirm(P)&&(s.resetTotalCheckboxItemOrderList(),e.trigger("reRenderGroupView",{}),e.trigger("requsetResetTotalOrderPrice",{}),s.addSelectedItemOrderList(this),c++,$("#olive_all").prop("checked",!1),$("#cookit_all").prop("checked",!1),$("#dawn_all").prop("checked",!1))}else s.addSelectedItemOrderList(this),c++}}),0==c?n.prop("checked",!1):y>0&&c>0&&(1==y&&1==c||(0==u&&alert(g),n.prop("checked",!1)))}else i.not(":disabled").each(function(){s.removeSelectedItemOrderList(this)});o.reRenderGroupView(),e.trigger("requsetResetTotalOrderPrice",{})},render:function(){var e=this;e.setCartGroupView(),e.sortingRender(),e.setAdvertiseValue()},setCartGroupView:function(){for(var r=this,o=r.deliveryPolicyCollection,n=e.get("cartListCollection"),l=0;l<n.length;l++){var i=n.at(l),s=i.get("itemDeliveryInfo"),c=s.deliveryCostGrpCode,u=i.get("itemBasicInfo").unitCode,p=[];if(p.push(u),"NONE"===c){var m=new t({deliveryCostGroupCode:s.deliveryCostGrpCode,deliveryClassificationCode:s.deliveryClsCode,deliveryCostCode:s.deliveryCostCode,deliveryType:s.deliveryType,unitCodeList:p,orderUnitCodeList:p});o.add(m)}var f=d.getDeliveryPolicyModel(u);i.get("isOlive")?-1==r.oliveGroupViewArray.indexOf(f)&&r.oliveGroupViewArray.push(f):i.get("isCookit")?-1==r.cookitGroupViewArray.indexOf(f)&&r.cookitGroupViewArray.push(f):i.get("isDawn")?-1==r.dawnGroupViewArray.indexOf(f)&&r.dawnGroupViewArray.push(f):-1==r.mallGroupViewArray.indexOf(f)&&r.mallGroupViewArray.push(f)}if(0==o.length)return cjosLogUtil.log("[CartListView] deliveryPolicyCollection.length is 0."),void r.renderEmptyCart();r.mallGroupViewArray.forEach(function(e){var t=new a({model:e,isOlive:!1,isCookit:!1,isDawn:!1,groupViewType:"cjmall",groupViewEl:"#cjmall_group"});r.listenTo(t,"deletedGroupView",r.deleteGroupViewHandler),r.mallViewArray.push(t)}),r.oliveGroupViewArray.forEach(function(e){var t=new a({model:e,isOlive:!0,isCookit:!1,isDawn:!1,groupViewType:"olive",groupViewEl:"#olive_group"});r.listenTo(t,"deletedGroupView",r.deleteGroupViewHandler),r.oliveViewArray.push(t)}),r.cookitGroupViewArray.forEach(function(e){var t=new a({model:e,isOlive:!1,isCookit:!0,isDawn:!1,groupViewType:"cookit",groupViewEl:"#cookit_group"});r.listenTo(t,"deletedGroupView",r.deleteGroupViewHandler),r.cookitViewArray.push(t)}),r.dawnGroupViewArray.forEach(function(e){var t=new a({model:e,isOlive:!1,isCookit:!1,isDawn:!0,groupViewType:"dawn",groupViewEl:"#dawn_group"});r.listenTo(t,"deletedGroupView",r.deleteGroupViewHandler),
r.dawnViewArray.push(t)})},calculateGroupView:function(){var t=this;if(0===t.mallViewArray.length+t.cookitViewArray.length+t.oliveViewArray.length+t.dawnViewArray.length)return void t.renderEmptyCart();e.trigger("requsetResetTotalOrderPrice",{})},deleteGroupViewHandler:function(t){var r=this,o=t.groupView,n=r.getGroupViewArray(o.groupViewType),l=n.indexOf(o);l>-1&&n.splice(l,1);var i=t.deliveryPolicyModel;(e.get("deliveryPolicyCollection").remove(i),0==n.length)&&r.$el.find(""+o.groupViewEl).remove();r.calculateGroupView()},reverseInsertDateCompareSortFunction:function(e,t){var r=e.topCartInsertDate,o=t.topCartInsertDate,n=e.deliveryPolicyModel.get("deliveryCostGroupCode"),l=t.deliveryPolicyModel.get("deliveryCostGroupCode");return r==o?n==l?0:n<l?1:-1:r<o?1:-1},sortingRender:function(){var t=this;t.$el;if(t.mallViewArray.length>0&&(t.mallViewArray.sort(t.reverseInsertDateCompareSortFunction),t.allGroupViewArray.push(t.mallViewArray)),t.oliveViewArray.length>0&&(t.oliveViewArray.sort(t.reverseInsertDateCompareSortFunction),t.allGroupViewArray.push(t.oliveViewArray)),t.cookitViewArray.length>0&&(t.cookitViewArray.sort(t.reverseInsertDateCompareSortFunction),t.allGroupViewArray.push(t.cookitViewArray)),t.dawnViewArray.length>0&&(t.dawnViewArray.sort(t.reverseInsertDateCompareSortFunction),t.allGroupViewArray.push(t.dawnViewArray)),t.allGroupViewArray.length>0){t.allGroupViewArray.sort(t.cartGroupSortingByInsertDate);var r=!0;$.each(t.allGroupViewArray,function(e,o){1==o[0].isOlive&&0==o[0].isCookit&&0==o[0].isDawn?t.oliveYoungRender(o):0==o[0].isOlive&&1==o[0].isCookit&&0==o[0].isDawn?t.cookitRender(o):0==o[0].isOlive&&0==o[0].isCookit&&1==o[0].isDawn?t.dawnRender(o):t.cjmallRender(o),r&&(r=!1,t.checkItemCodeAddedCartToday(o))}),t.reRenderGroupView(),e.trigger("requsetResetTotalOrderPrice",{})}},setItemCodeAddedCartToday:function(t){var r=this,o=r.getDateTime();_.each(t,function(t){var n=t.cartItemViewArray;_.each(n,function(t){var n=t.model,l=r.getDateTime(n.get("cartInsertDate"));o==l&&e.toDayIntoCartItemCodes.push(n.get("itemCode"))})})},checkItemCodeAddedCartToday:function(e){var t=this,r=(t.$el,0),o=0,n=!1,l=!1,i=!1;1==e[0].isOlive&&0==e[0].isCookit&&0==e[0].isDawn?n=!0:0==e[0].isOlive&&1==e[0].isCookit&&0==e[0].isDawn?l=!0:0==e[0].isOlive&&0==e[0].isCookit&&1==e[0].isDawn&&(i=!0),t.setItemCodeAddedCartToday(e),_.each(e,function(e){var n=e.cartItemViewArray;_.each(n,function(e){r++;var n=e.model,l=n.get("isSoloOrder"),i=n.get("itemCode"),a=n.get("itemBasicInfo").unitCode,c=(d.getDeliveryPolicyModel(a),t.isNotTodayAddCart(i)),u=n.get("isCookit"),p=!1;if(u){var m=n.get("cookitSupplyPlanList");_.isEmpty(m)&&(p=!0)}var f=!1;(l||c||p)&&(f=!0);var g=e.$el.find("input:checkbox[class=_itemCheckBox]");0==f&&!1===g.is(":disabled")&&(s.addSelectedItemOrderList(g),o++)})}),r==o&&(n?$("#olive_all").prop("checked",!0):l?$("#cookit_all").prop("checked",!0):i?$("#dawn_all").prop("checked",!0):$("#cjmall_all").prop("checked",!0))},isNotTodayAddCart:function(t){var r=!0;if(null!=e.toDayIntoCartItemCodes){var o=e.toDayIntoCartItemCodes;_.each(o,function(e){if(t==e)return r=!1,!1})}return r},cjmallRender:function(e){var t=this,r=t.$el,o=Handlebars.compile($("#cjmallViewTemplate").html());r.append(o()),$.each(e,function(e,t){r.append(t.$el)})},oliveYoungRender:function(t){var r=this,o=r.$el,n=e.get("totalOrderPriceInfoModel"),l=n.get("cjCardDiscountRate"),i=Handlebars.compile($("#oliveViewTemplate").html());o.append(i({discountRate:l})),$.each(t,function(e,t){o.append(t.$el)})},cookitRender:function(e){var t=this,r=t.$el,o=Handlebars.compile($("#cookitViewTemplate").html());r.append(o()),$.each(e,function(e,t){r.append(t.$el)})},dawnRender:function(e){var t=this,r=t.$el,o=Handlebars.compile($("#dawnViewTemplate").html());r.append(o()),$.each(e,function(e,t){r.append(t.$el)})},cartGroupSortingByInsertDate:function(e,t){var r=e[0].topCartInsertDate,o=t[0].topCartInsertDate,n=e[0].deliveryPolicyModel.get("deliveryCostGroupCode"),l=t[0].deliveryPolicyModel.get("deliveryCostGroupCode");return r==o?n==l?0:n<l?1:-1:r<o?1:-1},renderEmptyCart:function(){var e=this;e.trigger("emptyCart",{cartListView:e})},getGroupViewArray:function(e){var t=this;return"olive"==e?t.oliveViewArray:"cookit"==e?t.cookitViewArray:"dawn"==e?t.dawnViewArray:t.mallViewArray},setAdvertiseKey:function(){o.advertiseSetKey(n.PAGE_TYPE),o.advertiseSetKey(n.ITEM_ARRAY)},setAdvertiseValue:function(){var t=e.get("cartListCollection"),i=[];try{for(var a=0;a<t.length;a++){var d=new l,s=t.at(a),c=s.get("itemCode"),u=s.get("itemBasicInfo").itemNm,p=r.getImgUrl(c),m=s.get("itemPriceInfo").salePrice,f=s.get("channelCode"),g=s.get("quantity");d.set(n.ITEM.ITEM_CODE,c),d.set(n.ITEM.ITEM_NAME,u),d.set(n.ITEM.ITEM_IMG_URL,p),d.set(n.ITEM.UNIT_PRICE,m),d.set(n.ITEM.UNIT_QTY,g),d.set(n.ITEM.ITEM_CHANNEL_CODE,f),i.push(d)}o.advertiseSetValue(n.PAGE_TYPE,"cartList"),o.advertiseSetValue(n.ITEM_ARRAY,i)}catch(v){cjosLogUtil.log("[제휴 advertiseItemModel set]",v)}},setLoggerValue:function(){var t="",r="",o="",n="",l="",i="",a="",d="",s="",u=this,p=e.get("cartListCollection"),m=p.length-1;_.forEach(p.models,function(e,c){var p=c==m?"":";";t+=e.get("itemCode")+p;var f=e.get("itemBasicInfo"),g=e.get("categoryInfo");r+=f.unitCode+p,o+=f.mainVenCd+p,n+=u.getStringValue(e.get("pgmCd"))+p,s+=u.getStringValue(e.get("IpgmCd"))+p,l+=u.getStringValue(g.llargeCategoryId)+p,i+=u.getStringValue(g.largeCategoryId)+p,a+=u.getStringValue(g.middleCategoryId)+p,d+=u.getStringValue(g.smallCategoryId)+p}),c.setSplunkValue("customPI","OCV"),c.setSplunkValue("productId",t),c.setSplunkValue("productUnitCode",r),c.setSplunkValue("partnerCd",o),c.setSplunkValue("pgmCd",n),c.setSplunkValue("IpgmCd",s),c.setSplunkValue("gCateCd",l),c.setSplunkValue("lCateCd",i),c.setSplunkValue("mCateCd",a),c.setSplunkValue("sCateCd",d)},getStringValue:function(e){var t="";return _.isEmpty(e)||(t=e),t},getDateTime:function(e){var t=this,r=e!=undefined?new Date(e):new Date,o=r.getFullYear(),n=String(r.getMonth()+1),l=String(r.getDate());return""+o+t.LPAD(n,2)+t.LPAD(l,2)},LPAD:function(e,t,r){return r==undefined&&(r="0"),e=""+e,e.length>=t?e:new Array(t-e.length+1).join(r)+e}})}),define("page/cjmall/order/cart/cartOrderView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/models/totalOrderPriceInfoModel","page/cjmall/order/cart/cartTaxPopupView","page/cjmall/order/cart/cartAllPurchaseTaxPopupView","common/cjos/logger/utils/loggerUtil","page/cjmall/order/cart/util/deliveryUtils","page/cjmall/order/cart/util/cartOrderUtils"],function(e,t,r,o,n,l,i,a,d){return Backbone.View.extend({el:"._cartOrderViewContainer",template:Handlebars.compile($("#orderViewTemplate").html()),totalOrderPriceInfoModel:null,cartAllPurchaseTaxPopupView:null,data:{},events:{"click #_selectItemBuyButton":"selectItemBuyHandler","click #_allItemBuyButton":"allItemBuyHandler"},initialize:function(){var e=this;null!=r&&(Handlebars.registerHelper("isImmediatelyDiscount",function(e){for(var t=r.get("totalOrderPriceInfoModel").cartListCollection,o=0;o<t.length;o++){var n=t.at(o),l=[];if(n.get("itemDiscountInfo")&&(l=n.get("itemDiscountInfo").discountDetails),null!=l&&l.length>0)for(var i=0;i<l.length;i++)if(l[i].immediatelyDiscount)return e.fn(this)}return e.inverse(this)}),e.render(),e.listenTo(e.totalOrderPriceInfoModel,"reRenderCarOrderView",e.render))},render:function(){var e=this,t=e.$el,o=r.get("totalOrderPriceInfoModel");if(e.totalOrderPriceInfoModel=o,null!=o){var n=new Backbone.Model({totalCount:r.get("totalCount"),totalItemPrice:o.get("totalItemPrice"),totalDiscountPrice:o.get("totalDiscountPrice"),totalDeliveryPrice:o.get("totalDeliveryPrice"),totalSalePrice:o.get("totalSalePrice")});t.html(e.template(n.toJSON())),e.scrollMoveHandler(),e.data=n}},scrollMoveHandler:function(){var e=$(document),t=$(window),r=$(".fixed_sec"),o=(e.height(),t.scrollTop());t.height()+o>$("#_orderPriceLabel").offset().top?(r.hide(),r.addClass("off_out")):(r.show(),r.removeClass("off_out"))},selectItemBuyHandler:function(e){e&&e.originalEvent&&i.splunkClickLog("CART____bottom__selpay__"),this.choiceItemBuy("PART")},choiceItemBuy:function(e){var t=this,r=(t.$el,d.isChoiceCJmallItem()),o=d.isChoiceOliveItem(),n=d.isChoiceCookitItem(),i=d.isChoiceDawnItem(),a=d.getChoiceBNPIncomeItemCount(),s=!1,c=d.isSoloOrderItemExistsInCart(),u=0,p=0,m=!1;if(a>0&&(s=!0),r&&u++,o&&u++,n&&(u++,p++),i&&(u++,p++),s&&u++,p>0)if(u>p){var f="";if(n&&(f="COOK-IT"),i&&(f.length>0?f+="/새벽배송":f="새벽배송"),confirm(f+" 상품을 제외하고 나머지 상품을 주문하시겠습니까?")&&(m=!0),!m)return;n&&(d.removeALLCookitItem(),n=!1,u--,p--),i&&(d.removeALLDawnItem(),i=!1,u--,p--)}else if(2==p)return void alert("CJ COOKIT과 새벽배송은 CJ COOKIT 또는 새벽배송 상품끼리만 주문 가능합니다.");var g=!1;a>0&&a<d.getChoiceItemCount()&&(g=!0);var v=!1,y=null;if(g&&0==c&&0==o&&0==p?(v=!0,y="PART"):g&&c&&0==o&&0==p&&(v=!0,y="ALL"),v)null==t.cartAllPurchaseTaxPopupView?t.cartAllPurchaseTaxPopupView=new l(y):t.cartAllPurchaseTaxPopupView.render(y);else{var h=[];if(n){if(0==d.getCookitIntersectionDateList().length)return void alert("CJ COOKIT 주문 가능한 날짜가 없습니다.\n COOKIT 상품을 각각 주문 해 주세요. ");h=d.getOrderItemFormsForCookit()}else h=i?d.getOrderItemFormsForDawn():d.getOrderItemFormsForCJmall();if(_.isEmpty(h)||0==h.length)return alert("선택된 상품이 없습니다.\n먼저 구매하실 상품을 체크해 주시기 바랍니다."),void $(window).scrollTop(0);d.requestOrder(h)}},allItemBuyHandler:function(e){e&&e.originalEvent&&i.splunkClickLog("CART____bottom__allpay__"),this.allItemBuy()},allItemBuy:function(){var e=this,t=(r.get("cartListCollection"),!1),o=0,n=d.isCookitItemExistsInCart(),l=d.isDawnItemExistsInCart(),i=d.getItemCountForCJmall(),a=i>0,s=d.isOliveItemExistsInCart(),c=d.getItemCountForOlive(),u=d.isSoloOrderItemExistsInCart();n&&o++,l&&o++,a&&o++,s&&o++;var p="";if(o>=2&&(n||l)&&(n&&(p="COOK-IT"),l&&(p.length>0?p+="/새벽배송":p="새벽배송")),p.length>0?confirm(p+" 상품을 제외하고 나머지 상품을 전체 주문하시겠습니까?")&&(t=!0):n&&l?alert("CJ COOKIT과 새벽배송은 CJ COOKIT 또는 새벽배송 상품끼리만 주문 가능합니다."):t=!0,0!=t){if(a&&u){var m=d.getSoloOrderItemCount();if(i>1&&i==m&&0==c)return void alert("주문 상품이 모두 단독 주문 상품입니다. 단독 주문 상품은 하나씩 주문이 가능합니다.")}d.resetTotalCheckboxItemOrderList(),r.trigger("reRenderGroupView",{}),r.trigger("requsetResetTotalOrderPrice",{});$("#cjmall_all").length>0&&($("#cjmall_all").prop("checked",!0),r.trigger("selectAllForCartGroup",[$("#cjmall_all"),"FULL_ORDER"])),$("#olive_all").length>0&&($("#olive_all").prop("checked",!0),r.trigger("selectAllForCartGroup",[$("#olive_all"),"FULL_ORDER"])),$("#cookit_all").length>0&&(1==o&&n?($("#cookit_all").prop("checked",!0),r.trigger("selectAllForCartGroup",[$("#cookit_all"),"FULL_ORDER"])):$("#cookit_all").prop("checked",!1)),$("#dawn_all").length>0&&(1==o&&l?($("#dawn_all").prop("checked",!0),r.trigger("selectAllForCartGroup",[$("#dawn_all"),"FULL_ORDER"])):$("#dawn_all").prop("checked",!1));var u=d.isSoloOrderItemExistsInCart(),f=d.getItemCountForCJmall(),g=d.getChoiceItemCountForCJmall(),v=d.getChoiceItemCountForOlive();d.getChoiceItemCount;f>0&&0==g&&u&&v>0&&alert("장바구니에 담긴 상품 중 단독주문 또는 매진상품을 제외하고 주문서로 이동합니다."),e.choiceItemBuy("ALL")}}})}),define("page/cjmall/order/cart/cartTaxPopupView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/util/deliveryUtils","page/cjmall/order/cart/util/cartOrderUtils"],function(e,t,r,o,n){"use strict";return Backbone.View.extend({el:"._tax_notice_basket",events:{"click ._tax_btn":"taxHandler","click ._tax_cancel_btn":"cancelTaxHandler"},initialize:function(){this.render()},render:function(){var e=this,r=e.$el,o=r.find(".ly_msgct"),n="";switch(t.get(t.APPLICATION_TYPE)){case"p":n="<p>도서공연비 소득공제 상품과 일반 상품을 한 번에<br>결제하실 경우 도서공연비 소득공제를 받으실 수 없습니다.</p>";break;case"m":n="<p>도서공연비 소득공제 상품과<br>일반 상품을 한 번에 결제하실 경우<br>도서공연비 소득공제를 받으실 수 없습니다.</p>"}o.html("<h3>결제하시겠습니까?</h3>"+n),this.$el.show()},cancelTaxHandler:function(){var e=this,t=e.$el;this.$el.hide();for(var n=$(document).find("input:checkbox[class=_itemCheckBox]"),l=0;l<n.length;l++){var i=$(n[l]);if(i.is(":checked")){var a=i.attr("id"),d=r.get("cartListCollection").get(a),s=e.deliveryPolicyModel,c=r.get("totalOrderPriceInfoModel").cartListCollection,u=r.get("totalOrderPriceInfoModel").deliveryPolicyCollection,p=t.parents().find("input:checkbox[class=_allCheckBox]");if(i.attr("disabled"))return;for(var m=d.get("itemBasicInfo").unitCode,f=r.get("deliveryPolicyCollection"),s=null,g=0;g<f.length;g++)for(var v=f.at(g).get("unitCodeList"),y=0;y<v.length;y++)if(m===v[y]){s=f.at(g);var h=s.get("incomeDedYn");"0"===h&&(c.remove(d),o.removeOrderUnitCodeToDeliveryPolicyModel(d,s),0===s.get("orderUnitCodeList").length&&u.remove(s),o.resetDeliveryPolicyModel(d,s,s.get("orderUnitCodeList"),!1),i.prop("checked",!1),d.set("checked",""),p.is(":checked")&&p.prop("checked",!1))}}}e.trigger("reRenderCartGroupView",{cartItemView:e,cartItemModel:d,deliveryPolicyModel:s}),r.trigger("requsetResetTotalOrderPrice",{})},taxHandler:function(){this.$el.hide();for(var e=[],t=$(document).find("input:checkbox[class=_itemCheckBox]"),o=0;o<t.length;o++){var l=$(t[o]);if(l.is(":checked")){var i=l.attr("id"),a=r.get("cartListCollection").get(i);e.push(a.makeOrderItemForm())}}n.requestOrder(e)}})}),define("page/cjmall/order/cart/collections/cartListCollection",["page/cjmall/order/cart/models/cartItemModel"],function(e){return Backbone.Collection.extend({url:"",model:e,initialize:function(){var e=this;e.on({change:_.bind(e.changeHandler,e),destroy:_.bind(e.destroyHandler,e)})},changeHandler:function(e,t,r){},destroyHandler:function(e,t,r){}})}),define("page/cjmall/order/cart/collections/deliveryPolicyCollection",["page/cjmall/order/cart/models/deliveryPolicyModel"],function(e){return Backbone.Collection.extend({url:"",model:e,initialize:function(){}})}),define("page/cjmall/order/cart/collections/recentlyItemCollection",["page/cjmall/order/cart/models/recentlyItemModel","common/cjos/util/configUtil"],function(e,t){return Backbone.Collection.extend({url:"",model:e,initialize:function(){}})}),define("page/cjmall/order/cart/m/mobileCartMainView",["common/cjos/util/configUtil","common/cjos/util/appInterfaceUtil","page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/cartListView","page/cjmall/order/cart/cartOrderView","page/cjmall/order/cart/collections/recentlyItemCollection","page/cjmall/order/cart/util/deliveryUtils","common/cjos/advertise/util/advertiseUtil","common/cjos/advertise/models/advertiseConstantsModel","common/cjos/advertise/models/advertiseItemModel","common/cjos/advertise/advertiseCoreModule","common/cjmall/ui/m/loading/views/simpleLoadingBar","common/cjos/util/eventProxyManager","common/cjos/util/eventProxyTypes","common/cjos/util/noImageReplaceUtil","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m,f,g){return Backbone.View.extend({el:"._mainContent",$window:$(window),model:r,events:{"click #_allDeleteBtn":"allDeleteHandler","click #_showMoreRecentlyBtn":"showMoreRecentlyHandler"},cartListView:"",cartOrderView:"",recentlyItemStartIndex:0,recentlyItemTemplate:Handlebars.compile($("#recentlyItemTemplate").html()),simpleLoadingBar:new u,initialize:function(){var e=this,t=e.$el;e.simpleLoadingBar.appendTo(t,!0,!1),e.setLoggerKey(),e.createCartMainModel(),p.trigger(m.CART.UPDATED),e.setAdvertiseKey()},createCartMainModel:function(){var e=this,t={applicationType:"MOBILE"};e.model.fetch({data:t,xhrFields:{withCredentials:!0},success:function(t){if(null!=t.get("cartListCollection")){if(0==t.get("totalCount"))return void e.renderEmptyCart();e.render()}else e.renderEmptyCart()},error:function(t){cjosLogUtil.log("[mobileCartSheet] error : ",t),e.renderEmptyCart()}})},setDefaultImg:function(){var e=$(".img_thumb img").toArray();f.add(e,"//image.cjmall.net/mcom_web/images/mobile/no_img.gif")},render:function(){var e=this,t=e.$el,l=t.find("#_fullBasket"),i=e.simpleLoadingBar,a=new o;e.cartListView=a,e.listenTo(a,"emptyCart",e.renderEmptyCart),e.listenTo(r,"unCheckedAllCheckBox",e.unCheckedCheckBox);var d=new n;e.cartOrderView=d,e.setDefaultImg(),l.show(),i.remove(),e.cartOrderView.scrollMoveHandler(),e.$window.on("scroll",_.bind(e.cartOrderView.scrollMoveHandler,e)),e.spaceChecker()},renderEmptyCart:function(t){var o=this,n=o.$el,i=n.find("> ._basket"),a=i.find("> ._fullBasket"),d=i.find("> ._emptyBasket"),s=d.find("#_recentlyItemsContainer"),c=o.simpleLoadingBar;o.model.recentlyItemCollection;$.ajax({url:e.get("ecBaseSslUrl")+"/m/rest/myzone/recentview?type=D",type:"GET",data:{},xhrFields:{withCredentials:!0},success:function(e){if(1===e.code){o.model.recentlyItemCollection=new l(e.result.detailContentsList);for(var t=o.model.recentlyItemCollection.clone(),r=t.length,n=0;n<r;n++){var i=t.at(n);null==i.get("chnlCjOnePointPrice")&&o.model.recentlyItemCollection.remove(i)}var a=o.model.recentlyItemCollection;if(a.length>0){var d=[],c=o.recentlyItemStartIndex,u=c+3;a.length<u&&(c=0,u=c+3),o.recentlyItemStartIndex=u;for(var p=c;p<u;p++){var m=a.at(p);d.push(m.toJSON())}}var f={recentlyItems:d};s.html(o.recentlyItemTemplate(f))}else cjosLogUtil.log("최근 본 상품 불러오기 실패",e)},error:function(e,t,r){cjosLogUtil.log("최근 본 상품 불러오기 실패",e)}}),a.hide(),d.show(),c.remove(),r.destroy()},isShowRecentlyItems:function(e){var t=this,r=t.recentlyItems;return void 0===r?e.inverse(this):r.length>0?e.fn(this):e.inverse(this)},showMoreRecentlyHandler:function(e){var t=this,r=t.$el,o=r.find("> ._basket"),n=o.find("> ._emptyBasket"),l=n.find("#_recentlyItemsContainer"),i=t.model.recentlyItemCollection;if(i.length>0){var a=[],d=t.recentlyItemStartIndex,s=d+3;i.length<s&&(d=0,s=d+3),t.recentlyItemStartIndex=s;for(var c=d;c<s;c++){var u=i.at(c);a.push(u.toJSON())}}var p={recentlyItems:a};l.html(t.recentlyItemTemplate(p))},unCheckedCheckBox:function(e){this.$el.find("input:checkbox[class=_allCheckBox]").prop("checked",!1)},allDeleteHandler:function(t){if(t.preventDefault(),t.originalEvent&&g.splunkClickLog("CART____top__alldelete__"),confirm("장바구니 상품 전체를 삭제합니다.")){for(var o=this,n=r.get("cartListCollection"),l=[],i=0;i<n.length;i++){var a=n.at(i),d={grpCode:a.get("groupCode"),cartSeq:a.get("cartSequence")};l.push(d)}var s=JSON.stringify({cartKeyCriterias:l}),c=e.get("ecBaseSslUrl")+"/c/rest/cart/";$.ajax({url:c,type:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},data:s,xhrFields:{withCredentials:!0},success:function(e){if(1!=e.code)return void alert("잠시 후 다시 시도해주세요.");r.get("cartListCollection").reset(),r.get("deliveryPolicyCollection").reset(),null!=o.cartListView&&o.cartListView.$el.remove(),null!=o.cartOrderView&&o.cartOrderView.$el.remove(),p.trigger(m.CART.UPDATED),o.renderEmptyCart()},error:function(e,t,r){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("삭제 실패 Status : ",t),cjosLogUtil.log("삭제 실패 Error : ",r)}})}},getDeliveryPolicyModel:function(e){for(var t=r.get("deliveryPolicyCollection"),o=0;o<t.length;o++)for(var n=t.at(o).get("unitCodeList"),l=0;l<n.length;l++)if(n[l]===e)return t.at(o)},setLoggerKey:function(){g.setSplunkKey("customPI"),g.setSplunkKey("productId"),g.setSplunkKey("productUnitCode"),g.setSplunkKey("partnerCd"),g.setSplunkKey("pgmCd"),g.setSplunkKey("IpgmCd"),g.setSplunkKey("gCateCd"),g.setSplunkKey("lCateCd"),g.setSplunkKey("mCateCd"),g.setSplunkKey("sCateCd")},setAdvertiseKey:function(){a.advertiseSetKey(d.PAGE_TYPE),a.advertiseSetKey(d.ITEM_ARRAY)},spaceChecker:function(){$(".goods_info").length;$(".goods_info").each(function(){$(this).find(".img_thumb").height()<$(this).find(".purchase_info").height()&&$(this).addClass("is_bottom")})}})}),define("page/cjmall/order/cart/models/cartItemModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({url:e.get("ecBaseSslUrl")+"/c/rest/cart",defaults:{id:"",itemCode:"",channelCode:0,unitCode:"",quantity:0,totalDiscountPrice:0,itemStockQuantity:0,unitStockQuantity:0,cartSequence:0,cartInsertDate:0,shopId:"",groupCode:"",offerCode:"",bbsKindCode:"",venderItemCode:"",venderUnitname:"",cataCode:"",codiOrgItem:"",custMdCode:"",commId:"",itemSaleCls:"",itemBasicInfo:{},itemPriceInfo:{},totalGiftInfo:{},categoryInfo:{},itemDiscountInfo:{},itemDeliveryInfo:{},deliveryPolicyModel:null,isSelected:!1,checked:"",idx:0,isReCart:!1,isSoldOut:!1,saleId:"",itemImageUrl:""},initialize:function(){var e=this;e.set("id",e.cid),e.on({change:_.bind(e.changeHandler,e),destroy:_.bind(e.destroyHandler,e)})},makeOrderItemForm:function(){var e=this,t=e.get("totalGiftInfo"),r=[],o=[];if(!_.isEmpty(t))for(var n=0;n<t.length;n++){var l=t[n],i=l.itemEtcType;if(null!=t[n].giftcartSeq)switch(i){case"ONE_GIFT":case"ADD_GIFT":o.push(l)}}if(!_.isEmpty(o))for(var n=0;n<o.length;n++){var l=o[n],a={itemCode:l.giftItemCode,channelCode:l.channelCode,unitCode:l.giftUnitCode,promotionNo:l.tpromofferEntityKey.promNo,promotionSeq:l.tpromofferEntityKey.promSeq,offerSeq:l.tpromofferEntityKey.offerSeq};r.push(a)}var d={grpCode:e.get("groupCode"),cartSeq:e.get("cartSequence")};return{isSoloOrder:e.get("isSoloOrder"),itemCode:e.get("itemCode"),itemName:e.get("itemBasicInfo").itemNm,channelCode:e.get("channelCode"),unitName:e.get("itemBasicInfo").displayUnitName,unitCode:e.get("itemBasicInfo").unitCode,unitPrice:e.get("itemPriceInfo").salePrice,quantity:e.get("quantity"),shopId:e.get("shopId"),giftItemForms:r,cartKey:d,categoryId:e.get("categoryId"),saleId:e.get("saleId")}},changeHandler:function(e,t,r){},destroyHandler:function(e,t,r){}})}),define("page/cjmall/order/cart/models/cartMainModel",["common/cjos/util/configUtil","page/cjmall/order/cart/collections/cartListCollection","page/cjmall/order/cart/collections/deliveryPolicyCollection","page/cjmall/order/cart/models/totalOrderPriceInfoModel"],function(e,t,r,o){return new(Backbone.Model.extend({url:"",defaults:{totalCount:0,totalOrderPriceInfoModel:null,cartListCollection:null,deliveryPolicyCollection:null},recentlyItemCollection:null,soloOrderItemName:"",soloOrderFlag:!1,toDayIntoCartItemCodes:[],initialize:function(){var t=this;t.url=e.get("ecBaseSslUrl")+"/c/rest/cart",t.listenTo(t,"requsetResetTotalOrderPrice",t.resetTotalOrderPrice)},parse:function(e){var n=this,l=e.code,i=e.result;1===l&&null!=i?(n.set({totalCount:i.totalCount,cartListCollection:new t(i.cartList),deliveryPolicyCollection:new r(i.deliveryPolicyTuples),totalOrderPriceInfoModel:new o(i.totalOrderPriceInfo)}),n.on({change:_.bind(n.changeHandler,n),destroy:_.bind(n.destroyHandler,n)})):cjosLogUtil.log("장바구니 로딩에 실패했거나 장바구니가 비어있습니다. [code:"+l+"]")},resetTotalOrderPrice:function(e){var t=this,r=t.get("totalOrderPriceInfoModel").cartListCollection,o=t.get("totalOrderPriceInfoModel").deliveryPolicyCollection,n=t.get("totalOrderPriceInfoModel"),l=r.length;t.set("totalCount",l);for(var i=0,a=0,d=0,s=0,c=0;c<r.length;c++){var u=r.at(c);i+=u.get("itemPriceInfo").salePrice*u.get("quantity"),a+=u.get("totalDiscountPrice")}for(var c=0;c<o.length;c++){d+=o.at(c).get("groupDeliveryPrice")}s=i-a+d,n.set("totalItemPrice",i),a>0?n.set("totalDiscountPrice","-"+a):n.set("totalDiscountPrice",a),n.set("totalDeliveryPrice",d),n.set("totalSalePrice",s),t.set("totalOrderPriceInfoModel",n),n.trigger("reRenderCarOrderView",{totalOrderPriceInfoModel:n})},changeHandler:function(e,t){},destroyHandler:function(e,t,r){}}))}),define("page/cjmall/order/cart/models/deliveryPolicyModel",["page/cjmall/order/cart/models/cartMainModel"],function(e){return Backbone.Model.extend({url:"",defaults:{deliveryCostGroupCode:"",deliveryPrice:0,minordAmount:0,minordQuantity:0,deliveryClassificationCode:"",deliveryCostCode:"",deliveryType:"",regionalAddPrice:{},fastDeliveryAddPrice:{},groupDeliveryPrice:0,totalSalePrice:0,totalQuantity:0,unitCodeList:[],bundleSale:!1,freeDelivery:!1,orderUnitCodeList:[],incomeDedYn:0},initialize:function(){}})}),define("page/cjmall/order/cart/models/recentlyItemModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({url:e.get("ecBaseSslUrl")+"/m/rest/myzone/recentview?type=D",defaults:{id:"",harmGrd:"",chnlCjOnePointPrice:0,channelCode:0,contentUrl:"",noInterestMonth:0,itemTypeCode:"",contentType:"",contentName:"",contentId:"",moCode:null,saleCls:{},couponDcRt:null,contentImgUrl:"",cjOnePointPrice:0,customerPrice:0,salePrice:0,contentCondition:"",itemCode:""},initialize:function(){var e=this;e.set("id",e.cid)}})}),define("page/cjmall/order/cart/models/totalOrderPriceInfoModel",["page/cjmall/order/cart/models/cartItemModel","page/cjmall/order/cart/models/deliveryPolicyModel"],function(e,t){return Backbone.Model.extend({defaults:{totalDeliveryPrice:0,totalDiscountPrice:0,totalItemPrice:0,totalSalePrice:0},cartListCollection:new Backbone.Collection,deliveryPolicyCollection:new Backbone.Collection,initailize:function(){}})}),define("page/cjmall/order/cart/oliveCartGroupView",["page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/cartItemView"],function(e,t){return Backbone.View.extend({className:"lst_item_wrap _groupViewContainer",template:Handlebars.compile($("#groupViewTemplate").html()),deliveryPolicyModel:null,topCartInsertDate:0,cartItemViewArray:{},data:{},model:"",isOlive:!1,initialize:function(e){var t=this;t.deliveryPolicyModel=t.model,t.isOlive=e.isOlive,t.setData(),t.initRender()},initRender:function(){var e=this,t=e.data,r=e.$el;if(r.html(e.template(t)),null!=t&&"undefined"!=typeof t.fastDeliveryHeader&&"undefined"!=typeof t.fastDeliveryMessage){r.find("._fastDeliveryText").show()}e.render()},setData:function(){var e=this,t=(e.$el,e.deliveryPolicyModel),r=t.get("fastDeliveryAddPrice");if(null!=r){var o=r.fastDeliveryMessageInfo;if(null!=o){var n="["+o.data.header+"]",l=o.data.deadline+" "+o.data.payment+" "+o.data.footer,i={fastDeliveryHeader:n,fastDeliveryMessage:l};e.data=i}}},render:function(){var r=this,o=r.deliveryPolicyModel.get("unitCodeList"),n=e.get("cartListCollection"),l=[];if(0==o.length)return void cjosLogUtil.log("[CartGroupView] unitCodeList.length is 0.");for(var i=0;i<o.length;i++)for(var a=o[i],d=0;d<n.length;d++)if(n.at(d).get("itemBasicInfo").unitCode==a&&!n.at(d).get("isSelected")){var s=n.at(d);if(s.get("isOlive")!=r.isOlive)continue;s.set("deliveryPolicyModel",r.deliveryPolicyModel),s.set("isSelected",!0);var c=new t({model:s});r.listenTo(c,"deletedItemModel",r.deletedItemViewHandler),r.listenTo(c,"reRenderCartGroupView",r.renderItemViewHandler),l.push(c),r.compareTopInsertDate(s.get("cartInsertDate"));break}r.sortingRender(l)},renderItemViewHandler:function(e){var t=this,r=t.cartItemViewArray,o=e.deliveryPolicyModel;if(r.length>1)for(var n=!1,l=r.length-1;l>=0;l--){var i=r[l];i.deliveryPolicyModel=o,0==n&&"checked"===i.cartItemModel.get("checked")?(i.cartItemModel.set("firstRow",!0),n=!0):i.cartItemModel.set("firstRow",!1),i.promotionAndNoticeChecker()}},sortingRender:function(e){var t=this,r=t.$el;e.sort(t.cartItemSortFunction);for(var o=0;o<e.length;o++)r.prepend(e[o].$el),o===e.length-1?e[o].cartItemModel.set("firstRow",!0):e[o].cartItemModel.set("firstRow",!1);t.cartItemViewArray=e},deletedItemViewHandler:function(t){var r=this,o=r.cartItemViewArray,n=t.cartItemView,l=t.cartItemModel,i=t.deliveryPolicyModel;if(0===i.get("unitCodeList").length)r.$el.remove(),l.get("isOlive")?r.trigger("deletedOliveGroupView",{groupView:r,deliveryPolicyModel:i}):r.trigger("deletedGroupView",{groupView:r,deliveryPolicyModel:i});else{var a=o.indexOf(n);a>-1&&o.splice(a,1);for(var d=0;d<o.length;d++){var s=o[d];s.deliveryPolicyModel=i,s.promotionAndNoticeChecker()}e.trigger("requsetResetTotalOrderPrice",{})}},cartItemSortFunction:function(e,t){var r=e.cartItemModel.get("cartInsertDate"),o=t.cartItemModel.get("cartInsertDate");if(r==o){var n=e.cartItemModel.get("itemPriceInfo").salePrice,l=t.cartItemModel.get("itemPriceInfo").salePrice;if(n==l){var i=e.cartItemModel.get("itemCode"),a=t.cartItemModel.get("itemCode");if(i==a){var d=e.cartItemModel.get("itemBasicInfo").unitCode,s=t.cartItemModel.get("itemBasicInfo").unitCode;return d==s?0:d<s?1:-1}return i<a?1:-1}return n<l?-1:1}return r<o?-1:1},priceCompareSortFunction:function(e,t){var r=this,o=e.cartItemModel.get("itemPriceInfo").salePrice,n=t.cartItemModel.get("itemPriceInfo").salePrice;return o==n?r.itemCodeCompareSortFunction(e,t):o<n?-1:1},itemCodeCompareSortFunction:function(e,t){var r=this,o=e.cartItemModel.get("itemCode"),n=t.cartItemModel.get("itemCode");return o==n?r.unitCodeCompareSortFunction(e,t):o<n?1:-1},unitCodeCompareSortFunction:function(e,t){var r=e.cartItemModel.get("itemBasicInfo").unitCode,o=t.cartItemModel.get("itemBasicInfo").unitCode;return r==o?0:r<o?1:-1},compareTopInsertDate:function(e){var t=this;t.topCartInsertDate<e&&(t.topCartInsertDate=e)}})}),define("page/cjmall/order/cart/oliveCartListView",["page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/models/deliveryPolicyModel","common/cjmall/util/cjmallUtil","common/cjos/advertise/util/advertiseUtil","common/cjos/advertise/models/advertiseConstantsModel","common/cjos/advertise/models/advertiseItemModel","common/cjos/advertise/advertiseCoreModule","page/cjmall/order/cart/oliveCartGroupView","page/cjmall/order/cart/util/deliveryUtils"],function(e,t,r,o,n,l,i,a,d){return Backbone.View.extend({el:"._cartListViewContainer",template:Handlebars.compile($("#groupViewTemplate").html()),deliveryPolicyCollection:null,mallGroupViewArray:[],oliveGroupViewArray:[],mallViewArray:[],oliveViewArray:[],initialize:function(){var t=this;t.deliveryPolicyCollection=e.get("deliveryPolicyCollection"),t.setAdvertiseKey(),null==t.deliveryPolicyCollection?(cjosLogUtil.log("[CartListView] s.deliveryPolicyCollection is null."),t.trigger("emptyCart",{cartListView:t})):t.render()},events:{"click #olive_all":"checkOliveHandler"},reRenderGroupView:function(){var e=this;e.mallViewArray.forEach(function(e){e.cartItemViewArray.forEach(function(t){var r=t.cartItemModel.get("itemBasicInfo").unitCode,o=d.getDeliveryPolicyModel(r);e.renderItemViewHandler({deliveryPolicyModel:o})})}),e.oliveViewArray.length>0&&e.oliveViewArray.forEach(function(e){e.cartItemViewArray.forEach(function(t){var r=t.cartItemModel.get("itemBasicInfo").unitCode,o=d.getDeliveryPolicyModel(r);e.renderItemViewHandler({deliveryPolicyModel:o})})})},checkOliveHandler:function(t){var r=e.get("totalOrderPriceInfoModel").cartListCollection,o=e.get("totalOrderPriceInfoModel").deliveryPolicyCollection,n=this.$el.find("#olive_all"),l=$("._cartListViewContainer .lst_olive_goods").next().find("input:checkbox[class=_itemCheckBox]");!0===n.is(":checked")?l.not(":disabled").each(function(){var t=$(this).attr("id"),n=e.get("cartListCollection").get(t),l=n.get("itemBasicInfo").unitCode;if(n.get("isSoloOrder"))$(this).prop("checked",!1),e.soloOrderFlag=!1,alertFlag||(alertFlag=!0);else{for(var i=e.get("deliveryPolicyCollection"),a=null,s=0;s<i.length;s++){for(var c=i.at(s).get("unitCodeList"),u=0;u<c.length;u++)if(l===c[u]){a=i.at(s);break}if(null!=a)break}if(null===a)return void alert("선택할 수 없는 상품입니다.");d.addOrderUnitCodeToDeliveryPolicyModel(n,a),r.add(n),o.add(a),d.resetDeliveryPolicyModel(n,a,a.get("orderUnitCodeList"),!0),$(this).prop("checked",!0),n.set("checked","checked")}}):l.not(":disabled").each(function(){var t=$(this).attr("id"),n=e.get("cartListCollection").get(t),l=n.get("itemBasicInfo").unitCode;n.set("checked","");var i=d.getDeliveryPolicyModel(l);if(null===i)return!0;d.removeOrderUnitCodeToDeliveryPolicyModel(n,i),r.remove(n),o.remove(i),$(this).prop("checked",!1)}),e.trigger("requsetResetTotalOrderPrice",{})},render:function(){var e=this;e.setCartGroupView(),e.sortingRender(),e.setAdvertiseValue()},setCartGroupView:function(){for(var r=this,o=r.deliveryPolicyCollection,n=e.get("cartListCollection"),l=(new Map,new Map,0);l<n.length;l++){var i=n.at(l),d=i.get("itemDeliveryInfo"),s=d.deliveryCostGrpCode,c=[i.get("itemBasicInfo").unitCode];if("NONE"===s){var u=new t({deliveryCostGroupCode:d.deliveryCostGrpCode,deliveryClassificationCode:d.deliveryClsCode,deliveryCostCode:d.deliveryCostCode,deliveryType:d.deliveryType,unitCodeList:c,orderUnitCodeList:c});o.add(u)}
var p=i.get("itemBasicInfo").unitCode,m=r.getDeliveryPolicyModel(p);i.get("isOlive")?-1==r.oliveGroupViewArray.indexOf(m)&&r.oliveGroupViewArray.push(m):-1==r.mallGroupViewArray.indexOf(m)&&r.mallGroupViewArray.push(m)}if(0==o.length)return cjosLogUtil.log("[CartListView] deliveryPolicyCollection.length is 0."),void r.renderEmptyCart();r.mallGroupViewArray.forEach(function(e){var t=new a({model:e,isOlive:!1});r.listenTo(t,"deletedGroupView",r.deleteGroupViewHandler),r.mallViewArray.push(t)}),r.oliveGroupViewArray.forEach(function(e){var t=new a({model:e,isOlive:!0});r.listenTo(t,"deletedOliveGroupView",r.deleteOliveGroupViewHandler),r.oliveViewArray.push(t)})},calculateGroupView:function(){var t=this;if(0===t.oliveViewArray.length+t.mallViewArray.length)return void t.renderEmptyCart();e.trigger("requsetResetTotalOrderPrice",{})},deleteOliveGroupViewHandler:function(t){var r,o=this,n=t.groupView,l=t.deliveryPolicyModel,i=e.get("deliveryPolicyCollection");t.cartItemModel;r=o.oliveViewArray;var a=r.indexOf(n);a>-1&&r.splice(a,1),i.remove(l),o.$el.find(".lst_olive_goods").hide(),o.calculateGroupView()},deleteGroupViewHandler:function(t){var r,o=this,n=t.groupView,l=t.deliveryPolicyModel,i=e.get("deliveryPolicyCollection");e.get("totalOrderPriceInfoModel").deliveryPolicyCollection;r=o.mallViewArray;var a=r.indexOf(n);a>-1&&r.splice(a,1),i.remove(l),o.calculateGroupView()},getDeliveryPolicyModel:function(t){for(var r=e.get("deliveryPolicyCollection"),o=0;o<r.length;o++)for(var n=r.at(o).get("unitCodeList"),l=0;l<n.length;l++)if(n[l]===t)return r.at(o)},sortingRender:function(){var e=this,t=e.$el;e.mallViewArray.sort(e.reverseInsertDateCompareSortFunction),e.oliveViewArray.sort(e.reverseInsertDateCompareSortFunction);for(var r=0;r<e.mallViewArray.length;r++)t.append(e.mallViewArray[r].$el);if(e.oliveViewArray.length>0){var o=Handlebars.compile($("#oliveViewTemplate").html());t.append(o({}))}for(var r=0;r<e.oliveViewArray.length;r++)t.append(e.oliveViewArray[r].$el)},reverseInsertDateCompareSortFunction:function(e,t){var r=e.topCartInsertDate,o=t.topCartInsertDate,n=e.deliveryPolicyModel.get("deliveryCostGroupCode"),l=t.deliveryPolicyModel.get("deliveryCostGroupCode");return r==o?n==l?0:n<l?1:-1:r<o?1:-1},renderEmptyCart:function(){var e=this;e.trigger("emptyCart",{cartListView:e})},setAdvertiseKey:function(){o.advertiseSetKey(n.PAGE_TYPE),o.advertiseSetKey(n.ITEM_ARRAY)},setAdvertiseValue:function(){var t=e.get("cartListCollection"),i=[];try{for(var a=0;a<t.length;a++){var d=new l,s=t.at(a),c=s.get("itemCode"),u=s.get("itemBasicInfo").itemNm,p=r.getImgUrl(c),m=s.get("itemPriceInfo").salePrice,f=s.get("channelCode"),g=s.get("quantity");d.set(n.ITEM.ITEM_CODE,c),d.set(n.ITEM.ITEM_NAME,u),d.set(n.ITEM.ITEM_IMG_URL,p),d.set(n.ITEM.UNIT_PRICE,m),d.set(n.ITEM.UNIT_QTY,g),d.set(n.ITEM.ITEM_CHANNEL_CODE,f),i.push(d)}o.advertiseSetValue(n.PAGE_TYPE,"cartList"),o.advertiseSetValue(n.ITEM_ARRAY,i)}catch(v){cjosLogUtil.log("[제휴 advertiseItemModel set]",v)}}})}),define("page/cjmall/order/cart/p/pcCartMainView",["common/cjos/util/configUtil","page/cjmall/order/cart/models/cartMainModel","page/cjmall/order/cart/cartListView","page/cjmall/order/cart/cartOrderView","page/cjmall/order/cart/collections/recentlyItemCollection","common/cjos/advertise/util/advertiseUtil","common/cjos/advertise/models/advertiseConstantsModel","common/cjos/advertise/models/advertiseItemModel","common/cjos/advertise/advertiseCoreModule","page/cjmall/order/cart/util/deliveryUtils","common/cjos/util/eventProxyManager","common/cjos/util/eventProxyTypes","common/cjos/util/noImageReplaceUtil","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m){return Backbone.View.extend({el:"._mainContent",$window:$(window),model:t,events:{"click #_allDeleteBtn":"allDeleteHandler","click #_showMoreRecentlyBtn":"showMoreRecentlyHandler"},cartListView:"",cartOrderView:"",recentlyItemStartIndex:0,recentlyItemTemplate:Handlebars.compile($("#recentlyItemTemplate").html()),initialize:function(){var e=this;e.setLoggerKey(),e.createCartMainModel(),c.trigger(u.CART.UPDATED),e.setAdvertiseKey()},createCartMainModel:function(){var e=this,t=e.$el,r={applicationType:"PC"};e.model.fetch({data:r,success:function(t){if(null!=t.get("cartListCollection")){if(0==t.get("totalCount"))return void e.renderEmptyCart();e.render()}else e.renderEmptyCart()},error:function(t){cjosLogUtil.log("[mobileCartSheet] error : ",t),e.renderEmptyCart()},complete:function(){t.find("#_loading_cart").hide()}})},render:function(){var e=this,n=e.$el,l=n.find("#_fullBasket"),i=new r;e.cartListView=i,e.listenTo(i,"emptyCart",e.renderEmptyCart),e.listenTo(t,"unCheckedAllCheckBox",e.unCheckedCheckBox);var a=new o;e.cartOrderView=a,e.setDefaultImg(),l.show(),e.cartOrderView.scrollMoveHandler(),e.$window.on("scroll",_.bind(e.cartOrderView.scrollMoveHandler,e))},setDefaultImg:function(){var e=$(".img_thumb img").toArray();p.add(e,"//image.cjmall.net/mcom_web/images/mobile/no_img.gif")},renderEmptyCart:function(r){var o=this,l=o.$el,i=l.find("> ._basket"),a=i.find("> ._fullBasket"),d=i.find("> ._emptyBasket"),s=d.find("#_recentlyItemsContainer");$.ajax({url:e.get("ecBaseSslUrl")+"/p/rest/myzone/recentview?type=D",type:"GET",data:{},xhrFields:{withCredentials:!0},success:function(e){if(1===e.code){o.model.recentlyItemCollection=new n(e.result.detailContentsList);for(var t=o.model.recentlyItemCollection.clone(),r=t.length,l=0;l<r;l++){var i=t.at(l);null==i.get("chnlCjOnePointPrice")&&o.model.recentlyItemCollection.remove(i)}var a=o.model.recentlyItemCollection;if(a.length>0){var d=[],c=o.recentlyItemStartIndex,u=c+3;a.length<u&&(c=0,u=c+3),o.recentlyItemStartIndex=u;for(var p=c;p<u;p++){var m=a.at(p);d.push(m.toJSON())}}var f={recentlyItems:d};s.html(o.recentlyItemTemplate(f))}else cjosLogUtil.log("최근 본 상품 불러오기 실패",e)},error:function(e,t,r){cjosLogUtil.log("최근 본 상품 불러오기 실패",e)}}),a.hide(),d.show(),t.destroy()},isShowRecentlyItems:function(e){var t=this,r=t.recentlyItems;return void 0===r?e.inverse(this):r.length>0?e.fn(this):e.inverse(this)},showMoreRecentlyHandler:function(e){var t=this,r=t.$el,o=r.find("> ._basket"),n=o.find("> ._emptyBasket"),l=n.find("#_recentlyItemsContainer"),i=t.model.recentlyItemCollection;if(i.length>0){var a=[],d=t.recentlyItemStartIndex,s=d+3;i.length<=s&&(d=0,s=d+3),t.recentlyItemStartIndex=s;for(var c=d;c<s;c++){var u=i.at(c);a.push(u.toJSON())}}var p={recentlyItems:a};l.html(t.recentlyItemTemplate(p))},unCheckedCheckBox:function(e){this.$el.find("input:checkbox[class=_allCheckBox]").prop("checked",!1)},allDeleteHandler:function(r){if(r.preventDefault(),r.originalEvent&&m.splunkClickLog("CART____top__alldelete__"),confirm("장바구니 상품 전체를 삭제합니다.")){for(var o=this,n=t.get("cartListCollection"),l=[],i=0;i<n.length;i++){var a=n.at(i),d={grpCode:a.get("groupCode"),cartSeq:a.get("cartSequence")};l.push(d)}var s=JSON.stringify({cartKeyCriterias:l}),p=e.get("ecBaseSslUrl")+"/c/rest/cart/";$.ajax({url:p,type:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},data:s,xhrFields:{withCredentials:!0},success:function(e){if(1!=e.code)return void alert("잠시 후 다시 시도해주세요.");t.get("cartListCollection").reset(),t.get("deliveryPolicyCollection").reset(),null!=o.cartListView&&o.cartListView.$el.remove(),null!=o.cartOrderView&&o.cartOrderView.$el.remove(),c.trigger(u.CART.UPDATED),o.renderEmptyCart()},error:function(e,t,r){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("삭제 실패 Status : ",t),cjosLogUtil.log("삭제 실패 Error : ",r)}})}},getDeliveryPolicyModel:function(e){for(var r=t.get("deliveryPolicyCollection"),o=0;o<r.length;o++)for(var n=r.at(o).get("unitCodeList"),l=0;l<n.length;l++)if(n[l]===e)return r.at(o)},setLoggerKey:function(){m.setSplunkKey("customPI"),m.setSplunkKey("productId"),m.setSplunkKey("productUnitCode"),m.setSplunkKey("partnerCd"),m.setSplunkKey("pgmCd"),m.setSplunkKey("IpgmCd"),m.setSplunkKey("gCateCd"),m.setSplunkKey("lCateCd"),m.setSplunkKey("mCateCd"),m.setSplunkKey("sCateCd")},setAdvertiseKey:function(){l.advertiseSetKey(i.PAGE_TYPE),l.advertiseSetKey(i.ITEM_ARRAY)}})}),define("page/cjmall/order/cart/util/cartOrderUtils",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/cart/util/deliveryUtils","page/cjmall/order/cart/models/cartMainModel"],function(e,t,r,o){function n(){}var l={requestOrder:function(r){var o=JSON.stringify({orderFormType:"CART",orderItemForms:r}),n=e.get("ecBaseSslUrl")+"/c/rest/order/tempOrder",l="";switch(t.get(t.APPLICATION_TYPE)){case"p":l=e.get("ecBaseSslUrl")+"/p/order/sheet/";break;case"m":l=e.get("ecBaseSslUrl")+"/m/order/sheet/"}$.ajax({url:n,type:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:o,xhrFields:{withCredentials:!0},success:function(e){if(1!=e.code)return void alert("잠시 후 다시 시도해주세요.");var t=e.result,r=l+t;location.href=r},error:function(e,t,r){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("구매하기 실패 : response ",e)}})},getCartItemModel:function(e){return o.get("cartListCollection").get(e)},addSelectedItemOrderList:function(e){var t=this;if(!$(e).is(":disabled")){var n=$(e).attr("id"),l=t.getCartItemModel(n),i=l.get("itemBasicInfo").unitCode,a=l.get("isSoloOrder"),d=(l.get("isCookit"),l.get("itemBasicInfo").itemNm),s=r.getDeliveryPolicyModel(i);if(null===s)return void alert(d+" 상품은 선택할 수 없는 상품입니다.");a&&(o.soloOrderItemName=d,o.soloOrderFlag=!0);var c=o.get("totalOrderPriceInfoModel").cartListCollection,u=o.get("totalOrderPriceInfoModel").deliveryPolicyCollection;c.add(l),r.addOrderUnitCodeToDeliveryPolicyModel(l,s),u.add(s),r.resetDeliveryPolicyModel(l,s,s.get("orderUnitCodeList"),!0),$(e).prop("checked",!0),l.set("checked","checked")}},removeSelectedItemOrderList:function(e){var t=this;if(!$(e).is(":disabled")){var n=$(e).attr("id"),l=t.getCartItemModel(n),i=l.get("itemBasicInfo").unitCode,a=l.get("isSoloOrder"),d=r.getDeliveryPolicyModel(i);if(null!==d){var s=o.get("totalOrderPriceInfoModel").cartListCollection,c=o.get("totalOrderPriceInfoModel").deliveryPolicyCollection;a&&(o.soloOrderFlag=!1),s.remove(l),r.removeOrderUnitCodeToDeliveryPolicyModel(l,d),0===d.get("orderUnitCodeList").length&&c.remove(d),r.resetDeliveryPolicyModel(l,d,d.get("orderUnitCodeList"),!1),$(e).prop("checked",!1),l.set("checked","")}}},resetTotalCheckboxItemOrderList:function(e){var t=this;t.getTotalCheckboxElement().each(function(){e!=undefined?$(this).is(":checked")&&$(e)!=$(this)&&t.removeSelectedItemOrderList(this):$(this).is(":checked")&&t.removeSelectedItemOrderList(this)})},removeALLCookitItem:function(){var e=this;$("._cookitGroup").find("input:checkbox[class=_itemCheckBox]").not(":disabled").each(function(){e.removeSelectedItemOrderList(this)})},removeALLDawnItem:function(){var e=this;$("._dawnGroup").find("input:checkbox[class=_itemCheckBox]").not(":disabled").each(function(){e.removeSelectedItemOrderList(this)})},getTotalCheckboxElement:function(e){return e!=undefined&&e?$(document).find("input:checkbox[class=_itemCheckBox]:checked").not(":disabled"):$(document).find("input:checkbox[class=_itemCheckBox]").not(":disabled")},getChoiceItemCount:function(){return this.getTotalCheckboxElement(!0).length},isCJmallItem:function(e){var t=this,r=t.getCartItemModel(e),o=r.get("isOlive"),n=r.get("isCookit"),l=r.get("isDawn");return 0==o&&0==n&&0==l},isChoiceCJmallItem:function(){var e=this,t=!1;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");if(e.isCJmallItem(n))return t=!0,!1}),t},getOrderItemFormsForCJmall:function(){var e=this,t=[];return e.getTotalCheckboxElement(!0).each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=(o.get("isSoloOrder"),o.get("isSoldOut"),o.get("isCookit")),l=o.get("isDawn");0==n&&0==l&&t.push(o.makeOrderItemForm())}),t},getItemCountForCJmall:function(){var e=this,t=0;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=(o.get("isSoloOrder"),o.get("isSoldOut"),o.get("isCookit")),l=o.get("isDawn");0==o.get("isOlive")&&0==n&&0==l&&t++}),t},isCjmallItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id"),o=e.isOliveItem(r),n=e.isCookitItem(r),l=e.isDawnItem(r);if(0==o&&0==n&&0==l)return t=!0,!1}),t},getChoiceItemCountForCJmall:function(){var e=this,t=0;return e.getTotalCheckboxElement(!0).each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=(o.get("isSoloOrder"),o.get("isSoldOut"),o.get("isCookit")),l=o.get("isDawn");0==o.get("isOlive")&&0==n&&0==l&&t++}),t},getChoiceItemCountForOlive:function(){var e=this,t=0;return e.getTotalCheckboxElement(!0).each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=(o.get("isSoloOrder"),o.get("isSoldOut"),o.get("isCookit")),l=o.get("isDawn");1==o.get("isOlive")&&0==n&&0==l&&t++}),t},getItemCountForOlive:function(){var e=this,t=0;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=(o.get("isSoloOrder"),o.get("isSoldOut"),o.get("isCookit")),l=o.get("isDawn");1==o.get("isOlive")&&0==n&&0==l&&t++}),t},isOliveItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id"),o=e.isOliveItem(r);e.isCookitItem(r),e.isDawnItem(r);if(o)return t=!0,!1}),t},getOrderItemFormsForCookit:function(){var e=this,t=[];return e.getTotalCheckboxElement(!0).each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=o.get("isSoloOrder"),l=(o.get("isSoldOut"),o.get("isCookit")),i=o.get("isDawn"),a=o.get("isOlive");o.get("cookitSupplyPlanList");0==n&&0==a&&1==l&&0==i&&t.push(o.makeOrderItemForm())}),t},getOrderItemFormsForDawn:function(){var e=this,t=[];return e.getTotalCheckboxElement(!0).each(function(){var r=$(this).attr("id"),o=e.getCartItemModel(r),n=o.get("isSoloOrder"),l=(o.get("isSoldOut"),o.get("isCookit")),i=o.get("isDawn"),a=o.get("isOlive");0==n&&0==a&&0==l&&1==i&&t.push(o.makeOrderItemForm())}),t},isOliveItem:function(e){return this.getCartItemModel(e).get("isOlive")},isChoiceOliveItem:function(){var e=this,t=!1;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");if(e.isOliveItem(n))return t=!0,!1}),t},isCookitItem:function(e){return this.getCartItemModel(e).get("isCookit")},isChoiceCookitItem:function(){var e=this,t=!1;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");if(e.isCookitItem(n))return t=!0,!1}),t},isCookitItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id");if(e.isCookitItem(r))return t=!0,!1}),t},isDawnItem:function(e){return this.getCartItemModel(e).get("isDawn")},isChoiceDawnItem:function(){var e=this,t=!1;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");if(e.isDawnItem(n))return t=!0,!1}),t},isDawnItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id");if(e.isDawnItem(r))return t=!0,!1}),t},isBNPCostIncomeItem:function(e){var t=this,r=t.getCartItemModel(e).get("incomeDedYn");return Number(r)>0},isBNPItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id");if(e.isBNPCostIncomeItem(r))return t=!0,!1}),t},isSoldoutOrderItem:function(e){return this.getCartItemModel(e).get("isSoldOut")},isChoiceSoldoutOrderItem:function(){var e=this,t=!1;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");if(e.isSoldoutOrderItem(n))return t=!0,!1}),t},isSoldoutItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id");if(e.isSoldoutOrderItem(r))return t=!0,!1}),t},isSoloOrderItem:function(e){return this.getCartItemModel(e).get("isSoloOrder")},isChoiceSoloOrderItem:function(){var e=this,t=!1;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");if(e.isSoloOrderItem(n))return t=!0,!1}),t},isSoloOrderItemExistsInCart:function(){var e=this,t=!1;return e.getTotalCheckboxElement().each(function(){var r=$(this).attr("id");if(e.isSoloOrderItem(r))return t=!0,!1}),t},getSoloOrderItemCount:function(){var e=this,t=0;return e.getTotalCheckboxElement().each(function(r,o){var n=$(o).attr("id");e.isSoloOrderItem(n)&&t++}),t},getChoiceBNPIncomeItemCount:function(){var e=this,t=0;return e.getTotalCheckboxElement(!0).each(function(r,o){var n=$(o).attr("id");e.isBNPCostIncomeItem(n)&&t++}),t},getCookitIntersectionDateList:function(){var e=this,t=[],r=[];return $("._cookitGroup").find("input:checkbox[class=_itemCheckBox]:checked").not(":disabled").each(function(o,n){var l=$(n).attr("id"),i=e.getCartItemModel(l);if(e.isCookitItem(l)){var a=i.get("cookitSupplyPlanList");if(null==a)return t=[],!1;t=e.getDeliveryPlanDateList(a),r=0==r.length?t:_.intersection(r,t)}}),r},getDeliveryPlanDateList:function(e){var t=[];return _.each(e,function(e){t.push(e.deliveryPlanDate)}),t},getCookitSupplyPlanText:function(e){var t=this,r="",o=e.get("cookitSupplyPlanList");if(0==_.isEmpty(o)){var n=[];_.each(o,function(e){var r=t.cookitDeliveryPlanFormat(e.deliveryPlanDate);n.push(r)}),r=n.join(", ")}else r="없음";return r},cookitDeliveryPlanFormat:function(e){var t=e.substring(0,4),r=e.substring(4,6),o=e.substring(6,8),n=new Date(t,r-1,o),l=["일","월","화","수","목","금","토"],i=l[n.getDay()];return String(n.getMonth()+1)+"/"+String(n.getDate())+"("+i+")"}};return n.prototype=l,new n}),define("page/cjmall/order/cart/util/deliveryUtils",["page/cjmall/order/cart/models/cartMainModel"],function(e){function t(){}var r={addOrderUnitCodeToDeliveryPolicyModel:function(e,t){var r=_.clone(t.get("orderUnitCodeList"));-1===r.indexOf(e.get("itemBasicInfo").unitCode)&&r.push(e.get("itemBasicInfo").unitCode),t.set("orderUnitCodeList",r)},removeOrderUnitCodeToDeliveryPolicyModel:function(e,t){var r=_.clone(t.get("orderUnitCodeList")),o=r.indexOf(e.get("itemBasicInfo").unitCode);o>-1&&r.splice(o,1),t.set("orderUnitCodeList",r)},removeUnitCodeToDeliveryPolicyModel:function(e,t){var r=_.clone(t.get("unitCodeList")),o=r.indexOf(e.get("itemBasicInfo").unitCode);o>-1&&r.splice(o,1),t.set("unitCodeList",r)},resetDeliveryPolicyModel:function(t,r,o,n){for(var l=0,i=0,a=0,d=0,s=r.get("minordAmount"),c=r.get("minordQuantity"),u=r.get("deliveryPrice"),p=!1,m=e.get("cartListCollection"),o=r.get("orderUnitCodeList"),f=!1,g=0;g<o.length;g++)for(var v=o[g],y=0;y<m.length;y++){var h=m.at(y);h.get("itemBasicInfo").unitCode===v&&(l=h.get("quantity"),i=h.get("itemPriceInfo").salePrice*l,a+=l,d+=i,"FREE"===h.get("itemDeliveryInfo").deliveryTypeName&&(f=!0))}r.set("freeDelivery",f),f?u=0:(d>=s&&a>=c&&(u=0,o.length>1&&(p=!0)),0==s&&0==c&&(u=0,o.length>1&&(p=!0)),s>0&&0==c&&d>=s&&(u=0,o.length>1&&(p=!0)),0==u&&(u=0,o.length>1&&(p=!0))),a<0&&(a=0),d<0&&(d=0),u<0&&(u=0),r.set("totalQuantity",a),r.set("totalSalePrice",d),r.set("groupDeliveryPrice",u),r.set("bundleSale",p)},getFreeDelivery:function(e,t,r){var o=e.get("minordAmount"),n=e.get("minordQuantity"),l=e.get("deliveryPrice");return r>=o&&t>=n&&(l=0),0==o&&0==n&&(l=0),o>0&&0==n&&r>=o&&(l=0),0==l&&(l=0),l},getDeliveryPolicyModel:function(t){for(var r=e.get("deliveryPolicyCollection"),o=null,n=0;n<r.length;n++){for(var l=r.at(n),i=l.get("unitCodeList"),a=0;a<i.length;a++)if(t===i[a]){o=l;break}if(null!=o)break}return o}};return t.prototype=r,new t}),define("page/cjmall/order/common/m/view/amorePointFormView",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","page/cjmall/order/common/models/amorePointFormModel","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({tagName:"div",amorePointLayerTemplate:o.getPrecompiledTemplate("handlebars/page/cjmall/order/common/m/amoreBeautyPoint/amoreBeautyPointLayer"),model:null,events:{"click ._saveBeautyPoint":"saveAmorePoint"},initialize:function(e){this.render(e)},render:function(e){var t=this;t.$el.html(t.amorePointLayerTemplate(e))},saveAmorePoint:function(e){e.preventDefault();var t=this,o=$("#_amorePointPopUp"),n=(t.$el.find("#beautypoint_cardnum"),new r);if(0==o.find("#point_agree").is(":checked"))return alert("정보제공에 동의해주세요."),!1;if(""==o.find("#beautypoint_cardnum").val())return alert("카드번호를 입력해주세요."),!1;if(16!=o.find("#beautypoint_cardnum").val().length)return alert("카드번호를 정확히 입력해주세요."),!1;var l={orderNo:o.attr("data-order-no"),orderGSeq:o.attr("data-order-GSeq"),beautyOrderType:o.attr("data-beautyOrderType"),orderFlag:o.attr("data-orderFlag"),cstmCardno:o.attr("data-cstmCardno"),ucstmId:o.attr("data-ucstmId"),pointNumber1:t.$el.find("#beautypoint_cardnum").val(),pointNumber2:o.attr("data-pointNumber2")};n.submit(l,function(e){alert(e.message),"SUCCESS"===e.result.resultCode&&location.replace(location.href)})}})}),define("page/cjmall/order/common/models/amorePointFormModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil"],function(e,t){return Backbone.Model.extend({url:"",defaults:{amoreBeautyPointTuple:{}},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/end/"+e.get("orderNo")+"/amoreBeautyPoint"},parse:function(e){var r=this;if(!e||0==e.code)return void t.alertAndRedirect(e.message);var o=e.result?e.result:{};r.set("amoreBeautyPointTuple",o)},submit:function(e,t){var r=this;r.ajax=Backbone.ajax({url:r.url,async:!0,method:"POST",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(e),xhrFields:{withCredentials:!0},success:function(e,r,o){t(e)}})}})}),define("page/cjmall/order/common/p/view/amorePointFormView",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","page/cjmall/order/common/models/amorePointFormModel"],function(e,t,r){return Backbone.View.extend({el:"#_amorePointPopUp",amorePointLayerTemplate:Handlebars.compile($("#amorePointLayerTemplate").html()),model:null,events:{"click ._saveBeautyPoint":"saveAmorePoint","focusin .int":"addInputBoxText","focusout .int":"deleteInputBoxText"},initialize:function(){var e=this;e.model=new r,e.model.fetch({timeout:5e3,success:function(){e.render()},error:function(e){var r=e.message;t.alertAndRedirect(r)}})},render:function(){var t=this,r=t.$el,o=e.get("orderNo"),n=t.model.get("amoreBeautyPointTuple"),l={urlOrderNo:o,amoreBeautyPointTuple:n};r.html(t.amorePointLayerTemplate(l))},saveAmorePoint:function(e){e.preventDefault();var t=this,o=$("#_order_point_area"),n=new r;if(0==o.find("#point_agree").is(":checked"))return alert("정보제공에 동의해주세요."),!1;if(""==o.find("#beautypoint_cardnum").val())return alert("카드번호를 입력해주세요."),!1;if(16!=o.find("#beautypoint_cardnum").val().length)return alert("카드번호를 정확히 입력해주세요."),!1;var l={orderNo:o.attr("data-order-no"),orderGSeq:o.attr("data-order-GSeq"),beautyOrderType:o.attr("data-beautyOrderType"),orderFlag:o.attr("data-orderFlag"),cstmCardno:o.attr("data-cstmCardno"),ucstmId:o.attr("data-ucstmId"),pointNumber1:t.$el.find("#beautypoint_cardnum").val(),pointNumber2:o.attr("data-pointNumber2")};n.submit(l,function(e){alert(e.message),"SUCCESS"===e.result.resultCode&&history.back()})},addInputBoxText:function(e){$(".u_ipbx").addClass("on")},deleteInputBoxText:function(e){""==$("#_amorePointPopUp").find("#beautypoint_cardnum").val()&&$(".u_ipbx").removeClass("on")}})}),define("page/cjmall/order/delivery/collections/deliverySafeDetailAddrCollection",["common/cjos/util/configUtil","page/cjmall/order/delivery/deliverySafeModel"],function(e,t){return Backbone.Collection.extend({model:t,defaults:{deliverySafeDetailAddrList:null},url:e.get("ecBaseSslUrl")+"/c/rest/order/delivery/detailAddrList",parse:function(e){this.set({deliverySafeDetailAddrList:e.result})}})}),define("page/cjmall/order/delivery/collections/deliverySafeGuCollection",["common/cjos/util/configUtil","page/cjmall/order/delivery/deliverySafeModel"],function(e,t){return Backbone.Collection.extend({model:t,defaults:{deliverySafeGuList:null},url:e.get("ecBaseSslUrl")+"/c/rest/order/delivery/guList",parse:function(e){this.set({deliverySafeGuList:e.result})}})}),define("page/cjmall/order/delivery/deliverySafeMainModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r){return new(Backbone.Model.extend({url:"",defaults:{deliverySafeCityList:null},initialize:function(){cjosLogUtil.log("[DeliverySafeMainModel.js] init function IN!!!"),this.url=e.get("ecBaseSslUrl")+"/c/rest/order/delivery/cityList"},parse:function(t){var r=this;if(cjosLogUtil.log("response : ",t),!t||0==t.code)return alert("정상적인 조회가 아닙니다. [code:"+t.code+"]"),void location.replace(e.get("displayDomain")+"/m/main");r.set({deliverySafeCityList:t.result})}}))}),define("page/cjmall/order/delivery/deliverySafeModel",[],function(){return Backbone.Model.extend({defualts:{zipno:null,si_nm:null,gu_nm:null,dong_nm:null,dong_nm_dtl:null,road_nm:null,safe_box_nm:null,longitude:null,latitude:null},initialize:function(){cjosLogUtil.log("DeliverySafeModel initialize")}})}),define("page/cjmall/delivery/model/deliveryModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r){return new(Backbone.Model.extend({url:"",defaults:{safeDeliveryCityAddrList:""},initialize:function(){var t=this;switch(r.get(r.APPLICATION_TYPE)){case"p":"PC";break;case"m":"MOBILE"}t.url=e.get("ecBaseSslUrl")+"/p/order/delivery/referral/popup"},parse:function(t){var r=this;if(cjosLogUtil.log("response : ",t),!t||0==t.code)return alert("정상적인 조회가 아닙니다. [code:"+t.code+"]"),void location.replace(e.get("displayDomain")+"/m/main");r.set({safeDeliveryCityAddrList:t.result.safeDeliveryCityAddrList})}}))}),define("page/cjmall/order/delivery/view/deliverySafeMainView",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/delivery/deliverySafeMainModel","page/cjmall/order/delivery/collections/deliverySafeGuCollection","page/cjmall/order/delivery/collections/deliverySafeDetailAddrCollection","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l,i){return Backbone.View.extend({el:".wrap_safebox",cityEl:".city",model:o,templateCity:Handlebars.compile($("#safeDeliverySelectCity").html()),templateGu:Handlebars.compile($("#safeDeliverySelectGu").html()),templateDetailList:Handlebars.compile($("#safeDeliveryDetailAddr").html()),events:{"change ._siNmSelect":"changeSiNmSelectHandler","click ._odin_siNmSelect":"manuallyClickCodeHn","click ._odin_guNmSelect":"manuallyClickCodeHn","click ._addrSearch":"searchDetailAddrHandler","click ._radioSelect":"selectAddrHandler","click ._loadMap":"loadMap"},initialize:function(){cjosLogUtil.log("[2][deliverySafeMainView.js] initialize called.");var e=this;e.createKakaoSDK();e.model.fetch({timeout:6e4,dataType:"json",xhrFields:{withCredentials:!0},success:function(){e.render()},error:function(e,t,r){r&&"timeout"===r.textStatus&&alert("")}});e.deliverySafeGuCollection=new n,e.deliverySafeDetailAddrCollection=new l},render:function(){var e=this,t=(e.model.get("deliverySafeCityList"),e.$el);t.find("#_cityAreaSub").remove(),t.find("#_cityArea").html(e.templateCity(e.model.toJSON())),cjosLogUtil.log("[6][deliverySafeMainView] render called.")},manuallyClickCodeHn:function(e){i.splunkClickLog($(e.target).attr("data-click"))},changeSiNmSelectHandler:function(e){e.preventDefault();var t=this,r=(t.$el,t.$el.find("._siNmSelect option:selected").val());t.deliverySafeGuCollection.fetch({remove:!1,data:{siNm:r},xhrFields:{withCredentials:!0},beforeSend:function(){},success:function(e,r,o){var n=t.$el;n.find("#_guAreaSub").remove(),n.find("#_guArea").html(t.templateGu(e.models[0].toJSON()))},error:function(){},complete:function(){}})},searchDetailAddrHandler:function(e){e.preventDefault();var t=this,r=(t.$el,t.$el.find("._siNmSelect option:selected").val()),o=t.$el.find("._guNmSelect option:selected").val();null==r||""==r?alert("시/도를 선택해주세요."):null!=o&&""!=o||alert("구를 선택해주세요."),t.deliverySafeDetailAddrCollection.fetch({remove:!1,data:{siNm:r,guNm:o},xhrFields:{withCredentials:!0},beforeSend:function(){},success:function(e,r,o){t.$el.find("#_detailArea").html(t.templateDetailList(e.models[0].toJSON()))},error:function(){},complete:function(){}})},createKakaoSDK:function(){requirejs(["//dapi.kakao.com/v2/maps/sdk.js?appkey="+e.get("kakaoAppKey")+"&autoload=false"],function(e){window.daum.maps.load(function(){console.log(window.daum)})},function(){})},loadMap:function(e){e.preventDefault();for(var t=this,r=t.$el,o=$(e.target).val(),n="map"+o,l=parseFloat(t.$el.find("#longitude"+o).val()),a=parseFloat(t.$el.find("#latitude"+o).val()),d=r.find("#safeBoxNm"+o).val(),s="btn"+o,c=document.getElementById(n),u=document.getElementsByName("map"),p=0;p<u.length;p++){var m=document.getElementById(u[p].id);t.$el.find("#btn"+(p+1)).text("지도"),n!=u[p].id&&"none"!=m.style.display&&(m.style.display="none")}if("none"===t.$el.find("#"+n).css("display")){i.splunkClickLog("ODIN____delivery__ansimmap__"),t.$el.find("#"+n).css("display","block"),t.$el.find("#"+s).text("닫기");var f={center:new daum.maps.LatLng(a,l),level:3},g=new daum.maps.Map(c,f),v=new daum.maps.LatLng(a,l),y=new daum.maps.Marker({position:v});y.setMap(g),y.setTitle(d),g.setKeyboardShortcuts(!1)}else i.splunkClickLog("ODIN____delivery__ansimmapclose__"),t.$el.find("#"+n).css("display","none"),t.$el.find("#"+s).text("지도")},selectAddrHandler:function(t){t.preventDefault();var o=this;o.$el;o.manuallyClickCodeHn(t);var n=$(t.target).val(),l=o.$el.find("#zipNo"+n).val(),i=o.$el.find("#siNm"+n).val(),a=o.$el.find("#guNm"+n).val(),d=o.$el.find("#dongNm"+n).val(),s=o.$el.find("#dongNmDtl"+n).val(),c=o.$el.find("#roadNm"+n).val(),u=o.$el.find("#safeBoxNm"+n).val();$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/delivery/return",method:"POST",data:{zipNo:l,siNm:i,guNm:a,dongNm:d,dongNmDtl:s,roadNm:c,safeBoxNm:u},xhrFields:{withCredentials:!0},success:function(e){if(1===e.code){var t={siNm:e.result.siNm,guNm:e.result.guNm,dongNm:e.result.dongNm,dongNmDtl:e.result.dongNmDtl,roadNm:e.result.roadNm,safeBoxNm:e.result.safeBoxNm,zipNo:e.result.zipNo,transCode:e.result.transCode,isSuccessConvert:String(e.result.successConvert),address:e.result.convertAddress.address,addressDetail:e.result.convertAddress.addressDetail,addressReference:e.result.convertAddress.addressReference,roadManageKey:e.result.convertAddress.roadManageKey,buildingManageNo:e.result.convertAddress.buildingManageNo,zipCode:e.result.convertAddress.zipCode,newZipCode:e.result.convertAddress.newZipCode,newZipNoSeq:e.result.convertAddress.newZipCodeSeq,zipNoSeq:e.result.convertAddress.zipCodeSeq,isRepresentJibun:String(e.result.convertAddress.representJibun),addressType:e.result.convertAddress.addressType,areaCls:e.result.areaCls};return void("p"==r.get(r.APPLICATION_TYPE)?(window.parent.opener.womanSafeReturn(t),window.open("about:blank","_self").close()):(parent.parent.womanSafeReturn(t),parent.parent.womanSafeLayerViewClose()))}e.code},error:function(){}})}})}),define("page/cjmall/order/end/models/orderEndMainModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r){return new(Backbone.Model.extend({url:"",defaults:{orderEndType:"",orderNo:"",orderGSeq:"",urlOrderNo:"",orderEndTypeTuple:{},isNoneCust:!1,nonCustomerPassword:"",paymentTuple:{},orderEndDeliveryTuples:[],belifBrand:!1,amoreBeautyPoint:!1,amoreBeautyPointTuple:{},marketingBannerTuple:{},isRealtimeAccountTransfer:!1,realtimeAccountTransferTuple:{},isPresentYN:!1},initialize:function(){var t=this,o="";switch(r.get(r.APPLICATION_TYPE)){case"p":o="PC";break;case"m":o="MOBILE"}t.url=e.get("ecBaseSslUrl")+"/c/rest/order/end/"+e.get("orderNo")+"?applicationType="+o},parse:function(t){var r=this;if(cjosLogUtil.log("response : ",t),!t||0==t.code)return alert("정상적인 조회가 아닙니다. [code:"+t.code+"]"),void location.replace(e.get("displayDomain")+"/m/main");r.set({orderEndType:t.result.orderEndType,orderNo:t.result.orderNo,orderGSeq:t.result.orderGSeq,urlOrderNo:t.result.urlOrderNo,isNoneCust:t.result.isNoneCust,nonCustomerPassword:t.result.nonCustomerPassword,
orderEndTypeTuple:t.result.orderEndTypeTuple,paymentTuple:t.result.paymentTuple,orderEndDeliveryTuples:t.result.orderEndDeliveryTuples,belifBrand:t.result.belifBrand,amoreBeautyPoint:t.result.amoreBeautyPoint,amoreBeautyPointTuple:t.result.amoreBeautyPointTuple,marketingBannerTuple:t.result.marketingBannerTuple,isRealtimeAccountTransfer:t.result.realtimeAccountTransfer,realtimeAccountTransferTuple:t.result.realtimeAccountTransferTuple,orderInfoExternalUseTuple:t.result.orderInfoExternalUseTuple,maskingCellPhoneNo:t.result.maskingCellPhoneNo,commonBannerTuples:t.result.commonBannerTuples,commonPopupTuple:t.result.commonPopupTuple,isPresentYN:t.result.orderEndDeliveryTuples[0].presentYn,regularPaymentInfo:t.result.orderEndRegularPaymentInfoTuple})}}))}),define("page/cjmall/order/end/view/m/orderEndMainView",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/end/models/orderEndMainModel","common/cjmall/ui/m/fullLayer/views/fullLayerView","page/cjmall/order/common/m/view/amorePointFormView","common/cjos/logger/utils/loggerUtil","common/cjmall/ui/m/loading/views/simpleLoadingBar","common/cjos/util/urlUtil","page/cjmall/order/sheet/view/chargeDiscountExpectPriceView","page/cjmall/order/popup/view/m/orderPopupView","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n,l,i,a,d,s,c,u){return Backbone.View.extend({el:"._orderEndContent",template:u.getPrecompiledTemplate("handlebars/page/cjmall/order/end/m/orderEnd"),regularPaymentTemplate:u.getPrecompiledTemplate("handlebars/page/cjmall/order/end/m/orderRegularPaymentEnd"),paymentListLayerTemplate:u.getPrecompiledTemplate("handlebars/page/cjmall/order/end/m/paymentListLayer"),model:o,layerPopUp:null,orderEndType:null,simpleLoadingBar:new a,events:{"click ._showDetailPopUp":"showDetailPopUp","click ._hideDetailPopUp":"hideDetailPopUp","click ._showAmorePoint":"showAmorePointLayer","click ._linkUrl":"goLinkUrl","click ._goMarketingBanner":"goMarketingBanner","click ._goInsuAdBanner":"goInsuAdBanner","click #_closeDownloadAmazingCoupon":"closeDownloadAmazingCoupon","click ._closeSweetCashback":"closeSweetCashback","click ._redirectLive":"redirectLivePage"},initialize:function(){var r=this,o=r.$el;r.simpleLoadingBar.appendTo(o,!0,!1),r.setLoggerKey(),r.setHandlebarsHelper(),r.model.fetch({timeout:5e3,async:!1,data:{noneCustInfo:e.get("noneCustInfo")},success:function(e){r.render(),r.showDownloadAmazingCoupon(),r.setLoggerValue(),r.showHanssemDeliveryMessage()},error:function(e){t.alertAndRedirect("주문정보를 조회할수 없습니다.")}})},render:function(){var t=this,o=t.$el,n=e.get("orderChangePaymentMeansYn");_.isEmpty(n)||t.model.set("orderChangePaymentMeansYn",n);var l=t.model.toJSON();l.ecBaseCjmallImageUrl=e.get("ecBaseCjmallImageUrl");var i=_.isUndefined(e.get("orderEndRedirectForm"))?"":e.get("orderEndRedirectForm");if(i&&(l.orderEndRedirectForm=$.parseJSON(i)),t.orderEndType=l.orderEndType,"REGULAR_PAYMENT"==t.orderEndType){$("head").find("title").text("신청완료"),"m"===r.get(r.APPLICATION_TYPE)&&($("#header").find(".tit").text("신청완료"),1==r.userAgent.get("isOshoppingApp")&&appInterfaceUtil.setPageTitle("신청완료")),o.html(t.regularPaymentTemplate(l))}else o.html(t.template(l));t.chargeDiscountExpectPrice(l),t.orderPopupView=new c,t.simpleLoadingBar.remove()},chargeDiscountExpectPrice:function(e){var t=this,r=t.$el;if(!0!==t.model.get("orderEndTypeTuple").cjcard)for(var o=t.model.get("paymentTuple").paymentMeanTuples,n=0;n<o.length;n++){var l=o[n],i=l.pamMethodCodeType;if("PAM_METH_CD_01"===i){var a=l.chargeDiscountExpectPrice;t.chargeDiscountExpectPriceView=new s;var d=t.chargeDiscountExpectPriceView.render(a);if(null===d)return;var c=d.$el;r.find("#_chargeExpectPrice").html(c),a>0&&r.find("#_chargeExpectPriceArea").css("display","")}}},setHandlebarsHelper:function(){Handlebars.registerHelper("concatImageServerUrl",function(t){return e.get("imgServerUrl")+t}),Handlebars.registerHelper("extraItemCount",function(e){return e>1?e-1:e})},setLoggerKey:function(){i.setSplunkKey("customPI"),i.setSplunkKey("orderAmount"),i.setSplunkKey("orderProductCode"),i.setSplunkKey("orderProductName"),i.setSplunkKey("orderProductUnitCode"),i.setSplunkKey("orderProductCount"),i.setSplunkKey("productType"),i.setSplunkKey("shopCode"),i.setSplunkKey("mdCode"),i.setSplunkKey("searchWord"),i.setSplunkKey("ordNo"),i.setSplunkKey("employeeYN"),i.setSplunkKey("employeeSaleItemYN"),i.setSplunkKey("gCateCd"),i.setSplunkKey("lCateCd"),i.setSplunkKey("mCateCd"),i.setSplunkKey("sCateCd"),i.setSplunkKey("pgmCd"),i.setSplunkKey("IpgmCd"),i.setSplunkKey("partnerCd"),i.setSplunkKey("orderFormType"),i.setSplunkKey("realOrderAmount"),i.setSplunkKey("vatRate"),i.setSplunkKey("payType"),i.setSplunkKey("orderSheetType")},setLoggerValue:function(){var e=this,t=e.model;if(null!=t){try{for(var r=t.get("orderInfoExternalUseTuple"),o=r?r.listOrderItem:[],n=r?r.keyword:"",l=r?r.orderFormType:"",a=t.get("orderEndType"),d=r?r.payType:"",s="",c="",u="",p="",m="",f="",g="",v="",y="",h="",_="",C="",P="",A="",T="",I="",w="",k="",b="",D="",M=0;M<o.length;M++)0==M?(s=o[M].itemCode,c=o[M].itemName,u=o[M].unitCode,p=o[M].unitQty,y=o[M].shopId,m=o[M].unitOriginalPrice,v=o[M].mdCode,I=e.getStringValue(o[M].programCode),w=e.getStringValue(o[M].internetLiveProgramCode),k=o[M].mainVenCode,g="50001001"==o[M].channelCode||"30001003"==o[M].channelCode||"50014002"==o[M].channelCode||"30002003"==o[M].channelCode||"50001010"==o[M].channelCode||"30001022"==o[M].channelCode?"ETV":"NML",h=r.employee?"Y":"N",_=o[M].employeeSaleItem?"Y":"N",C=e.getStringValue(o[M].llargeCategoryId),P=e.getStringValue(o[M].largeCategoryId),A=e.getStringValue(o[M].middleCategoryId),T=e.getStringValue(o[M].smallCategoryId),b=o[M].realSaleAmount,D=o[M].vatRate):(s=s+";"+o[M].itemCode,c=c+";"+o[M].itemName,u=u+";"+o[M].unitCode,p=p+";"+o[M].unitQty,y=y+";"+o[M].shopId,m=m+";"+o[M].unitOriginalPrice,v=v+";"+o[M].mdCode,I=I+";"+e.getStringValue(o[M].programCode),w=w+";"+e.getStringValue(o[M].internetLiveProgramCode),k=k+";"+o[M].mainVenCode,"50001001"==o[M].channelCode||"30001003"==o[M].channelCode||"50014002"==o[M].channelCode||"30002003"==o[M].channelCode||"50001010"==o[M].channelCode||"30001022"==o[M].channelCode?g+=";ETV":g+=";NML",h=h+";"+(r.employee?"Y":"N"),_=_+";"+o[M].employeeSaleItem?"Y":"N",C=C+";"+e.getStringValue(o[M].llargeCategoryId),P=P+";"+e.getStringValue(o[M].largeCategoryId),A=A+";"+e.getStringValue(o[M].middleCategoryId),T=T+";"+e.getStringValue(o[M].smallCategoryId),b=b+";"+o[M].realSaleAmount,D=D+";"+o[M].vatRate);f=t.get("orderNo")}catch(O){cjosLogUtil.log("[orderEndMainView.setLoggerValue setting error]",O)}i.setSplunkValue("customPI","ODR"),i.setSplunkValue("orderAmount",m),i.setSplunkValue("orderProductCode",s),i.setSplunkValue("orderProductName",c),i.setSplunkValue("orderProductUnitCode",u),i.setSplunkValue("orderProductCount",p),i.setSplunkValue("productType",g),i.setSplunkValue("shopCode",y),i.setSplunkValue("mdCode",v),i.setSplunkValue("searchWord",n),i.setSplunkValue("ordNo",f),i.setSplunkValue("employeeYN",h),i.setSplunkValue("employeeSaleItemYN",_),i.setSplunkValue("gCateCd",C),i.setSplunkValue("lCateCd",P),i.setSplunkValue("mCateCd",A),i.setSplunkValue("sCateCd",T),i.setSplunkValue("pgmCd",I),i.setSplunkValue("IpgmCd",w),i.setSplunkValue("partnerCd",k),i.setSplunkValue("orderFormType",l),i.setSplunkValue("realOrderAmount",b),i.setSplunkValue("vatRate",D),i.setSplunkValue("payType",d),i.setSplunkValue("orderSheetType",a)}},getStringValue:function(e){var t="";return _.isEmpty(e)||(t=e),t},showDetailPopUp:function(e){e&&(e.originalEvent&&i.splunkClickLog("ODEN____payinfo__infolayer__"),e.preventDefault());var t=this,r=t.$el.find(".billing_amount");r.html(t.paymentListLayerTemplate(t.model.toJSON())),r.show()},hideDetailPopUp:function(e){e.preventDefault(),this.$el.find("#billing_amount").hide()},showAmorePointLayer:function(e){e.preventDefault();var t=this;t.$el;t.amorelayerPopUp||(t.amorelayerPopUp=new n({title:"아모레포인트",container:"body",useHistory:!1,content:new l(t.model.toJSON())})),t.amorelayerPopUp.show(),cjosLogUtil.log($("#_amorePointPopUp"))},goLinkUrl:function(t){var r,o,n=this,l=(n.$el,$(t.currentTarget).attr("data-link-value")),a=e.get("orderNo"),d=e.get("noneCustInfo");if("orderChangePaymentMeans"==l){r="ODEN____payinfo__chgpay__";if(n.model.get("orderEndTypeTuple").cjcard)return alert("CJ카드 즉시할인을 받으신 결제건은 결제수단 변경이 불가합니다. 전체 취소 후 재주문해주세요."),void t.preventDefault();cjosLogUtil.log("결제수단 변경"),o=e.get("ecBaseSslUrl")+"/m/myzone/orderInfo/"+a}else"orderDeliveryChange"==l?(r="ODEN____prdinfo__chgadd__",cjosLogUtil.log("배송지 변경"),o=e.get("ecBaseSslUrl")+"/m/myzone/orderInfo/"+a):"main"==l?(i.splunkClickLog("ODEN____bottom__main__"),cjosLogUtil.log("main"),o=e.get("displayDomain")+"/m/main"):"orderDetailInfo"==l&&(r="ODEN____bottom__detailpay__",cjosLogUtil.log("주문상세내역"),o=e.get("ecBaseSslUrl")+"/m/myzone/orderInfo/"+a);if(r&&i.splunkClickLog(r),"orderDetailInfo"==l){if("NON_CUSTOMER"==n.model.get("orderEndType")){var s=$("<form></form>");s.append($("<input>").attr("type","hidden").attr("name","noneCustInfo").val(d)),s.attr({action:o,method:"post",id:"orderInfoForm"}),$("#container").append(s),s.submit()}else location.href=o}else location.href=o},goInsuAdBanner:function(e){e.preventDefault();location.href="http://minsu.cjmall.com/shop/insu/join/gateInsu_first_gate.jsp?GATE_GBN=80&GATE_URL=http://minsu.cjmall.com/m/join/cj_order_index.jsp"},goMarketingBanner:function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-link-url");t+="&pic=btn_order_submit_001",location.href=t},showDownloadAmazingCoupon:function(){var t=this,r=t.$el;"true"==e.get("isDownloadAmazingCoupon")&&"1"!=e.get("orderChangePaymentMeansYn")&&r.find("#amazing_cpn_layout").show()},showHanssemDeliveryMessage:function(){var t=this,r=(t.$el,e.get("hanssemAlertMessage"));_.isUndefined(r)||_.isEmpty(r)||_.isNull(r)||alert(r)},closeDownloadAmazingCoupon:function(){this.$el.find("#amazing_cpn_layout").hide()},closeSweetCashback:function(){this.$el.find("#order_popup_layout").hide()},redirectLivePage:function(){i.splunkClickLog("ODEN____bottom__live__"),orderEndRedirectForm=$.parseJSON(e.get("orderEndRedirectForm")),location.href=orderEndRedirectForm.redirectUrl}})}),define("page/cjmall/order/end/view/p/orderEndMainView",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/end/models/orderEndMainModel","page/cjmall/order/common/models/amorePointFormModel","page/cjmall/order/payment/helper/realtimeAccountTransferHelper","common/cjos/logger/utils/loggerUtil","common/cjos/util/urlUtil","page/cjmall/order/sheet/view/chargeDiscountExpectPriceView","page/cjmall/order/popup/view/p/orderPopupView","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n,l,i,a,d,s,c){return Backbone.View.extend({el:"._orderEndContent",template:c.getPrecompiledTemplate("handlebars/page/cjmall/order/end/p/orderEnd"),regularPaymentTemplate:c.getPrecompiledTemplate("handlebars/page/cjmall/order/end/p/orderRegularPaymentEnd"),paymentListLayerTemplate:c.getPrecompiledTemplate("handlebars/page/cjmall/order/end/p/paymentListLayer"),model:o,layerPopUp:null,orderEndType:null,events:{"click ._showDetailPopUp":"showDetailPopUp","click ._hideDetailPopUp":"hideDetailPopUp","click ._goAmorePoint":"goAmorePoint","click ._linkUrl":"goLinkUrl","click ._goBelifShop":"goBelifShop","click ._goMarketingBanner":"goMarketingBanner","click #_closeDownloadAmazingCoupon":"closeDownloadAmazingCoupon","click ._closeSweetCashback":"closeSweetCashback","click ._redirectLive":"redirectLivePage"},initialize:function(){var r=this;r.$el;r.setLoggerKey(),r.setHandlebarsHelper(),r.model.fetch({timeout:5e3,async:!1,data:{noneCustInfo:e.get("noneCustInfo")},xhrFields:{withCredentials:!0},success:function(){r.render(),r.showDownloadAmazingCoupon(),r.setLoggerValue(),r.showHanssemDeliveryMessage()},error:function(e){cjosLogUtil.log(e.message),t.alertAndRedirect("주문정보를 조회할수 없습니다.")}})},render:function(){var t=this,r=t.$el,o=e.get("orderChangePaymentMeansYn");_.isEmpty(o)||t.model.set("orderChangePaymentMeansYn",o);var n=t.model.toJSON();n.ecBaseCjmallImageUrl=e.get("ecBaseCjmallImageUrl");var i=_.isUndefined(e.get("orderEndRedirectForm"))?"":e.get("orderEndRedirectForm");i&&(n.orderEndRedirectForm=$.parseJSON(i)),t.orderEndType=n.orderEndType,"REGULAR_PAYMENT"==t.orderEndType?r.html(t.regularPaymentTemplate(n)):(r.html(t.template(n)),l.call(n)),t.orderPopupView=new s,t.chargeDiscountExpectPrice(n)},chargeDiscountExpectPrice:function(e){var t=this,r=t.$el;if(!0!==t.model.get("orderEndTypeTuple").cjcard)for(var o=t.model.get("paymentTuple").paymentMeanTuples,n=0;n<o.length;n++){var l=o[n],i=l.pamMethodCodeType;if("PAM_METH_CD_01"===i){var a=l.chargeDiscountExpectPrice;t.chargeDiscountExpectPriceView=new d;var s=t.chargeDiscountExpectPriceView.render(a);if(null===s)return;var c=s.$el;r.find("#_chargeExpectPrice").html(c),a>0&&r.find("#_chargeExpectPriceArea").css("display","")}}},setHandlebarsHelper:function(){Handlebars.registerHelper("concatImageServerUrl",function(t){return e.get("imgServerUrl")+t}),Handlebars.registerHelper("extraItemCount",function(e){return e>1?e-1:e})},setLoggerKey:function(){i.setSplunkKey("customPI"),i.setSplunkKey("orderAmount"),i.setSplunkKey("orderProductCode"),i.setSplunkKey("orderProductName"),i.setSplunkKey("orderProductUnitCode"),i.setSplunkKey("orderProductCount"),i.setSplunkKey("productType"),i.setSplunkKey("shopCode"),i.setSplunkKey("mdCode"),i.setSplunkKey("searchWord"),i.setSplunkKey("ordNo"),i.setSplunkKey("employeeYN"),i.setSplunkKey("employeeSaleItemYN"),i.setSplunkKey("gCateCd"),i.setSplunkKey("lCateCd"),i.setSplunkKey("mCateCd"),i.setSplunkKey("sCateCd"),i.setSplunkKey("pgmCd"),i.setSplunkKey("IpgmCd"),i.setSplunkKey("partnerCd"),i.setSplunkKey("orderFormType"),i.setSplunkKey("realOrderAmount"),i.setSplunkKey("vatRate"),i.setSplunkKey("payType"),i.setSplunkKey("orderSheetType")},setLoggerValue:function(){var e=this,t=e.model;if(null!=t){try{for(var r=t.get("orderInfoExternalUseTuple"),o=r?r.listOrderItem:[],n=r?r.keyword:"",l=r?r.orderFormType:"",a=t.get("orderEndType"),d=r?r.payType:"",s="",c="",u="",p="",m="",f="",g="",v="",y="",h="",_="",C="",P="",A="",T="",I="",w="",k="",b="",D="",M=0;M<o.length;M++)0==M?(s=o[M].itemCode,c=o[M].itemName,u=o[M].unitCode,p=o[M].unitQty,y=o[M].shopId,m=o[M].unitOriginalPrice,v=o[M].mdCode,I=e.getStringValue(o[M].programCode),w=e.getStringValue(o[M].internetLiveProgramCode),k=o[M].mainVenCode,g="50001001"==o[M].channelCode||"30001003"==o[M].channelCode||"50014002"==o[M].channelCode||"30002003"==o[M].channelCode||"50001010"==o[M].channelCode||"30001022"==o[M].channelCode?"ETV":"NML",h=r.employee?"Y":"N",_=o[M].employeeSaleItem?"Y":"N",C=e.getStringValue(o[M].llargeCategoryId),P=e.getStringValue(o[M].largeCategoryId),A=e.getStringValue(o[M].middleCategoryId),T=e.getStringValue(o[M].smallCategoryId),b=o[M].realSaleAmount,D=o[M].vatRate):(s=s+";"+o[M].itemCode,c=c+";"+o[M].itemName,u=u+";"+o[M].unitCode,p=p+";"+o[M].unitQty,y=y+";"+o[M].shopId,m=m+";"+o[M].unitOriginalPrice,v=v+";"+o[M].mdCode,I=I+";"+e.getStringValue(o[M].programCode),w=w+";"+e.getStringValue(o[M].internetLiveProgramCode),k=k+";"+o[M].mainVenCode,"50001001"==o[M].channelCode||"30001003"==o[M].channelCode||"50014002"==o[M].channelCode||"30002003"==o[M].channelCode||"50001010"==o[M].channelCode||"30001022"==o[M].channelCode?g+=";ETV":g+=";NML",h=h+";"+(r.employee?"Y":"N"),_=_+";"+o[M].employeeSaleItem?"Y":"N",C=C+";"+e.getStringValue(o[M].llargeCategoryId),P=P+";"+e.getStringValue(o[M].largeCategoryId),A=A+";"+e.getStringValue(o[M].middleCategoryId),T=T+";"+e.getStringValue(o[M].smallCategoryId),b=b+";"+o[M].realSaleAmount,D=D+";"+o[M].vatRate);f=t.get("orderNo")}catch(O){cjosLogUtil.log("[orderEndMainView.setLoggerValue setting error]",O)}i.setSplunkValue("customPI","ODR"),i.setSplunkValue("orderAmount",m),i.setSplunkValue("orderProductCode",s),i.setSplunkValue("orderProductName",c),i.setSplunkValue("orderProductUnitCode",u),i.setSplunkValue("orderProductCount",p),i.setSplunkValue("productType",g),i.setSplunkValue("shopCode",y),i.setSplunkValue("mdCode",v),i.setSplunkValue("searchWord",n),i.setSplunkValue("ordNo",f),i.setSplunkValue("employeeYN",h),i.setSplunkValue("employeeSaleItemYN",_),i.setSplunkValue("gCateCd",C),i.setSplunkValue("lCateCd",P),i.setSplunkValue("mCateCd",A),i.setSplunkValue("sCateCd",T),i.setSplunkValue("pgmCd",I),i.setSplunkValue("IpgmCd",w),i.setSplunkValue("partnerCd",k),i.setSplunkValue("orderFormType",l),i.setSplunkValue("realOrderAmount",b),i.setSplunkValue("vatRate",D),i.setSplunkValue("payType",d),i.setSplunkValue("orderSheetType",a)}},getStringValue:function(e){var t="";return _.isEmpty(e)||(t=e),t},showDetailPopUp:function(e){e&&(e.originalEvent&&i.splunkClickLog("ODEN____payinfo__infolayer__"),e.preventDefault());var t=this;t.$el.find(".ly_tooltip").html(t.paymentListLayerTemplate(t.model.toJSON())),$(e.target).closest(".tooltip_wrap").addClass("open")},hideDetailPopUp:function(e){e.preventDefault(),$(e.target).closest(".tooltip_wrap").removeClass("open")},goAmorePoint:function(t){t.preventDefault();var r=this,o=r.model.get("orderNo");location.href=e.get("ecBaseSslUrl")+"/p/order/end/"+o+"/amoreBeautyPoint"},goBelifShop:function(t){var r=e.get("ecBaseUrl")+"/p/order/end/belifStamp";window.open(r,"빌리프온라인스탬프","width=700, height=700")},goLinkUrl:function(t){var r,o,n=this,l=(n.$el,$(t.currentTarget).attr("data-link-value")),a=e.get("orderNo"),d=e.get("noneCustInfo");if("orderChangePaymentMeans"==l){r="ODEN____payinfo__chgpay__";if(n.model.get("orderEndTypeTuple").cjcard)return alert("CJ카드 즉시할인을 받으신 결제건은 결제수단 변경이 불가합니다. 전체 취소 후 재주문해주세요."),void t.preventDefault();cjosLogUtil.log("결제수단 변경"),o=e.get("ecBaseSslUrl")+"/p/myzone/orderInfo/"+a}else"orderDeliveryChange"==l?(r="ODEN____prdinfo__chgadd__",cjosLogUtil.log("배송지 변경"),o=e.get("ecBaseSslUrl")+"/p/myzone/orderInfo/"+a):"main"==l?(i.splunkClickLog("ODEN____bottom__main__"),cjosLogUtil.log("main"),o=e.get("ecDisplayUrl")+"/p/main"):"orderDetailInfo"==l&&(r="ODEN____bottom__detailpay__",cjosLogUtil.log("주문상세내역"),o=e.get("ecBaseSslUrl")+"/p/myzone/orderInfo/"+a);if(r&&i.splunkClickLog(r),"orderDetailInfo"==l){if("NON_CUSTOMER"==n.model.get("orderEndType")){var s=$("<form></form>");s.append($("<input>").attr("type","hidden").attr("name","noneCustInfo").val(d)),s.attr({action:o,method:"post",id:"orderInfoForm"}),$("#container").append(s),s.submit()}else location.href=o}else location.href=o},goMarketingBanner:function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-link-url");t+="&pic=btn_order_submit_001",location.href=t},showDownloadAmazingCoupon:function(){var t=this,r=t.$el;"true"==e.get("isDownloadAmazingCoupon")&&r.find(".amazing_cpn").show()},showHanssemDeliveryMessage:function(){var t=this,r=(t.$el,e.get("hanssemAlertMessage"));_.isUndefined(r)||_.isEmpty(r)||_.isNull(r)||alert(r)},closeDownloadAmazingCoupon:function(){this.$el.find(".amazing_cpn").hide()},closeSweetCashback:function(){this.$el.find("#order_popup_layout").hide()},redirectLivePage:function(){i.splunkClickLog("ODEN____bottom__live__"),orderEndRedirectForm=$.parseJSON(e.get("orderEndRedirectForm")),location.href=orderEndRedirectForm.redirectUrl}})}),define("page/cjmall/order/evidence/model/bookAndPerformanceCostIncomeEvidenceCollection",["page/cjmall/order/evidence/model/bookAndPerformanceCostIncomeEvidenceModel"],function(e){"use strict";return Backbone.Collection.extend({model:e,initialize:function(){},parse:function(e){if(1===e.code)return cjosLogUtil.log("[bookAndPerformanceCostIncomeEvidenceModel success]",e),e.result;alert(e.errorCode),cjosLogUtil.log("[bookAndPerformanceCostIncomeEvidenceModel error]",e)}})}),define("page/cjmall/order/evidence/model/bookAndPerformanceCostIncomeEvidenceModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/currencyUtil"],function(e,t,r,o){"use strict";return Backbone.Model.extend({defaults:{},initialize:function(){},parse:function(e){return e}})}),define("page/cjmall/order/evidence/view/bookAndPerformanceCostIncomeEvidenceMainView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","common/cjmall/ui/m/loading/views/simpleLoadingBar","page/cjmall/order/evidence/model/bookAndPerformanceCostIncomeEvidenceCollection"],function(e,t,r,o){return Backbone.View.extend({el:".myzone_shopping",submitModel:undefined,simpleLoadingBar:new r,noItemListTemplate:Handlebars.compile($("#noItemListTemplate").html()),orderProgressItemTemplate:Handlebars.compile($("#orderProgressItemTemplate").html()),events:{"click ._btn_retrieve":"retrieve"},initialize:function(){var e=this;e.$el.find("#orderChangeWrap").html(e.noItemListTemplate())},render:function(){var e=this;return $el=e.$el,$el.find("#orderChangeWrap").append(e.orderProgressItemTemplate({orderNo:e.orderNo,bookAndPerformanceCostIncomeEvidenceInfos:e.bookAndPerformanceCostIncomeEvidenceCollection.toJSON()})),this},retrieve:function(){var t=this,r=t.$el;if(t.submitModel=new Backbone.Model,t.orderNo=r.find("input[id=ordNo]").val(),!1==!!t.orderNo||null==t.orderNo)return void alert("주문번호를 입력해주세요.");t.bookAndPerformanceCostIncomeEvidenceCollection=new o,t.bookAndPerformanceCostIncomeEvidenceCollection.url=e.get("ecBaseSslUrl")+"/c/rest/bookAndPerformanceCostIncomeEvidenceConfirmApi",t.simpleLoadingBar.appendTo("#container",!0,!0),t.bookAndPerformanceCostIncomeEvidenceCollection.fetch({data:{orderNo:t.orderNo},xhrFields:{withCredentials:!0},success:function(){cjosLogUtil.log("[bookAndPerformanceCostIncomeEvidenceCollection response]",t.bookAndPerformanceCostIncomeEvidenceCollection),t.$el.find(".notice_bx").hide(),t.$el.find(".box_chk_prod").hide(),t.render(),t.model=t.bookAndPerformanceCostIncomeEvidenceCollection},error:function(){alert("상품목록을 불러오지 못하였습니다"),window.history.back()}}).always(function(){t.simpleLoadingBar.remove()})}})}),define("page/cjmall/order/giftcard/cjGiftCardInfoLayerView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","common/cjmall/ui/m/fullLayer/views/fullLayerView","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n){return Backbone.View.extend({model:null,fullLayerView:null,option:null,cjGiftCardInfoLayerTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/m/cjGiftCardInfoLayer"),initialize:function(e){var t=this;t.option=e||{},t.model=o.get("orderBenefitModel"),t.render()},render:function(){var o=this,n=Backbone.View.extend({model:null,el:o.cjGiftCardInfoLayerTemplate(o.model.toJSON()),events:{"click #myCard":"showMyGiftCard","click #cardRefund":"refundGiftCard","click #cardReg":"regGiftCard"},initialize:function(r){var o=this,n={tempOrderNo:e.get("tempOrderNo")};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookupList",type:"post",data:n,success:function(e){"0000"==e.jsonTuple.resCode?(o.$el.find("#cardCnt").text(t.formatNumber(e.jsonTuple.result.userCardCnt)),o.$el.find("#cardTotalAmt").text(t.formatNumber(e.jsonTuple.result.totalAmount)),o.$el.find("#divCardInfo").show()):alert(e.jsonTuple.resMsg+"("+e.jsonTuple.resCode+")")},error:function(e){alert("CJ기프트카드 카드조회에 실패 하였습니다.")}})},showMyGiftCard:function(e){window.open(o.model.get("cjGiftCardMyCardUrl"))},refundGiftCard:function(e){window.open(o.model.get("cjGiftCardRefundUrl"))},regGiftCard:function(e){window.open(o.model.get("cjGiftCardRegUrl"))}});o.fullLayerView=new r({title:"CJ 기프트카드",container:"body",content:(new n).$el}),o.fullLayerView.on(r.EVENT.HIDE,function(){o.fullLayerView.remove()}),o.fullLayerView.show()}})}),define("page/cjmall/order/giftcard/cjGiftCardSearchLayerView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","common/cjmall/ui/m/fullLayer/views/fullLayerView","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n){return Backbone.View.extend({model:null,fullLayerView:null,option:null,cjGiftCardSearchPopupTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/m/cjGiftCardSearchLayer"),initialize:function(e){var t=this;t.option=e||{},t.model=o.get("orderBenefitModel"),t.render()},render:function(){var n=this,l=Backbone.View.extend({model:null,el:n.cjGiftCardSearchPopupTemplate(),events:{"keyup #_pin_number":"keyUpHandler","click #cardRefund":"refundGiftCard","click #_btn_giftcard_search":"searchGiftCard","click #_btn_giftcard_set":"setGiftCard","click #_btn_giftcard_research":"researchGiftCard"},initialize:function(e){var t=this;t.model=o.get("orderBenefitModel"),t.model.get("cjGiftCardAmount")>0?this.searchGiftCardAmt(t.model.get("cjGiftCardNo")):(this.$el.find("#divSearch").show(),this.$el.find("#divPinNo").hide())},setGiftCard:function(e){e.preventDefault();var t=this.$el.find("#_pin_number").val();if(6!=t.length)return void alert("PIN번호 6자리를 입력해 주시길 바랍니다.");this.model.set("cjGiftCardAmount",this.model.get("cardAmtTmp")),this.model.set("cjGiftCardNo",this.model.get("cardNoTmp")),this.model.set("cjGiftCardPinNo",t),n.fullLayerView.destroy()},researchGiftCard:function(e){e.preventDefault(),this.$el.find("#_card_no1").val(""),this.$el.find("#_card_no2").val(""),this.$el.find("#_card_no3").val(""),this.$el.find("#_card_no4").val(""),this.$el.find("#_pin_number").val(""),alert("카드정보가 초기화 됩니다."),this.model.set("_useCjGiftCardAmount",0),this.model.set("cjGiftCardAmount",0),this.model.set("cjGiftCardNo",""),this.model.set("cardAmtTmp",0),this.model.set("cardNoTmp",""),this.model.set("cjGiftCardPinNo",""),this.$el.find("#divSearch").show(),this.$el.find("#divPinNo").hide()},searchGiftCard:function(r){var o=this,n=this.$el.find("#_card_no1").val(),l=this.$el.find("#_card_no2").val(),i=this.$el.find("#_card_no3").val(),a=this.$el.find("#_card_no4").val();if(4!=n.length||4!=l.length||4!=i.length||4!=a.length)return void alert("카드번호 확인");var d=n+l+i+a,s={tempOrderNo:e.get("tempOrderNo"),registrationStatus:"2",cardNo:d};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookup",type:"post",data:s,success:function(e){if(!e.jsonTuple.result)return void alert(e.jsonTuple.resMsg);if("0000"==e.jsonTuple.result.niceCommonResponseTuple.responseCode){var r=e.jsonTuple.result.conBalanceAmount;if(r<=0)return void alert("카드잔액이 0원입니다.");var n=d.substring(0,4)+"-"+d.substring(4,8)+"-"+d.substring(8,12)+"-"+d.substring(12,16);o.model.set("cardNoTmp",d),o.model.set("cardAmtTmp",r),o.$el.find("#cardNumber").text(n),o.$el.find("#cardAmt").text(t.formatNumber(r)),o.$el.find("#divSearch").hide(),o.$el.find("#divPinNo").show()}else alert(e.jsonTuple.result.niceCommonResponseTuple.responseMessage+"("+e.jsonTuple.result.niceCommonResponseTuple.responseCode+")")},error:function(){alert("CJ기프트카드 카드조회에 실패 하였습니다.")}})},searchGiftCardAmt:function(r){var o=this,n={tempOrderNo:e.get("tempOrderNo"),registrationStatus:"2",cardNo:r};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookup",type:"post",data:n,success:function(e){if(!e.jsonTuple.result)return void alert(e.jsonTuple.resMsg);if("0000"==e.jsonTuple.result.niceCommonResponseTuple.responseCode){var n=e.jsonTuple.result.conBalanceAmount;if(n<=0)return void alert("카드잔액이 0원입니다.");var l=r.substring(0,4)+"-"+r.substring(4,8)+"-"+r.substring(8,12)+"-"+r.substring(12,16);o.model.set("cardNoTmp",r),o.model.set("cardAmtTmp",n),o.$el.find("#cardNumber").text(l),o.$el.find("#cardAmt").text(t.formatNumber(n)),o.$el.find("#divSearch").hide(),o.$el.find("#divPinNo").show()}else alert(e.jsonTuple.result.niceCommonResponseTuple.responseMessage+"("+e.jsonTuple.result.niceCommonResponseTuple.responseCode+")")},error:function(){alert("CJ기프트카드 카드조회에 실패 하였습니다.")}})},refundGiftCard:function(e){window.open(n.model.get("cjGiftCardRefundUrl"))},keyUpHandler:function(e){e.preventDefault();var t=this;""==$.trim(t.$el.find("#_pin_number").val())?t.$el.find("#_pin_number_lbl").show():t.$el.find("#_pin_number_lbl").hide()}});n.fullLayerView=new r({title:"CJ 기프트카드",container:"body",content:(new l).$el}),n.fullLayerView.on(r.EVENT.HIDE,function(){n.fullLayerView.remove()}),n.fullLayerView.show()}})}),define("page/cjmall/order/giftcard/pcCjGiftCardModel",[],function(){return Backbone.Model.extend({url:"",defaults:{cardNo:"",pinNo:"",cardAmt:0},initialize:function(){}})}),define("page/cjmall/order/giftcard/pcCjGiftCardInfoView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/configUtil","common/cjos/util/currencyUtil"],function(e,t,r){return Backbone.View.extend({el:".wrap_card",model:e.get("orderBenefitModel"),events:{"click #myCard":"showMyGiftCard","click #cardRefund":"refundGiftCard","click #cardReg":"regGiftCard"},initialize:function(){var e=this,o={tempOrderNo:t.get("tempOrderNo")};$.ajax({url:t.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookupList",type:"post",data:o,success:function(t){"0000"==t.jsonTuple.resCode?(e.$el.find("#cardCnt").text(r.formatNumber(t.jsonTuple.result.userCardCnt)),e.$el.find("#cardTotalAmt").text(r.formatNumber(t.jsonTuple.result.totalAmount)),e.$el.find("#divCardInfo").show()):alert(t.jsonTuple.resMsg+"("+t.jsonTuple.resCode+")")},error:function(e){alert("CJ기프트카드 카드조회에 실패 하였습니다.")}})},showMyGiftCard:function(e){window.open(t.get("myCardUrl"))},refundGiftCard:function(e){window.open(t.get("refundUrl"))},regGiftCard:function(e){window.open(t.get("regUrl"))}})}),define("page/cjmall/order/giftcard/pcCjGiftCardSearchPopupView",["common/cjos/util/configUtil","page/cjmall/order/sheet/models/orderSheetMainModel"],function(e,t){return Backbone.View.extend({model:null,initialize:function(e){var r=this;r.model=t.get("orderBenefitModel"),window.__searchPopUpView=r,r.afterSearchCallbackFn=!(!e||!e.afterSearchInfo)&&e.afterSearchInfo,r.resetGiftCardCallbackFn=!(!e||!e.resetGiftCard)&&e.resetGiftCard,r.openPopupCallbackFn=!(!e||!e.openPopup)&&e.openPopup,r.render()},render:function(){var t=this,r="0";""!=t.model.get("cjGiftCardNo")&&(r=t.model.get("cjGiftCardNo"));var o=screen.availHeight-100;o>=500&&(o=500);var n="/p/order/cjGiftCard/search/"+e.get("tempOrderNo")+"/"+r,l="width=520, height="+o+", resizable=no, scrollbars=yes, status=no;",i=window.open(n,"",l);t.popUp=i,t.openPopupCallbackFn(i)},popUpClose:function(e){var t=this;t.afterSearchCallbackFn(e),t.popUp.close(),t.remove()},resetCard:function(){this.resetGiftCardCallbackFn()}})}),define("page/cjmall/order/giftcard/pcCjGiftCardSearchView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","page/cjmall/order/giftcard/pcCjGiftCardModel"],function(e,t,r){return Backbone.View.extend({el:".wrap_card",model:null,cardNo:"",events:{"click #cardRefund":"refundGiftCard","keyup #_pin_number":"keyUpHandler","click #_btn_giftcard_search":"searchGiftCard","click #_btn_giftcard_set":"setGiftCard","click #_btn_giftcard_research":"researchGiftCard"},initialize:function(){var t=this;t.model=new r,t.cardNo=e.get("cardNo"),"0"!=t.cardNo?t.searchGiftCardAmt(t.cardNo):(t.$el.find("#divSearch").show(),t.$el.find("#divPinNo").hide())},searchGiftCard:function(r){var o=this,n=o.$el.find("#_card_no1").val(),l=o.$el.find("#_card_no2").val(),i=o.$el.find("#_card_no3").val(),a=o.$el.find("#_card_no4").val();if(4!=n.length||4!=l.length||4!=i.length||4!=a.length)return void alert("카드번호 확인");var d=n+l+i+a,s={tempOrderNo:e.get("tempOrderNo"),registrationStatus:"2",cardNo:d};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookup",type:"post",data:s,success:function(e){if(!e.jsonTuple.result)return void alert(e.jsonTuple.resMsg);if("0000"==e.jsonTuple.result.niceCommonResponseTuple.responseCode){var r=e.jsonTuple.result.conBalanceAmount;if(r<=0)return void alert("카드잔액이 0원입니다.");var n=d.substring(0,4)+"-"+d.substring(4,8)+"-"+d.substring(8,12)+"-"+d.substring(12,16);o.model.set("cardNo",d),o.model.set("cardAmt",r),o.$el.find("#cardNumber").text(n),o.$el.find("#cardAmt").text(t.formatNumber(r)),
o.$el.find("#divSearch").hide(),o.$el.find("#divPinNo").show()}else alert(e.jsonTuple.result.niceCommonResponseTuple.responseMessage+"("+e.jsonTuple.result.niceCommonResponseTuple.responseCode+")")},error:function(){alert("CJ기프트카드 카드조회에 실패 하였습니다.")}})},setGiftCard:function(e){var t=this;e.preventDefault();var r=this.$el.find("#_pin_number").val();if(6!=r.length)return void alert("PIN번호 6자리를 입력해 주시길 바랍니다.");t.model.set("pinNo",r),window.parent.opener.__searchPopUpView.popUpClose(t.model.toJSON())},searchGiftCardAmt:function(r){var o=this,n={tempOrderNo:e.get("tempOrderNo"),registrationStatus:"2",cardNo:r};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookup",type:"post",data:n,success:function(e){if(!e.jsonTuple.result)return void alert(e.jsonTuple.resMsg);if("0000"==e.jsonTuple.result.niceCommonResponseTuple.responseCode){var n=e.jsonTuple.result.conBalanceAmount;if(n<=0)return void alert("카드잔액이 0원입니다.");var l=r.substring(0,4)+"-"+r.substring(4,8)+"-"+r.substring(8,12)+"-"+r.substring(12,16);o.model.set("cardNo",r),o.model.set("cardAmt",n),o.$el.find("#cardNumber").text(l),o.$el.find("#cardAmt").text(t.formatNumber(n)),o.$el.find("#divSearch").hide(),o.$el.find("#divPinNo").show()}else alert(e.jsonTuple.result.niceCommonResponseTuple.responseMessage+"("+e.jsonTuple.result.niceCommonResponseTuple.responseCode+")")},error:function(){alert("CJ기프트카드 카드조회에 실패 하였습니다.")}})},researchGiftCard:function(e){e.preventDefault();var t=this;t.$el.find("#_card_no1").val(""),t.$el.find("#_card_no2").val(""),t.$el.find("#_card_no3").val(""),t.$el.find("#_card_no4").val(""),t.$el.find("#_pin_number").val(""),alert("카드정보가 초기화 됩니다."),window.parent.opener.__searchPopUpView.resetCard(),this.$el.find("#divSearch").show(),this.$el.find("#divPinNo").hide()},refundGiftCard:function(t){window.open(e.get("refundUrl"))},keyUpHandler:function(e){e.preventDefault();var t=this;""==$.trim(t.$el.find("#_pin_number").val())?t.$el.find("#_pin_number_lbl").show():t.$el.find("#_pin_number_lbl").hide(),13===(e.keyCode?e.keyCode:e.which)&&(e.preventDefault(),t.setGiftCard(e))}})}),define("page/cjmall/order/otour/view/otourMainView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t){return Backbone.View.extend({initialize:function(){var t=this;t.$el;null!=e.get("errorCode")&&e.get("errorCode").length>0||null==e.get("orderForm")||0==e.get("orderForm").length||""!==location.hash?(null!=e.get("errorMessage")&&e.get("errorMessage").length>0&&alert(e.get("errorMessage")),t.goReturnPage()):t.ajaxBuy(t.goReturnPage)},ajaxBuy:function(r){var o=e.get("orderForm");$.ajax({type:"POST",xhrFields:{withCredentials:!0},contentType:"application/json",url:e.get("ecBaseSslUrl")+"/c/rest/order/tempOrder",data:o,success:function(o){if(1==o.code&&""!=o.result){location.hash="#goOrder";var n=o.result;location.href=e.get("ecBaseUrl")+"/"+t.get(t.APPLICATION_TYPE)+"/order/sheet/"+n}else alert("주문서로 이동할 수 없습니다. 잠시 후 다시 시도해주세요."),"function"==typeof r&&r.apply(this,[])},error:function(e,t,o){alert("주문서로 이동할 수 없습니다. 잠시 후 다시 시도해주세요."),"function"==typeof r&&r.apply(this,[])}})},goReturnPage:function(){var t=e.get("returnUrl");t.indexOf("http")<0&&(t="http://"+t),setTimeout(function(){cjosLogUtil.log("otour[err]",t),location.href=t},1e3)}})}),define("page/cjmall/order/payment/helper/callAppHelper",["common/cjos/inflowInfo/inflowInfo","common/cjos/util/logUtil"],function(e,t){function r(e,t){var r=document.getElementById(e);return null!==r&&r.parentNode.removeChild(r),r=document.createElement("iframe"),r.id=e,r.style.visibility="hidden",r.style.display="none",r.src=t,r}function o(t,r,o,n){var l=e.userAgent,i=l.get(l.OS_NAME);if("android"===i){var a,d=/([a-zA-Z_]+):\/\/(.*)/.exec(t);d?(o=o||d[1],o+"://"+d[2],a=d[2]):(o||"://"+t,a=t),location.href="intent://"+a+"#Intent;scheme="+o+";package="+r+";end"}else location.href=t}function n(e){this.callApp(e,"com.lguplus.paynow","lguthepay","https://itunes.apple.com/kr/app/paynow/id760098906?l=en&mt=8")}function l(e){this.callApp(e,"kvp.jjy.MispAndroid320","ispmobile","https://itunes.apple.com/kr/app/id369125087?mt=8")}return{getIframe:r,callApp:o,callPyanowApp:n,callIspApp:l}}),define("page/cjmall/order/payment/helper/danalHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo"],function(e,t,r,o){function n(t){switch(o.get(o.APPLICATION_TYPE)){case"p":break;case"m":$("#content").hide(),$("#footer").hide()}switch(o.get(o.APPLICATION_TYPE)){case"p":l=t,$("#danalFrame").length>0&&$("#danalFrame").remove();var n=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/payment/danal/start",i=$('<iframe id="danalFrame" name="danalFrame" style="display:none;width:0px;height:0px" src="'+n+'" title="빈프레임"></iframe>');$("body").append(i);break;case"m":$("#danalForm").length>0&&$("#danalForm").remove();var i=$('<iframe id="danal_layer_view" name="danal" frameborder="0" style="overflow:auto !important;width:100%;height:100%;"></iframe>'),a=$('<form accept-charset="euc-kr"></form>');a.append($("<input>").attr("type","hidden").attr("name","CPName").val(t.cpName)),a.append($("<input>").attr("type","hidden").attr("name","ItemName").val(t.summaryItemName)),a.append($("<input>").attr("type","hidden").attr("name","ItemAmt").val(t.paymentAmount)),a.append($("<input>").attr("type","hidden").attr("name","IsPreOtbill").val(t.isPreOtbill)),a.append($("<input>").attr("type","hidden").attr("name","UseBAS").val(t.useBas)),a.append($("<input>").attr("type","hidden").attr("name","ServerInfo").val(t.serverInfo)),a.append($("<input>").attr("type","hidden").attr("name","IsUseCI").val(t.isUseCi)),a.append($("<input>").attr("type","hidden").attr("name","ByBuffer").val(t.byBuffer)),a.append($("<input>").attr("type","hidden").attr("name","BackURL").val(t.backUrl)),a.append($("<input>").attr("type","hidden").attr("name","CIURL").val(t.ciUrl)),a.append($("<input>").attr("type","hidden").attr("name","TargetURL").val(t.targetUrl)),a.append($("<input>").attr("type","hidden").attr("name","ByAnyName").val(t.byAnyName)),a.append($("<input>").attr("type","hidden").attr("name","BgColor").val(t.bgColor)),a.attr({action:t.url,method:"POST",target:"danal",id:"danalForm",name:"danalForm"}),$("body").append(a),r.set("danalLayerViewClose",function(){$("#danal_layer_view").remove(),$("#content").show(),$("#footer").show(),r.remove("danalLayerViewClose")},!0),$("body").append(i),a.submit()}}var l;return window.orderApprovalDanal=function(r){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderDanalTuple.otp").val(r.otp)),n.append($("<input>").attr("type","hidden").attr("name","orderDanalTuple.serverInfo").val(r.serverInfo)),n.append($("<input>").attr("type","hidden").attr("name","orderDanalTuple.dstAddr0").val(r.dstAddr0)),n.append($("<input>").attr("type","hidden").attr("name","orderDanalTuple.dstAddr1").val(r.dstAddr1)),n.append($("<input>").attr("type","hidden").attr("name","orderDanalTuple.dstAddr2").val(r.dstAddr2)),n.append($("<input>").attr("type","hidden").attr("name","orderDanalTuple.itemAmt").val(r.itemAmt));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a={},d=e.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+i;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),n.attr({action:s,method:"POST"}),$("body").append(n),n.submit()},window.getOrderCertainDanal=function(){return l},window.getDanalPopupUrl=function(){return e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/payment/danal/popupStart"},{call:n}}),define("page/cjmall/order/payment/helper/happymoneyHelper",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r){function o(t,r,o){l=t;var i=$("<form></form>");i.append($("<input>").attr("type","hidden").attr("name","totalPrice").val(r)),i.append($("<input>").attr("type","hidden").attr("name","productName").val(o)),$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/happymoney/start",type:"post",data:i.serialize(),xhrFields:{withCredentials:!0},success:function(e){"0000"===e.jsonTuple.result.returnCode?n(e,"popupHappymoney","350","450"):alert(e.jsonTuple.result.returnMessage)},error:function(e){alert("해피머니 접속 중 오류가 발생하였습니다.")}})}function n(e,t,o,n){var l=o!=undefined?o:800,i=n!=undefined?n:750,a=screen.availWidth/2-l/2,d=screen.availHeight/2-i/2-30;t=t!=undefined?t:"";var s=window.open(e.jsonTuple.result.happymoneyUrl+"?EncodeData="+encodeURIComponent(e.jsonTuple.result.requestPacket),t,"width="+l+", height="+i+", left="+a+", top="+d+", menubar=no, scrollbars=no, resizable=no"),c=r.popupCheck(s);if(""!=c)return alert(c),void(s!==undefined&&null!==s&&s.close());s!==undefined&&null!==s&&s.focus()}var l;return window.happymoneyCallBack=function(e){l.happyMoneyApply(e)},{call:o}}),define("page/cjmall/order/payment/helper/ilkHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","page/cjmall/order/sheet/util/observer","common/cjos/inflowInfo/inflowInfo"],function(e,t,r,o,n){function l(t){var o,l,i=e.get("ecBaseSslUrl")+"/"+n.get(n.APPLICATION_TYPE)+"/order/payment/ilk/return";switch($("#ilkForm").length>0&&$("#ilkForm").remove(),o=$('<form accept-charset="euc-kr"></form>'),o.append($("<input>").attr("type","hidden").attr("name","pan").val(t.pan)),o.append($("<input>").attr("type","hidden").attr("name","purchase_amount").val(t.purchaseAmount)),o.append($("<input>").attr("type","hidden").attr("name","currency").val(t.contry)),o.append($("<input>").attr("type","hidden").attr("name","url").val(e.get("ecBaseUrl"))),o.append($("<input>").attr("type","hidden").attr("name","returnUrl").val(i)),o.append($("<input>").attr("type","hidden").attr("name","goodsname").val(t.representItemName)),o.append($("<input>").attr("type","hidden").attr("name","apvl_chain_no").val(t.apvlChainNo)),o.append($("<input>").attr("type","hidden").attr("name","apvl_halbu").val("1")),o.append($("<input>").attr("type","hidden").attr("name","apvl_seller_id").val(t.apvlSellerId)),o.append($("<input>").attr("type","hidden").attr("name","useActiveX").val("N")),o.append($("<input>").attr("type","hidden").attr("name","usimYn").val("N")),o.append($("<input>").attr("type","hidden").attr("name","name").val("CJmall")),o.attr({action:t.url,method:"POST",target:"ilk",id:"ilkForm"}),n.get(n.APPLICATION_TYPE)){case"p":l=$('<iframe name="ilk" id="ilk_layer_view" title="ILK결제프레임" frameborder="0" src="about:blank" style="width:0px;height:0px;display:none;"></iframe>'),document.charset="euc-kr";break;case"m":$("#wrap").hide(),l=$('<iframe name="ilk" id="ilk_layer_view" title="ILK결제프레임" frameborder="0" style="overflow:auto !important;width:100%;height:100%;"></iframe>'),r.set("ilkLayerViewClose",function(){$("#ilk_layer_view").remove(),$("#wrap").show(),r.remove("ilkLayerViewClose")},!0)}switch(0==$("#ilk_layer_view").length&&$("body").append(l),$("body").append(o),o.submit(),n.get(n.APPLICATION_TYPE)){case"p":document.charset="utf-8"}}return window.orderApprovalIlk=function(e){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo,o=t.payProcType,n=t.procFlg;"CHANGE_PAYMENT"===o?changePaymentApprovalIlk(e):"exchPay"==n?window.callbackClaimIlk(e,r):orderPaymentApprovalIlk(e)},orderPaymentApprovalIlk=function(r){var o=window._cjmallOrderObserver.getContent("orderCertainResult"),l=o.preOrderNo;o.procFlg;$("#ilkApprovalForm").length>0&&$("#ilkApprovalForm").remove();var i=$("<form></form>");i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.xid").val(r.xid)),i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.eci").val(r.eci)),i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.cavv").val(r.cavv)),i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.realPan").val(r.realPan));var a={},d=e.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=e.get("ecBaseSslUrl")+"/"+n.get(n.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+l;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),i.attr({action:s,method:"POST",id:"ilkApprovalForm"}),$("body").append(i),i.submit()},changePaymentApprovalIlk=function(t){var r=window._cjmallOrderObserver.getContent("orderCertainResult"),o=r.preOrderNo,l=r.orderNo;$("#ilkApprovalForm").length>0&&$("#ilkApprovalForm").remove();var i=$("<form></form>");i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.xid").val(t.xid)),i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.eci").val(t.eci)),i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.cavv").val(t.cavv)),i.append($("<input>").attr("type","hidden").attr("name","orderIlkTuple.realPan").val(t.realPan)),i.attr({action:e.get("ecBaseSslUrl")+"/"+n.get(n.APPLICATION_TYPE)+"/myzone/changepayment/approval/"+l+"/"+o,method:"POST",id:"ilkApprovalForm"}),$("body").append(i),i.submit()},window.orderApprovalIlkCancel=function(){$("#ilk_layer_view").length>0&&$("#ilk_layer_view").remove()},{call:l}}),define("page/cjmall/order/payment/helper/ispHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/callAppHelper","page/cjmall/order/sheet/util/polling","page/cjmall/order/sheet/models/ispCertificationModel"],function(e,t,r,o,n,l){function i(e){var t;switch(r.get(r.APPLICATION_TYPE)){case"p":break;case"m":t="ispmobile://TID="+e.tid;var n=r.userAgent;"ios"===n.get(n.OS_NAME)&&(t="ispmobile://?TID="+e.tid),o.callIspApp(t),n.get(n.IS_OSHOPPING_APP)||a(e.tid),n.get(n.IS_OSHOPPING_APP)&&"android"===n.get(n.OS_NAME)&&a(e.tid)}this.paymentView(t)}function a(e){var t=this;if(e){n.destroy();var r=new l(e),o=n.init(r,{startTime:3e3,endTime:3e5,intervalTime:2e3});o.on("success",function(e,o){var n=e.get("certificationStep");null!==n&&(r.destroy(),"40"===n?t.orderApprovalIsp():"99"===n?($("#isp_wrap").remove(),$("#wrap_order").show(),$("#claim_content").show()):(alert("ISP인증에 실패 하였습니다. 다시 시도하시기 바랍니다. "),$("#isp_wrap").remove(),$("#wrap_order").show(),$("#claim_content").show()))}),o.start()}}function d(t){var o=this;o.$el;switch(r.get(r.APPLICATION_TYPE)){case"p":$("#ispForm").length>0&&$("#ispForm").remove();var l=$("<form></form>");$iframe=$('<iframe id="ispFrame" name="ispFrame" style="display:none;width:0px;height:0px" src="about:blank" title="빈프레임"></iframe>'),l.attr({action:e.get("ecBaseSslUrl")+"/p/order/payment/isp/start",method:"post",target:"ispFrame",id:"ispForm"}),0==$("#ispFrame").length&&$("body").append($iframe),$("body").append(l),l.submit();break;case"m":$("#wrap").show(),$("#wrap_order").hide(),$("#claim_content").hide(),$(".myzone_shopping").hide();var i=Backbone.View.extend({el:'<div id="isp_wrap" class="wrap_progress">  <strong class="noti_progress"><em>ISP 인증</em>을 진행중입니다.</strong>  <p class="txt_noti">잠시만 기다려 주십시오.<br>인증완료를 위해 <em>결제완료</em> 버튼을 눌러 주십시오.</p>  <div id="installApp" class="box_notice"><small class="notice_area">ISP 앱 설치</small></div>  <div id="callApp" class="box_notice"><small class="notice_area">ISP 앱이 실행되지 않았다면 여기를 눌러주세요.</small></div>  <p class="txt_noti"></p>  <div class="btn_in_wrap">    <div class="u_td"><button type="button" class="u_btn btn_cancel"><span class="txt">취소</span></button></div>    <div class="u_td"><button type="button" class="u_btn btn_done"><span class="txt">결제완료</span></button></div>  </div><div>',flag:!1,events:{"click .btn_cancel":"closeIspProgressView","click .btn_done":"orderApproval","click #callApp":"callIspApp","click #installApp":"installIspApp"},closeIspProgressView:function(e){e.preventDefault(),n.destroy(),this.remove(),$("#wrap_order").show(),$("#claim_content").show(),$(".myzone_shopping").show()},orderApproval:function(e){e.preventDefault(),n.destroy();var t=this;!1===t.flag&&(t.flag=!0,orderApprovalIsp())},callIspApp:function(e){$(location).attr("href",t)},installIspApp:function(e){var t=r.userAgent,o=t.get(t.OS_NAME);return"ios"===o?void $(location).attr("href","https://itunes.apple.com/kr/app/id369125087?mt=8"):"android"===o?void $(location).attr("href","market://details?id=kvp.jjy.MispAndroid320"):void 0}});$("#content").append((new i).$el)}}return window.orderApprovalIsp=_.once(function(e){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo,o=t.payProcType;t.procFlg;"CHANGE_PAYMENT"===o?changePaymentApprovalIsp(e):"EXCHANGE_PAYMENT"===o?window.callbackClaimIsp(e,r):orderPaymentApprovalIsp(e)}),orderPaymentApprovalIsp=function(o){var n=$("<form></form>");"p"===r.get(r.APPLICATION_TYPE)&&($("#ispApprovalForm").length>0&&$("#ispApprovalForm").remove(),n=getPaymentApprovalFormIsp(o));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a=(l.procFlg,{}),d=e.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+i;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),n.attr({action:s,method:"POST",id:"ispApprovalForm"}),$("body").append(n),n.submit()},changePaymentApprovalIsp=function(t){var o=$("<form></form>");"p"===r.get(r.APPLICATION_TYPE)&&($("#ispApprovalForm").length>0&&$("#ispApprovalForm").remove(),o=getPaymentApprovalFormIsp(t));var n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i=n.orderNo;o.attr({action:e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/myzone/changepayment/approval/"+i+"/"+l,method:"POST",id:"ispApprovalForm"}),$("body").append(o),o.submit()},getPaymentApprovalFormIsp=function(e){var t=$("<form></form>");return t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpCardcode").val($(e).find("[name=KVP_CARDCODE]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpSessionkey").val($(e).find("[name=KVP_SESSIONKEY]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpEncdata").val($(e).find("[name=KVP_ENCDATA]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpQuota").val($(e).find("[name=KVP_QUOTA]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpNoint").val($(e).find("[name=KVP_NOINT]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpUsingPoint").val($(e).find("[name=KVP_USING_POINT]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpPaysetFlag").val($(e).find("[name=KVP_PAYSET_FLAG]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.vpRetSavepoint").val($(e).find("[name=VP_RET_SAVEPOINT]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpPgid").val($(e).find("[name=KVP_PGID]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpGoodName").val($(e).find("[name=KVP_GOODNAME]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpPrice").val($(e).find("[name=KVP_PRICE]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpCardCompany").val($(e).find("[name=KVP_CARDCOMPANY]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpCurrency").val($(e).find("[name=KVP_CURRENCY]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpQuotaInf").val($(e).find("[name=KVP_QUOTA_INF]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpNointInf").val($(e).find("[name=KVP_NOINT_INF]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpNointFlag").val($(e).find("[name=KVP_NOINT_FLAG]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpFixpayflag").val($(e).find("[name=KVP_FIXPAYFLAG]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpImgUrl").val($(e).find("[name=KVP_IMGURL]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpCardPrefix").val($(e).find("[name=kvpCardPrefix]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpConame").val($(e).find("[name=kvpConame]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpReserved1").val($(e).find("[name=KVP_RESERVED1]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpReserved2").val($(e).find("[name=KVP_RESERVED2]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpReserved3").val($(e).find("[name=KVP_RESERVED3]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.kvpEISPYn").val("1")),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.vpBcIssuercode").val($(e).find("[name=VP_BC_ISSUERCODE]").val())),t.append($("<input>").attr("type","hidden").attr("name","orderISPCardTuple.vpBcSavepoint").val($(e).find("[name=VP_BC_SAVEPOINT]").val())),t},{call:i,paymentView:d,orderApprovalIsp:orderApprovalIsp}}),define("page/cjmall/order/payment/helper/kakaopayHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil"],function(e,t){function r(e){var t=this;$("#content").hide();var r="";r+='<div id="comon_kakaopay_order_wrap" class="common_hp_order_wrap">',r+='\t<div class="hpo_wrap">',r+='\t\t<form name="payForm" id="payForm" action="#"  method="post">',r+='\t\t\t<div id="kakaopay_layer"  style="display:none"></div>',r+='\t\t\t<div id="dlpContents">\x3c!-- style="display:none" --\x3e',r+='\t\t\t\t<input type="hidden" name="SPU" value=""/>',r+='\t\t\t\t<input type="hidden" name="SPU_SIGN_TOKEN" value=""/>',r+='\t\t\t\t<input type="hidden" name="MPAY_PUB" value=""/>',r+='\t\t\t\t<input type="hidden" name="NON_REP_TOKEN" value=""/>',r+="\t\t\t</div>",r+="\t\t</form>",r+="\t</div>",r+="</div>",$("body").append(r),"00"===e.resultCode?(!function(){this.kakaopayDlp.setTxnId(e.txnId),this.kakaopayDlp.setChannelType("MPM","WEB"),this.kakaopayDlp.callDlp("kakaopay_layer",document.payForm,t.submitFunc)}(),$("#comon_kakaopay_order_wrap").height($("#kakaopay_layer").height())):(alert(e.resultMsg+" ["+e.resultCode+"]"),this.closeKakaopayDlp())}function o(r){var o=function(){"none"===$("#content").css("display")&&$("#content").show(),$("#comon_kakaopay_order_wrap").remove()};if("00"===r.RESULT_CODE)if($("input[name='NON_REP_TOKEN']").val()==r.NON_REP_TOKEN){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderKakaopayTuple.spu").val(r.SPU)),n.append($("<input>").attr("type","hidden").attr("name","orderKakaopayTuple.spuSignToken").val(r.SPU_SIGN_TOKEN)),n.append($("<input>").attr("type","hidden").attr("name","orderKakaopayTuple.mpayPub").val(r.MPAY_PUB)),n.append($("<input>").attr("type","hidden").attr("name","orderKakaopayTuple.nonRepToken").val(r.NON_REP_TOKEN));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a={},d=e.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=e.get("ecBaseSslUrl")+"/m/order/approval/"+e.get("tempOrderNo")+"/"+i;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),n.attr({action:s,method:"POST"}),$("body").append(n),n.submit(),o()}else alert("결제정보가 올바르지 않습니다. 카카오페이 결제 인증을 다시 받으세요."),o();else"KKP_SER_002"===r.RESULT_CODE?(alert(r.RESULT_MSG+" ["+r.RESULT_CODE+"]"),o()):"557"===r.RESULT_CODE?alert(r.RESULT_MSG+" ["+r.RESULT_CODE+"]"):(alert(r.RESULT_MSG+" ["+r.RESULT_CODE+"]"),o())}return{call:r,submitFunc:o}}),define("page/cjmall/order/payment/helper/kakaotalkpayHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper","page/cjmall/order/sheet/util/polling","page/cjmall/order/sheet/models/kakaotalkpayCertainModel"],function(e,t,r,o,n,l,i){function a(e){switch(o.get(o.APPLICATION_TYPE)){case"p":createPopupKakaotalkpay(e.nextRedirectPcUrl,"popupKakaotalkpay","750","800"),d();break;case"m":location.href=e.nextRedirectMobileUrl}}function d(){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo,o=e.get("tempOrderNo");l.destroy();var n=new i(r),a=l.init(n,{startTime:3e3,endTime:3e5,intervalTime:2e3});a.on("success",function(e,t){if(e.get("pgToken")){var n={pgToken:e.get("pgToken"),preOrderNo:r,tempOrderNo:o,totalAmount:e.get("totalAmount"),taxfreeAmount:e.get("taxfreeAmount")};l.destroy(),s(n)}}),a.start()}function s(r){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderKakaotalkpayTuple.pgToken").val(r.pgToken)),n.append($("<input>").attr("type","hidden").attr("name","orderKakaotalkpayTuple.totalAmount").val(r.totalAmount)),n.append($("<input>").attr("type","hidden").attr("name","orderKakaotalkpayTuple.taxfreeAmount").val(r.taxfreeAmount));var l={},i=e.get("rPIC");i!==undefined&&null!==i&&""!==i&&(l.rPIC=i);var a=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+r.tempOrderNo+"/"+r.preOrderNo;_.isEmpty(l)||(a=a+"?"+t.hashToQuery(l)),n.attr({action:a,method:"POST"}),$("body").append(n),n.submit()}return window.orderApprovalKakaotalkpay=function(e){s(e)},window.createPopupKakaotalkpay=function(e,t,r,o){var l=r!=undefined?r:800,i=o!=undefined?o:750,a=screen.availWidth/2-l/2,d=screen.availHeight/2-i/2-30;t=t!=undefined?t:"";var s=window.open(e,t,"width="+l+", height="+i+", left="+a+", top="+d+", scrollbars=yes, resizable=no"),c=n.popupCheck(s);if(""!=c)return alert(c),void(s!==undefined&&null!==s&&s.close());s!==undefined&&null!==s&&s.focus()},{call:a,approval:s}}),define("page/cjmall/order/payment/helper/kmotionHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r){function o(t){var o,n;switch(r.get(r.APPLICATION_TYPE)){case"p":o=$("<form></form>"),n=$('<iframe name="kmotionFrame" id="kmotionFrame" frameborder="0" src="about:blank" style="width:0px;height:0px;display:none;"></iframe>'),0==$("#kmotionFrame").length&&$("body").append(n),o.attr({action:e.get("ecBaseSslUrl")+"/p/order/payment/kmotion/start?tempOrderNo="+e.get("tempOrderNo"),method:"POST",target:"kmotionFrame",id:"kmotionForm"}),cjosLogUtil.log(o),$("body").append(o),o.submit();break;case"m":require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(t){new t({title:"KB 앱카드",container:"body",iframeContent:e.get("ecBaseSslUrl")+"/m/order/payment/kmotion/start?tempOrderNo="+e.get("tempOrderNo")}).show()})}}return window.orderApprovalKmotion=function(e){var t=window._cjmallOrderObserver.getContent("orderCertainResult");t.preOrderNo;"CHANGE_PAYMENT"===t.payProcType?changePaymentApprovalKmotion(e):orderPaymentApprovalKmotion(e)},orderPaymentApprovalKmotion=function(e){$("#kmotionApprovalForm").length>0&&$("#kmotionApprovalForm").remove();var o=$("<form></form>"),n=require("common/cjos/util/configUtil");o.append($("<input>").attr("type","hidden").attr("name","orderKmotionConfirmResultTuple.accres").val(e.accres)),o.append($("<input>").attr("type","hidden").attr("name","orderKmotionConfirmResultTuple.kmTid").val(e.kmTid)),o.append($("<input>").attr("type","hidden").attr("name","orderKmotionConfirmResultTuple.kmXid").val(e.kmXid));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a={},d=n.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=n.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+n.get("tempOrderNo")+"/"+i;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),o.attr({action:s,method:"POST",id:"kmotionApprovalForm",name:"kmotionApprovalForm"}),$("body").append(o),o.submit()},changePaymentApprovalKmotion=function(e){$("#kmotionApprovalForm").length>0&&$("#kmotionApprovalForm").remove();var t=$("<form></form>"),o=require("common/cjos/util/configUtil");t.append($("<input>").attr("type","hidden").attr("name","orderKmotionConfirmResultTuple.accres").val(e.accres)),t.append($("<input>").attr("type","hidden").attr("name","orderKmotionConfirmResultTuple.kmTid").val(e.kmTid)),t.append($("<input>").attr("type","hidden").attr("name","orderKmotionConfirmResultTuple.kmXid").val(e.kmXid));var n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i=n.orderNo;t.attr({action:o.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/myzone/changepayment/approval/"+i+"/"+l,method:"POST",id:"kmotionApprovalForm",name:"kmotionApprovalForm"}),$("body").append(t),t.submit()},window.callKmotionToISP=function(){"p"===r.get(r.APPLICATION_TYPE)&&($("#kmotionFrame").remove(),$("#kmotionForm").remove(),$("#rdbx12").click(),$("#_buy").click())},{call:o}}),define("page/cjmall/order/payment/helper/mobiliansHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o){function n(t){var o="?productName="+encodeURIComponent(t.productName);switch(o+="&totalPaymentAmt="+encodeURIComponent(t.paymentAmount),r.get(r.APPLICATION_TYPE)){case"p":createPopupMobilians(e.get("ecBaseSslUrl")+"/p/order/payment/mobilians/start"+o,"mobiliansStart","470","640");break;case"m":require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(t){new t({title:"휴대폰결제",container:"body",iframeContent:e.get("ecBaseSslUrl")+"/m/order/payment/mobilians/start"+o}).show()})}}return window.orderApprovalMobilians=function(o){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.mode").val(o.mode)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.recordkey").val(o.recordkey)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.mrchid").val(o.mrchid)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.svcid").val(o.svcid)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.no").val(o.no)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.userid").val(o.userid)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.username").val(o.username)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.userkey").val(o.userkey)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.tradeid").val(o.tradeid)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.prdtnm").val(o.prdtnm)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.prdtprice").val(o.prdtprice)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.smsval").val(o.smsval)),n.append($("<input>").attr("type","hidden").attr("name","orderMobiliansTuple.commid").val(o.commid));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a={},d=e.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+i;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),n.attr({action:s,method:"POST",id:"mobiliansForm",name:"mobiliansForm"}),$("body").append(n),n.submit()},window.createPopupMobilians=function(e,t,r,n){var l=r!=undefined?r:800,i=n!=undefined?n:750;t=t!=undefined?t:"";var a=window._paymentPopup,d=o.popupCheck(a);if(""!=d){var s=screen.availWidth/2-l/2,c=screen.availHeight/2-i/2-30;t=t!=undefined?t:"",a=window.open(e,t,"width="+l+", height="+i+", left="+s+", top="+c+", scrollbars=yes, resizable=no"),d=o.popupCheck(a)}if(""!=d)return alert(d),void(a!==undefined&&null!==a&&a.close());a!==undefined&&null!==a&&(a.resizeTo(l,i),a.location.href=e,a.focus())},{call:n}}),
define("page/cjmall/order/payment/helper/naverpayHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper","page/cjmall/order/sheet/util/polling","page/cjmall/order/sheet/models/naverpayCertainModel"],function(e,t,r,o,n,l,i){function a(e){var t=e.payWindowUrl+e.reserveId;switch(o.get(o.APPLICATION_TYPE)){case"p":createPopupNaverpay(t,"popupNaverpay","750","800"),d();break;case"m":window.location.href=t}}function d(){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo;l.destroy();var o=e.get("tempOrderNo"),n=new i(r),a=l.init(n,{startTime:3e3,endTime:3e5,intervalTime:2e3});a.on("success",function(e,t){if(e.get("paymentId")){var n={paymentId:e.get("paymentId"),preOrderNo:r,tempOrderNo:o,taxAmt:e.get("taxAmt"),taxExAmt:e.get("taxExAmt"),totalPaymentAmt:e.get("totalPaymentAmt")};l.destroy(),s(n)}}),a.start()}function s(r){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderNaverpayTuple.paymentId").val(r.paymentId)),n.append($("<input>").attr("type","hidden").attr("name","orderNaverpayTuple.taxAmt").val(r.taxAmt)),n.append($("<input>").attr("type","hidden").attr("name","orderNaverpayTuple.taxExAmt").val(r.taxExAmt)),n.append($("<input>").attr("type","hidden").attr("name","orderNaverpayTuple.totalPayAmt").val(r.totalPaymentAmt));var l={},i=e.get("rPIC");i!==undefined&&null!==i&&""!==i&&(l.rPIC=i);var a=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+r.tempOrderNo+"/"+r.preOrderNo;_.isEmpty(l)||(a=a+"?"+t.hashToQuery(l)),n.attr({action:a,method:"POST"}),$("body").append(n),n.submit()}return window.approvalPc=function(e){s(e)},window.createPopupNaverpay=function(e,t,r,o){var l=r!=undefined?r:800,i=o!=undefined?o:750,a=screen.availWidth/2-l/2,d=screen.availHeight/2-i/2-30;t=t!=undefined?t:"";var s=window.open(e,t,"width="+l+", height="+i+", left="+a+", top="+d+", scrollbars=yes, resizable=no"),c=n.popupCheck(s);if(""!=c)return alert(c),void(s!==undefined&&null!==s&&s.close());s!==undefined&&null!==s&&s.focus()},{call:a,approval:s}}),define("page/cjmall/order/payment/helper/payallHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo"],function(e,t,r,o){function n(t){switch(o.get(o.APPLICATION_TYPE)){case"p":$("#payallForm").length>0&&$("#payallForm").remove();var n=$("<form></form>");$iframe=$('<iframe id="payallFrame" name="payallFrame" style="display:none;width:0px;height:0px" src="about:blank" title="빈프레임"></iframe>'),n.attr({action:e.get("ecBaseSslUrl")+"/p/order/payment/payall/start",method:"post",target:"payallFrame",id:"payallForm"}),0==$("#payallFrame").length&&$("body").append($iframe),$("body").append(n),n.submit();break;case"m":require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(t){var o=new t({container:"body",title:"PAYALL 결제",iframeContent:e.get("ecBaseSslUrl")+"/m/order/payment/payall/start"});r.set("payallLayerViewClose",function(){o.destroy(),$("#wrap").show(),r.remove("payallLayerViewClose")},!0),o.show()})}}return window.orderApprovalPayall=function(e){var t=window._cjmallOrderObserver.getContent("orderCertainResult");t.preOrderNo;"CHANGE_PAYMENT"===t.payProcType?changePaymentApprovalPayall(e):orderPaymentApprovalPayall(e)},orderPaymentApprovalPayall=function(r){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpEncdata").val(r.kvpEncdata)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpSessionkey").val(r.kvpSessionkey)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpCardcode").val(r.kvpCardcode)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpNoint").val(r.kvpNoint)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpQuota").val(r.kvpQuota)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpCardPrefix").val(r.kvpCardPrefix)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpUsingPoint").val(r.kvpUsingPoint)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpFixpayflag").val(r.kvpFixpayflag)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.vpBcSavepoint").val(r.vpBcSavepoint)),n.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.vpRetSavepoint").val(r.vpRetSavepoint));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a={},d=e.get("rPIC");d!==undefined&&null!==d&&""!==d&&(a.rPIC=d);var s=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+i;_.isEmpty(a)||(s=s+"?"+t.hashToQuery(a)),n.attr({action:s,method:"POST"}),$("body").append(n),n.submit()},changePaymentApprovalPayall=function(t){var r=$("<form></form>");r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpEncdata").val(t.kvpEncdata)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpSessionkey").val(t.kvpSessionkey)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpCardcode").val(t.kvpCardcode)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpNoint").val(t.kvpNoint)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpQuota").val(t.kvpQuota)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpCardPrefix").val(t.kvpCardPrefix)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpUsingPoint").val(t.kvpUsingPoint)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.kvpFixpayflag").val(t.kvpFixpayflag)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.vpBcSavepoint").val(t.vpBcSavepoint)),r.append($("<input>").attr("type","hidden").attr("name","orderPayallTuple.vpRetSavepoint").val(t.vpRetSavepoint));var n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i=n.orderNo;r.attr({action:e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/myzone/changepayment/approval/"+i+"/"+l,method:"POST"}),$("body").append(r),r.submit()},{call:n}}),define("page/cjmall/order/payment/helper/paycoHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n){function l(e){switch(o.get(o.APPLICATION_TYPE)){case"p":createPopupPayco(e.orderSheetUrl,"popupPayco","727","512");break;case"m":location.href=e.orderSheetUrl}}function i(e){orderApprovalPayco(e)}return window.orderApprovalPayco=function(r){var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","orderPaycoTuple.sellerOrderReferenceKey").val(r.sellerOrderReferenceKey)),n.append($("<input>").attr("type","hidden").attr("name","orderPaycoTuple.reserveOrderNo").val(r.reserveOrderNo)),n.append($("<input>").attr("type","hidden").attr("name","orderPaycoTuple.paymentCertifyToken").val(r.paymentCertifyToken)),n.append($("<input>").attr("type","hidden").attr("name","orderPaycoTuple.totalPaymentAmt").val(r.totalPaymentAmt));var l={},i=e.get("rPIC");i!==undefined&&null!==i&&""!==i&&(l.rPIC=i);var a=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+r.tempOrdNo+"/"+r.preOrdNo;_.isEmpty(l)||(a=a+"?"+t.hashToQuery(l)),n.attr({action:a,method:"POST"}),$("body").append(n),n.submit()},window.createPopupPayco=function(e,t,r,o){var l=r!=undefined?r:800,i=o!=undefined?o:750;t=t!=undefined?t:"";var a=window._paymentPopup,d=n.popupCheck(a);if(""!==d){var s=screen.availWidth/2-l/2,c=screen.availHeight/2-i/2-30;t=t!=undefined?t:"",a=window.open(e,t,"width="+l+", height="+i+", left="+s+", top="+c+", scrollbars=yes, resizable=no"),d=n.popupCheck(a)}if(""!=d)return alert(d),void(a!==undefined&&null!==a&&a.close());a!==undefined&&null!==a&&(a.resizeTo(l,i),a.location.href=e,a.focus())},{call:l,approval:i}}),define("page/cjmall/order/payment/helper/paymentHelper",["page/cjmall/order/payment/helper/ispHelper","page/cjmall/order/payment/helper/polarisHelper","page/cjmall/order/payment/helper/ilkHelper","page/cjmall/order/payment/helper/payallHelper","page/cjmall/order/payment/helper/kmotionHelper","page/cjmall/order/payment/helper/mobiliansHelper","page/cjmall/order/payment/helper/danalHelper","page/cjmall/order/payment/helper/paynowHelper","page/cjmall/order/payment/helper/paycoHelper","page/cjmall/order/payment/helper/kakaopayHelper","page/cjmall/order/payment/helper/syruppayHelper","page/cjmall/order/payment/helper/naverpayHelper","page/cjmall/order/payment/helper/happymoneyHelper","page/cjmall/order/payment/helper/kakaotalkpayHelper","page/cjmall/order/payment/helper/smilepayHelper","page/cjmall/order/payment/helper/settlebankHelper","page/cjmall/order/payment/helper/regularPaymentHelper","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m,f,g,v,y){return{isp:e,polaris:t,ilk:r,payall:o,kmotion:n,mobilians:l,danal:i,paynow:a,payco:d,kakaopay:s,syruppay:c,naverpay:u,happymoney:p,kakaotalkpay:m,smilepay:f,settlebank:g,regularpayment:v,popupWindowCheck:y}}),define("page/cjmall/order/payment/helper/paynowHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/callAppHelper","page/cjmall/order/sheet/util/polling","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n,l){function i(t){switch(d=t,r.get(r.APPLICATION_TYPE)){case"p":window.createPopupPaynow(e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/payment/paynow/start","paynow_charge","620","447");break;case"m":$("#wrap").show(),$("#wrap_order").hide();var n=Backbone.View.extend({el:'<div class="wrap_progress">  <strong class="noti_progress"><em>PAYNOW 인증</em>을 진행중입니다.</strong>  <p class="txt_noti">잠시만 기다려 주십시오.<br>인증완료를 위해 <em>결제완료</em> 버튼을 눌러 주십시오.</p>  <div id="installApp" class="box_notice"><small class="notice_area">PAYNOW 앱 설치</small></div>  <div id="callApp" class="box_notice"><small class="notice_area">PAYNOW 앱이 실행되지 않았다면 여기를 눌러주세요.</small></div>  <p class="txt_noti"></p>  <div class="btn_in_wrap">    <div class="u_td"><button type="button" class="u_btn btn_cancel"><span class="txt">취소</span></button></div>    <div class="u_td"><button type="button" class="u_btn btn_done"><span class="txt">결제완료</span></button></div>  </div><div>',flag:!1,events:{"click .btn_cancel":"closePaynowProgressView","click .btn_done":"orderApproval","click #callApp":"callIspApp","click #installApp":"installIspApp"},closePaynowProgressView:function(e){e.preventDefault(),this.remove(),$("#wrap_order").show()},orderApproval:function(e){e.preventDefault();var t=this;!1===t.flag&&(t.flag=!0,window.orderApprovalPaynow())},callIspApp:function(e){$(location).attr("href",l)},installIspApp:function(e){var t=r.userAgent,o=t.get(t.OS_NAME);return"ios"===o?void $(location).attr("href","https://itunes.apple.com/kr/app/paynow/id760098906?l=en&mt=8"):"android"===o?void $(location).attr("href","market://details?id=com.lguplus.paynow"):void 0}});$("#content").append((new n).$el);var l=t.startPaynowUrl,i=r.userAgent;i.get(i.IS_OSHOPPING_APP)||a(t.upay_MER_TID),o.callPyanowApp(l)}}function a(t){n.destroy();var r=Backbone.Model.extend({defaults:{isSaved:!1},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/paynow?upayTid="+t},parse:function(e){var t=this,r=e.jsonTuple;r.result&&t.set({isSaved:r.result})}}),o=new r(t),l=n.init(o,{startTime:3e3,endTime:3e5,intervalTime:2e3});l.on("success",function(e){e.get("isSaved")&&(window.orderApprovalPaynow()(),n.destroy())}),l.start()}var d;return window.orderApprovalPaynow=function(){var o=$("<form></form>"),n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i={},a=e.get("rPIC");a!==undefined&&null!==a&&""!==a&&(i.rPIC=a);var d=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+l;_.isEmpty(i)||(d=d+"?"+t.hashToQuery(i)),o.attr({action:d,method:"POST"}),$("body").append(o),o.submit()},window.orderApprovalPaynowPc=function(t){var o=$("<form></form>");o.append($("<input>").attr("type","hidden").attr("name","orderPaynowTuple.upayMerTid").val(t.upayMerTid));var n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i=e.get("rPIC");i!==undefined&&null!==i&&""!==i&&o.append($("<input>").attr("type","hidden").attr("name","rPIC").val(i));var a=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+l;o.attr({action:a,method:"POST"}),$("body").append(o),o.submit()},window.createPopupPaynow=function(e,t,r,o){var n=r!=undefined?r:800,i=o!=undefined?o:750;t=t!=undefined?t:"";var a=window._paymentPopup,d=l.popupCheck(a);if(""!==d){var s=screen.availWidth/2-n/2,c=screen.availHeight/2-i/2-30;t=t!=undefined?t:"",a=window.open(e,t,"width="+n+", height="+i+", left="+s+", top="+c),d=l.popupCheck(a)}if(""!=d)return alert(d),void(a!==undefined&&null!==a&&a.close());a!==undefined&&null!==a&&(a.resizeTo(n,i),a.location.href=e,a.focus())},window.getPaynowTuple=function(){return d},{call:i,orderApprovalPaynow:window.orderApprovalPaynow}}),define("page/cjmall/order/payment/helper/polarisHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/polling","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n,l){function i(t,n){var l,i;switch(cjosLogUtil.log(t),o.get(o.APPLICATION_TYPE)){case"p":var d=e.get("ecBaseSslUrl")+"/p/order/payment/polaris/popupStart",s="",c="";"LOTTE_CARD"==n?(s="699",c="511"):"SHINHAN_CARD"==n?(s="440",c="470"):(s="430",c="470"),createPopupPolaris(d,"popupPolaris",s,c),a();break;case"m":l=$("<form></form>"),l.append($("<input>").attr("type","hidden").attr("name","pareq1").val(t.pareq1)),l.append($("<input>").attr("type","hidden").attr("name","pareq2").val(t.pareq2)),l.append($("<input>").attr("type","hidden").attr("name","pareq3").val(t.pareq3)),l.append($("<input>").attr("type","hidden").attr("name","pareq4").val(t.pareq4)),l.append($("<input>").attr("type","hidden").attr("name","xid").val(t.xid)),$("#wrap").hide(),i=$('<iframe id= "_polaris" name="polaris" frameborder="0" style="overflow:auto !important;width:100%;height:100%;"></iframe>'),l.attr({action:t.cardPareqUrl,method:"post",target:"polaris"}),r.set("polarisCardLayerViewClose",function(){$("#_polaris").remove(),$("#wrap").show(),r.remove("polarisCardLayerViewClose")},!0),$("body").append(i),$("body").append(l),l.submit()}}function a(){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo;n.destroy();var o=Backbone.Model.extend({defaults:{r0:"",r1:"",r2:"",r3:"",r4:"",msg:"",isSaved:!1},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/polaris?preOrdNo="+t},parse:function(e){var t=this,r=e.jsonTuple;0!==r.code&&r.result&&t.set({r0:r.result.r0,r1:r.result.r1,r2:r.result.r2,r3:r.result.r3,r4:r.result.r4,msg:r.result.msg,isSaved:r.result.isSaved})}}),l=new o(r),i=n.init(l,{startTime:3e3,endTime:3e5,intervalTime:2e3});i.on("success",function(e,t){if(e.get("r0")){var r={r0:e.get("r0"),r1:e.get("r1"),r2:e.get("r2"),r3:e.get("r3"),r4:e.get("r4"),msg:e.get("msg")};n.destroy(),"0000"===r.r0?polarisBuy(r):pcPolarisError(r)}}),i.start()}return window.polarisBuy=function(e){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo,o=t.payProcType,n=t.procFlg;"CHANGE_PAYMENT"===o?changePaymentApproval(e):"exchPay"==n?window.callbackClaimPolaris(e,r):orderPaymentApproval(e)},window.samsungpayBuy=function(t){$("#polarisApprovalForm").length>0&&$("#polarisApprovalForm").remove();var r=$("<form></form>");"11"===t.issuerCode?(r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.kvpSessionKey").val(t.sessionKey)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.kvpEncdata").val(t.encData)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.kvpCardCode").val(t.kvpCardCode))):(r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.r1").val(t.r1)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.r2").val(t.r2)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.r3").val(t.r3)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.r4").val(t.r4))),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.issuerCode").val(t.issuerCode)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.monInstallment").val(t.monInstallment)),r.append($("<input>").attr("type","hidden").attr("name","orderSamsungpayTuple.cardPoint").val(t.cardPoint));var n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i=e.get("rPIC");i!==undefined&&null!==i&&""!==i&&r.append($("<input>").attr("type","hidden").attr("name","rPIC").val(i));var a=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+l;r.attr({action:a,method:"POST",id:"polarisApprovalForm"}),$("body").append(r),$(".modalCloseImg.simplemodal-close").click(),r.submit()},window.pcPolarisError=function(e){"LOTTE_CARD"!=window._cjmallOrderObserver.getContent("orderCertainResult").payType&&alert("응답결과["+e.r0+"] : "+e.msg)},window.createPopupPolaris=function(e,t,r,o){var n=r!=undefined?r:800,i=o!=undefined?o:750,a=window._paymentPopup,d=l.popupCheck(a);if(""!==d){var s=screen.availWidth/2-n/2,c=screen.availHeight/2-i/2-30;t=t!=undefined?t:"",a=window.open(e,t,"width="+n+", height="+i+", left="+s+", top="+c),d=l.popupCheck(a)}if(""!=d)return alert(d),void(a!==undefined&&null!==a&&a.close());a!==undefined&&null!==a&&(a.resizeTo(n,i),a.location.href=e,a.focus())},orderPaymentApproval=function(r){$("#polarisApprovalForm").length>0&&$("#polarisApprovalForm").remove();var n=getApprovalForm(r),l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+i,d={},s=e.get("rPIC");s!==undefined&&null!==s&&""!==s&&(d.rPIC=s),_.isEmpty(d)||(a=a+"?"+t.hashToQuery(d)),n.attr({action:a,method:"POST",id:"polarisApprovalForm"}),$("body").append(n),n.submit()},changePaymentApproval=function(t){$("#polarisApprovalForm").length>0&&$("#polarisApprovalForm").remove();var r=getApprovalForm(t),n=window._cjmallOrderObserver.getContent("orderCertainResult"),l=n.preOrderNo,i=n.orderNo;r.attr({action:e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/myzone/changepayment/approval/"+i+"/"+l,method:"POST",id:"polarisApprovalForm"}),$("body").append(r),r.submit()},getApprovalForm=function(e){var t=$("<form></form>");return t.append($("<input>").attr("type","hidden").attr("name","orderPolarisTuple.r1").val(e.r1)),t.append($("<input>").attr("type","hidden").attr("name","orderPolarisTuple.r2").val(e.r2)),t.append($("<input>").attr("type","hidden").attr("name","orderPolarisTuple.r3").val(e.r3)),t.append($("<input>").attr("type","hidden").attr("name","orderPolarisTuple.r4").val(e.r4)),t},{call:i}}),define("page/cjmall/order/payment/helper/popupWindowCheckHelper",["common/cjos/inflowInfo/inflowInfo"],function(e){function t(e){var t="";return null!=e&&void 0!==e||(t="팝업 차단 기능이 설정되어있습니다\n차단 기능을 해제(팝업허용) 한 후 다시 이용해 주십시오.\n만약 팝업 차단 기능을 해제하지 않으면\n정상적인 주문이 이루어지지 않습니다."),t}return{popupCheck:t}}),define("page/cjmall/order/payment/helper/realtimeAccountTransferHelper",["common/cjos/util/currencyUtil","common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r){function o(r){if(n=r,r.isRealtimeAccountTransfer){$("#realtimeAccountTransferForm").length>0&&$("#realtimeAccountTransferForm").remove(),$("#realtimeAccountTransferFrame").length>0&&$("#realtimeAccountTransferFrame").remove(),alert("실시간 계좌 이체금액("+e.formatNumber(r.orderEndTypeTuple.noBankPayAmount)+")에 대해서 계좌이체를 진행합니다.");var o=$('<iframe id="realtimeAccountTransferFrame" name="realtimeAccountTransferFrame" style="display:none;width:0px;height:0px" src="about:blank" title="빈프레임"></iframe>'),l=$('<form accept-charset="euc-kr"></form>');l.attr({action:t.get("ecBaseSslUrl")+"/p/order/payment/realtimeaccounttransfer/start",method:"post",target:"realtimeAccountTransferFrame",id:"realtimeAccountTransferForm"}),0==$("#realtimeAccountTransferFrame").length&&$("body").append(o),$("body").append(l),l.submit()}}var n;return window.getOrderEndMainModel=function(){return n},window.getRealtimeTransferPopupStartUrl=function(){return t.get("ecBaseSslUrl")+"/p/order/payment/realtimeaccounttransfer/popupStart"},window.getEcBaseSslUrl=function(){return t.get("ecBaseSslUrl")},{call:o}}),define("page/cjmall/order/payment/helper/regularPaymentHelper",["common/cjos/util/configUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/polling","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n){function l(t){switch($("#regularPaymentForm").length>0&&$("#regularPaymentForm").remove(),r.get(r.APPLICATION_TYPE)){case"p":var o=e.get("ecBaseSslUrl")+"/p/order/payment/regularpayment/popupStart";i(),createPopupRegularPayment(o,"popupRegularPayment","800","900");break;case"m":var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","ordr_idxx").val(t.ordrIdxx)),n.append($("<input>").attr("type","hidden").attr("name","good_name").val(t.goodsName)),n.append($("<input>").attr("type","hidden").attr("name","good_mny").val(t.goodsAmt)),n.append($("<input>").attr("type","hidden").attr("name","buyr_name").val(t.buyrName)),n.append($("<input>").attr("type","hidden").attr("name","kcp_group_id").val(t.kcpGroupId)),n.append($("<input>").attr("type","hidden").attr("name","req_tx").val(t.reqTx)),n.append($("<input>").attr("type","hidden").attr("name","shop_name").val(t.siteName)),n.append($("<input>").attr("type","hidden").attr("name","site_cd").val(t.siteCd)),n.append($("<input>").attr("type","hidden").attr("name","currency").val(t.currency)),n.append($("<input>").attr("type","hidden").attr("name","eng_flag").val("N")),n.append($("<input>").attr("type","hidden").attr("name","approval_key").val(t.approvalKey)),n.append($("<input>").attr("type","hidden").attr("name","escw_used").val("N")),n.append($("<input>").attr("type","hidden").attr("name","pay_method").val(t.payMethod)),n.append($("<input>").attr("type","hidden").attr("name","ActionResult").val(t.actionResult)),n.append($("<input>").attr("type","hidden").attr("name","Ret_URL").val(t.returnUrl)),n.append($("<input>").attr("type","hidden").attr("name","traceNo").val(t.traceNo)),n.append($("<input>").attr("type","hidden").attr("name","batch_soc_choice").val("S")),n.append($("<input>").attr("type","hidden").attr("name","tablet_size").val("1.0")),n.append($("<input>").attr("type","hidden").attr("name","param_opt_1").val("")),n.append($("<input>").attr("type","hidden").attr("name","param_opt_2").val("")),n.append($("<input>").attr("type","hidden").attr("name","param_opt_3").val("")),n.append($("<input>").attr("type","hidden").attr("name","cancel_bnt_used").val("Y")),n.append($("<input>").attr("type","hidden").attr("name","kcp_url_rewrite").val("Y")),n.attr({action:t.payUrl,method:"post",name:"order_info"}),$("body").append(n),n.submit()}}function i(){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo,n=e.get("tempOrderNo");o.destroy();var l=Backbone.Model.extend({"default":{resultCode:"",resultMessage:"",encInfo:"",encData:"",traceNo:"",tranCd:""},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/regularpayment?preOrdNo="+t},parse:function(e){var t=this,r=e.jsonTuple;0!==r.code&&r.result&&t.set({resultCode:r.result.resultCode,resultMessage:r.result.resultMessage,encInfo:r.result.encInfo,encData:r.result.encData,traceNo:r.result.traceNo,tranCd:r.result.tranCd})}}),i=new l(r),d=o.init(i,{startTime:3e3,endTime:3e5,intervalTime:2e3});d.on("success",function(e,t){if(e.get("resultCode")&&"0000"===e.get("resultCode")){var l={resultCode:e.get("resultCode"),resultMessage:e.get("resultMessage"),encInfo:e.get("encInfo"),encData:e.get("encData"),traceNo:e.get("traceNo"),tranCd:e.get("tranCd"),preOrdNo:r,tempOrderNo:n};o.destroy(),a(l)}}),d.start()}function a(t){var o=$("<form></form>");o.append($("<input>").attr("type","hidden").attr("name","orderRegularPaymentTuple.resultCode").val(t.resultCode)),o.append($("<input>").attr("type","hidden").attr("name","orderRegularPaymentTuple.resultMessage").val(t.resultMessage)),o.append($("<input>").attr("type","hidden").attr("name","orderRegularPaymentTuple.encInfo").val(t.encInfo)),o.append($("<input>").attr("type","hidden").attr("name","orderRegularPaymentTuple.encData").val(t.encData)),o.append($("<input>").attr("type","hidden").attr("name","orderRegularPaymentTuple.traceNo").val(t.traceNo)),o.append($("<input>").attr("type","hidden").attr("name","orderRegularPaymentTuple.tranCd").val(t.tranCd)),o.attr({action:e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+t.tempOrderNo+"/"+t.preOrdNo,method:"POST",id:"regularPaymentApprovalForm"}),$("body").append(o),o.submit()}return window.createPopupRegularPayment=function(e,t,r,o){var l=r,i=o,a=screen.availWidth/2-l/2,d=screen.availHeight/2-i/2-30;t=t!=undefined?t:"";var s=window.open(e,t,"width="+l+", height="+i+", left="+a+", top="+d+", scrollbars=yes, resizable=no"),c=n.popupCheck(s);if(""!=c)return alert(c),void(s!==undefined&&null!==s&&s.close());s!==undefined&&null!==s&&s.focus()},{call:l,approval:a}}),define("page/cjmall/order/payment/helper/settlebankHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/polling","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n,l){function i(t){switch(o.get(o.APPLICATION_TYPE)){case"p":var r=e.get("ecBaseSslUrl")+"/p/order/payment/settlebank/popupStart";createPopupSettlebank(r,"popupSettlebank","420","610"),"ORDER_PAYMENT"===t.payProcType&&a();break;case"m":var n=$("<form></form>");n.append($("<input>").attr("type","hidden").attr("name","payGb").val(t.payGb)),n.append($("<input>").attr("type","hidden").attr("name","PMid").val(t.pmid)),n.append($("<input>").attr("type","hidden").attr("name","PCustId").val(t.pcustId)),n.append($("<input>").attr("type","hidden").attr("name","POid").val(t.poid)),n.append($("<input>").attr("type","hidden").attr("name","PGoods").val(t.pgoods)),n.append($("<input>").attr("type","hidden").attr("name","PAmt").val(t.pamt)),n.append($("<input>").attr("type","hidden").attr("name","PBname").val(t.pbname)),n.append($("<input>").attr("type","hidden").attr("name","PNextUrl").val(t.pnextUrl)),n.append($("<input>").attr("type","hidden").attr("name","PCancUrl").val(t.pcanclUrl)),n.append($("<input>").attr("type","hidden").attr("name","_method").val(t.pmethod)),n.append($("<input>").attr("type","hidden").attr("name","PHash").val(t.phash)),n.attr({action:t.requestUrl,method:"post"}),$("body").append(n),n.submit()}}function a(){var t=window._cjmallOrderObserver.getContent("orderCertainResult"),r=t.preOrderNo,o=e.get("tempOrderNo");n.destroy();var l=Backbone.Model.extend({defualt:{payGb:"",pCustId:"",pAmt:"",pOid:"",pStatus:"",pTrNo:"",pTrDt:"",pRmesg1:""},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/settlebank?preOrdNo="+t},parse:function(e){var t=this,r=e.jsonTuple;0!==r.code&&r.result&&t.set({payGb:r.result.pamt,pCustId:r.result.pcustId,pAmt:r.result.pamt,pOid:r.result.poid,pTrNo:r.result.ptrNo,pTrDt:r.result.ptrDt,pStatus:r.result.pstatus,pRmesg1:r.result.prmesg1})}}),i=new l(r),a=n.init(i,{startTime:3e3,endTime:3e5,intervalTime:2e3});a.on("success",function(e,t){if(e.get("pStatus"))if("0021"===e.get("pStatus")){var l={pAmt:e.get("pAmt"),preOrderNo:r,tempOrdNo:o,payGb:e.get("payGb"),pCustId:e.get("pCustId"),pOid:e.get("pOid"),pRmesg1:e.get("pRmesg1"),pStatus:e.get("pStatus"),pTrDt:e.get("pTrDt"),pTrNo:e.get("pTrNo")};n.destroy(),s(l)}else alert(e.get("prmesg1")),n.destroy()}),a.start()}function d(e){var t=$("<form></form>");return t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pAmt").val(e.pAmt)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.payGb").val(e.payGb)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pCustId").val(e.pCustId)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pOid").val(e.pOid)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pRmesg1").val(e.pRmesg1)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pStatus").val(e.pStatus)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pTrDt").val(e.pTrDt)),t.append($("<input>").attr("type","hidden").attr("name","orderSettlebankTuple.pTrNo").val(e.pTrNo)),t}function s(r){var n=d(r),l={},i=e.get("rPIC");i!==undefined&&null!==i&&""!==i&&(l.rPIC=i);var a=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+r.tempOrdNo+"/"+r.pOid;_.isEmpty(l)||(a=a+"?"+t.hashToQuery(l)),n.attr({action:a,method:"POST"}),$("body").append(n),n.submit()}function c(e){"ORDER_PAYMENT"===e.payProcType?s(e):"CHANGE_PAYMENT"===e.payProcType&&settlebankChangePaymentApproval(e)}function u(t){var r=e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE);"ORDER_PAYMENT"===t.payProcType?location.href=r+"/order/sheet/"+t.tempOrdNo:"CHANGE_PAYMENT"===t.payProcType&&(location.href=r+"/myzone/changepayment/sheet/"+t.ordNo)}return window.settlebankChangePaymentApproval=function(t){$("#settlebankApprovalForm").length>0&&$("#settlebankApprovalForm").remove();var r=d(t);r.attr({action:e.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/myzone/changepayment/approval/"+t.ordNo+"/"+t.pOid,method:"POST",id:"settlebankApprovalForm"}),$("body").append(r),r.submit()},window.createPopupSettlebank=function(e,t,r,o){var n=screen.availWidth/2-210,i=screen.availHeight/2-305-30;t=t!=undefined?t:"";var a=window.open(e,t,"width=420, height=610, left="+n+", top="+i+", scrollbars=yes, resizable=no"),d=l.popupCheck(a);if(""!=d)return alert(d),void(a!==undefined&&null!==a&&a.close());a!==undefined&&null!==a&&a.focus()},{call:i,approval:c,cancel:u}}),define("page/cjmall/order/payment/helper/smilepayHelper",["common/cjos/util/configUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o){function n(e){$("#smilePay_layer").length>0&&$("#smilePay_layer").remove();var t='<div id="smilePay_layer" style="display:none">';switch(t+='       <input type="hidden" id="txnId" name="txnId" value=""/>',t+='       <input type="hidden" id="prDt" name="prDt" value=""/>',t+="    </div>",$("body").append(t),$("#txnId").val(e.txnId),$("#prDt").val(e.prDt),r.get(r.APPLICATION_TYPE)){case"p":cnspay_L.destroy(),i();break;case"m":l(e.txnId)}}function l(e){smilepay_L.movePage(e,"v4")}function i(){XD.receiveMessage(s,"https://pg.cnspay.co.kr"),cnspay_L.callPage("smilePay_layer",!0,s)}function a(t){var o=$("<form></form>");o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.spu").val(t.SPU)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.spuSignToken").val(t.SPU_SIGN_TOKEN)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.etc1").val(t.ETC1)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.etc2").val(t.ETC2)),
o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.etc3").val(t.ETC3));var n=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+t.tempOrdNo+"/"+t.preOrdNo;o.attr({action:n,method:"POST"}),$("body").append(o),o.submit()}function d(t){var o=$("<form></form>");o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.spu").val(t.Spu)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.spuSignToken").val(t.SpuSignToken)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.etc1").val(t.Etc1)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.etc2").val(t.Etc2)),o.append($("<input>").attr("type","hidden").attr("name","orderSmilepayTuple.etc3").val(t.Etc3));var n=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+t.tempOrdNo+"/"+t.preOrdNo;o.attr({action:n,method:"POST"}),$("body").append(o),o.submit()}var s=function(t){if(cnspay_L.destroy(),t&&"null"!=t){var r=JSON.parse(t),o=window._cjmallOrderObserver.getContent("orderCertainResult"),n=o.preOrderNo;r.tempOrdNo=e.get("tempOrderNo"),r.preOrdNo=n,a(r)}else alert("결제를 취소하였습니다.")};return{call:n,approval:a,mobileApproval:d}}),define("page/cjmall/order/payment/helper/syruppayHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo"],function(e,t,r,o){function n(t){switch(t.token,o.get(o.APPLICATION_TYPE)){case"p":break;case"m":;$("#wrap").hide();var n=$(window).height();n<300&&(n=1e3);var l=e.get("ecBaseSslUrl")+"/m/order/payment/syruppay/start?tempOrderNo="+e.get("tempOrderNo"),i="";i+='<div id="comon_syruppay_order_wrap" class="common_hp_order_wrap">',i+='\t<div class="hpo_wrap">',i+='\t\t<div class="hpo_cont_wrap" style="-webkit-overflow-scrolling:touch;overflow-y:auto !important;width:100%;height:'+n+'px;margin-top:0px;">',i+='\t\t\t<iframe name="SYRUPPAY_FRAME" title="SYRUPPAY프레임" id="SYRUPPAY_FRAME" src="'+l+'" frameborder="0" style="overflow:auto !important;width:100%;height:'+(n-5)+'px;"></iframe>',i+="\t\t</div>",i+="\t</div>",i+="</div>",r.set("syruppayLayerViewClose",function(){$("#comon_syruppay_order_wrap").remove(),$("#wrap").show(),r.remove("syruppayLayerViewClose")},!0),$("body").append(i)}}return window.syruppayBuy=function(e){var r=$("<form></form>"),n=require("common/cjos/util/configUtil");r.append($("<input>").attr("type","hidden").attr("name","orderSyruppayTuple.tranAuthValue").val(e.tranAuthValue)),r.append($("<input>").attr("type","hidden").attr("name","orderSyruppayTuple.mctTransAuthId").val(e.mctTransAuthId)),r.append($("<input>").attr("type","hidden").attr("name","orderSyruppayTuple.ocTransAuthId").val(e.ocTransAuthId));var l=window._cjmallOrderObserver.getContent("orderCertainResult"),i=l.preOrderNo,a=n.get("ecBaseSslUrl")+"/m/order/approval/"+n.get("tempOrderNo")+"/"+i,d={},s=n.get("rPIC");s!==undefined&&null!==s&&""!==s&&(d.rPIC=s);var a=n.get("ecBaseSslUrl")+"/"+o.get(o.APPLICATION_TYPE)+"/order/approval/"+n.get("tempOrderNo")+"/"+i;_.isEmpty(d)||(a=a+"?"+t.hashToQuery(d)),r.attr({action:a,method:"POST"}),$("body").append(r),r.submit()},{call:n}}),define("page/cjmall/order/popup/collections/orderPopupCollection",["common/cjos/util/configUtil"],function(e){return Backbone.Collection.extend({initialize:function(t){this.url=e.get("ecDisplaySslUrl")+"/c/rest/commonBanners/objCustPopups?displayAreaCd=009&limit=1"},search:function(e){var t=this;t.reqParams=e,t.ajax&&t.ajax.abort(),t.reset(),t.ajax=Backbone.ajax({url:t.url,data:e,xhrFields:{withCredentials:!0},success:function(e){var r=e.result;if(_.isUndefined(r)||_.isNull(r))alert(e.resMsg),t.trigger("error");else if(e.result.list.length>0){for(var o=0;o<e.result.list.length;o++){if(!_.isEmpty(e.result.list[o].htmlUrl)){var n=t.getUrlSeparator(e.result.list[o].htmlUrl);e.result.list[o].htmlUrl=e.result.list[o].htmlUrl+n+"pic=MYCJ_"+e.result.list[o].bannerId+"__mp__bn__",t.isNotSearchText(e.result.list[o].htmlUrl,["http://","https://"])&&(e.result.list[o].linkUrl="http://"+e.result.list[o].linkUrl)}if(!_.isEmpty(e.result.list[o].linkUrl)){var n=t.getUrlSeparator(e.result.list[o].linkUrl);e.result.list[o].linkUrl=e.result.list[o].linkUrl+n+"pic=MYCJ_"+e.result.list[o].bannerId+"__mp__bn__",t.isNotSearchText(e.result.list[o].linkUrl,["http://","https://"])&&(e.result.list[o].linkUrl="http://"+e.result.list[o].linkUrl)}}t.add(r)}},error:function(){t.trigger("error")}})},getUrlSeparator:function(e){var t="?";return e.indexOf("?")>-1&&(t="&"),t},isSearchText:function(e,t){var r=!1;return _.each(t,function(t,o){e.indexOf(t)>-1&&(r=!0)}),r},isNotSearchText:function(e,t){return!this.isSearchText(e,t)}})}),define("page/cjmall/order/popup/view/m/orderPopupView",["page/cjmall/order/popup/collections/orderPopupCollection","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper"],function(e,t,r){"use strict";return Backbone.View.extend({el:"#popup_spot",events:{"click #notToday":"todayHide","click .btn_cls_pop":"hide"},template:r.getPrecompiledTemplate("handlebars/page/cjmall/order/end/m/orderPopup"),initialize:function(r,o,n){var l=this,i=new e;l.collection=i,l.listenTo(l.collection,"update",l.render),"Y"!==r?(n=t&&t.userAgent&&t.userAgent.get(t.userAgent.IS_OSHOPPING_APP)?"APP":"mweb",l.searchCriteria={exposeLocation:n}):l.searchCriteria={exposeLocation:n,preview:r,searchDay:o},l.collection.search(l.searchCriteria)},render:function(){var e=this,t=e.$el,r=e.collection.toJSON();if(!_.isEmpty(e.collection)){e.cookieName="pop_"+r[0].list[0].bannerId+"_"+r[0].list[0].bannerType;"N"!==Cookies.get(e.cookieName)&&(t.html(e.template(r[0])),t.show())}},hide:function(){this.$el.hide()},todayHide:function(){var e=this,t=new Date;t.setHours(23,59,59,999),e.setCookie(e.cookieName,"N",t),this.$el.hide()},setCookie:function(e,t,r){Cookies.set(e,escape(t),{expires:r})}})}),define("page/cjmall/order/popup/view/p/orderPopupView",["page/cjmall/order/popup/collections/orderPopupCollection","common/cjos/util/handlebarsHelper"],function(e,t){"use strict";return Backbone.View.extend({el:"#popup_spot",events:{"click #notToday":"todayHide","click .btn_cls_pop":"hide"},template:t.getPrecompiledTemplate("handlebars/page/cjmall/order/end/p/orderPopup"),initialize:function(t,r){var o=this,n=new e;o.collection=n,o.listenTo(o.collection,"update",o.render),o.collection.search({exposeLocation:"PC",preview:t,searchDay:r})},render:function(){var e=this,t=e.$el,r=e.collection.toJSON();if(!_.isEmpty(e.collection)){e.cookieName="pop_"+r[0].list[0].bannerId+"_"+r[0].list[0].bannerType;"N"!==Cookies.get(e.cookieName)&&(t.html(e.template(r[0])),t.show())}},hide:function(){this.$el.hide()},todayHide:function(){var e=this,t=new Date;t.setHours(23,59,59,999),e.setCookie(e.cookieName,"N",t),this.$el.hide()},setCookie:function(e,t,r){Cookies.set(e,escape(t),{expires:r})}})}),define("page/cjmall/order/present/delivery/models/orderPresentDeliveryAcceptFormModel",["common/cjos/util/configUtil"],function(e){"use strict";return Backbone.Model.extend({url:"",defaults:{encryptData:null,receiverCellno:null},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/accept"},submit:function(e,t,r){var o=this;cjosLogUtil.log(JSON.stringify(t)),o.ajax=Backbone.ajax({url:o.url,contentType:"application/json;charset=utf-8",data:JSON.stringify(t),dataType:"json",xhrFields:{withCredentials:!0},type:"POST",success:function(t,o,n){if(cjosLogUtil.log("submit order data : ",t),1===t.code)r(e,t.result);else if(t.resMsg){var l=t.resMsg;t.description&&(l=l+"\n"+t.description),alert(l),OrderPresentDeliveryAuthInfoModel.set("isProgress",!1)}},error:function(t,r,o){cjosLogUtil.log(r),e.set("isProgress",!1),alert("결제관련 통신이 원활하지 않습니다. 다시 시도해주시고 동일한 현상이 계속 발생시 고객센터로 문의해주세요.(CJmall 고객센터 1644-2525)")},complete:function(e,t,r){}})},convertOrderPresentDeliveryForm:function(){}})}),define("page/cjmall/order/present/delivery/models/orderPresentDeliveryAcceptInfoModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil"],function(e,t){"use strict";return Backbone.Model.extend({url:"",defaults:{encryptData:null,ordererNm:null,receiveNm:null},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/aceeptInfo"},parse:function(r){var o=this;o.responseData=$.extend(!0,{},r);var n=e.get("ecBaseSslUrl")+"/m/main.jsp";if(r.errorCode!=undefined&&null!==r.errorCode)return alert(r.message),void(window.location.href=n);var l=r.result;if(l===undefined)return alert("정상적인 접근이 아닙니다."),void(window.location.href=n);if(null===l)return alert("선물배송 주문이 아닙니다."),void(window.location.href=n);if(null===l.encryptData||null===l.authData||null===l.orderDetailInfo)return alert("선물배송 주문이 아닙니다."),void(window.location.href=n);if(l.orderDetailInfo.orderItemInfoTuples)for(var i=l.orderDetailInfo.orderItemInfoTuples,a=0;a<i.length;a++){var d=i[a];d.orderDetailClassCode.code;i[a]._itemImageDetailUrl=t.getLinkUrl(d.itemCode,d.channelCode)+"&isMyzone=true",i[a]._itemDetailUrl=t.getLinkUrl(d.itemCode,d.channelCode)+"&isMyzone=true";var s=d.itemImgUrl;i[a]._itemImageUrl=s||l.emptyItemImageUrl,i[a]._emptyItemImageUrl=l.emptyItemImageUrl;var c=0;if(i[a].subItems&&i[a].subItems.length>0)for(var u=0;u<i[a].subItems.length;u++)"ITEM_CLS_CD_30"==i[a].subItems[u].itemClassCode&&null!=i[a].subItems[u].offerTypeCd&&("01"==i[a].subItems[u].offerTypeCd?i[a].subItems[u].itemName="사은품 : "+i[a].subItems[u].itemName:"13"==i[a].subItems[u].offerTypeCd&&(i[a].subItems[u].itemName="추가구성품 : "+i[a].subItems[u].itemName)),"ITEM_CLS_CD_10"!=i[a].subItems[u].itemClassCode&&"ITEM_CLS_CD_20"!=i[a].subItems[u].itemClassCode||c++;i[a]._optionItemCount=c,i[a]._isPresentYn=l.presentYn}var p=new Backbone.Model({isPresentMessage:l.isPresentMessage,ordererName:l.ordererName,presentMessage:l.presentMessage}),m=new Backbone.Model({dispOrderNo:l.dispOrderNo,acceptEndDate:l.acceptEndDate,receiverName:l.receiverName,presentItemInfoList:l.orderDetailInfo.orderItemInfoTuples}),f=new Backbone.Model({orderEndDeliveryList:l.orderDetailInfo.orderEndDeliveryTuples,dispOrderNo:l.orderDetailInfo.dispOrderNo,presentItemInfoList:l.orderItemList});return o.set({encryptData:l.encryptData,authData:l.authData,orderNo:l.orderDetailInfo.orderNo,presentMessageModel:p,presentDetailModel:m,orderReceiveInfoModel:f,presentItemInfoList:l.orderItemList}),o}})}),define("page/cjmall/order/present/delivery/models/orderPresentDeliveryAuthFormModel",["common/cjos/util/configUtil"],function(e){"use strict";return Backbone.Model.extend({url:"",defaults:{encryptData:null,receiverCellno:null},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/auth"},submit:function(e,t,r){var o=this;cjosLogUtil.log(JSON.stringify(t)),o.ajax=Backbone.ajax({url:o.url,contentType:"application/json;charset=utf-8",data:JSON.stringify(t),dataType:"json",xhrFields:{withCredentials:!0},type:"POST",success:function(t,o,n){if(cjosLogUtil.log("submit order data : ",t),1===t.code)r(e,t.result);else if(t.resMsg){var l=t.resMsg;t.description&&(l=l+"\n"+t.description),alert(l),e.set("isProgress",!1)}},error:function(t,r,o){cjosLogUtil.log(r),e.set("isProgress",!1),alert("결제관련 통신이 원활하지 않습니다. 다시 시도해주시고 동일한 현상이 계속 발생시 고객센터로 문의해주세요.(CJmall 고객센터 1644-2525)")},complete:function(e,t,r){}})}})}),define("page/cjmall/order/present/delivery/models/orderPresentDeliveryAuthInfoModel",["common/cjos/util/configUtil"],function(e){"use strict";return Backbone.Model.extend({url:"",defaults:{encryptData:null,ordererNm:null,receiveNm:null},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/authInfo"},parse:function(t){var r=this;r.responseData=$.extend(!0,{},t);e.get("ecBaseSslUrl");if(t.errorCode!=undefined&&null!==t.errorCode)return r.set({errorCode:t.errorCode,message:t.message}),r;var o=t.result;return r.set({errorCode:"0",encryptData:o.encryptData,ordererNm:o.ordererNm,receiveNm:o.receiveNm}),r}})}),define("page/cjmall/order/present/delivery/view/orderPresentAcceptCompleteView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:".wrap_order",template:Handlebars.compile($("#orderPresenttAcceptComplete").html()),model:null,initialize:function(){var e=this;e.$el;e.setHandlebarsHelper(),e.render()},events:{"click ._mainLink":"mainLinkBtn"},mainLinkBtn:function(t){var r=this;r.$el;location.replace(e.get("displayDomain")+"/m/main")},render:function(){var e=this,t=e.$el,r=e.model.get("presentAcceptCompleteModel").orderDetailInfo;e.orderDetailModel=new Backbone.Model,e.orderDetailModel.set({dispOrderNo:r.dispOrderNo,orderEndDeliveryTuples:r.orderEndDeliveryTuples}),t.empty(),$(".wrap_tit","#header").find(".tit").text("주문완료"),t.html(e.template(e.orderDetailModel.toJSON())),e.scrollTo(t)},setHandlebarsHelper:function(){Handlebars.registerHelper("concatImageServerUrl",function(t){return e.get("imgServerUrl")+t}),Handlebars.registerHelper("extraItemCount",function(e){return e>1?e-1:e})}})}),define("page/cjmall/order/present/delivery/view/orderPresentAcceptConfirmView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"#_orderPresentAcceptConfirm",template:Handlebars.compile($("#orderPresentAcceptConfirm").html()),model:new Backbone.Model,initialize:function(){var e=this;e.$el;if(0==$("#_orderPresentAcceptConfirm").length){var t=$("<div>");t.attr("id","_orderPresentAcceptConfirm"),$("#content").append(t)}e.render()},events:{"click #presentAcceptConfirmCancelBtn":"confirmCancel","click #presentAcceptConfirmBtn":"confirm"},confirmCancel:function(e){var t=this;t.$el;t.model.get("presentAcceptConfirmCancelOnClick")&&t.model.get("presentAcceptConfirmCancelOnClick")()},confirm:function(e){var t=this;t.model.get("presentAcceptConfirmOnClick")&&t.model.get("presentAcceptConfirmOnClick")()},render:function(){var e=this,t=e.$el;t.html(e.template(e.model.toJSON())),t.find(".lay_wrap.lay_gift_wrap").show()}})}),define("page/cjmall/order/present/delivery/view/orderPresentAcceptSuccessView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper","page/cjmall/order/present/delivery/view/orderPresentAcceptCompleteView"],function(e,t,r,o,n){return Backbone.View.extend({el:"#_orderPresentAcceptSuccess",template:Handlebars.compile($("#orderPresentAcceptSuccess").html()),model:new Backbone.Model,initialize:function(){var e=this;e.$el;e.render()},events:{"click #presentAcceptSuccessBtn":"confirm"},confirm:function(e){var t=this;t.$el;$("._orderPresentAcceptSuccess").hide(),t.remove(),t.presentAcceptCompleteView=new n({model:t.model})},render:function(){var e=this,t=e.$el;t.html(e.template(e.model.toJSON())),t.find(".lay_wrap.lay_gift_wrap").show()}})}),define("page/cjmall/order/present/delivery/view/orderPresentAddCostConfirmView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"#_orderPresentAddCostConfirm",template:Handlebars.compile($("#orderPresentAddCostConfirmTemplate").html()),model:null,initialize:function(){var e=this;e.$el;e.render()},events:{"click #addCostConfirmBtn":"confirm"},confirm:function(e){var t=this;t.$el;t.model.get("addCostConfirmOnClick")&&t.model.get("addCostConfirmOnClick")()},render:function(){var e=this,t=e.$el;t.html(e.template()),t.find(".lay_wrap.lay_gift_wrap").show()}})}),define("page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptBtnView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"._btnContainer",template:Handlebars.compile($("#presentDeliveryBtnTemplate").html()),model:null,initialize:function(){var e=this;e.$el;e.render()},render:function(){var e=this;e.$el.html(e.template())}})}),define("page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptItemDetailView",["common/cjos/util/configUtil","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n,l){return Backbone.View.extend({el:"._presentDetailContainer",template:Handlebars.compile($("#presentDetailTemplate").html()),model:null,initialize:function(){var e=this;e.$el;e.render()},events:{"click ._itemDetailInfoView":"itemDetailInfoView"},itemDetailInfoView:function(o){o.preventDefault(),r.splunkClickLog("GIFT____product__prd__");var n=this,l=(n.$el,$(o.currentTarget)),i=l.data("itemname"),a=l.data("itemcode");require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(r){var o=new r({title:i,container:"body",iframeContent:e.get("ecDisplaySslUrl")+"/m/item/kakao/"+a});t.set("presentItemLayerViewClose",function(){o.destroy(),$("#wrap").show(),t.remove("presentItemLayerViewClose")},!0),o.show()})},render:function(){var e=this;e.$el.html(e.template(e.model.toJSON()))}})}),define("page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptPresentMessageView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"._presentMessageContainer",template:Handlebars.compile($("#presentMessageTemplate").html()),model:null,initialize:function(){var e=this;e.$el;e.render()},render:function(){var e=this;e.$el.html(e.template(e.model.toJSON()))}})}),define("page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptReceiverDeliveryFormView",["common/cjos/util/configUtil","common/cjos/logger/utils/loggerUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper","page/cjmall/order/present/delivery/view/orderPresentAddCostConfirmView"],function(e,t,r,o,n,l){return Backbone.View.extend({el:"._receiverDeliveryFormContainer",template:Handlebars.compile($("#receiverDeliveryFormTemplate").html()),model:null,presentAcceptFormModel:new Backbone.Model,presentDeliveryAddressModel:new Backbone.Model,initialize:function(){var e=this;e.$el;e.render(),e.presentDeliveryAddressModel=new Backbone.Model({areaCls:undefined,fastAreaCls:undefined,roadBldDtlNm:undefined,roadAddr:undefined,roadAddrId:undefined,roadAddrSeq:undefined,zipno:undefined,newZipno:undefined,zipno_seq:undefined,post_name:undefined,addr:undefined})},render:function(){var e=this;e.$el.append(e.template()),e.setContactInfo(e.model)},setContactInfo:function(e){var t=this,r=t.$el,o=e.get("orderEndDeliveryList"),n=r.find(".addr_make"),l=o[0].presentReceiveName,i=o[0].presentReceiveCellno1,a=o[0].presentReceiveCellno2,d=o[0].presentReceiveCellno3;null!=i&&""!=i?(n.find("._cellno1").val(i),n.find("._cellno").val(a+d)):(n.find("._cellno1").val(""),n.find("._cellno").val("")),n.find("#placeName").val(l)},events:{"click .btn_post":"postFindOnClickHn","change ._delimsgselect":"deliMsgSelectOnChangeHn","focusin ._delimsg":"delimsgOnFocusInHn","blur ._delimsg":"delimsgOnBlurHn","blur ._telno":"telnumOnBlurHn"},telnumOnBlurHn:function(e){var t=this,r=window._cjmallOrderValidator,o=$(e.currentTarget),n=o.val();if(!1===r.isNumber(n))return alert("전화번호는 숫자만 입력해주세요"),o.val(""),o.focus(),t.eventCheck="blur",!1;t.eventCheck="event"},deliMsgSelectOnChangeHn:function(e){var t=this,r=$(e.currentTarget),o=t.$el.find(r.data().delimsgTargetSelector);0==r.prop("selectedIndex")?o.val("").blur():o.val(r.val()).focus().blur()},delimsgOnFocusInHn:function(e){$(e.currentTarget).siblings(".lab_cont").hide()},delimsgOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lab_cont");0==$.trim(t.val()).length&&r.show()},postFindOnClickHn:function(e){var t,o=this,n=r.get(r.APPLICATION_TYPE);switch(n){case"p":t="page/cjmall/postcode/p/pcPostPopupView";break;case"m":t="page/cjmall/postcode/m/mobilePostLayerView"}require([t],function(e){new e({afterSelectAddress:function(e,t){var r,n,i,a;if("ADDRESS_ROAD_NAME"===t&&(r=e.ZIPNO5,n=e.ROAD_ADDR,i=e.BLD_NAME,a="1"),"ADDRESS_JIBUN"===t&&(r=e.ZIPNO,n=e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,i=e.ZIP_APT_BLD,a="0"),o.presentDeliveryAddressModel.set({addressType:a,areaCls:e.AREA_CLS,fastAreaCls:e.FAST_AREA_CLS,roadBldDtlNm:e.BLD_NAME,roadAddr1:e.ROAD_ADDR,roadAddr:e.BLD_NAME,roadAddrId:e.ROAD_ADDR_ID,roadAddrSeq:e.ROAD_ADDR_SEQ,zipno:e.ZIPNO,zipno_seq:e.ZIPNO_SEQ,roadZipno:e.ZIPNO,roadZipnoSeq:e.ZIPNO_SEQ,newZipno:e.ZIPNO5,post_name:e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,addr:e.ZIP_APT_BLD,fullAddr:n+i}),o.$el.find(".tf_post").val(r),o.$el.find(".tf_addr1").val(n),o.$el.find(".tf_addr2").val(i),o.getAddDelivCostYn()){if(o.addCostEventModel=new Backbone.Model,o.addCostEventModel.set("addCostConfirmOnClick",$.proxy(o.addCostConfirmOnClick,o)),0==$("#_orderPresentAddCostConfirm").length){var d=$("<div>");d.attr("id","_orderPresentAddCostConfirm"),$("#content").append(d)}o.orderPresentAddCostConfirmView=new l({model:o.addCostEventModel})}}})})},addCostConfirmOnClick:function(){var e=this;$(".tf_post").val(""),$(".tf_addr1").val(""),$(".tf_addr2").val(""),e.orderPresentAddCostConfirmView.remove(),e.orderPresentAddCostConfirmView.unbind(),e.addCostEventModel.clear(),t.splunkClickLog("GIFT____popup__prd__")},validate:function(){var e=this,t=e.$el,r=t.find(".addr_make"),o=window._cjmallOrderValidator,n=r.find(".tf_place"),l=r.find(".tf_post"),i=r.find(".tf_addr1"),a=r.find(".tf_addr2"),d=r.find("._cellno1"),s=r.find("._cellno"),c=r.find("._telno1"),u=r.find("._telno"),p=!!(o.validate(l)&&o.validate(i)&&o.validate(a)),m=!(!o.validate(d)||!o.validate(s)),f=!(!o.validate(c)||!o.validate(u)),g=d.val(),v=s.val(),y=c.val(),h=u.val();if(!o.validate(n))return alert("받는분 이름을 입력하세요"),!1;if(!0===o.isOverMaxlength(n))return alert("받는분 이름은 "+n.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(n),!1;if(n.length>0&&!1===o.isHangulEngText(n.val()))return alert("받는분 이름은 특수문자입력이 불가합니다"),e.scrollTo(n),!1;if(!p)return alert("주소를 입력하세요"),e.scrollTo(l),!1;if((null==g||""==g||g.length<=0||""==v||v.length<=0)&&(null==y||""==y||y.length<=0||""==h||h.length<=0))return alert("한 개 이상의 전화번호를 입력하셔야 합니다"),s.focus(),!1;if(!m&&!f)return alert("받는분 연락처를 입력해주세요"),!1;if(m){if(!1===o.isNumber(v))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(s),!1;if(v.length<7)return alert("휴대폰 번호를 정확하게 입력해 주세요"),!1;if(!0===o.isOverMaxlength(s))return alert("휴대폰 번호는 "+s.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(s),!1}if(f){if(!1===o.isNumber(h))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(u),!1;if(h.length<7)return alert("전화 번호를 정확하게 입력해 주세요"),!1;if(!0===o.isOverMaxlength(u))return alert("전화 번호는 "+u.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(u),!1}return m||!o.validate(d)&&!o.validate(s)?f||!o.validate(c)&&!o.validate(u)?!($("._delimsg").val().trim().length>30)||(alert("30자 이내에서 입력해 주세요."),$("._delimsg").val($("._delimsg").val().trim().substring(0,30)),void $("._delimsg").focus()):(alert("전화 번호를 정확하게 입력해 주세요"),!1):(alert("휴대폰 번호를 정확하게 입력해 주세요"),!1)},setPresentDeliveryAddressModel:function(){cjosLogUtil.log("## setPresentDeliveryAddressModel start");var e=this,t=e.$el,r=e.presentDeliveryAddressModel,o=t.find(".addr_make"),n=o.find(".tf_place"),l=(o.find(".tf_post"),o.find(".tf_addr1")),i=o.find(".tf_addr2"),a=o.find("._cellno1"),d=o.find("._cellno"),s=o.find("._telno1"),c=o.find("._telno"),u=o.find("._delimsg");r.set("delivPlcAlias",n.val()),r.set("nm",n.val()),r.set("cellno1",a.val()),r.set("cellno2",e.subStringNo(d.val(),"first")),r.set("cellno3",e.subStringNo(d.val(),"second")),r.set("ddd",s.val()),r.set("telno1",e.subStringNo(c.val(),"first")),r.set("telno2",e.subStringNo(c.val(),"second")),r.set("deliveryMsg",u.val()),r.set("deliv_plc_seq",e.model.get("orderEndDeliveryList")[0].delivPlcSeq),"1"==r.get("addressType")?r.set("roadAddr",i.val()):r.set("addr",i.val()),r.set("fullAddr",l.val()+" "+i.val())},getAddDelivCostYn:function(){cjosLogUtil.log("## getAddDelivCostYn start");var e=this,t=e.getAddressData(),r=e.model.get("presentItemInfoList")[0];return!!("01"==t.areaCls&&r.isAddDeliveryCost&&r.groupJejuAddCost>0||"02"==t.areaCls&&r.isAddDeliveryCost&&r.groupIslandAddCost>0)},getAddressData:function(){var e=this;e.$el;return!!e.validate()&&(e.setPresentDeliveryAddressModel(),e.presentDeliveryAddressModel.toJSON())},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}}})}),define("page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptView",["common/cjos/util/configUtil","common/cjos/logger/utils/loggerUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper","common/cjmall/ui/m/loading/views/simpleLoadingBar","page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptPresentMessageView","page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptItemDetailView","page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptReceiverDeliveryFormView","page/cjmall/order/present/delivery/view/orderPresentDeliveryAcceptBtnView","page/cjmall/order/present/delivery/view/orderPresentAcceptConfirmView","page/cjmall/order/present/delivery/view/orderPresentAcceptSuccessView","page/cjmall/order/present/delivery/view/orderPresentRefuseConfirmView","page/cjmall/order/present/delivery/view/orderPresentRefuseSuccessView","page/cjmall/order/present/delivery/view/orderPresentAcceptCompleteView","page/cjmall/order/present/delivery/models/orderPresentDeliveryAcceptInfoModel","page/cjmall/order/present/delivery/models/orderPresentDeliveryAcceptFormModel"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m,f,g,v){return Backbone.View.extend({el:".wrap_order",model:null,simpleLoadingBar:new l,initialize:function(){var e=this;e.$el;e.simpleLoadingBar.appendTo("#content"),e.model=new g,e.model.set("isProgress",!1),window._cjmallOrderValidator=o,e.validator=window._cjmallOrderValidator,e.getAcceptInfo(),e.newAddressModel=new Backbone.Model({areaCls:undefined,fastAreaCls:undefined,roadBldDtlNm:undefined,roadAddr:undefined,roadAddrId:undefined,roadAddrSeq:undefined,zipno:undefined,newZipno:undefined,zipno_seq:undefined,post_name:undefined,addr:undefined}),e.setHandlebarsHelper(),window._cjmallOrderValidator=o},events:{"click ._presentAcceptBtn":"accept","click ._presentRefuseBtn":"refuse"},setHandlebarsHelper:function(){Handlebars.registerHelper("hasTelCell",function(e){var t=e.data.root;return t.ddd&&t.cellno1?e.fn(this):e.inverse(this)})},getAcceptInfo:function(){var t=this;t.$el;cjosLogUtil.log("encryptData : "+e.get("encryptData")),cjosLogUtil.log("authData : "+e.get("authData"));var r={encryptData:e.get("encryptData"),authData:e.get("authData")};t.model.fetch({contentType:"application/json;charset=utf-8",data:JSON.stringify(r),dataType:"json",xhrFields:{withCredentials:!0},type:"POST",success:function(e,r,o){200==r.status&&(t.model=e,t.render())},error:function(e,t,r){cjosLogUtil.log("fetch error")}})},render:function(){var t=this,r=t.$el;e.get("ecBaseCjmallImageUrl");t.model.get("orderReceiveInfoModel").set("refuseProgressFunc",$.proxy(t.refuseProgress,t)),t.presentMessageView=new i({model:t.model.get("presentMessageModel")}),t.itemDetailView=new a({model:t.model.get("presentDetailModel")}),t.receiverDeliveryFormView=new d({model:t.model.get("orderReceiveInfoModel")}),t.btnView=new s,t.simpleLoadingBar.remove(),r.show()},validatePresentDeliveryAccept:function(){return!1!==this.$el.find("#agree_prd_order").is(":checked")||(alert("비회원 개인정보 수집 이용에 대한 약관에 동의가 필요합니다."),!1)},presentDeliveryAcceptCallback:function(e,t,r){cjosLogUtil.log("callback 도착"),e.set("isProgress",!1),cjosLogUtil.log(r)},getAddDelivCostYn:function(){cjosLogUtil.log("## getAddDelivCostYn start");var e=this,t=e.receiverDeliveryFormView.getAddressData(),r=e.model.get("presentItemInfoList")[0];return!!("01"==t.areaCls&&r.isAddDeliveryCost&&r.groupJejuAddCost>0||"02"==t.areaCls&&r.isAddDeliveryCost&&r.groupIslandAddCost>0)},presentAcceptConfirmCancelOnClick:function(){var e=this;e.orderPresentAcceptConfirmView.remove(),e.orderPresentAcceptConfirmView.unbind(),e.acceptEventModel.clear()},presentAcceptConfirmOnClick:function(){var e=this;e.acceptProgress(e.orderPresentAcceptConfirmView)},accept:function(e){cjosLogUtil.log("## accept start"),e.preventDefault();var r=this;r.$el;if(!1!==r.validatePresentDeliveryAccept()){var o=r.receiverDeliveryFormView.getAddressData();if(!1!=!!o){if(0==$("#_orderPresentAcceptConfirm").length){var n=$("<div>");n.attr("id","_orderPresentAcceptConfirm"),$("#content").append(n)}var o=r.receiverDeliveryFormView.getAddressData();r.acceptEventModel=new Backbone.Model,r.acceptEventModel.set("presentAcceptConfirmCancelOnClick",$.proxy(r.presentAcceptConfirmCancelOnClick,r)),r.acceptEventModel.set("presentAcceptConfirmOnClick",$.proxy(r.presentAcceptConfirmOnClick,r)),r.acceptEventModel.set("fullAddr",o.fullAddr),r.orderPresentAcceptConfirmView=new c({model:r.acceptEventModel}),t.splunkClickLog("GIFT____botomm__aceept__")}}},acceptProgress:function(t){cjosLogUtil.log("## progress start");var r=this,o=r.$el;if(!1!==r.validatePresentDeliveryAccept()){var n=r.receiverDeliveryFormView.getAddressData();if(!1!=!!n){if(r.model.get("isProgress"))return void alert("인증 처리 중 입니다. 잠시만 기다려주세요.");var l=0,i=[],a=r.model.get("presentItemInfoList");cjosLogUtil.log(a),_.forEach(a,function(e){cjosLogUtil.log(e);var t={itemCode:e.itemCode,channelCode:e.channelCode};i[l]=t,l++});var d="0";r.getAddDelivCostYn()&&(d="1"),cjosLogUtil.log("# addDelivCostYn : "+d);var s=new Backbone.Model;s.set({encryptData:e.get("encryptData"),authData:e.get("authData"),addDelivCostYn:d,orderItems:i,treceiverRatelyNewTuple:n,deliveryMessage:o.find("._delimsg").val()}),cjosLogUtil.log(s.get("treceiverRatelyNewTuple")),t.remove(),t.unbind(),r.acceptSubmit(s,r.acceptCallback)}}},acceptSubmit:function(t,r){var o=this;cjosLogUtil.log(JSON.stringify(t)),o.ajax=Backbone.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/accept",contentType:"application/json;charset=utf-8",data:JSON.stringify(t),dataType:"json",xhrFields:{withCredentials:!0},type:"POST",beforeSend:function(){o.simpleLoadingBar.appendTo("#container",!0)},success:function(e,t,o){if(cjosLogUtil.log("submit order data : ",e),1===e.code)r(e.result);else if(e.resMsg){var n=e.resMsg;e.description&&(n=n+"\n"+e.description),alert(n)}},error:function(e,t,r){cjosLogUtil.log(t),alert("통신이 원활하지 않습니다. 다시 시도해주시고 동일한 현상이 계속 발생시 고객센터로 문의해주세요.(CJmall 고객센터 1644-2525)")},complete:function(e,t,r){o.simpleLoadingBar.remove(),o.model.set("isProgress",!1)}})},presentAcceptSuccessOnClick:function(){cjosLogUtil.log("# presentAcceptSuccessOnClick start");var e=this;e.acceptSuccessView.remove(),e.acceptSuccessView.unbind(),e.acceptSuccessEventModel.clear()},acceptCallback:function(e){var t=this;cjosLogUtil.log(t.presentAcceptSuccessOnClick),t.acceptSuccessEventModel=new Backbone.Model,t.acceptSuccessEventModel.set("presentAcceptCompleteModel",e),t.acceptSuccessView=new u({model:t.acceptSuccessEventModel})},presentRefuseConfirmCancelOnClick:function(){var e=this;e.orderPresentRefuseConfirmView.remove(),e.orderPresentRefuseConfirmView.unbind(),e.refuseEventModel.clear()},presentRefuseConfirmOnClick:function(){var e=this;e.refuseProgress(e.orderPresentRefuseConfirmView)},refuse:function(e){cjosLogUtil.log("## refuse start"),e.preventDefault();var r=this;r.$el;if(r.refuseEventModel=new Backbone.Model,r.refuseEventModel.set("presentRefuseConfirmCancelOnClick",$.proxy(r.presentRefuseConfirmCancelOnClick,r)),
r.refuseEventModel.set("presentRefuseConfirmOnClick",$.proxy(r.presentRefuseConfirmOnClick,r)),0==$("#_orderPresentRefuseConfirm").length){var o=$("<div>");o.attr("id","_orderPresentRefuseConfirm"),$("#content").append(o)}r.orderPresentRefuseConfirmView=new p({model:r.refuseEventModel}),t.splunkClickLog("GIFT____botomm__reject__")},refuseProgress:function(t){var r=this;r.$el;r.refuseFormModel=new Backbone.Model,r.refuseFormModel.set({encryptData:e.get("encryptData"),authData:e.get("authData")}),t.remove(),t.unbind(),r.refuseSubmit(r.refuseFormModel,r.refuseCallback)},refuseSubmit:function(t,r){var o=this;o.$el;cjosLogUtil.log(JSON.stringify(t)),o.ajax=Backbone.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/refuse",contentType:"application/json;charset=utf-8",data:JSON.stringify(t),dataType:"json",xhrFields:{withCredentials:!0},type:"POST",beforeSend:function(){o.simpleLoadingBar.appendTo("#container",!0)},success:function(e,t,o){if(cjosLogUtil.log("submit order data : ",e),1===e.code)r(e.result);else if(e.resMsg){var n=e.resMsg;e.description&&(n=n+"\n"+e.description),alert(n)}},error:function(e,t,r){cjosLogUtil.log(t),alert("통신이 원활하지 않습니다. 다시 시도해주시고 동일한 현상이 계속 발생시 고객센터로 문의해주세요.(CJmall 고객센터 1644-2525)")},complete:function(e,t,r){o.model.set("isProgress",!1),o.simpleLoadingBar.remove()}})},refuseCallback:function(e){new m}})}),define("page/cjmall/order/present/delivery/view/orderPresentDeliveryAuthView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper","common/cjmall/ui/m/loading/views/simpleLoadingBar","page/cjmall/order/present/delivery/models/orderPresentDeliveryAuthInfoModel","page/cjmall/order/present/delivery/models/orderPresentDeliveryAuthFormModel"],function(e,t,r,o,n,l,i){return Backbone.View.extend({el:".wrap_register",template:Handlebars.compile($("#orderPresentDeliveryAuthTemplate").html()),model:null,simpleLoadingBar:new n,initialize:function(){var e=this;e.$el;e.simpleLoadingBar.appendTo("#content"),e.model=new l,e.model.set("isProgress",!1),window._cjmallOrderValidator=r,e.validator=window._cjmallOrderValidator,e.getOrderPresentDeliveryAuthInfo()},getOrderPresentDeliveryAuthInfo:function(){var t=this,r=(t.$el,e.get("ecBaseSslUrl")+"/m/main.jsp"),o={encryptData:e.get("encryptData")};t.model.fetch({data:o,dataType:"json",xhrFields:{withCredentials:!0},type:"POST",success:function(e,o,n){var l=e.responseData;if(cjosLogUtil.log(l),200!=o.status){if("0"!=l.errorCode)return alert(l.message),void(window.location.href=r)}else{if("MSG_COM_SUC_009"!=l.resCode)return alert(l.message),void(window.location.href=r);t.model=e,t.render()}},error:function(e,t,r){cjosLogUtil.log("fetch error")}})},render:function(){var t=this,r=t.$el;e.get("ecBaseCjmallImageUrl");r.html(t.template(t.model.toJSON())),t.simpleLoadingBar.remove(),r.show()},events:{"click ._btn_auth":"presentDeliveryAuth","keypress ._cellno":"telnumOnKeyPressHn","focusin ._receiveCellno":"receiverCellnoOnFocusInHn","blur ._receiveCellno":"receiverCellnoOnBlurHn","keypress ._receiveCellno":"enterKeyEventForAuth"},enterKeyEventForAuth:function(e){13==e.keyCode&&(e.preventDefault(),$("._btn_auth").click())},telnumOnKeyPressHn:function(e){e.keyCode>47&&e.keyCode<58||e.preventDefault()},receiverCellnoOnFocusInHn:function(e){$(e.currentTarget).siblings(".lbl").hide()},receiverCellnoOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lbl");0==$.trim(t.val()).length&&r.show()},validatePresentDeliveryAuth:function(){var e=this,t=e.$el,r=t.find("#agree_prd_order").is(":checked"),o=e.model.get("encryptData"),n=t.find("._receiveCellno");return!1===r?(alert("휴대폰번호 수집 및 이용에 대한 동의여부를 확인해주세요."),!1):o?e.validator.isNumber(n.val())?!0===e.validator.isMinerMinlength(n)?(alert("휴대폰 번호는 "+n.data().minlength+"자 이상 입력하셔야 합니다."),n.focus(),!1):!0!==e.validator.isOverMaxlength(n)||(alert("휴대폰 번호는 "+n.data().maxlength+"자까지 입력가능합니다."),n.focus(),!1):(alert("숫자만 입력해주세요."),n.focus(),!1):(alert("데이터가 비정상적입니다. 재접속하시어 다시 시도해주세요."),!1)},presentDeliveryAuth:function(e){e.preventDefault();var t=this,r=t.$el;if(!1!==t.validatePresentDeliveryAuth()){if(t.model.get("isProgress"))return void alert("인증 처리 중 입니다. 잠시만 기다려주세요.");var o=t.model.get("encryptData"),n=r.find("._receiveCellno").val();t.model.set("isProgress",!0);var l=new Backbone.Model;l.set("encryptData",o),l.set("receiverCellno",n);(new i).submit(t.model,l,t.presentDeliveryAuthCallback)}},presentDeliveryAuthCallback:function(t,r){cjosLogUtil.log("callback 도착"),cjosLogUtil.log(r);var o;$("#presentDeliveryAcceptForm").length>0&&$("#presentDeliveryAcceptForm").remove(),o=$("<form></form>"),o.append($("<input>").attr("type","hidden").attr("name","authData").val(r.authData)),o.append($("<input>").attr("type","hidden").attr("name","encryptData").val(r.encryptData)),o.attr({id:"presentDeliveryAcceptForm",action:e.get("ecBaseSslUrl")+"/m/order/present/delivery/accept",method:"post"}),$("body").append(o),o.submit(),t.set("isProgress",!1)}})}),define("page/cjmall/order/present/delivery/view/orderPresentRefuseConfirmView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"#_orderPresentRefuseConfirm",template:Handlebars.compile($("#orderPresentRefuseConfirm").html()),model:new Backbone.Model,initialize:function(){var e=this;e.$el;e.render()},events:{"click #presentRefuseConfirmCancelBtn":"confirmCancel","click #presentRefuseConfirmBtn":"confirm"},confirmCancel:function(e){var t=this;t.$el;t.model.get("presentRefuseConfirmCancelOnClick")&&t.model.get("presentRefuseConfirmCancelOnClick")()},confirm:function(e){var t=this;t.model.get("presentRefuseConfirmOnClick")&&t.model.get("presentRefuseConfirmOnClick")()},render:function(){var e=this,t=e.$el;t.html(e.template(e.model.toJSON())),t.find(".lay_wrap.lay_gift_wrap").show()}})}),define("page/cjmall/order/present/delivery/view/orderPresentRefuseSuccessView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/util/validator","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"#_orderPresenttRefuseSuccess",template:Handlebars.compile($("#orderPresenttRefuseSuccess").html()),model:new Backbone.Model,initialize:function(){var e=this;e.$el;e.render()},events:{"click #presentRefuseSuccessBtn":"confirm"},confirm:function(t){location.replace(e.get("displayDomain")+"/m/main")},render:function(){var e=this,t=e.$el;t.html(e.template(e.model.toJSON())),t.find(".lay_wrap.lay_gift_wrap").show()}})}),define("page/cjmall/order/rental/models/rentalOrderInfoModel",["common/cjos/util/configUtil"],function(e){"use strict";return Backbone.Model.extend({url:"",defaults:{itemCode:null,itemName:null,channelCode:null,custNm:null,representTelNo1:null,representTelNo2:null,representTelNo3:null,rentalItemImageUrl:null,_emptyImageUrl:"http://itemimage.cjmall.com/goods_images/imageL.jpg",insuAgreeCodeNm:null,insuCompNm:null,insuInfoPeriod:null},initialize:function(){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/rental/getUserInfo"},parse:function(e){var t=this;e.jsonTuple===undefined?(alert("잠시 후 다시 시도해주십시오."),history.back()):null===e.jsonTuple.result&&(alert("상담신청 주문 상품이 아닙니다."),history.back());var r=e.jsonTuple.result;return t.set(r),t}})}),define("page/cjmall/order/rental/view/m/mobileRentalView",["page/cjmall/order/rental/models/rentalOrderInfoModel","page/cjmall/order/rental/view/m/rentalOrderInfoView","common/cjos/util/configUtil","common/cjos/ui/m/loading/views/simpleLoadingBar","common/cjos/advertise/util/advertiseUtil"],function(e,t,r,o,n){return Backbone.View.extend({el:".wrap_order",model:null,simpleLoadingBar:new o,events:{"click #click_counsel_submit":"teraScript"},initialize:function(){var e=this;e.$el;n.isActive=!1,e.createOrderInfoModel(),e.getOrderInfo()},createOrderInfoModel:function(){var t=this,r=new e;t.model=r},getOrderInfo:function(){var e=this,t=r.get("itemCode"),o=r.get("channelCode");e.simpleLoadingBar.appendTo("#container");var n={itemCode:t,channelCode:o};e.model.fetch({data:n,type:"GET",dataType:"json",success:function(t,r,o){cjosLogUtil.log("[rentalMainView] fetch success"),e.simpleLoadingBar.remove(),e.model=t,e.render()},error:function(t,r,o){cjosLogUtil.log("[rentalMainView] fetch error"),e.simpleLoadingBar.remove()}})},render:function(){var e=this,r=e.$el;e.model;Handlebars.registerHelper("isCustomerAgreeShow",function(e,t,r){Handlebars.Utils.isEmpty(e),Handlebars.Utils.isEmpty(t);return e&&t?r.fn(this):r.inverse(this)}),e.view=new t({model:e.model}),e.listenTo(e.view,"clickSubmit",e.clickSubmitHandler),r.append(e.view.render().$el)},clickSubmitHandler:function(){var e=this,t=e.$el,r=e.$el.find("._message");if(r.val().length>100)return void alert("상담메시지는 최대 100자까지 입력할 수 있습니다.");var o=t.find("input:checkbox[class=_customer_agree]").is(":checked");if(null!=e.model.get("insuAgreeCodeNm")&&null!=e.model.get("insuCompNm")&&!o)return void alert("개인정보 3자 제공에 대한 동의가 필요합니다.");var n="";o&&(n="1");var l={itemCode:e.model.get("itemCode"),channelCode:e.model.get("channelCode"),message:r.val(),isCustomerAgree:n};e.createRentalOrder(l)},createRentalOrder:function(e){var t=this;if(0==confirm("상담신청 상담을 위해 신청자명과 연락처가 협력사에 제공됩니다. \n\n확인을 클릭하시면 상담신청이 완료됩니다."))return!1;$.ajax({type:"post",datatype:"json",async:!1,url:r.get("ecBaseSslUrl")+"/c/rest/order/rental/create",cache:!1,data:JSON.stringify(e),contentType:"application/json; charset=UTF-8",xhrFields:{withCredentials:!0},success:function(e){if("00"===e.result){alert("고객님의 상담신청이 정상적으로 등록되었습니다.");var r=t.model.get("itemCode"),o=t.model.get("channelCode"),n=require("common/cjmall/util/cjmallUtil"),l=n.getLinkUrl(r,o);window.location.href=l+"&isMyzone=true"}else alert("상담신청을 접수하는 중 오류가 발생하였습니다. 지속될 경우 고객센터로 문의바랍니다. [errorCode : "+e.result+"]")},error:function(e,t,r){alert("서버와의 통신이 실패했습니다.[28]\njqXHR: "+e+"\ntextStatus: "+t+"\nerrorThrown: "+r)}})},teraScript:function(){_LA.EVT("2492")}})}),define("page/cjmall/order/rental/view/m/rentalOrderInfoView",["common/cjmall/util/cjmallUtil","common/cjos/util/configUtil"],function(e,t){return Backbone.View.extend({model:null,events:{"click ._submit":"clickSubmit"},template:{},initialize:function(){this.template=Handlebars.compile($("#rentalTemplate").html())},render:function(){var t=this,r=t.$el,o=t.model.get("itemCode"),n=t.model.get("channelCode"),l=t.model.get("rentalItemImageUrl");t.model.set("itemImageUrl",l);var i=e.getLinkUrl(o,n);t.model.set("itemDetailUrl",i);var a=t.model.toJSON();return r.html(t.template(a)),t},clickSubmit:function(e){e.preventDefault(),this.trigger("clickSubmit")}})}),define("page/cjmall/order/rental/view/p/pcRentalView",["common/cjos/util/configUtil","page/cjmall/order/rental/models/rentalOrderInfoModel","page/cjmall/order/rental/view/p/rentalOrderInfoView","common/cjos/advertise/util/advertiseUtil"],function(e,t,r,o){return Backbone.View.extend({el:".wrap_order",model:null,events:{"click #click_counsel_submit":"teraScript"},initialize:function(){var e=this;e.$el;o.isActive=!1,e.createOrderInfoModel(),e.getOrderInfo()},createOrderInfoModel:function(){var e=this,r=new t;e.model=r},getOrderInfo:function(){var t=this,r=e.get("itemCode"),o=e.get("channelCode"),n={itemCode:r,channelCode:o};t.model.fetch({data:n,type:"GET",dataType:"json",success:function(e,r,o){cjosLogUtil.log("[rentalMainView] fetch success"),t.model=e,t.render()},error:function(e,t,r){cjosLogUtil.log("[rentalMainView] fetch error")}})},render:function(){var e=this,t=e.$el;e.model;Handlebars.registerHelper("isCustomerAgreeShow",function(e,t,r){Handlebars.Utils.isEmpty(e),Handlebars.Utils.isEmpty(t);return e&&t?r.fn(this):r.inverse(this)}),e.view=new r({model:e.model}),e.listenTo(e.view,"clickSubmit",e.clickSubmitHandler),t.append(e.view.render().$el)},clickSubmitHandler:function(){var e=this,t=e.$el,r=e.$el.find("._message");if(r.val().length>100)return void alert("상담메시지는 최대 100자까지 입력할 수 있습니다.");var o=t.find("input:checkbox[class=_customer_agree]").is(":checked");if(null!=e.model.get("insuAgreeCodeNm")&&null!=e.model.get("insuCompNm")&&!o)return void alert("개인정보 3자 제공에 대한 동의가 필요합니다.");var n="";o&&(n="1");var l={itemCode:e.model.get("itemCode"),channelCode:e.model.get("channelCode"),message:r.val(),isCustomerAgree:n};e.createRentalOrder(l)},createRentalOrder:function(t){var r=this;if(0==confirm("상담신청 상담을 위해 신청자명과 연락처가 협력사에 제공됩니다. \n\n확인을 클릭하시면 상담신청이 완료됩니다."))return!1;$.ajax({type:"post",datatype:"json",async:!1,url:e.get("ecBaseSslUrl")+"/c/rest/order/rental/create",cache:!1,data:JSON.stringify(t),contentType:"application/json; charset=UTF-8",xhrFields:{withCredentials:!0},success:function(e){if("00"===e.result){alert("고객님의 상담신청이 정상적으로 등록되었습니다.");var t=r.model.get("itemCode"),o=r.model.get("channelCode"),n=require("common/cjmall/util/cjmallUtil"),l=n.getLinkUrl(t,o);window.location.href=l+"&isMyzone=true"}else alert("상담신청을 접수하는 중 오류가 발생하였습니다. 지속될 경우 고객센터로 문의바랍니다. [errorCode : "+e.result+"]")},error:function(e,t,r){alert("서버와의 통신이 실패했습니다.[28]\njqXHR: "+e+"\ntextStatus: "+t+"\nerrorThrown: "+r)}})},teraScript:function(){_LA.EVT("2491")}})}),define("page/cjmall/order/rental/view/p/rentalOrderInfoView",["common/cjmall/util/cjmallUtil","common/cjos/util/configUtil"],function(e,t){return Backbone.View.extend({model:null,events:{"click ._submit":"clickSubmit"},template:{},initialize:function(){this.template=Handlebars.compile($("#rentalTemplate").html())},render:function(){var t=this,r=t.$el,o=t.model.get("itemCode"),n=t.model.get("channelCode"),l=t.model.get("rentalItemImageUrl");t.model.set("itemImageUrl",l);var i=e.getLinkUrl(o,n);t.model.set("itemDetailUrl",i);var a=t.model.toJSON();return r.html(t.template(a)),t},clickSubmit:function(e){e.preventDefault(),this.trigger("clickSubmit")}})}),define("page/cjmall/order/sheet/collections/couponCollection",["page/cjmall/order/sheet/models/couponDetailModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(e){}})}),define("page/cjmall/order/sheet/collections/deliveryAddressCollection",["common/cjos/util/configUtil","page/cjmall/order/sheet/models/deliveryAddressItemModel"],function(e,t){return Backbone.Collection.extend({model:t,url:e.get("ecBaseSslUrl")+"/c/rest/order/sheet/deliveryAddresses",parse:function(e){return e.jsonTuple.result}})}),define("page/cjmall/order/sheet/collections/deliveryGroupItemCollection",["page/cjmall/order/sheet/models/deliveryGroupItemModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(){},getTotalGroupDeliveryFee:function(){var e=0;return this.each(function(t,r){e+=t.get("groupDeliveryFee")}),e},setSelectedAddress:function(e){this.each(function(t,r){t.set("selectedAddressModel",e)})}})}),define("page/cjmall/order/sheet/collections/deliveryPolicyCollection",["page/cjmall/order/sheet/models/deliveryPolicyModel"],function(e){return Backbone.Collection.extend({model:e})}),define("page/cjmall/order/sheet/collections/discountDetailCollection",["page/cjmall/order/sheet/models/discountDetailModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(e){}})}),define("page/cjmall/order/sheet/collections/orderCertainFormCollection",["page/cjmall/order/sheet/models/orderCertainFormModel"],function(e){return Backbone.Collection.extend({model:e})}),define("page/cjmall/order/sheet/collections/orderDeliveryAddressCollection",["page/cjmall/order/sheet/models/orderMultipleDeliveryAddressModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(){}})}),define("page/cjmall/order/sheet/collections/orderItemCertainFormCollection",["page/cjmall/order/sheet/models/orderItemCertainFormModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(){}})}),define("page/cjmall/order/sheet/collections/orderItemPriceCollection",["page/cjmall/order/sheet/models/orderItemPriceModel"],function(e){return Backbone.Collection.extend({model:e,initialize:function(){},modelId:function(e){return e.unitCode},getIsFastDeliveryAble:function(){var e=!0;return this.each(function(t,r){var o=t.get("orderDeliveryTuple").fastDeliveryInfoTuple,n=!!o&&!!o.fastDelivMsgInfo,l=!!o&&o.fastDelivery,i=!0===t.get("orderItemTypeTuple").bookingOrder,a="true"==t.get("isCustHopeDelyYn"),d="true"==t.get("isCustFixedDelyYn");if(!1===n||!1===l||i||a||d)return e=!1,!1}),e}})}),define("page/cjmall/order/sheet/collections/receiverAddressFormCollection",["page/cjmall/order/sheet/models/receiverAddressFormModel"],function(e){return Backbone.Collection.extend({model:e})}),define("page/cjmall/order/sheet/collections/venDeliveryDateCollection",["page/cjmall/order/sheet/models/venDeliveryDateModel","common/cjos/util/configUtil"],function(e,t){return Backbone.Collection.extend({url:"",model:e,initialize:function(){},parse:function(e){return e.jsonTuple.result}})}),define("page/cjmall/order/sheet/helper/deliveryAbleHelper",["common/cjos/util/configUtil"],function(e){return Backbone.View.extend({zipno:"",zipnoSeq:"",orderPriceModel:{},initialize:function(e,t,r){var o=this;o.zipno=e,o.zipnoSeq=t,o.orderPriceManagers=r},checkDeliveryAble:function(e){var t=this,r=[];r=t.getDeliveryAbleForms(t.zipno,t.zipnoSeq),t.callDeliveryAble(r,e)},getDeliveryAbleForms:function(e,t){var r=this,o=[];return _.each(r.orderPriceManagers,function(r,n){var l={itemCode:r.itemCode,channelCode:r.channelCode,itemName:r.displayItemName,zipno:e,zipnoSeq:t};o.push(l)}),o},callDeliveryAble:function(t,r){var o=e.get("ecBaseSslUrl")+"/c/rest/order/sheet/deliveryAble";$.ajax({url:o,type:"post",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(t),xhrFields:{withCredentials:!0},success:function(e,t,o){if(1!==e.code)return void _.defer(function(){alert(e.message)});r(e)},error:function(e){cjosLogUtil.log("error data : ",e)}})}})}),define("page/cjmall/order/sheet/helper/deliveryAddressHelper",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/helper/orderSheetHelper"],function(e,t,r,o,n,l){function i(){}var a={isAbleSelectDeliveryDay:function(){var e=!1,t=!1,r=!1,o=!1;return _.forEach(l.getOrderPriceManagers(),function(n){n.isCustFixedDelyYn&&(t=!0,r=!0),n.isCustHopeDelyYn&&(e=!0,r=!0),(n.orderItemTypeTuple.cookit||n.orderItemTypeTuple.dawn)&&(o=!0)}),r&&(e&&t&&(r=!1),o&&(r=!1)),r},isCheckDataLGEDeliveryItem:function(){var e=!0;return _.forEach(l.getOrderPriceManagers(),function(t){if(!t.checkDataLGEDeliveryItem)return e=!1,!1}),e},isOneOrMoreLGEDeliveryItem:function(){var e=!1;return _.forEach(l.getOrderPriceManagers(),function(t){if(t.isLGEDeliveryItem)return e=!0,!1}),e},getIsDuplicateSelectDelivery:function(){var e=!1,t=!1,r=!1,o=!1,l=n.get("orderPriceModel").get("orderPriceManagers");return _.forEach(l,function(n){n.isCustFixedDelyYn&&(t?o=!0:t=!0),n.isCustHopeDelyYn&&(e?r=!0:e=!0)}),!(!r&&!o)},isCookitDeliveryItem:function(){var e=!1;return _.forEach(l.getOrderPriceManagers(),function(t){if(t.orderItemTypeTuple.cookit)return e=!0,!1}),e},isDawnDeliveryItem:function(){var e=!1;return _.forEach(l.getOrderPriceManagers(),function(t){if(t.orderItemTypeTuple.dawn)return e=!0,!1}),e},isDawnDeliveryItemIncluded:function(){var e=!1;return _.forEach(l.getOrderPriceManagers(),function(t){if(t.orderItemTypeTuple.cookit||t.orderItemTypeTuple.dawn)return e=!0,!1}),e},isDawnDeliveryAbled:function(e){var t=!1,r={addressType:e.get("addressType"),fullAddress:e.get("fullAddress"),customerNo:e.get("cust_no")};return $.ajax({url:"/c/rest/cookitDelivery/isCookitDelivery",async:!1,type:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},data:r,xhrFields:{withCredentials:!0},success:function(e){1==e.code&&(t=e.result.success)},error:function(e,t,r){cjosLogUtil.log("새벽배송 가능지역여부 조회 실패 : response ",e)}}),t},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}},makeDate:function(e){var t=Number(e.substring(0,4)),r=Number(e.substring(4,6))-1,o=Number(e.substring(6,8));return new Date(t,r,o)},isDawnDeliveryArea:function(){},getVenDeliveryOrderStatus:function(){var e="",t={isDeliveryOrder:!0,isNormalDeliveryItem:!0},r=!1;return _.forEach(l.getOrderPriceManagers(),function(o){var n=!1;if(!r)return"Y"!==o.venDeliveryCompYn?(t.isDeliveryOrder=!1,void(r=!0)):(o.venDeliveryApplyYn&&(n="Y"==o.venDeliveryApplyYn),n&&o.venModelCode?""!=e&&e!=o.mainVenCode?(t.isNormalDeliveryItem=!1,void(r=!0)):void(e=o.mainVenCode):(t.isNormalDeliveryItem=!1,void(r=!0)))}),t}};return i.prototype=a,new i}),define("page/cjmall/order/sheet/helper/fastDeliveryHelper",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/helper/payTypeHelper","common/cjos/util/configUtil"],function(e,t,r){return Backbone.View.extend({fastAreaCls:"",deliveryPolicyModel:{},MSG_FASTDELIV:{ALERT_AREA:"현재 선택하신 배송지는 [빠른배송] 배송서비스 불가 지역입니다.",ALERT_PAYMENT_ONLINE:"[ 빠른배송 ]서비스의 경우 현금 결제 (무통장입금, 실시간계좌이체)가 불가능 합니다.\n다른 결제수단으로 변경 후 주문해주세요."},initialize:function(e,t){var r=this;r.fastAreaCls=e,r.deliveryPolicyModel=t},getFastDeliveryObj:function(){var t=this,r=t.fastAreaCls;if(!1==!!t.deliveryPolicyModel.get("fastDeliveryAddPrice"))return null;var o=t.deliveryPolicyModel.get("fastDeliveryAddPrice").capCost,n=t.deliveryPolicyModel.get("fastDeliveryAddPrice").allCost,l=t.deliveryPolicyModel.get("fastDeliveryAddPrice").fastDeliveryMessageInfo,i=t.deliveryPolicyModel.get("fastDeliveryAddPrice").fastDeliveryMessageInfos;if(!1==!!i)return null;var a=l?l.code:null;if(t.fastDeliveryObj={fastDelivDisabled:!1,fastDelivDisplay:"",fastDeliveryCost:0,fastDeliveryFree:!1,fastDeliveryMsg:null,fastDeliveryData:null,fastDeliveryAlertMsg:"",fastDeliveryAlertType:""},a){var d=a.substring(2,3),s=(a.substring(3,4),a.substring(4,5));switch("T"==d||"N"==d?"C"==s?(t.fastDeliveryObj.fastDeliveryCost=o,"01"!=r&&(t.fastDeliveryObj.fastDelivDisabled=!0)):"A"==s&&("01"==r?t.fastDeliveryObj.fastDeliveryCost=o:"02"==r?t.fastDeliveryObj.fastDeliveryCost=n:(t.fastDeliveryObj.fastDeliveryCost=!!t.fastDeliveryObj.fastDeliveryCost||n,t.fastDeliveryObj.fastDelivDisabled=!0)):t.fastDeliveryObj.fastDelivDisabled=!0,0===t.fastDeliveryObj.fastDeliveryCost&&!1===t.fastDeliveryObj.fastDelivDisabled&&(t.fastDeliveryObj.fastDeliveryFree=!0),r){case"00":t.fastDeliveryObj.fastDeliveryMsg=!!t.fastDeliveryObj.fastDeliveryMsg||i.allDelivMsg;break;case"01":t.fastDeliveryObj.fastDeliveryMsg=i.capDelivMsg;break;case"02":t.fastDeliveryObj.fastDeliveryMsg=i.allDelivMsg}}return"01"!=r&&"02"!=r?("NONE"!==e.get("orderAddressModel").get("orderAddressType")&&(t.fastDeliveryObj.fastDeliveryAlertMsg=t.MSG_FASTDELIV.ALERT_AREA,t.fastDeliveryObj.fastDeliveryAlertType="ALERT_AREA"),t.fastDeliveryObj.fastDelivDisabled=!0,t.fastDeliveryObj.fastDeliveryCost,t.fastDeliveryObj):!0===t.isNoBankBook()?(t.fastDeliveryObj.fastDeliveryAlertMsg=t.MSG_FASTDELIV.ALERT_PAYMENT_ONLINE,t.fastDeliveryObj.fastDelivDisabled=!1,t.fastDeliveryObj.fastDeliveryAlertType="ALERT_PAYMENT_ONLINE",t.fastDeliveryObj):(cjosLogUtil.log("s.fastAreaCls : ",t.fastAreaCls),cjosLogUtil.log("s.deliveryPolicyModel : ",t.deliveryPolicyModel),cjosLogUtil.log("fastDeliveryObj : ",t.fastDeliveryObj),t.fastDeliveryObj)},isNoBankBook:function(){var r=e.get("orderPaymentModel");return!!t.isNobankbook(r.get("_payType"))}})}),define("page/cjmall/order/sheet/helper/hanssemDeliveryHelper",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjos/util/globalVariables","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/popupWindowCheckHelper","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/helper/payTypeHelper"],function(e,t,r,o,n,l,i){function a(e){var t=e.result.hanssemDeliveryHope;if(_.isUndefined(t)||null!=t){if(t.isAlert)return alert(t.alertMessage),!1;if(t.isCallPopup)return!0}return!1}function d(e){var t=e.result.hanssemDeliveryHope,r=t.popupUrl,o=t.callbackUrl,n=t.hanssemDeliveryAvailableRequestCriteria;(_.isUndefined(t)||null!=t)&&s(r,o,n)}function s(e,t,n){var l=o.get(o.APPLICATION_TYPE),i=n.saleChnlNo,a=n.postCode,d=n.tempOrderNo,s=n.gdsList,c={};c.gdsList=s;var u=$("<form></form>");switch(u.append($("<input>").attr("type","hidden").attr("id","postCode").attr("name","postCode").val(a)),u.append($("<input>").attr("type","hidden").attr("id","saleChnlNo").attr("name","saleChnlNo").val(i)),u.append($("<input>").attr("type","hidden").attr("id","tempOrderNo").attr("name","tempOrderNo").val(d)),u.append($("<input>").attr("type","hidden").attr("id","callbackUrl").attr("name","callbackUrl").val(t)),u.append($("<input>").attr("type","hidden").attr("id","gdsList").attr("name","gdsList").val(JSON.stringify(c))),u.attr({action:e,method:"post",target:"payment"}),l){case"p":$("body").append(u),createPopupHanssemDelivery(e,"payment",800,900),u.submit();break;case"m":;$("#wrap").hide(),$iframe=$('<iframe id="_payment" name="payment" frameborder="0" style="overflow:auto !important;width:100%;height:100%;"></iframe>'),r.set("hanssemDeliveryLayerViewClose",function(){$("#_payment").remove()},!0),r.set("hanssemDeliveryLayerViewCloseAndShowOrderSheet",function(){$("#wrap").show(),$("#_payment").remove()},!0),$("body").append($iframe),$("body").append(u),u.submit()}}return window.createPopupHanssemDelivery=function(e,t,r,o){var l=r!=undefined?r:800,i=o!=undefined?o:900,a=window._paymentPopup,d=n.popupCheck(a);if(""!==d){var s=screen.availWidth/2-l/2,c=screen.availHeight/2-i/2-30;t=t!=undefined?t:"",a=window.open("about:blank",t,"width="+l+", height="+i+", left="+s+", top="+c+", scrollbars=yes"),d=n.popupCheck(a)}if(""!==d)return alert(d),void(a!==undefined&&null!==a&&a.close());_.isNull(a)||_.isUndefined(a)||(!0===a.closed?a=window.open("about:blank",t,"width="+l+", height="+i+", left="+s+", top="+c+", scrollbars=yes"):(a.resizeTo(l,i),a.focus()))},window.callHanssemPayTypeHelper=function(){var e=window._cjmallOrderObserver.getContent("orderCertainResult"),t=window._cjmallOrderObserver.getContent("callPayTypeHelper"),r={};r.result=e,t(r,l)},{checkHanssemDeliveryAble:a,call:d}}),define("page/cjmall/order/sheet/handlbarsHelpers",["handlebars","common/cjutil/util"],function(e,t){}),define("page/cjmall/order/sheet/helper/orderSheetHelper",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/models/orderSheetMainModel"],function(e,t,r,o,n){function l(){}var i={getOrderSheetType:function(){return n.get("orderSheetType")},getOrderPriceModel:function(){return n.get("orderPriceModel")},getOrderPriceManagers:function(){return this.getOrderPriceModel().get("orderPriceManagers")},getTotalOrderItemTypeTuple:function(){return this.getOrderPriceModel().get("totalOrderItemTypeTuple")},isNoDeliveryItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if("NONE"===e.orderDeliveryTuple.deliveryType)return t=!0,!1}),t},isPackageItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(!0==!!e.packUnitItemTuples)return t=!0,!1}),t},isLinkGiftItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(_.forEach(e.totalGiftTuples,function(e){if("LINK_GIFT"===e.itemEtcType)return t=!0,!1}),t)return!1}),t},isLumpSumDiscountItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){var r=e.discountPriceTuple.discountDetails;_.forEach(r,function(e){return"LUMP_SUM"===e.category&&!0===e.immediatelyDiscount?(t=!0,!1):!t&&void 0})}),t},isMemberShipPointDiscountItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){var r=e.discountPriceTuple.discountDetails;if(_.forEach(r,function(e){if("PROMOTION_NOW"===e.category)return t=!0,!1}),t)return!1}),t},isHyundaiStoreItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(e.orderItemTypeTuple.hyundaiStore)return t=!0,!1}),t},isOliveyoungItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if("OLIVEYOUNG"===e.orderItemTypeTuple.orderItemType)return t=!0,!1}),t},isHanssemDeliveryItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(e.isHanssemDeliveryItem)return t=!0,!1}),t},isCookitItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(e.orderItemTypeTuple.cookit)return t=!0,!1}),t},isDawnItemIncluded:function(){var e=this,t=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(e.orderItemTypeTuple.dawn)return t=!0,!1}),t},isNotAllSaleEmployeeOrVIP:function(){var e=this,t=!1,r=!1,o=!1;return _.forEach(e.getOrderPriceManagers(),function(e){if(!0===o)return!1;_.forEach(e.discountPriceTuple.discountDetails,function(e){if("EMPLOYEE"==e.category){var n=e.cjMemberDiscountTuple.discountAllAmtYn,l=e.cjMemberDiscountTuple.cjDcGbnType,i=e.cjMemberDiscountTuple.availAmt,a=e.cjMemberDiscountTuple.subAvailAmt;""!==n&&"Y"===n||("DISCOUNT"===l&&"0"!=i?(t=!0,o=!0):"SUB_DISCOUNT"===l&&"0"!=a&&(t=!0,o=!0))}if("VIP"==e.category){var d=e.vipMemberDiscountTuple.discountAllAmtYn,s=e.vipMemberDiscountTuple.limitAmt;""!==d&&"Y"===d||"0"==s||(r=!0,o=!0)}})}),t||r},getCookitIntersectionDateList:function(){var e=this,t=[];return _.forEach(e.getOrderPriceModel().get("cookitIntersectionDateList"),function(r){var o={optValue:r,optText:e.cookitDeliveryPlanFormat(r)};t.push(o)}),t},cookitDeliveryPlanFormat:function(e){var t=this,r=e.substring(0,4),o=e.substring(4,6),n=e.substring(6,8),l=new Date(r,o-1,n),i=[];return i.push(String(l.getFullYear())+"년"),i.push(String(l.getMonth()+1)+"월"),i.push(String(l.getDate())+"일"),i.push(t.getDayOfWeek(l.getDay())),i.join(" ")},getDayOfWeek:function(e){return["일요일","월요일","화요일","수요일","목요일","금요일","토요일"][e]},getIsDeliveryTravelProduct:function(){var e=this,t=!1,r=e.getOrderPriceManagers();return _.forEach(r,function(e){var r=e.orderItemTypeTuple.domesticTravel,o=e.orderItemTypeTuple.overseasTravel;(r||o)&&(t=!0),"80040103"===e.itemTypeCode&&(t=!0)}),t},getIsNoDeliveryProduct:function(){var e=this,t=!1,r=!1,o=e.getOrderPriceManagers();return _.forEach(o,function(e){"NONE"===e.orderDeliveryTuple.deliveryType||e.orderItemTypeTuple.ecoupon||e.orderItemTypeTuple.mobileVoucher?t=!0:r=!0}),!1===r&&!0===t},getIsEcouponProduct:function(){var e=this,t=!1,r=!1,o=e.getOrderPriceManagers();return _.forEach(o,function(e){e.orderItemTypeTuple.ecoupon?r=!0:t=!0}),!1===t&&!0===r},getIsCpnProduct:function(){var e=this,t=!1,r=!1,o=e.getOrderPriceManagers();return _.forEach(o,function(e){e.orderItemTypeTuple.cpnItem?r=!0:t=!0}),!1===t&&!0===r},getTourItemType:function(){var e,t=this,r=t.getOrderPriceManagers();return _.forEach(r,function(t){e=t.tourItemTypeCode}),e},isGiftItemCpn:function(){var e=this,t=!0,r=e.getOrderPriceManagers();if(e.isGiftItemPromotion())for(var o=0;o<r.length;o++){var n=r[o];if(0==n.orderItemTypeTuple.giftItemCpn){t=!1;break}}return t},isGiftItemPromotion:function(){for(var e=this,t=!1,r=e.getOrderPriceManagers(),o=0;o<r.length;o++){var n=r[o];if(0==_.isEmpty(n.totalGiftTuples)){t=!0;break}}return t},isDisplayCellNoWhenCpnItem:function(){var e=this,t=!1;return e.getIsCpnProduct()&&e.isGiftItemPromotion()&&0==e.isGiftItemCpn()&&(t=!0),t}};return l.prototype=i,new l}),define("page/cjmall/order/sheet/helper/payTypeAttributeHelper",[],function(){function e(e){var t=_.findWhere(n,{payType:e});return t?t.name:""}function t(e){var t=_.findWhere(n,{payType:e});return t?t["class"]:""}function r(e){var t=_.findWhere(n,{payType:e});return t?t.spcId:""}function o(e){var t=_.findWhere(n,{payType:e});return t?t.icon:""}var n=[{payType:"CARD",name:"신용카드",
"class":"_CARD",spcId:"ODIN____payment__card__",icon:""},{payType:"NOBANKBOOK",name:"무통장입금","class":"_NOBANKBOOK",spcId:"ODIN____payment__bank__",icon:""},{payType:"REALTIME_ACCOUNT_TRANSFER",name:"실시간계좌이체","class":"_REALTIMEACCOUNTTRANSFER",spcId:"ODIN____payment__realtimepay__",icon:""},{payType:"MOBILE",name:"휴대폰결제","class":"_MOBILE",spcId:"ODIN____payment__cellpay__",icon:""},{payType:"KAKAOTALKPAY",name:"카카오페이","class":"_KAKAOPAY",spcId:"ODIN____payment__kakaopay__",icon:"ico_kakaopay"},{payType:"SAMSUNGPAY",name:"samsung pay","class":"_SAMSUNGPAY",spcId:"ODIN____payment__sspay__",icon:"ico_samsungpay"},{payType:"PAYCO",name:"PAYCO","class":"_PAYCO",spcId:"ODIN____payment__payco__",icon:"ico_payco"},{payType:"SMILEPAY",name:"스마일페이","class":"_SMILEPAY",spcId:"ODIN____payment__smilepay__",icon:"ico_smilepay"},{payType:"SYRUPPAY",name:"11 pay","class":"_SYRUPPAY",spcId:"ODIN____payment__syruppay__",icon:"ico_11pay"},{payType:"NAVERPAY",name:"네이버페이","class":"_NAVERPAY",spcId:"ODIN____payment__naverpay__",icon:"ico_naverpay"},{payType:"PAYNOW",name:"Paynow","class":"_PAYNOW",spcId:"ODIN____payment__paynow__",icon:"ico_paynow"},{payType:"SETTLEBANK",name:"현금간편결제","class":"_SETTLEBANK",spcId:"ODIN____payment__settlebank__",icon:""},{payType:"REGULARPAYMENT",name:"정기결제","class":"_REGULARPAYMENT",spcId:"ODIN____payment__regularpayment__",icon:""}];return{getPayTypeIcon:o,getPayTypeSpcId:r,getPayTypeClass:t,getPayTypeName:e}}),define("page/cjmall/order/sheet/helper/payTypeHelper",[],function(){function e(e){var t=_.findWhere(s,{payType:e});return!!t&&("ISP"===t.groupType||"ILK"===t.groupType||"POLRARIS"===t.groupType||"PAYALL"===t.groupType||"KMOTION"===t.groupType)}function t(e){var t=_.findWhere(s,{payType:e});return!!t&&"ISP"===t.groupType}function r(e){var t=_.findWhere(s,{payType:e});return!!t&&"ILK"===t.groupType}function o(e){var t=_.findWhere(s,{payType:e});return!!t&&"POLRARIS"===t.groupType}function n(e){var t=_.findWhere(s,{payType:e});return!!t&&"NOBANKBOOK"===t.groupType}function l(e){return"NAVERPAY"===e}function i(e){return"SAMSUNG_CARD"===e}function a(e){var t=_.findWhere(s,{payType:e});return t?t.name:""}function d(e){var t=_.findWhere(s,{payType:e});return t?t.groupType:""}var s=[{payType:"PAYALL",name:"PAYALL",groupType:"PAYALL"},{payType:"PAYALL_BC",name:"BC카드 PAYALL",groupType:"PAYALL"},{payType:"PAYALL_WORI",name:"우리카드 PAYALL",groupType:"PAYALL"},{payType:"PAYALL_SCBC",name:"SCBC카드 PAYALL",groupType:"PAYALL"},{payType:"KMOTION",name:"KB국민카드",groupType:"KMOTION"},{payType:"BC_CARD",name:"BC카드",groupType:"ISP"},{payType:"KB_CARD",name:"KB국민카드",groupType:"ISP"},{payType:"GWANGJU_CARD",name:"광주VISA카드",groupType:"ISP"},{payType:"JEONBUK_CARD",name:"전북VISA카드",groupType:"ISP"},{payType:"SUHYUP_CARD",name:"수협VISA카드",groupType:"ISP"},{payType:"SCBC_CARD",name:"SCBC카드",groupType:"ISP"},{payType:"WOORI_CARD",name:"우리카드",groupType:"ISP"},{payType:"BK_CARD",name:"저축은행카드",groupType:"ISP"},{payType:"SM_CARD",name:"MG새마을체크카드",groupType:"ISP"},{payType:"POST_CARD",name:"우체국카드",groupType:"ISP"},{payType:"JEJU_CARD",name:"제주VISA카드",groupType:"ISP"},{payType:"KDB_CARD",name:"KDB산업은행",groupType:"ISP"},{payType:"BUSAN_CARD",name:"부산은행카드",groupType:"ISP"},{payType:"KAKAOBANK_CARD",name:"카카오뱅크",groupType:"ISP"},{payType:"LOTTE_CARD",name:"롯데카드",groupType:"POLRARIS"},{payType:"NONGHYUP_CARD",name:"NH농협카드",groupType:"POLRARIS"},{payType:"SHINHAN_CARD",name:"신한카드",groupType:"POLRARIS"},{payType:"SAMSUNG_CARD",name:"삼성카드",groupType:"POLRARIS"},{payType:"HYUNDAI_CARD",name:"현대카드",groupType:"POLRARIS"},{payType:"HANA_CARD",name:"하나카드",groupType:"ILK"},{payType:"HANA_KEB_CARD",name:"하나카드(구.외환카드)",groupType:"ILK"},{payType:"CITI_CARD",name:"씨티카드(구.한미, 신세계)",groupType:"ILK"},{payType:"HANA_NOBANKBOOK",name:"하나은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"POST_NOBANKBOOK",name:"우체국 무통장입금",groupType:"NOBANKBOOK"},{payType:"KB_NOBANKBOOK",name:"국민은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"KEB_NOBANKBOOK",name:"외환은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"NONGHYUP_NOBANKBOOK",name:"농협은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"WOORI_NOBANKBOOK",name:"우리은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"SHINHAN_NOBANKBOOK",name:"신한은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"DAEGU_NOBANKBOOK",name:"대구은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"BUSAN_NOBANKBOOK",name:"부산은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"CITI_NOBANKBOOK",name:"씨티은행 무통장입금",groupType:"NOBANKBOOK"},{payType:"ACCOUNT_TRANSFER",name:"실시간계좌이체",groupType:""},{payType:"PAYCO",name:"페이코",groupType:""},{payType:"PAYNOW",name:"페이나우",groupType:""},{payType:"KAKAOPAY",name:"카카오페이",groupType:""},{payType:"SYRUPPAY",name:"11 pay",groupType:""},{payType:"NAVERPAY",name:"네이버페이",groupType:""},{payType:"MOBILE",name:"휴대폰결제",groupType:""},{payType:"REALTIME_ACCOUNT_TRANSFER",name:"실시간계좌이체",groupType:"NOBANKBOOK"},{payType:"SAMSUNGPAY",name:"삼성페이",groupType:"POLRARIS"},{payType:"NOPAY",name:"",groupType:""},{payType:"KAKAOTALKPAY",name:"카카오페이",groupType:""},{payType:"SMILEPAY",name:"스마일페이",groupType:""},{payType:"SETTLEBANK",name:"현금간편결제",groupType:""},{payType:"CARD",name:"신용카드",groupType:""},{payType:"NOBANKBOOK",name:"무통장입금",groupType:""},{payType:"REGULARPAYMENT",name:"정기결제",groupType:""}];return{isCard:e,isIspCard:t,isIlkCard:r,isPolrarisCard:o,isNobankbook:n,isNaverpay:l,isSamsungCard:i,getPayTypeName:a,getPayGroupType:d}}),define("page/cjmall/order/sheet/models/couponDetailModel",[""],function(){return Backbone.Model.extend({defaults:{},initialize:function(){}})}),define("page/cjmall/order/sheet/models/couponModel",["page/cjmall/order/sheet/collections/couponCollection"],function(e){return Backbone.Model.extend({defaults:{couponCollection:null,spCouponCollection:null},initialize:function(t){var r=this;0==_.isEmpty(t)&&r.set({couponCollection:new e(t.couponList),spCouponCollection:new e(t.spCouponList)})}})}),define("page/cjmall/order/sheet/models/customerAddressFormModel",[""],function(){return Backbone.Model.extend({defaults:{custType:"",custNo:"",custNm:"",celno1:"",celno2:"",celno3:"",passWord1:"",passWord2:""}})}),define("page/cjmall/order/sheet/models/customerAddressModel",[""],function(){return Backbone.Model.extend({defaults:{custNo:"",custNm:"",celno1:"",celno2:"",celno3:"",roadAddr:"",roadAddr1:""}})}),define("page/cjmall/order/sheet/models/cvsModel",[],function(){return Backbone.Model.extend({defaults:{storeCode:null,hoCode:null,storeAddress1:null,storeAddress2:null,zipNo:null,codeF:null,ddZone:null,ddBag:null,codePany:null,codeName:null,codeTel:null,dcrDock:null,dcName:null,dcCode:null,eupmyeon:null,transCode:null,isSuccessConvert:null,address:null,addressDetail:null,addressReference:null,roadManageKey:null,buildingManageNo:null,zipCode:null,newZipCode:null,zipNoSeq:null,newZipNoSeq:null,isRepresentJibun:null,addressType:"0",areaCls:"00"},initialize:function(e){}})}),define("page/cjmall/order/sheet/models/deliveryAddressItemModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({defaults:{id:"",addr:null,addrConvCd:null,addressType:null,areaCls:null,bef_deliv_plc_seq:null,bookmarkYn:null,cellno1:null,cellno2:null,cellno3:null,custNo:null,custNm:null,cust_no:null,ddd:null,default_yn:null,delivPlcAlias:null,deliv_info:null,deliv_plc_cls_cd:null,deliv_plc_seq:null,enm:null,fastAreaCls:null,fullAddress:null,ins_dtm:null,ins_id:null,last_use_dtm:null,latelyYn:null,mod_dtm:null,mod_id:null,newZipno:null,nm:null,post_name:null,roadAddr:null,roadAddr1:null,roadAddrRef:null,roadAddrSeq:null,roadBldDtlNm:null,roadZipCd1:null,roadZipCd2:null,roadZipno:null,roadZipnoSeq:null,rowNum:null,telno1:null,telno2:null,telno3:null,totalCount:null,use_yn:null,zipno:null,zipno_seq:null,isSelected:!1,isChecked:!1,customerHopeDate:null},url:e.get("ecBaseSslUrl")+"/c/rest/order/sheet/deliveryAddress/",initialize:function(){var e=this;e.get("nm")&&e.set("shortNm",e.get("nm").slice(0,4)),e.on("change:nm",function(){e.get("nm")&&e.set("shortNm",e.get("nm").slice(0,4))})},parse:function(e){return e.nm&&(e.shortNm=e.nm.slice(0,4)),e}})}),define("page/cjmall/order/sheet/models/deliveryGroupItemModel",["common/cjos/util/models/baseModel","page/cjmall/order/sheet/helper/fastDeliveryHelper","page/cjmall/order/sheet/models/orderSheetMainModel"],function(e,t,r){return e.extend({defaults:{multipleIndex:0,selectedAddressModel:null,deliveryPolicyModel:null,isFastChecked:!1,orderItemPriceCollection:null,jejuAddCost:0,landAddCost:0,fastDeliveryReqYn:!1,fastAddCost:0,deliveryFee:0,deliveryCouponAmt:0,deliveryCouponForm:null,groupDeliveryFee:0,deliveryCoupon:null,discountDeliveryFee:0,isCollectType:!1},initialize:function(){var e=this;e.listenTo(e,"change:deliveryCoupon",e.setDeliveryPrice)},getFastDeliveryObj:function(){var e=this;if(!0===e.get("isCollectType"))return null;var r=e.get("selectedAddressModel");if(!r)return null;var o=this.get("orderItemPriceCollection");if(o&&!o.getIsFastDeliveryAble())return null;var n=r.get("fastAreaCls"),l=e.get("deliveryPolicyModel");return new t(n,l).getFastDeliveryObj()},setDeliveryCoupon:function(){var e=this;if(0===e.get("deliveryFee"))return void e.set("deliveryCoupon",null);var t=e.get("deliveryPolicyModel").get("deliveryPrice"),o=0,n=e.get("deliveryCoupon");if(n&&0!==t){if("1"===n.dcClsCode&&(o=n.dcAmount),"2"===n.dcClsCode){var l=n.maxDcAmount,i=n.dcRate;o=99===i?t:e.cutUnderTen(t*i/100),l&&(o=o>l?l:o)}}else o=0;t-=o,r.get("orderPriceModel").get("totalOrderPriceTuple").totalDiscountDeliveryPrice=o,e.set("deliveryFee",t),e.set("discountDeliveryFee",o)},setFastDeliveryPrice:function(e){var t=this,r=t.get("deliveryPolicyModel");if(0==e)return void t.set({isFastChecked:!1,fastDeliveryReqYn:!1,fastAddCost:0});var r=t.get("deliveryPolicyModel");if(!r||!r.get("fastDeliveryAddPrice"))return void t.set({isFastChecked:!1,fastDeliveryReqYn:!1,fastAddCost:0});!0===t.get("isCollectType")&&t.set({isFastChecked:!1,fastDeliveryReqYn:!1,fastAddCost:0});var o=t.get("selectedAddressModel"),n=o.get("fastAreaCls"),l=0;switch(n){case"01":l=r.get("fastDeliveryAddPrice").capCost;break;case"02":l=r.get("fastDeliveryAddPrice").allCost;break;default:l=0}t.set({isFastChecked:!0,fastDeliveryReqYn:!0,fastAddCost:l})},setDeliveryPrice:function(e,t,r){var o=this,n=o.get("deliveryPolicyModel");if(n){var l=0,i=0,a=o.get("orderItemPriceCollection");if(!1!=!!a.length){if(a.each(function(e,t){var r=Number(e.get("selectQuantity")),o=Number(e.get("salePrice"));l+=r,i+=r*o}),0===l||!0===o.get("isCollectType"))return o.set("deliveryFee",0),o.set("groupDeliveryFee",0),o.set("jejuAddCost",0),void o.set("landAddCost",0);o.setMinordFreePrice(i,l),o.setRegionalAddPrice(),!1===n.get("lcYn")&&o.set("deliveryFee",0,r),o.setDeliveryCoupon(),o.setGroupDeliveryFee(r)}}},setMinordFreePrice:function(e,t){var r=this,o=r.get("deliveryPolicyModel");if(o&&!0!==r.get("isCollectType")){var n=o.get("minordAmount"),l=o.get("minordQuantity"),i=Number(o.get("deliveryPrice"));!0==!!n&&!1==!!l&&e>=n&&(i=0,!0),!1==!!n&&!0==!!l&&t>=l&&(i=0,!0),!0==!!n&&!0==!!l&&e>=n&&t>=l&&(i=0,!0),r.set("deliveryFee",i)}},setRegionalAddPrice:function(){var e=this,t=e.get("deliveryPolicyModel");if(!t||!0===e.get("isCollectType"))return e.set("jejuAddCost",0),void e.set("landAddCost",0);var r=e.get("selectedAddressModel");if(!r)return void cjosLogUtil.log("no selectedAddressModel",e);var o=t.get("regionalAddPrice"),n=r.get("areaCls");o&&!0===o.regional&&("01"===n?e.set("jejuAddCost",o.jejuAddCost):"02"===n&&e.set("landAddCost",o.landAddCost))},getRegionalAddPrice:function(){var e=this,t=0,r=e.get("deliveryPolicyModel");if(!r||!0===e.get("isCollectType"))return t;var o=e.get("selectedAddressModel");if(!o)return void cjosLogUtil.log("no selectedAddressModel",e);if(0===e.getGroupTotalQuantity())return t;var n=r.get("regionalAddPrice"),l=o.get("areaCls");return n&&!0===n.regional&&("01"===l?t=n.jejuAddCost:"02"===l&&(t=n.landAddCost)),t},getFastAddCost:function(){var e=this,t=0,r=e.get("deliveryPolicyModel");if(!r||!r.get("fastDeliveryAddPrice")||!0===e.get("isCollectType"))return t=0;switch(e.get("selectedAddressModel").get("fastAreaCls")){case"01":t=r.get("fastDeliveryAddPrice").capCost;break;case"02":t=r.get("fastDeliveryAddPrice").allCost;break;default:t=0}return t},setGroupDeliveryFee:function(e){var t=this,r=t.get("jejuAddCost")+t.get("landAddCost")+t.get("fastAddCost")+t.get("deliveryFee");!0==!!e?t.set("groupDeliveryFee",r,e):t.set("groupDeliveryFee",r)},setItemQuantity:function(e,t){var r=this;r.get("orderItemPriceCollection").get(e).set("selectQuantity",t),r.setDeliveryPrice()},getDeliveryFee:function(){var e=this,t=e.get("jejuAddCost")+e.get("landAddCost")+e.get("fastAddCost")+e.get("deliveryFee");return!0===e.get("isCollectType")?0:t},getGroupTotalQuantity:function(){var e=this,t=0,r=e.get("orderItemPriceCollection");return!1==!!r.length?0:(r.each(function(e,r){t+=Number(e.get("selectQuantity"))}),t)}})}),define("page/cjmall/order/sheet/models/deliveryHopeMainModel",["common/cjos/util/configUtil","page/cjmall/order/sheet/collections/venDeliveryDateCollection"],function(e,t){return Backbone.Model.extend({url:e.get("ecBaseSslUrl")+"/c/rest/order/deliveryHope",defaults:{venDeliveryDateCollection:t},initialize:function(){},parse:function(e){this.set({venDeliveryDateCollection:new t(e.jsonTuple.result)})},getHasDate:function(){var e=this,t=!1;return e.get("venDeliveryDateCollection").models&&(t=e.get("venDeliveryDateCollection").models.length>0),_.forEach(e.get("venDeliveryDateCollection").models,function(e){if(!e.get("startDate"))return t=!1,!1}),t},getVenAvailableDate:function(){var e=this,t=[],r=[],o="",n=!1;return _.forEach(e.get("venDeliveryDateCollection").models,function(e){e.get("startDate")>o&&(o=e.get("startDate")),$.merge(t,e.get("holidays").split(";")),n=e.get("sundayOff")}),r=e.createDateList(o,n),e.mergeDate(r,t),r},createDateList:function(e,t){var r=new Date(e),o=new Date(e);o.setDate(r.getDate()+30);for(var n=[],l=r,i=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};l<=o;)if(t&&0==l.getDay())l=i.call(l,1);else{var a=l.getFullYear().toString(),d=(l.getMonth()+1).toString(),s=l.getDate().toString(),c=a+(d[1]?d:"0"+d[0])+(s[1]?s:"0"+s[0]);n.push(c),l=i.call(l,1)}return n},mergeDate:function(e,t){_.forEach(t,function(t){var r=e.indexOf(t);r>-1&&e.splice(r,1)})},getSundayList:function(e,t){return""}})}),define("page/cjmall/order/sheet/models/deliveryPolicyModel",[""],function(){return Backbone.Model.extend({defaults:{isFastChecked:!1,bundleSale:!1,deliveryClassificationCode:null,deliveryCostCode:null,deliveryCostGroupCode:null,deliveryPrice:null,deliveryType:null,fastDeliveryAddPrice:null,freeDelivery:null,groupDeliveryPrice:null,minordAmount:null,minordQuantity:null,regionalAddPrice:null,totalQuantity:null,totalSalePrice:null,unitCodeList:null,itemCode:null,lcYn:null,exchangeCost:null,returnCost:null,nonCancelYn:null,nonReturnYn:null,nevExchangeYn:null,incomeDedYn:null},initialize:function(){}})}),define("page/cjmall/order/sheet/models/discountDetailModel",[""],function(){return Backbone.Model.extend({defaults:{category:"",type:"",title:"",discountPrice:0,discountRate:0},initialize:function(e){}})}),define("page/cjmall/order/sheet/models/discountPriceModel",["page/cjmall/order/sheet/collections/discountDetailCollection","page/cjmall/order/sheet/models/couponModel"],function(e,t){return Backbone.Model.extend({defaults:{customerPrice:0,totalDiscountPrice:0,discountDetailCollection:new e,couponModel:t},initialize:function(r){var o=this;r&&o.set({discountDetailCollection:new e(r.discountDetails),couponModel:new t(r.couponTuples)})}})}),define("page/cjmall/order/sheet/models/ispCertificationModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({defaults:{certificationComplete:!1,certificationStep:null},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/isp?tid="+t},parse:function(e){var t=this;0!==e.jsonTuple.code&&e.jsonTuple.result&&t.set({certificationStep:e.jsonTuple.result})}})}),define("page/cjmall/order/sheet/models/kakaotalkpayCertainModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({defaults:{pgToken:"",taxfreeAmount:0,tid:"",totalAmount:0},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/kakaotalkpay?preOrdNo="+t},parse:function(e){var t=this,r=e.jsonTuple;0!==r.code&&r.result&&t.set({pgToken:r.result.pgToken,taxfreeAmount:r.result.taxfreeAmount,tid:r.result.tid,totalAmount:r.result.totalAmount})}})}),define("page/cjmall/order/sheet/models/naverpayCertainModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({defaults:{paymentId:"",taxAmt:0,taxExAmt:0,totalPaymentAmt:0},initialize:function(t){this.url=e.get("ecBaseSslUrl")+"/c/rest/order/preOrderInfo/naverpay?preOrdNo="+t},parse:function(e){var t=this,r=e.jsonTuple;0!==r.code&&r.result&&t.set({paymentId:r.result.paymentId,taxAmt:r.result.taxAmt,taxExAmt:r.result.taxExAmt,totalPaymentAmt:r.result.totalPayAmt})}})}),define("page/cjmall/order/sheet/model/noMemberOrdererModel",[],function(){return Backbone.Model.extend({initialize:function(){}})}),define("page/cjmall/order/sheet/models/orderAddressModel",["common/cjos/util/configUtil","page/cjmall/order/sheet/models/deliveryAddressItemModel"],function(e,t){return Backbone.Model.extend({usr:"",defaults:{orderSheetType:"",orderAddressType:"",basicAddressModel:t,latelyAddressModel:t,isSafeDeliveryChecked:!1,isConvenience:!1,isWomanSafe:!1,selectedAddressModel:null,orderDeliveryType:"",customerAddressForm:{},receiverCvsForm:{},receiverAddressForms:[]},initialize:function(r){var o=this;_.isNull(r)||_.isUndefined(r)?o.set({orderSheetType:e.get("orderSheetType")}):o.set({orderSheetType:e.get("orderSheetType"),orderAddressType:r.orderAddressType,basicAddressModel:new t(r.basicAddressTuple),latelyAddressModel:new t(r.latelyAddressTuple)})}})}),define("page/cjmall/order/sheet/models/orderBenefitModel",["common/cjos/util/currencyUtil"],function(e){return Backbone.Model.extend({SAVED_MONEY:"SavedMoney",CJ_GIFTCARD_AMOUNT:"CjGiftCardAmount",CJONE_POINT:"CjonePoint",CJ_GIFT_AMOUNT:"CjGiftAmount",DEPOSIT_AMOUNT:"DepositAmount",CULTURELAND:"CulturelandAmount",HAPPYMONEY:"HappyMoneyAmount",BOOKNLIFE:"BooknLifeAmount",CAFETERIA_POINT:"CafeteriaPoint",OTOUR_CAFETERIA_POINT:"OtourCafeteriaPoint",HISTORY:"history",defaults:{usedSavedMoney:!1,usedCjonePoint:!1,usedCafeteriaPoint:!1,usedCultureLandAmount:!1,usedHappyMoneyAmount:!1,usedBooknLifeAmount:!1,usedBooknLifeAmount:!1,usedOtourCafeteriaPoint:!1,usedCjGiftCardNamed:!1,usedCjGiftCardNonNamed:!1,usedCjGiftCardAmount:!1,savedMoney:0,cjGiftCardAmount:0,depositAmount:0,cjonePoint:0,cafeteriaPoint:0,otourCafeteriaPoint:0,cjGiftAmount:0,cjoneEssetialPoint:0,culturelandAmount:0,happyMoneyAmount:0,booknLifeAmount:0,culturelandResHeadNo:"",culturelandCustId:"",happyMoneyEncodeData:"",cjGiftCardNo:"",cjGiftCardPinNo:"",cjGiftCardBtnCtr:"",_culturelandId:"",_culturelandPassword:"",_booknLifeId:"",_booknLifePassword:"",_totalAmount:0,_useSavedMoney:0,_useCjGiftCardAmount:0,_useCjonePoint:0,_useCjGiftAmount:0,_useDepositAmount:0,_useCafeteriaPoint:0,_useOtourCafeteriaPoint:0,_useSalarySubtractAmount:0,_useCompanySupportAmount:0,_useConvertCateferiaPoint:0,_useCulturelandAmount:0,_useHappyMoneyAmount:0,_useBooknLifeAmount:0,_paymentAmount:0,_history:[],appType:""},initialize:function(){var e=this;e.on("invalid",function(e,t){alert(t)}),e.on("change:_useSavedMoney",function(e,t,r){var o=this;0===o.get("_useSavedMoney")&&(tempHIstoryArray=o.deleteHistory(o.SAVED_MONEY)),0!=r.history&&o.get("_useSavedMoney")>0&&(tempHIstoryArray=o.deleteHistory(o.SAVED_MONEY),tempHIstoryArray.push(o.SAVED_MONEY),o.set("_history",tempHIstoryArray))}),e.on("change:_useCjGiftCardAmount",function(e,t,r){var o=this;0===o.get("_useCjGiftCardAmount")&&(tempHIstoryArray=o.deleteHistory(o.CJ_GIFTCARD_AMOUNT)),0!=r.history&&o.get("_useCjGiftCardAmount")>0&&(tempHIstoryArray=o.deleteHistory(o.CJ_GIFTCARD_AMOUNT),tempHIstoryArray.push(o.CJ_GIFTCARD_AMOUNT),o.set("_history",tempHIstoryArray))}),e.on("change:_useCjonePoint",function(e,t,r){var o=this;0===o.get("_useCjonePoint")&&(tempHIstoryArray=o.deleteHistory(o.CJONE_POINT)),0!=r.history&&o.get("_useCjonePoint")>0&&(tempHIstoryArray=o.deleteHistory(o.CJONE_POINT),tempHIstoryArray.push(o.CJONE_POINT),o.set("_history",tempHIstoryArray))}),e.on("change:_useCjGiftAmount",function(e,t,r){var o=this;0===o.get("_useCjGiftAmount")&&(tempHIstoryArray=o.deleteHistory(o.CJ_GIFT_AMOUNT)),0!=r.history&&o.get("_useCjGiftAmount")>0&&(tempHIstoryArray=o.deleteHistory(o.CJ_GIFT_AMOUNT),tempHIstoryArray.push(o.CJ_GIFT_AMOUNT),o.set("_history",tempHIstoryArray))}),e.on("change:_useDepositAmount",function(e,t,r){var o=this;0===o.get("_useDepositAmount")&&(tempHIstoryArray=o.deleteHistory(o.DEPOSIT_AMOUNT)),0!=r.history&&o.get("_useDepositAmount")>0&&(tempHIstoryArray=o.deleteHistory(o.DEPOSIT_AMOUNT),tempHIstoryArray.push(o.DEPOSIT_AMOUNT),o.set("_history",tempHIstoryArray))}),e.on("change:_useCafeteriaPoint",function(e,t,r){var o=this;0===o.get("_useCafeteriaPoint")&&(tempHIstoryArray=o.deleteHistory(o.CAFETERIA_POINT)),0!=r.history&&o.get("_useCafeteriaPoint")>0&&(tempHIstoryArray=o.deleteHistory(o.CAFETERIA_POINT),tempHIstoryArray.push(o.CAFETERIA_POINT),o.set("_history",tempHIstoryArray))}),e.on("change:_useCulturelandAmount",function(e,t,r){var o=this;0===o.get("_useCulturelandAmount")&&(tempHIstoryArray=o.deleteHistory(o.CULTURELAND)),0!=r.history&&o.get("_useCulturelandAmount")>0&&(tempHIstoryArray=o.deleteHistory(o.CULTURELAND),tempHIstoryArray.push(o.CULTURELAND),o.set("_history",tempHIstoryArray))}),e.on("change:_useBooknLifeAmount",function(e,t,r){var o=this;0===o.get("_useBooknLifeAmount")&&(tempHIstoryArray=o.deleteHistory(o.BOOKNLIFE)),0!=r.history&&o.get("_useBooknLifeAmount")>0&&(tempHIstoryArray=o.deleteHistory(o.BOOKNLIFE),tempHIstoryArray.push(o.BOOKNLIFE),o.set("_history",tempHIstoryArray))}),e.on("change:_useHappyMoneyAmount",function(e,t,r){var o=this;cjosLogUtil.log("change _useHappyMoneyAmount : "+o.get("_useHappyMoneyAmount")),0===o.get("_useHappyMoneyAmount")&&(tempHIstoryArray=o.deleteHistory(o.HAPPYMONEY)),0!=r.history&&o.get("_useHappyMoneyAmount")>0&&(tempHIstoryArray=o.deleteHistory(o.HAPPYMONEY),tempHIstoryArray.push(o.HAPPYMONEY),o.set("_history",tempHIstoryArray))}),e.on("change:_useOtourCafeteriaPoint",function(e,t,r){var o=this;0===o.get("_useOtourCafeteriaPoint")&&(tempHIstoryArray=o.deleteHistory(o.OTOUR_CAFETERIA_POINT)),0!=r.history&&o.get("_useOtourCafeteriaPoint")>0&&(tempHIstoryArray=o.deleteHistory(o.OTOUR_CAFETERIA_POINT),tempHIstoryArray.push(o.OTOUR_CAFETERIA_POINT),o.set("_history",tempHIstoryArray))})},deleteHistory:function(e){var t=this,r=t.get("_history"),o=r.indexOf(e);return o>-1&&r.splice(o,1),r},validate:function(t,r){cjosLogUtil.log("++++ orderBenefitModel.validate() start ++++++");var o=this;return t._useSavedMoney>t.savedMoney?"적립금은 최대 "+e.wonFloor(t.savedMoney)+"원 까지 사용가능합니다.":t._useCjonePoint>t.cjonePoint?"CJONE포인트 사용금액은"+e.wonFloor(t.cjonePoint)+"포인트까지 사용가능합니다.":t._useCjGiftAmount>t.cjGiftAmount?"상품권은 "+e.wonFloor(t.cjGiftAmount)+"원 까지 사용가능합니다.":t._useDepositAmount>t.depositAmount?"예치금은 "+e.wonFloor(t.depositAmount)+"원까지 사용가능합니다.":t._useCafeteriaPoint>0&&t._useCafeteriaPoint<500?"카페테리아 최소 사용금액은 500원 입니다.":o.convertWonToCafeteriaPoint(t._useCafeteriaPoint)>t.cafeteriaPoint?"카페테리아 포인트는 "+e.wonFloor(t.cafeteriaPoint)+"포인트 까지 사용가능합니다.":t._useCulturelandAmount>t.culturelandAmount?"컬쳐캐시는 "+e.wonFloor(t.culturelandAmount)+"원까지 사용가능합니다.":t._useCulturelandAmount>0&&t._useCulturelandAmount<10?"컬쳐랜드 사용금액은 10원 이상부터 사용 가능합니다.":t._useBooknLifeAmount>t.booknLifeAmount?"북앤캐시는 "+e.wonFloor(t.booknLifeAmount)+"원까지 사용가능합니다.":t._useBooknLifeAmount>0&&t._useBooknLifeAmount<10?"북앤캐시 사용금액은 10원 이상부터 사용 가능합니다.":t._useHappyMoneyAmount>0&&t._useHappyMoneyAmount<10?"해피머니 사용금액은 10원 이상부터 사용 가능합니다.":t._useCjGiftCardAmount>t.cjGiftCardAmount?"CJ기프트카드는 "+e.wonFloor(t.cjGiftCardAmount)+"원까지 사용가능합니다.":$.isNumeric(t._useSavedMoney)&&$.isNumeric(t._useCjonePoint)&&$.isNumeric(t._useCjGiftAmount)&&$.isNumeric(t._useDepositAmount)&&$.isNumeric(t._useCafeteriaPoint)&&$.isNumeric(t._useBooknLifeAmount)&&$.isNumeric(t._useHappyMoneyAmount)&&$.isNumeric(t._useCjGiftCardAmount)?t._useSavedMoney<0||t._useCjonePoint<0||t._useCjGiftAmount<0||t._useDepositAmount<0||t._useCafeteriaPoint<0||t._useBooknLifeAmount<0||t._useHappyMoneyAmount<0||t._useCjGiftCardAmount<0?"음수값은 입력할 수 없습니다.":void 0:"숫자로만 입력해 주세요."},getAvaliableSavedMoney:function(){return this.getAvaliable(this.get("savedMoney"))},getAvaliableCjGiftCardAmount:function(){return this.getAvaliable(this.get("cjGiftCardAmount"))},getAvaliableCjonePoint:function(){return this.getAvaliable(this.get("cjonePoint"))},getAvaliableCjGiftAmount:function(){return this.getAvaliable(this.get("cjGiftAmount"))},getAvaliableDepositAmount:function(){return this.getAvaliable(this.get("depositAmount"))},getAvaliableCafeteriaPoint:function(){var e=this;return e.getAvaliable(e.convertCafeteriaPointToWon(e.get("cafeteriaPoint")))},getAvaliableCulturelandAmount:function(e){var t=this,r=t.get("culturelandAmount");return e>r&&(e=r),t.getAvaliable(e)},getAvaliableBooknLifeAmount:function(e){var t=this,r=t.get("booknLifeAmount");return cjosLogUtil.log("booknLifeAmount : "+r),e>r&&(e=r),t.getAvaliable(e)},getAvaliableHappyMoneyAmount:function(e){var t=this,r=t.get("happyMoneyAmount");return cjosLogUtil.log("happyMoneyAmount : "+r),e>r&&(e=r),t.getAvaliable(e)},getAvaliable:function(t){var r=this,o=0,n=r.get("_totalAmount");return o=t>n?n:t,e.wonFloor(o)},initBenefitAmount:function(){var e=this,t=e.get("_paymentAmount"),r=e.get("_history");t<0&&_.forEach(r,function(r,o){var n=e.get("_use"+r);n+t>0?e.set("_use"+r,n+t,{history:!1}):e.set("_use"+r,0),t=e.get("_totalAmount")-e.get("_useSavedMoney")-e.get("_useCjGiftCardAmount")-e.get("_useCjonePoint")-e.get("_useCjGiftAmount")-e.get("_useDepositAmount")-e.get("_useCafeteriaPoint")-e.get("_useCulturelandAmount")-e.get("_useBooknLifeAmount")-e.get("_useHappyMoneyAmount")-e.get("_useOtourCafeteriaPoint")-e.get("_useSalarySubtractAmount")-e.get("_useCompanySupportAmount")})},convertWonToCafeteriaPoint:function(e){var t=parseInt(e/1e3);return e%1e3>=500&&(t+=1),t},convertCafeteriaPointToWon:function(e){return 1e3*e},getUseCafeteriaPoint:function(){var e=this;return e.convertWonToCafeteriaPoint(e.get("_useCafeteriaPoint"))},isUsedAllBenefit:function(){var e=this;return e.get("usedSavedMoney")||e.get("usedDepositAmount")||e.get("usedCjonePoint")||e.get("usedCjGiftAmount")||e.get("usedCafeteriaPoint")||e.get("usedOtourCafeteriaPoint")||e.get("usedCjGiftCardAmount")},sumTotalBenefitAmount:function(){var e=this;return e.get("_useSavedMoney")+e.get("_useDepositAmount")+e.get("_useCjonePoint")+e.get("_useCjGiftAmount")+e.get("_useCafeteriaPoint")+e.get("_useCulturelandAmount")+e.get("_useBooknLifeAmount")+e.get("_useHappyMoneyAmount")+e.get("_useOtourCafeteriaPoint")+e.get("_useSalarySubtractAmount")+e.get("_useCompanySupportAmount")+e.get("_useCjGiftCardAmount")}})}),define("page/cjmall/order/sheet/models/orderCashReceiptModel",[""],function(){return Backbone.Model.extend({DEDUCT:"DEDUCT",EVIDENCE:"EVIDENCE",BIZ:"BIZ",PHONE:"PHONE",CARD_NO:"CARD_NO",CASH_RECEIPT_CARD_NO:"CASH_RECEIPT_CARD_NO",defaults:{orderCashReceiptIssueUseType:"",orderCashReceiptIssueWayType:"",issueNo:""},validate:function(e,t){}})}),define("page/cjmall/order/sheet/models/orderCertainFormModel",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/collections/orderItemCertainFormCollection","page/cjmall/order/sheet/models/orderItemCertainFormModel","page/cjmall/order/sheet/collections/deliveryAddressCollection","page/cjmall/order/sheet/models/orderPersonalCertainModel","page/cjmall/order/sheet/helper/payTypeHelper","common/cjos/logger/utils/loggerUtil","common/cjos/logger/models/fdsConstantsModel","page/cjmall/order/payment/helper/paymentHelper"],function(e,t,r,o,n,l,i,a,d,s){return Backbone.Model.extend({url:e.get("ecBaseSslUrl")+"/c/rest/order/certain",arrGroupDeliveryKey:[],defaults:{payType:"",tempOrderNo:"",orderItemCertainForms:""},submit:function(e,t,r){var o,n=this,i=e.get("orderSheetType");try{o="REGULAR_PAYMENT"==i?n.convertOrderCertainFormForRegulayPayment(e):n.convertOrderCertainForm(e)}catch(d){e.set("isProgress",!1),cjosLogUtil.log("[orderCertainForm set]",d)}if(!1===o)return void e.set("isProgress",!1);var a=new l;!1!==a.isSimpleAccountOrderable()&&a.callPersonalCertain(function(l){o.personalCertainForm=l,e.set("isProgress",!0),n.callOrderCertain(o,t,e,r)})},callOrderCertain:function(e,r,o,n){var l=this;l.ajax=Backbone.ajax({url:l.url,method:"POST",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(e),xhrFields:{withCredentials:!0},success:function(e,l,i){if(1===e.code)r(e,n);else{var a=window._paymentPopup;if(null!=a&&void 0!==a&&a.close(),e.resMsg){var d=e.resMsg;e.description&&(d=d+"\n"+e.description),alert(d),o.set("isProgress",!1),"MSG_ORDCHK_VAL_028"===e.resCode&&location.replace(("p"===t.get(t.APPLICATION_TYPE)?"/p":"/m")+"/cart")}}},error:function(e,t,r){cjosLogUtil.log(t),console.log(e),o.set("isProgress",!1);var n=window._paymentPopup;null!=n&&void 0!==n&&n.close(),alert("결제관련 통신이 원활하지 않습니다. 다시 시도해주시고 동일한 현상이 계속 발생시 고객센터로 문의해주세요.(CJmall 고객센터 1644-2525)")},complete:function(e,t,r){}})},convertOrderCertainForm:function(t){var r,o=this,n=t.get("orderSheetType"),l=t.get("orderAddressModel").get("isMultiple");if("NON_CUSTOMER"===n&&!1===(r=o.getOrderNoMemberInfoForm(t)))return!1;var i=o.getOrderDeliveryAddressForms(t);if(!1===i)return!1;var a=o.getOrderDeliveryAddressCvsForm(t);if(!1===a)return!1;var d=o.getOrderDeliveryAddressWomanSafeForm(t);if(!1===d)return!1;var s=o.getOrderTourlistInformationForms(t);if(!1===s)return!1;var c=o.getOrderItemCertainForms(t);if(!1===c)return!1;var u=o.getOrderEtcForm(t);if(!1===u)return!1;var p=o.getOrderPaymentForm(t);if(!1===p)return!1;var m=o.getOrderBenefitForms(t);if(!1===m)return!1;if(l){var f=o.mergeMultipleOrderItems(i,c);i=f.orderDeliveryAddressForms,c=f.orderItemCertainForms}var g=o.getOrderPresentDeliveryForm(t);if(!1===g)return!1;var v=o.getOrderEcouponDeliveryForm(t);if(!1===v)return!1;var y=o.getOrderDoorPasswordForm(t);if(!1===y)return!1;var h=o.getOrderTourItemInfoForm(t);if(!1===h)return!1;var f={payType:t.get("orderPaymentModel").get("_payType"),tempOrderNo:e.get("tempOrderNo"),orderPaymentForm:p,orderBenefitForms:m,orderItemCertainForms:c,orderDeliveryAddressForms:!0==!!i?i:null,orderDeliveryAddressCvsForm:!0==!!a?a:null,orderTouristInformationForms:!0==!!s?s:null,orderDeliveryAddressWomanSafeForm:!0==!!d?d:null,orderEtcForm:u,orderPresentDeliveryForm:!0==!!g?g:null,orderEcouponDeliveryForm:!0==!!v?v:null,orderDoorPasswordForm:!0==!!y?y:null,orderTourItemInfoForm:!0==!!h?h:null,payProcType:"ORDER_PAYMENT"};"NON_CUSTOMER"===n&&(f.orderNoMemberInfoForm=r);var _=o.getOrderCashReceiptForm(t);if(_){if(!1===o.isOrderCashReceiptFormValidation(_))return!1;f.orderCashReceiptForm=_}return f},convertOrderCertainFormForRegulayPayment:function(t){var r=this,o=(t.get("orderSheetType"),r.getOrderDeliveryAddressForms(t));if(!1===o)return!1;var n=r.getOrderItemCertainForms(t);if(!1===n)return!1;var l=r.getOrderRegularPaymentForm(t);if(!1===l)return!1;var i=r.getRegularPaymentAgree(t);return 0!=i&&{payType:t.get("orderRegularPaymentModel").get("_payType"),tempOrderNo:e.get("tempOrderNo"),orderPaymentForm:l,orderBenefitForms:[],orderItemCertainForms:n,orderDeliveryAddressForms:!0==!!o?o:null,orderDeliveryAddressCvsForm:null,orderTouristInformationForms:null,orderDeliveryAddressWomanSafeForm:null,orderEtcForm:i,orderPresentDeliveryForm:null,orderEcouponDeliveryForm:null,orderDoorPasswordForm:null,payProcType:"ORDER_PAYMENT"}},isOrderCashReceiptFormValidation:function(e){if(""===e.orderCashReceiptIssueWayType)return alert("현금영수증발급방식 항목은 필수 입력입니다."),!1;if(null!=e.orderCashReceiptIssueUseType){
if(""===e.issueNo)return alert("현금영수증발급번호 항목은 필수 입력입니다."),!1;var t=window._cjmallOrderValidator;if(!0===t.isHasSpecialChar(e.issueNo)||!1===t.isNumber(e.issueNo)||e.issueNo.length<10)return alert("현금영수증 발행정보를 정확하게 입력해 주세요"),!1}return!0},mergeMultipleOrderItems:function(e,t){var r=[],o=[];return _.forEach(e,function(e){_.forEach(e.deliveryGroupOrderItems,function(e,o){var n=e.unitCode,l=_.findWhere(t,{unitCode:n});e.orderDeliveryFeeForm.orderItemDeliveryCostForm=l.orderDeliveryFeeForm.orderItemDeliveryCostForm;var i=_.extend(l,e);r.push($.extend(!0,{},i))}),o.push(e.deliveryAddressData)}),{orderDeliveryAddressForms:o,orderItemCertainForms:r}},getGiftItemForms:function(e){var t=[],r=e.get("totalGiftTuples");return _.each(r,function(e,r){if(e.tpromofferEntityKey){var o={promotionNo:e.tpromofferEntityKey.promNo,promotionSeq:e.tpromofferEntityKey.promSeq,offerSeq:e.tpromofferEntityKey.offerSeq,giftcartSeq:e.giftcartSeq,itemCode:e.giftItemCode,channelCode:e.channelCode,unitCode:e.giftUnitCode,quantity:e.payQty};t.push(o)}}),t},getPackItemForms:function(e){var t=[],r=e.get("packUnitItemTuples");return _.each(r,function(e,r){var o={itemSequence:e.itemSequence,unitSequence:e.unitSequence,configItemCode:e.configItemCode,configUnitCode:e.unitItemCode};t.push(o)}),t},getDiscountInfo:function(e){var t=0,r=0,o=0;return e.get("discountPriceModel").get("discountDetailCollection").each(function(e,n){var l=e.get("category");"EMPLOYEE"==l&&(t=e.get("discountPrice")),"VIP"==l&&(r=e.get("discountPrice")),"LUMP_SUM"==l&&(o=e.get("discountPrice"))}),{cjMemberDiscountAmount:t,vipDiscountAmount:r,norestDiscountAmount:o}},getOrderDeliveryFeeForm:function(e,t){var r=this,o={};return e.get("deliveryPolicyCollection").each(function(e,n){if(t==e.get("deliveryCostGroupCode")){var l=r.checkFirstGroupDelivery(t),i=0;l&&(i=e.get("groupDeliveryPrice")),o={jejuAddCost:0,islandAddCost:0,fastDeliveryReqYn:!1,fastAddCost:0,deliveryFee:i,deliveryCouponAmt:0,deliveryCouponForm:null}}}),o},getOrderBenefitForms:function(e){return e.get("orderBenefitModel").get("getOrderBenefitFormsCallback")?e.get("orderBenefitModel").get("getOrderBenefitFormsCallback")()||!1:null},getOrderPresentDeliveryForm:function(e){return e.get("orderPresentDeliveryModel").get("getPresentDeliveryDataCallback")?e.get("orderPresentDeliveryModel").get("getPresentDeliveryDataCallback")()||!1:null},getOrderEcouponDeliveryForm:function(e){return e.get("orderEcouponDeliveryModel").get("getEcouponDeliveryDataCallback")?e.get("orderEcouponDeliveryModel").get("getEcouponDeliveryDataCallback")()||!1:null},getOrderDoorPasswordForm:function(e){return e.get("orderDoorPasswordModel").get("getOrderDoorPasswordDataCallback")?e.get("orderDoorPasswordModel").get("getOrderDoorPasswordDataCallback")()||!1:null},checkFirstGroupDelivery:function(e){var t=this;return-1==$.inArray(e,t.arrGroupDeliveryKey)&&(t.arrGroupDeliveryKey.push(e),!0)},callSubmit:function(e){var t=this,r={};t.ajax=Backbone.ajax({url:t.url,async:!1,method:"POST",dataType:"json",contentType:"application/json;charset=utf-8",xhrFields:{withCredentials:!0},data:JSON.stringify(t),success:function(t,o,n){r=t,e(r)}})},getOrderTourlistInformationForms:function(e){return e.get("orderTourlistModel").get("getTravelerInfomationCallback")?e.get("orderTourlistModel").get("getTravelerInfomationCallback")()||!1:null},getOrderNoMemberInfoForm:function(e){return e.get("orderNoMemberModel").get("getNoMemberInfomationCallback")?e.get("orderNoMemberModel").get("getNoMemberInfomationCallback")()||!1:null},getOrderDeliveryAddressCvsForm:function(e){return e.get("orderAddressModel").get("getAddressCvsDataCallback")?e.get("orderAddressModel").get("getAddressCvsDataCallback")()||!1:null},getOrderDeliveryAddressWomanSafeForm:function(e){return e.get("orderAddressModel").get("getAddressSafeDelivDataCallback")?e.get("orderAddressModel").get("getAddressSafeDelivDataCallback")()||!1:null},getOrderDeliveryAddressForms:function(e){var t;if(e.get("orderAddressModel").get("getAddressDataCallback")){if(!0==!!(t=e.get("orderAddressModel").get("getAddressDataCallback")())){if(_.size(t)>1){var r=0,o=[];return _.forEach(t,function(e){if(e.deliveryAddressData&&e.deliveryGroupOrderItems){var t=_.size(e.deliveryGroupOrderItems);if(t>0){e.deliveryAddressData.deliveryIndex=r;for(var n=0;n<t;n++)e.deliveryGroupOrderItems[n].deliveryIndex=r;o.push(e),r++}}}),o}return t}return!1}return null},getOrderItemCertainForms:function(e){var t;if(e.get("orderPriceModel").get("getOrderItemDataCallback")){if(!1===(t=e.get("orderPriceModel").get("getOrderItemDataCallback")()))return;return _.each(t,function(t,r){var o=t.packItemForms,n=t.itemCode,l=[];_.size(o)>0?(_.each(o,function(t,r){var o=t.configItemCode;_.each(e.get("orderItemDeliveryCollection").models,function(e,t){if(o===e.get("itemCode")){var r={itemCode:e.get("itemCode"),lcYn:e.get("lcYn"),delivClsCode:e.get("deliveryClassificationCode"),delivCostCode:e.get("deliveryCostCode"),delivCostType:e.get("deliveryType"),minOrdAmount:e.get("minordAmount"),minOrdQty:e.get("minordQuantity"),deliveryCost:e.get("deliveryPrice"),exchangeCost:e.get("exchangeCost"),returnCost:e.get("returnCost"),jejuAddCost:e.get("regionalAddPrice").jejuAddCost,islandAddCost:e.get("regionalAddPrice").landAddCost,nonCancelYn:e.get("nonCancelYn"),nonReturnYn:e.get("nonReturnYn"),nevExchangeYn:e.get("nevExchangeYn"),incomeDedYn:e.get("incomeDedYn")};l.push(r)}})}),(_.isUndefined(t.orderDeliveryFeeForm.orderItemDeliveryCostForm)||_.isEmpty(t.orderDeliveryFeeForm.orderItemDeliveryCostForm))&&(t.orderDeliveryFeeForm.orderItemDeliveryCostForm={}),t.orderDeliveryFeeForm.orderItemDeliveryCostForm.packItemDeliveryCostForms=l):_.each(e.get("orderItemDeliveryCollection").models,function(e,r){if(n===e.get("itemCode")){var o={itemCode:e.get("itemCode"),lcYn:e.get("lcYn"),delivClsCode:e.get("deliveryClassificationCode"),delivCostCode:e.get("deliveryCostCode"),delivCostType:e.get("deliveryType"),minOrdAmount:e.get("minordAmount"),minOrdQty:e.get("minordQuantity"),deliveryCost:e.get("deliveryPrice"),exchangeCost:e.get("exchangeCost"),returnCost:e.get("returnCost"),jejuAddCost:e.get("regionalAddPrice").jejuAddCost,islandAddCost:e.get("regionalAddPrice").landAddCost,nonCancelYn:e.get("nonCancelYn"),nonReturnYn:e.get("nonReturnYn"),nevExchangeYn:e.get("nevExchangeYn"),incomeDedYn:e.get("incomeDedYn")};t.orderDeliveryFeeForm.orderItemDeliveryCostForm=o}})}),t||!1}return null},getOrderEtcForm:function(e){return e.get("orderPaymentModel").get("getOrderEtcFormCallback")?e.get("orderPaymentModel").get("getOrderEtcFormCallback")()||!1:null},getOrderCashReceiptForm:function(e){return e.get("orderPaymentModel").get("getOrderCashReceiptFormCallback")?e.get("orderPaymentModel").get("getOrderCashReceiptFormCallback")()||!1:null},getOrderPaymentForm:function(e){return e.get("orderPaymentModel").get("getOrderPaymentFormCallback")?e.get("orderPaymentModel").get("getOrderPaymentFormCallback")()||!1:null},getOrderRegularPaymentForm:function(e){return e.get("orderRegularPaymentModel").get("getOrderRegularPaymentFormCallback")?e.get("orderRegularPaymentModel").get("getOrderRegularPaymentFormCallback")()||!1:null},getRegularPaymentAgree:function(e){return e.get("orderRegularPaymentModel").get("getRegularPaymentAgreeCallback")?e.get("orderRegularPaymentModel").get("getRegularPaymentAgreeCallback")()||!1:null},getOrderTourItemInfoForm:function(e){if(e.get("orderTourItemInfoModel").get("getTourItemInfoCallBack"))return e.get("orderTourItemInfoModel").get("getTourItemInfoCallBack")()||!1},trackEventCheckoutTry:function(t){var r=this;try{var o=d.EVENT.CATE_CD.checkout,n=d.EVENT.DETAIL_CD.checkout_try,l={tr_tt:r.getFdsTotalPrice(t),tr_idt:e.get("tempOrderNo"),ti_sk:r.getFdsItems(t),tr:r.getFdsDelivery(t),p_mp:r.getFdsPaymentMethodPrice(t),p_crd:r.getFdsPaymentCard(t),p_bnk:r.getFdsPaymentBank(t),p_mbl:r.getFdsPaymentMobile(t),p_cr:r.getFdsPaymentCashReceipt(t)},i={cateCd:o,detailCd:n,data:l};a.sendFdsTrackEventLogData(i)}catch(s){cjosLogUtil.log("trackEventPurchase() error!!"),cjosLogUtil.log(s.message)}},getFdsTotalPrice:function(e){return e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice},getFdsItems:function(e){var t=this,r=new Array,o=t.getOrderItemCertainForms(e);return o&&_.each(o,function(e,t){var o=0,n=new Array,l=e.packItemForms;if(l)o=1,_.each(l,function(e,t){var r={option_name:e.packUnitName,option_value:e.configUnitCode};n.push(r)});else{var i={option_name:e.unitName,option_value:e.unitCode};n.push(i)}var a=new Array,d=e.orderCouponForm;if(d){var s={item_coupon_uid:d.offerCode,dcissue_seq:d.giveSeq,item_coupon_price:d.dcAmount};a.push(s)}var c=e.orderSpCouponForm;if(c){var s={item_coupon_uid:c.offerCode,dcissue_seq:c.giveSeq,item_coupon_price:c.dcAmount};a.push(s)}var u=new Array,p=e.giftItemForms;p&&_.each(p,function(e,t){item_promotion_etc_type="ONE_GIFT";var r={item_promotion_code:e.promotionNo,item_promotion_etc_type:item_promotion_etc_type,item_promotion_item_cd:e.itemCode,item_promotion_unit_cd:e.unitCode};u.push(r)});var m="";e.itemTypeCode&&(m=e.itemTypeCode.substring(0,2));var f=0;e.cjMemberDiscountAmount&&(f=e.cjMemberDiscountAmount);var g=0;e.vipDiscountAmount&&(g=e.vipDiscountAmount);var v=0;e.arsDiscountAmount&&(v=e.arsDiscountAmount);var y=0;e.lumpSavePointDcAmount&&(y=e.lumpSavePointDcAmount);var h={chn_cd:e.channelCode,shop_id:e.shopId,mo_cd:e.moCode,item_cate:m,item_id:e.itemCode,item_name:e.itemName,item_price:e.salePrice,item_count:e.quantity,cj_member_dc_amt:f,vip_dc_amt:g,lp_ars_dc_amt:v,lp_saveamt_dc_amt:y,pack_yn:o,item_option:n,item_coupon:a,item_promotion:u};r.push(h)}),r},getFdsDelivery:function(e){var t=this,r=new Array,o=new Array,n=0,l=0,i=0,a=0,d=0,s=0,c=t.getOrderItemCertainForms(e);c&&_.each(c,function(e,t){var s={item_id:e.itemCode,item_count:e.quantity,item_option_value:e.unitCode};r.push(s);var c=e.orderDeliveryFeeForm;if(c){n=c.deliveryFee,l=c.islandAddCost,i=c.jejuAddCost,a=c.fastAddCost,d=c.deliveryCouponAmt;var u=c.orderDeliveryFeeForm;if(u){var p={deliv_dc_offer:u.offerCode,deliv_dc_giveseq:u.giveSeq,deliv_coupon_amt:d};o.push(p)}}}),s=n+l+i+a-d;var u="",p="",m="",f="",g=t.getOrderDeliveryAddressForms(e);return g&&_.each(g,function(e,t){0==t&&(u=e.telno2,p=e.cellno3,m=e.zipno,f=e.roadAddr1?e.roadAddr1:e.post_name)}),[{item:r,shipping:s,shipping_dtl:{total_cost_amt:n,total_island_add_cost_amt:l,total_jeju_add_cost_amt:i,total_fast_add_cost_amt:a},shipping_coupon:o,recv_telno:u,recv_celno:p,zipcode:m,addr1:f}]},getFdsPaymentMethodPrice:function(e){var t=this,r=new Array,o=e.get("orderPaymentModel").get("_payType"),n=e.get("orderBenefitModel");if(n){if(n.get("_useSavedMoney")>0){var l=n.get("_useSavedMoney"),a=n.get("savedMoney"),d=a-l;r.push(t.getCheckoutPaymentData("05","적립금",l,a,d))}if(n.get("_useDepositAmount")>0){var l=n.get("_useDepositAmount"),a=n.get("depositAmount"),d=a-l;r.push(t.getCheckoutPaymentData("06","예치금",l,a,d))}if(n.get("_useCjGiftAmount")>0){var l=n.get("_useCjGiftAmount"),a=n.get("cjGiftAmount"),d=a-l;r.push(t.getCheckoutPaymentData("10","CJ상품권",l,a,d))}if(n.get("_useCjonePoint")>0){var l=n.get("_useCjonePoint"),a=n.get("cjonePoint"),d=a-l;r.push(t.getCheckoutPaymentData("14","통합포인트",l,a,d))}if(n.get("_useCafeteriaPoint")>0){var l=n.get("_useCafeteriaPoint"),a=n.get("cafeteriaPoint"),d=a-l;r.push(t.getCheckoutPaymentData("12","카페테리아",l,a,d))}if(n.get("_useCulturelandAmount")>0){var l=orderBenefitForms.useAmount,a=n.get("culturelandAmount"),d=a-l;r.push(t.getCheckoutPaymentData("20","컬쳐캐쉬",l,a,d))}if(n.get("_useBooknLifeAmount")>0){var l=n.get("_useBooknLifeAmount"),a=n.get("booknLifeAmount"),d=a-l;r.push(t.getCheckoutPaymentData("21","북앤캐시",l,a,d))}if(n.get("_useHappyMoneyAmount")>0){var l=n.get("_useHappyMoneyAmount"),a=n.get("happyMoneyAmount"),d=a-l;r.push(t.getCheckoutPaymentData("22","해피머니",l,a,d))}}var s=t.getOrderPaymentForm(e);return s&&(i.isCard(o)&&r.push(t.getCheckoutPaymentData("01","카드",s.paymentAmount,0,0)),i.isNobankbook(o)&&r.push(t.getCheckoutPaymentData("02","현금",s.paymentAmount,0,0)),"MOBILE"==o&&r.push(t.getCheckoutPaymentData("15","휴대폰",s.paymentAmount,0,0)),"PAYCO"==o&&r.push(t.getCheckoutPaymentData("35","PAYCO",s.paymentAmount,0,0)),"PAYNOW"==o&&r.push(t.getCheckoutPaymentData("38","페이나우",s.paymentAmount,0,0)),"KAKAOPAY"==o&&r.push(t.getCheckoutPaymentData("36","KAKAOPAY",s.paymentAmount,0,0)),"SYRUPPAY"==o&&r.push(t.getCheckoutPaymentData("37","SYRUPPAY",s.paymentAmount,0,0))),r},getCheckoutPaymentData:function(e,t,r,o,n){return{pam_meth_cd:e,pam_meth_nm:t,pam_amt:r,before_amt:o,remain_amt:n}},getFdsPaymentCard:function(e){var t,r=this,o=e.get("orderPaymentModel").get("_payType");if(i.isCard(o)){var n=r.getOrderPaymentForm(e);if(!1===n)return"";var l,a=n.installmentMonth,d=n.isCardPointUse,s=n.polarisDetailPayType;i.isIspCard(o)&&(l="isp"),"PAYALL"==o&&(l="speed"),(i.isIlkCard(o)||i.isPolrarisCard(o))&&("ANSIM_CLICK"==s?l="safe":"SIMPLE_PAYMENT"==s?l="easy":"APP_PAYMENT"==s&&(l="app")),t={card_type:i.getPayTypeName(o),slct_norest_month:a,card_point_use:d?"1":"",card_payment:l}}return t||""},getFdsPaymentBank:function(e){var t,r=this,o=e.get("orderPaymentModel").get("_payType");if(i.isNobankbook(o)||"REALTIME_ACCOUNT_TRANSFER"===o){var n=r.getOrderPaymentForm(e);if(!1===n)return"";var l;i.isNobankbook(o)?l="0":"REALTIME_ACCOUNT_TRANSFER"===o&&(l="1");var a=n.depositor,d=n.paymentDueDate;t={realtime_online_yn:l,bank_cd:i.getPayTypeName(o),bank_account_online:"",bank_seq_online:"",receipter_online:a,receipt_yyyymmdd_online:d}}return t||""},getFdsPaymentMobile:function(e){var t;return"MOBILE"==e.get("orderPaymentModel").get("_payType")&&(t={hp_module_type:""}),t||""},getFdsPaymentCashReceipt:function(e){var t,r=this,o=r.getOrderCashReceiptForm(e);if(o){var n,l,i,a=o.issueNo,d=o.orderCashReceiptIssueUseType,s=o.orderCashReceiptIssueWayType;n="DEDUCT"==d?"소득공제":"EVIDENCE"==d?"지출증빙":"미발행","BIZ"==s?l="사업자등록번호":"PHONE"==s?l="휴대폰번호":"CARD_NO"==s?l="신용카드번호":"CASH_RECEIPT_CARD_NO"==s&&(l="현금영수증카드번호"),i=a.substring(a.length-4,a.length),t={cash_receipt_select:n,online_tax_select:l,online_tax_value:i}}return t||""}})}),define("page/cjmall/order/sheet/models/orderCertainPaymentFormModel",[],function(){return Backbone.Model.extend({defaults:{payType:null}})}),define("page/cjmall/order/sheet/models/orderDeliveryModel",[],function(){return Backbone.Model.extend({defaults:{}})}),define("page/cjmall/order/sheet/models/orderEcouponDeliveryModel",[],function(){return Backbone.Model.extend({initialize:function(){}})}),define("page/cjmall/order/sheet/models/orderItemCertainFormModel",[""],function(){return Backbone.Model.extend({defaults:{},initialize:function(){}})}),define("page/cjmall/order/sheet/models/orderItemPriceModel",["common/cjos/util/configUtil","common/cjmall/util/cjmallUtil","page/cjmall/order/sheet/models/orderDeliveryModel","page/cjmall/order/sheet/models/discountPriceModel"],function(e,t,r,o){return Backbone.Model.extend({defaults:{itemCode:"",itemName:"",unitCode:"",unitName:"",dispUnitName:"",channelCode:"",quantity:"",salePrice:"",orderDeliveryModel:r,discountPriceModel:o,itemImageUrl:"",selectQuantity:0},initialize:function(e){this.set({itemImageUrl:e.itemImageUrl,orderDeliveryModel:new r(e.orderDeliveryTuple),discountPriceModel:new o(e.discountPriceTuple)})},getItemDetailUrl:function(){var e=this;return t.getLinkUrl(e.get("itemCode"),e.get("channelCode"))}})}),define("page/cjmall/order/sheet/models/orderLatelyPaymentModel",[""],function(){return Backbone.Model.extend({defaults:{latelyPaymentType:"",creditCardCompany:""}})}),define("page/cjmall/order/sheet/models/orderMasterFormModel",["common/cjos/util/configUtil","page/cjmall/order/sheet/models/customerAddressFormModel","page/cjmall/order/sheet/collections/receiverAddressFormCollection","page/cjmall/order/sheet/models/receiverAddressFormModel","page/cjmall/order/sheet/collections/orderCertainFormCollection","page/cjmall/order/sheet/models/orderCertainFormModel","page/cjmall/order/sheet/models/orderPriceFormModel","page/cjmall/order/sheet/models/orderCertainPaymentFormModel"],function(e,t,r,o,n,l,i,a){return Backbone.Model.extend({url:e.get("ecBaseSslUrl")+"/c/rest/order/certain",defaults:{tempOrderNo:"",receiverAddressForms:r,orderCertainForms:n},initialize:function(){},submit:function(e){var t=this,r={},o={};return o=t.convert(e),t.ajax=Backbone.ajax({url:t.url,async:!1,method:"POST",dataType:"json",contentType:"application/json;charset=utf-8",xhrFields:{withCredentials:!0},data:JSON.stringify(o),success:function(e,t,o){cjosLogUtil.log("submit order data : ",e),r=e}}),alert(111),r},convert:function(t){var r=this,o={custNm:"kkoma"};r.getReceiverAddressForms(t.get("orderAddressModel")),r.getOrderCertainPriceForms(t.get("orderPriceModel")),r.getOrderCertainPaymentForm(t.get("orderPaymentModel"));return{tempOrderNo:e.get("tempOrderNo"),customerAddressForm:o,payType:"PAYNOW",paymentAmount:"2626260"}},getReceiverAddressForms:function(e){var t=[];return t.push(e.get("latelyAddressModel").toJSON()),t},getOrderCertainPriceForms:function(e){var t=[];return _.each(e.get("orderPriceManagers"),function(e,r){var o={orderItemType:e.itemDetailType,itemCode:e.itemCode,itemName:e.itemName,channelCode:e.channelCode,unitName:e.unitName,unitCode:e.unitCode,unitPrice:e.unitPrice,quantity:e.quantity,shopId:e.shopId},n={orderPriceForm:o,receiverAddressType:"NORMAL",receiverAddressSeq:"FIRST",deliv_plc_seq:"0000000360",travel:!0,deliveryMsg:"빠른 배송 부탁드립니다.",custHopeDate:"2016-11-20",arsDiscountYn:"Y",arsDiscountAmt:"1000",saveAmtDiscountYn:"Y",saveAmtDiscountAmt:"2000",noRestYn:"Y",noRestDiscountAmt:"3000",noRestDiscountRate:"",noRestMonth:"3",lumpSum:!0};t.push(n)}),t},getOrderCertainPaymentForm:function(e){return{payType:"PAYNOW",totalAmount:"2626260"}}})}),define("page/cjmall/order/sheet/models/orderMultipleDeliveryAddressModel",["common/cjos/util/configUtil","page/cjmall/order/sheet/models/orderAddressModel","page/cjmall/order/sheet/models/deliveryAddressItemModel"],function(e,t,r){return t.extend({usr:"",defaults:{multipleIndex:0,orderPriceModel:{},totalDeliveryCost:0},initialize:function(){}})}),define("page/cjmall/order/sheet/models/orderNoMemberInfoFormModel",[""],function(){return Backbone.Model.extend({defaults:{name:"",celno1:"",celno2:"",celno3:"",passWord1:"",passWord2:"",emailId:"",emailAddress:""}})}),define("page/cjmall/order/sheet/models/orderPaymentModel",["common/cjos/util/currencyUtil"],function(e){return Backbone.Model.extend({defaults:{_payType:"",_depositor:"",_paymentDueDate:"",_installmentMonth:0,_interestType:"",_polarisDetailPayType:"ANSIM_CLICK",orderCashReceiptTuple:null,totalOliveyoungPrice:"",cjCardDiscountRate:"",orderSheetType:""},isUsedAllPayment:function(){var e=this,t=e.get("orderPaymentControlTuple"),r=!1;return _.forEach(t.orderPaymentControlDetailTuples,function(e){if(e.available)return r=!0,!1}),r},setAddOliveyoung:function(t){var r=this;if(null!==t){var o=t.get("orderBenefitModel").get("_paymentAmount"),n=t.get("orderPriceModel").get("totalOrderPriceTuple").totalItemPrice,l=t.get("orderPriceModel").get("totalOrderPriceTuple").totalDiscountPrice,i=t.get("orderPriceModel").get("totalOrderPriceTuple").cjCardDiscountRate;r.set("totalOliveyoungPrice",o-e.wonFloor(i/100*(n-l))),r.set("cjCardDiscountRate",t.get("orderPriceModel").get("totalOrderPriceTuple").cjCardDiscountRate),r.set("orderSheetType",t.get("orderSheetType"))}}})}),define("page/cjmall/order/sheet/models/orderPersonalCertainModel",["common/cjos/util/configUtil","common/cjos/util/authMainManager","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/cjonePwdCheckUtil"],function(e,t,r,o){return Backbone.Model.extend({url:"",orderItemType:"",orderBenefitModel:{},defaults:{},callPersonalCertain:function(n){var l=this,i=e.get("orderSheetType");"NON_CUSTOMER"==i||"REGULAR_PAYMENT"==i?n(null):!1===l.checkPersonalCertain()?l.checkCjoneMemberAuthRequired()?(o.checkCjonePwd({callBackFunc:function(e){var t={cjoneMemberPwdResultToken:e};alert("인증되었습니다."),n(t)},additionalInfo:"1000",currentPageTitle:"주문서"}),r.set("isProgress",!1)):n(null):(t.openAuth({keyInfo:{custNo:e.get("customerNo")},authType:"CUST_INFO_MATCH",serviceType:"HP",callBackFunc:function(e){var t=JSON.parse(e),r={authResult:t.result.authResult,sessionKey:t.result.sessionKey,authChecked:t.result.authChecked};n(r)},serviceTypeCode:"00"}),r.set("isProgress",!1))},checkPersonalCertain:function(){var t=this;t.orderBenefitModel=r.get("orderBenefitModel");var o=r.get("orderPriceModel"),n=(t.orderBenefitModel.get("_paymentAmount"),t.orderBenefitModel.get("_totalAmount")),l=o.get("orderItemPriceCollection"),i=0;l.each(function(e,r){t.orderItemType=e.get("orderItemTypeTuple").orderItemType;var o=e.get("totalPrice"),n=e.get("orderItemTypeTuple");t.checkImmaterialItem(n)&&(i+=o)});var a=t.getTotalUsePointAmount();if("NON_CUSTOMER"==e.get("orderSheetType"))return!0;if(n==a){var d=e.get("immaterialItemReferenceAmount");if(i>d)return!0;if(t.checkCJOnePoint())return!0;if(t.checkCjGiftCard())return!0;if(n>=3e5)return!0}return!1},isSimpleAccountOrderable:function(){var t=this;if(!0===e.get("simpleAccountCustomer")){t.orderBenefitModel=r.get("orderBenefitModel");var o=r.get("orderPriceModel"),n=(t.orderBenefitModel.get("_paymentAmount"),t.orderBenefitModel.get("_totalAmount")),l=o.get("orderItemPriceCollection"),i=0;if(l.each(function(e,r){t.orderItemType=e.get("orderItemTypeTuple").orderItemType;var o=e.get("totalPrice"),n=e.get("orderItemTypeTuple");t.checkImmaterialItem(n)&&(i+=o)}),n==t.getTotalUsePointAmount()&&(i>=1e4||n>=3e5))return alert("고객님께서는 간편회원으로 배송이 진행되는 실물상품은 30만원 미만까지\n모바일로 전송되는 상품은 1만원 미만까지만 기타결제수단을 사용하실 수 있습니다.\n\n결제수단 금액을 조정 후 다시 주문 시도해주세요."),r.set("isProgress",!1),!1}return!0},checkImmaterialItem:function(e){var t=e.giftVoucher,o=e.mobileVoucher,n=e.ecoupon,l=r.get("orderPriceModel");if(t){if(!0===l.getIsNoDeliveryProduct())return!0}else if(o||n)return!0;return!1},getTotalUsePointAmount:function(){var e=this,t=0;return e.orderBenefitModel.get("_useSavedMoney")>0&&(t+=e.orderBenefitModel.get("_useSavedMoney")),e.orderBenefitModel.get("_useCjGiftAmount")>0&&(t+=e.orderBenefitModel.get("_useCjGiftAmount")),e.orderBenefitModel.get("_useDepositAmount")>0&&(t+=e.orderBenefitModel.get("_useDepositAmount")),e.orderBenefitModel.get("_useCafeteriaPoint")>0&&(t+=e.orderBenefitModel.get("_useCafeteriaPoint")),e.orderBenefitModel.get("_useCjonePoint")>0&&(t+=e.orderBenefitModel.get("_useCjonePoint")),e.orderBenefitModel.get("_useCulturelandAmount")>0&&(t+=e.orderBenefitModel.get("_useCulturelandAmount")),e.orderBenefitModel.get("_useBooknLifeAmount")>0&&(t+=e.orderBenefitModel.get("_useBooknLifeAmount")),e.orderBenefitModel.get("_useHappyMoneyAmount")>0&&(t+=e.orderBenefitModel.get("_useHappyMoneyAmount")),e.orderBenefitModel.get("_useCjGiftCardAmount")>0&&(t+=e.orderBenefitModel.get("_useCjGiftCardAmount")),cjosLogUtil.log("getTotalUsePointAmount _useHappyMoneyAmount : "+e.orderBenefitModel.get("_useHappyMoneyAmount")),cjosLogUtil.log("getTotalUsePointAmount useTotalPoint : "+t),t},checkCJOnePoint:function(){var e=this;return e.orderBenefitModel.get("_useCjonePoint")>=1e4},checkCjGiftCard:function(){var e=this;return e.orderBenefitModel.get("_useCjGiftCardAmount")>=1e4&&!0===e.orderBenefitModel.get("usedCjGiftCardNamed")},checkCjoneMemberAuthRequired:function(){var e=this;if(e.orderBenefitModel.get("thirdPartyLoginByCjoneMember")){var t=e.orderBenefitModel.get("_totalAmount"),r=e.getTotalUsePointAmount(),o=e.orderBenefitModel.get("_useCjGiftCardAmount")+e.orderBenefitModel.get("_useCjonePoint");if(t==r&&o>0)return!0}return!1}})}),define("page/cjmall/order/sheet/models/orderPresentDeliveryModel",[],function(){return Backbone.Model.extend({initialize:function(){}})}),define("page/cjmall/order/sheet/models/orderPriceFormModel",[],function(){return Backbone.Model.extend({defaults:{itemCode:"",itemName:"",unitCode:"",unitName:"",channelCode:"",quantity:"",salePrice:""}})}),define("page/cjmall/order/sheet/models/orderPriceGroupModel",["page/cjmall/order/sheet/collections/orderItemPriceCollection"],function(e){return Backbone.Model.extend({defaults:{multipleIndex:0,deliveryPolicyModel:null,fastDeliveryAddPrice:null,orderItemPriceCollection:null},initialize:function(){},setOrderItemPriceCollection:function(t){this.set("orderItemPriceCollection",new e(t))}})}),define("page/cjmall/order/sheet/models/orderPriceModel",["page/cjmall/order/sheet/collections/orderItemPriceCollection"],function(e){return Backbone.Model.extend({defaults:{totalOrderItemTypeTuple:{},totalOrderPriceTuple:{},orderItemPriceCollection:e},initialize:function(t){var r=this;r.set("totalOrderItemTypeTuple",t.totalOrderItemTypeTuple),r.set("totalOrderPriceTuple",t.totalOrderPriceTuple),r.set("orderItemPriceCollection",new e(t.orderPriceManagers)),r.get("totalOrderPriceTuple").currentTotalDeliveryPrice=r.get("totalOrderPriceTuple").totalDeliveryPrice,r.get("totalOrderPriceTuple").totalDiscountDeliveryPrice=0},getIsDeliveryTravelProduct:function(){var e=this,t=!1,r=e.get("orderPriceManagers");return _.forEach(r,function(e){var r=e.orderItemTypeTuple.domesticTravel,o=e.orderItemTypeTuple.overseasTravel;(r||o)&&(t=!0),"80040103"===e.itemTypeCode&&(t=!0)}),t},getIsNoDeliveryProduct:function(){var e=this,t=!1,r=!1,o=e.get("orderPriceManagers");return _.forEach(o,function(e){"NONE"===e.orderDeliveryTuple.deliveryType||e.orderItemTypeTuple.ecoupon||e.orderItemTypeTuple.mobileVoucher?t=!0:r=!0}),!1===r&&!0===t},getIsEcouponProduct:function(){var e=this,t=!1,r=!1,o=e.get("orderPriceManagers");return _.forEach(o,function(e){e.orderItemTypeTuple.ecoupon?r=!0:t=!0}),!1===t&&!0===r},getIsCpnProduct:function(){var e=this,t=!1,r=!1,o=e.get("orderPriceManagers");return _.forEach(o,function(e){e.orderItemTypeTuple.cpnItem?r=!0:t=!0}),!1===t&&!0===r},getTourItemType:function(){var e,t=this,r=t.get("orderPriceManagers");return _.forEach(r,function(t){e=t.tourItemTypeCode}),e}})}),define("page/cjmall/order/sheet/models/orderRegularPaymentModel",["common/cjos/util/currencyUtil"],function(e){return Backbone.Model.extend({defaults:{period:null,cycle:null,cycleType:"MONTH",_payType:"REGULARPAYMENT"}})}),define("page/cjmall/order/sheet/models/orderSheetMainModel",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/models/treceiverAddressModel","page/cjmall/order/sheet/models/orderAddressModel","page/cjmall/order/sheet/collections/orderItemPriceCollection","page/cjmall/order/sheet/models/orderItemPriceModel","page/cjmall/order/sheet/models/orderPriceModel","page/cjmall/order/sheet/models/orderBenefitModel","page/cjmall/order/sheet/models/orderDeliveryModel","page/cjmall/order/sheet/models/discountPriceModel","page/cjmall/order/sheet/collections/discountDetailCollection","page/cjmall/order/sheet/models/discountDetailModel","page/cjmall/order/sheet/models/orderPaymentModel","page/cjmall/order/sheet/collections/deliveryPolicyCollection","page/cjmall/order/sheet/models/orderRegularPaymentModel"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m,f){return new(Backbone.Model.extend({url:"",defaults:{status:"ready",isProgress:!1,orderSheetType:"",keyword:"",orderFormType:"",paymentMethod:"",orderAddressModel:o,orderTourlistModel:new Backbone.Model,orderNoMemberModel:new Backbone.Model,orderItemPriceCollection:n,orderPriceModel:i,deliveryPolicyCollection:m,orderBenefitModel:a,orderPaymentModel:p,orderPresentDeliveryModel:new Backbone.Model,orderEcouponDeliveryModel:new Backbone.Model,orderDoorPasswordModel:new Backbone.Model,orderRegularPaymentModel:f,orderTourItemInfoModel:new Backbone.Model},responseData:{},initialize:function(){var r=this;r.url=e.get("ecBaseSslUrl")+"/c/rest/order/sheet/"+e.get("tempOrderNo")+"?clientAppType="+t.get(t.APPLICATION_TYPE),r.setPayMethod()},parse:function(r){if(0===r.code||!r.result)return r.resMsg?alert(r.resMsg):alert("주문정보 조회가 실패하였습니다."),void("MSG_ORDCHK_VAL_022"==r.resCode||"MSG_ORDCHK_VAL_019"==r.resCode||"MSG_ORDCHK_VAL_018"==r.resCode||"MSG_ORD_ERR_051"==r.resCode?location.replace(e.get("displayDomain")+("p"===t.get(t.APPLICATION_TYPE)?"/p":"/m")+"/main"):"MSG_ORD_ERR_045"==r.resCode||"MSG_ORD_ERR_059"==r.resCode?location.replace(("p"===t.get(t.APPLICATION_TYPE)?"/p":"/m")+"/page/account/myInformation"):"MSG_ORD_ERR_046"==r.resCode?location.replace(("p"===t.get(t.APPLICATION_TYPE)?"/p":"/m")+"/myzone/main"):history.back());var n=this;e.set("orderSheetType",r.result.orderSheetType),e.set("keyword",r.result.keyword),e.set("orderFormType",r.result.orderFormType),e.set("customerNo",r.result.customerNo),e.set("localCustomer",r.result.localCustomer),e.set("simpleAccountCustomer",r.result.simpleAccountCustomer),n.responseData=$.extend(!0,{},r),n.set({customsIdNumber:r.result.customsIdNumber,orderSheetType:r.result.orderSheetType,keyword:r.result.keyword,paymentMethod:r.result.paymentMethod,orderFormType:r.result.orderFormType,orderAddressModel:new o(r.result.orderAddressTuple),orderPriceModel:new i(r.result.orderPrice),orderBenefitModel:new a(r.result.orderBenefitTuple),orderPaymentModel:new p(r.result.orderPaymentTuple),deliveryPolicyCollection:new m(r.result.deliveryPolicyTuples),orderItemDeliveryCollection:new m(r.result.orderItemDeliveryTuples),otourEmployeeTuple:new Backbone.Model(r.result.otourEmployeeTuple),orderNoticeTuple:new Backbone.Model(r.result.orderNoticeTuple),orderCardEventNoticeTuple:new Backbone.Model(r.result.orderCardEventNoticeTuple),orderRegularPaymentModel:new f(r.result.orderRegularPaymentInfoTuple)})},createOrderAddressModel:function(){return new o($.extend(!0,{},this.responseData.result.orderAddressTuple))},createOrderPriceModel:function(){return new i($.extend(!0,{},this.responseData.result.orderPrice))},createOrderBenefitModel:function(){return new a($.extend(!0,{},this.responseData.result.savedMoneyPointTuple))},createOrderPaymentModel:function(){return new SavedMoneyPointModel($.extend(!0,{},this.responseData.result.savedMoneyPointTuple))},createDeliveryPolicyCollection:function(){return new m($.extend(!0,[],this.responseData.result.deliveryPolicyTuples))},getDeliveryPolicyByUnitCode:function(e){var e=e.toString(),t=!1;return this.get("deliveryPolicyCollection").forEach(function(r){var o=r;_.forEach(r.get("unitCodeList"),function(r){e===r&&(t=o)})}),t},getDeliveryPolicyByGroupCode:function(e){var t=!1;return this.get("deliveryPolicyCollection").forEach(function(r){var o=r;r.get("deliveryCostGroupCode")===e&&(t=o)}),t},validate:function(e,t){},setPayMethod:function(){var e=this,r=null,o=/payMethod=([^&]+)/.exec(location.search),n=t.get(t.INFLOW_DATA),l=null;n!==undefined&&null!==n&&(l=n.split(":")),o!==undefined&&null!==o&&o[1]!==undefined&&null!==o[1]?r=o[1]:l!==undefined&&null!==l&&l[1]!==undefined&&null!==l[1]&&(r=l[1]),null!==r&&(e.url+="&payMethod="+r)},isOliveyoungItemUnit:function(){var e=this,t=!1;return e.get("orderPriceModel").get("orderPriceManagers").forEach(function(e,r){"OLIVEYOUNG"===e.orderItemTypeTuple.orderItemType&&(t=!0)}),t}}))}),define("page/cjmall/order/sheet/models/receiverAddressFormModel",[""],function(){return Backbone.Model.extend({defaults:{receiverNm:"",telno1:"",telno2:"",telno3:"",celno1:"",celno2:"",celno3:"",addr1:"",addr2:"",zipno:"",zipnoSeq:""}})}),define("page/cjmall/order/sheet/models/receiverAddressModel",[""],function(){return Backbone.Model.extend({defaults:{receiverNm:"",telno1:"",telno2:"",telno3:"",celno1:"",celno2:"",celno3:"",addr1:"",addr2:"",zipno:"",zipnoSeq:"",areaCls:"",fastAreaCls:"",delivPlcAlias:"",delivPlcSeq:"",delivPlcClsCd:""}})}),define("page/cjmall/order/sheet/models/tourlistInfomationModel",[],function(){return Backbone.Model.extend({defaults:{name:null,lastName:null,firstName:null,birthDay:null,sex:null,tel:null,message:null,agesStagesType:null},initialize:function(){}})}),define("page/cjmall/order/sheet/models/treceiverAddressModel",[""],function(){return Backbone.Model.extend({defaults:{custNo:"",custNm:"",cellno1:"",cellno2:"",cellno3:"",delivPlcSeq:"",delivPlcClsCd:"",befDelivPlcSeq:"",ddd:"",telno1:"",
telno2:"",zipno:"",zipnoSeq:"",addr:"",fullAddress:"",useYn:"",roadAddrId:"",roadAddrSeq:"",roadAddr1:"",roadAddr:"",addrConvCd:""}})}),define("page/cjmall/order/sheet/models/venDeliveryDateModel",["common/cjos/util/configUtil"],function(e){return Backbone.Model.extend({"default":{holidays:"",startDate:"",modelCode:"",apiStartDate:""},initialize:function(){},parse:function(e){return e}})}),define("page/cjmall/order/sheet/models/womanSafeModel",[],function(){return Backbone.Model.extend({defaults:{siNm:null,guNm:null,dongNm:null,dongNmDtl:null,roadNm:null,zipNo:null,safeBoxNm:null,transCode:null,isSuccessConvert:null,address:null,addressDetail:null,addressReference:null,roadManageKey:null,buildingManageNo:null,zipCode:null,newZipCode:null,zipNoSeq:null,newZipNoSeq:null,isRepresentJibun:null,addressType:"1",areaCls:"00"},initialize:function(e){}})}),define("page/cjmall/order/sheet/util/observer",[],function(){function e(){this.contentPool=[],this.indexArray=[],this.listeningEventGroup={},this.init()}var t={init:function(){Backbone&&_.extend(this,Backbone.Events)},eventTrigger:function(){var e=arguments,t="changeAddress"===e[0];this.listeningEventGroup[e[0]]&&_.forEach(this.listeningEventGroup[e[0]],function(r){t&&e[1]&&"DeliveryAddressView"===e[1].constructorName?(r.context.cid===e[1].cid&&r.callBackFn(),"OrderItemListView"===r.context.constructorName&&r.callBackFn(e[1])):r.callBackFn(e[1])})},setListeningCallback:function(e,t,r){!1==!!this.listeningEventGroup[t]&&(this.listeningEventGroup[t]=[]),this.listeningEventGroup[t].push({context:e,callBackFn:function(t){r.apply(e,[t])}})},removeListeningCallback:function(e){var t=this,r=e.cid;for(var o in t.listeningEventGroup)_.forEach(t.listeningEventGroup[o],function(e,n){e&&e.context.cid===r&&t.listeningEventGroup[o].splice(n,1)})},setContent:function(e){if(!e)throw new Error("data is undefine");if(e.index){if("string"!=typeof e.index)throw new Error("index is must string");if(0==$.trim(e.index).length)throw new Error("index is empty")}if(!e.content)throw new Error("content is empty");this.hasIndex(e.index);this.indexArray.push(e.index),this.contentPool.push({index:e.index,content:e.content})},getContent:function(e){for(var t=!1,r=0;r<this.contentPool.length;r++)this.contentPool[r].index===e&&(t=this.contentPool[r].content);return t},removeContent:function(e){for(var t=!1,r=0;r<this.contentPool.length;r++)this.contentPool[r].index===e&&(t=this.contentPool.splice(r,1));return t[0]},hasIndex:function(e){for(var t=!1,r=0;r<this.contentPool.length;r++)this.contentPool[r].index==e&&(t=!0);return t}};return e.prototype=t,new e}),define("page/cjmall/order/sheet/util/polling",[],function(){function e(e,t){this.model=e,this.options=_.extend({},n,t||{})}var t=null,r=function(r,n){return t||(t=new e(r,n),t.listenTo(t.model,"destroy",o)),t},o=function(){t&&(t.stop().stopListening().off(),t=null)},n={startTime:0,endTime:3e5,intervalTime:1e3,elapsedTime:0},l={start:function(){this.options.active=!0,this.options.startTime>0?this.delayedRun(this.options.startTime):this.run(this)},stop:function(){return this.options.active=!1,this.xhr&&this.xhr.abort&&this.xhr.abort(),this.xhr=null,clearTimeout(this.timeoutId),this.timeoutId=null,this},active:function(){return!0===this.options.active},run:function(e){if(e.validate()){var t=_.extend({},e.options,{success:function(t,r){e.trigger("success",t,r),e.delayedRun()},error:function(t,r){e.delayedRun()}});e.trigger("fetch",e.model),e.xhr=e.model.fetch(t)}},getDelay:function(){return this.options.elapsedTime+=this.options.intervalTime,this.options.endTime<this.options.elapsedTime&&o(),this.options.intervalTime},delayedRun:function(e){var t=this;t.validate()&&(t.timeoutId=_.delay(t.run,e||t.getDelay(),t))},validate:function(){return!!this.options.active}};return _.extend(e.prototype,Backbone.Events,l),{init:r,destroy:o}});var ajax_flag=!0,req01_AJAX,PayUrl="",cnspay_L={domain:"https://pg.cnspay.co.kr",method:"/smilepay/getCertifyPage.htm",layer:"cns_layer",target:"cns_target",left:0,top:0,width:0,height:640,p_win:null,form:null,interval:null,closed:!1,pay_layout:function(e){var t=document.getElementById(e),r=document.getElementsByTagName("body")[0],o=r.offsetWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.left=o/2-this.width/2,this.top=n/2-this.height/2,t.style.position="absolute",t.style.zIndex=100001,t.style.width=this.width+"px",t.style.height=this.height+"px",t.style.left=this.left+0+"px",t.style.top=this.top+0+"px",t.style.border="none",t.tabIndex=0,t.style.display="block";var l=document.createElement("iframe");return l.name=this.target,l.setAttribute("id","i_cnspay"),l.style.border="none",l.style.width=t.style.width,l.style.height=t.style.height,t.appendChild(l),t},addInput:function(e,t){var r;this.form.txnId!==undefined?this.form.txnId.value=t:(r=document.createElement("input"),r.type="hidden",r.name=e,r.value=t,this.form.appendChild(r))},callPage:function(e,t,r){if("mobile"==this.getDeviceType()&&(this.width=Math.max(window.innerWidth,document.documentElement.clientWidth||document.body.clientWidth),this.height=Math.max(window.innerHeight,document.documentElement.clientHeight||document.body.clientHeight),t=!1),t){"undefined"!=typeof this.p_win&&null!=this.p_win&&this.p_win.close();var o=0,n=0;"undefined"!=typeof window.screenLeft?(o=window.screenLeft,n=window.screenTop):"undefined"!=typeof window.screenX&&(o=window.screenX,n=window.screenY),this.left=o+window.innerWidth/2-this.width/2,this.top=n+window.innerHeight/2-this.height/2,this.p_win=this.openPopup(r,"about:blank","smilePayPopup",null,"width="+this.width+", height="+this.height+", top="+this.top+", left="+this.left+", menubar=no, toolbar=no, location=no, resizable=no, scrollbars=no, status=no, titlebar=no"),this.useForm(this.domain+this.method,"smilePayPopup")}else this.pay_layout(e),this.layer=e,this.useForm(this.domain+this.method,this.target)},callAPIPage:function(e,t,r,o){if("mobile"==this.getDeviceType()&&(this.width=Math.max(window.innerWidth,document.documentElement.clientWidth||document.body.clientWidth),this.height=Math.max(window.innerHeight,document.documentElement.clientHeight||document.body.clientHeight),t=!1),t){"undefined"!=typeof this.p_win&&null!=this.p_win&&this.p_win.close();var n=0,l=0;"undefined"!=typeof window.screenLeft?(n=window.screenLeft,l=window.screenTop):"undefined"!=typeof window.screenX&&(n=window.screenX,l=window.screenY),this.left=n+window.innerWidth/2-this.width/2,this.top=l+window.innerHeight/2-this.height/2,this.p_win=this.openPopup(r,"about:blank","smilePayPopup",o,"width="+this.width+", height="+this.height+", top="+this.top+", left="+this.left+", menubar=no, toolbar=no, location=no, resizable=no, scrollbars=no, status=no, titlebar=no"),this.useAPIForm(this.domain+this.method,"smilePayPopup",o)}else this.pay_layout(e),this.layer=e,this.useAPIForm(this.domain+this.method,this.target,o)},openPopup:function(e,t,r,o,n){cnspay_L.closed=!1;var l=window.open(t,r,n);return void 0===l||null==l?alert("팝업 차단 기능이 설정되어있습니다\n차단 기능을 해제(팝업허용) 한 후 다시 이용해 주십시오.\n만약 팝업 차단 기능을 해제하지 않으면\n정상적인 주문이 이루어지지 않습니다."):(l.focus(),cnspay_L.interval=window.setInterval(function(){try{(null==l||l.closed)&&(window.clearInterval(cnspay_L.interval),cnspay_L.closed||(cnspay_L.closed=!1,null!=o&&""!=o?cnspay_L.useAjax(cnspay_L.domain+"/smile/v1/callbackCancel","txnId="+o,e):cnspay_L.useAjax(cnspay_L.domain+"/smilepay/cancel.htm","txnId="+document.getElementById("txnId").value,e),"function"==typeof e&&e(null)))}catch(t){}},100)),l},useAjax:function(e,t,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&200==o.status&&"function"==typeof r&&r(null)}},useForm:function(e,t){this.form.action=e,this.form.target=t,this.addInput("txnId",document.getElementById("txnId").value),this.form.submit()},useAPIForm:function(e,t,r){this.form.action=e,this.form.target=t,this.addInput("txnId",r),this.form.submit()},init:function(){var e=document.getElementsByTagName("script"),t=e[e.length-1],r=t.src;this.domain=r.replace(/^(.*\/\/[^\/?#]*).*$/,"$1");var o=window.navigator.userAgent,n=window.navigator.userAgent.indexOf("MSIE"),l=window.navigator.userAgent.indexOf("Trident");if(underversion=0,n>-1){var i=o.charAt(n+5);i>1&&i<10&&(underversion=1)}else if(l>-1){var a=o.charAt(l+8);a<=4&&(underversion=2)}underversion>0?document.attachEvent("onreadystatechange",function(){"complete"==document.readyState&&cnspay_L.createForm()}):document.addEventListener("DOMContentLoaded",function(){cnspay_L.createForm()})},createForm:function(){this.form=document.createElement("form"),this.form.method="POST",document.body.appendChild(this.form)},getDeviceType:function(){return/Android/i.test(navigator.userAgent)?/mobile/i.test(navigator.userAgent)?"mobile":"tablet":/playbook|silk|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile":/iPad/i.test(navigator.userAgent)?"tablet":"pc"},destroy:function(){if("undefined"!=typeof this.p_win&&null!=this.p_win)this.closed=!0,null!=this.interval&&window.clearInterval(this.interval),this.p_win.close();else{var e=document.getElementById("i_cnspay");null!=e&&e.parentNode.removeChild(e),null!=document.getElementById(this.layer)&&(document.getElementById(this.layer).style.display="none")}}};cnspay_L.init(),define("page/cjmall/order/sheet/util/validator",[],function(){function e(){this.requireArray=[],this.aSync=!1}var t={registRequire:function(e){var t=this;e.each(function(){var e=$(this),r=e.data().required;if(!t._validate[$.trim(r)])return void cjosLogUtil.log("type is not have you can add type");this.requireArray.push({nodeName:e[0].nodeName,type:r,$el:e})})},runValidate:function(){var e=this,t=[];return $.each(this.requireArray,function(r){var o=this.type,n=this.$el,l=this.nodeName,i=e._validate[o](n,l);t.push({result:i,$el:n})}),t},_validate:{required:function(e,t){if("SELECT"===t)return!!e.prop("selectedIndex");if("INPUT"===t){if("radio"===e[0].type){var r=!1;return $("[name="+e.prop("name")+"]").each(function(){$(this).is(":checked")&&(r=!0)}),r}return!!$.trim(e.val()).length}},withRequired:function(e,t){var r=e.data().withRequired,o=$("[data-with-required="+r+"]:visible");cjosLogUtil.log("$groupEls",o)}},method:{"with":function(){}},validate:function(e,t){var r,o=this;if(e.length>1){var n,l=[];return $.each(e,function(){if(e.data().required)r=e.data().required;else{if("SELECT"!==e[0].nodeName&&"INPUT"!==e[0].nodeName)throw new Error("type is undefined");r="required"}o._validate[r]?n=o._validate[r](e,e[0].nodeName):(n=!1,cjosLogUtil.log("type is not have you can add type",e)),l.push({result:n,$el:e})}),l}if(1==e.length){var n;if(e.data().required)r=e.data().required;else{if("SELECT"!==e[0].nodeName&&"INPUT"!==e[0].nodeName)throw new Error("type is undefined");r="required"}return o._validate[r]?n=o._validate[r](e,e[0].nodeName):(n=!1,cjosLogUtil.log("type is not have you can add type",e)),n}},isMinerMinlength:function(e){var t=e.data().minlength;return e.val().length<t},isOverMaxlength:function(e){var t=e.data().maxlength;return e.val().length>t},isNumber:function(e){return/^(?:[-+]?(?:0|[1-9][0-9]*))$/.test(Number(e))},isHasSpecialChar:function(e){return/[\{\}\[\]\/?.,:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/gi.test(e)},isAlphabetText:function(e){return/^[a-zA-z\s]+$/.test(e)},isHangulText:function(e){return/^[가-힣\s]+$/.test(e)},isDomain:function(e){return/[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i.test(e)},isHangulEngText:function(e){return/^[0-9a-zA-Zㄱ-ㅎㅏ-ㅣ가-힣\s]+$/.test(e)},isSpecialCharKeyCode:function(e){return e>32&&e<48||(e>57&&e<65||(e>90&&e<97||e>122&&e<127))},isSpecialCharString:function(e){return!!/^[A-Za-z0-9+]*$/.test(e)}};return e.prototype=t,new e}),define("page/cjmall/order/sheet/view/chargeDiscountEventView",["common/cjos/util/handlebarsHelper"],function(e){return Backbone.View.extend({className:"payco_sale",template:e.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/chargeDiscountEvent"),events:{"click ._cj_card_detail":"clickCjCardDetail","click ._cj_card_detail_popup_close":"clickCjCardDetail"},initialize:function(){},render:function(){var e=this,t=e.$el,r=e.model.chargeDiscountList,o=e.model.isPaynow;return r!==undefined&&null!==r&&!1!==r.length||!0!==o?(t.append(e.template(e.model)),e):null},renderAdditionEvent:function(e){var t=this;return t.$el.append(e),t},clickCjCardDetail:function(){"block"===$("._cj_card_detail_popup").css("display")?$("._cj_card_detail_popup").hide():$("._cj_card_detail_popup").show()}})}),define("page/cjmall/order/sheet/view/chargeDiscountExpectPriceView",["common/cjos/util/handlebarsHelper","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/models/orderSheetMainModel"],function(e,t,r){return Backbone.View.extend({id:"_chargeExpectPrice",template:e.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===t.get(t.APPLICATION_TYPE)?"p":"m")+"/cardChargeDiscount"),events:{},render:function(e){var t=this,r=t.$el;if(e===undefined||null===e||e<0)return null;var o={chargeExpectPrice:e};return r.append(t.template(o)),t},getExpectedPrice:function(){var e=this,r=e.model.chargeDiscountList,o=e.model._payType;if(r===undefined||null===r||0===r.length)return 0;for(var n=0,l=t.userAgent,i=0;i<r.length;i++)if(r[i].payType===o){if(l.get(l.IS_OSHOPPING_APP)){n=e.calculateExpectPrice(r[i]);break}if("N"===r[i].appYn){n=e.calculateExpectPrice(r[i]);break}}return n},calculateExpectPrice:function(e){var t=r.get("orderBenefitModel").get("_paymentAmount"),o=e.strAmt;if(null===o||o>t)return 0;var n=e.dcRc,l=e.limitCd,i=e.limitAmt;if(null===n||n<=0)return 0;var a=0;if(null===l||null===i||i<=0)a=10*Math.floor(t*n/1e3);else if("01"===l){var d=t;t>i&&(d=i),a=10*Math.floor(d*n/1e3)}else"02"===l&&(a=10*Math.floor(t*n/1e3))>i&&(a=i);return t-a}})}),define("page/cjmall/order/sheet/view/deliveryAddressGroupView",["common/cjos/util/currencyUtil","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({tag:"div",className:"dely_plural",template:o.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===r.get(r.APPLICATION_TYPE)?"p":"m")+"/deliveryAddressGroupView"),model:null,events:{"change select[data-unitcode]":"quantityOnSelectHn","change ._fastDeliveryCheckbox":"fastDeliveryOnCheckHn"},initialize:function(){var e=this;e.fastDeliveryObj=e.model.getFastDeliveryObj(),e.listenTo(e.model,"change:selectedAddressModel",e.changeAddress),e.listenTo(e.model,"change:fastAddCost",e.renderFastDeliveryPrice),e.listenTo(e.model,"change:discountDeliveryFee",e.renderDiscountDeliveryFee),"04"===e.model.get("deliveryPolicyModel").get("deliveryType")&&e.model.set("isCollectType",!0),e.render()},render:function(){var e=this,t=e.model.toJSON();return _.extend(t,{fastDeliveryObj:e.fastDeliveryObj}),cjosLogUtil.log("delveryAddressGroupViewModel",t),e.$el.html(e.template(t)),!0==!!e.fastDeliveryObj&&(!0===e.fastDeliveryObj.fastDelivDisabled?e.model.setFastDeliveryPrice(!1):!0===e.fastDeliveryObj.fastDeliveryFree&&e.$el.find("._fastDeliveryCheckbox").prop("checked",!0).trigger("change")),e.model.trigger("deliveryPriceUpdate"),this},renderFastDeliveryPrice:function(){var e=this,t=e.model.get("fastAddCost");e.$el.find('[data-modelindex="fastDeliveryCost"]').text(e.numberMasking(t))},renderDiscountDeliveryFee:function(){var e=this,t=e.model.get("discountDeliveryFee");0===t?$("[data-modelindex=totalDiscountDeliveryPrice]").text(e.numberMasking(t)):$("[data-modelindex=totalDiscountDeliveryPrice]").text("-"+e.numberMasking(t))},fastDeliveryOnCheckHn:function(e){e.preventDefault();var t=this;$(e.currentTarget).is(":checked")?t.model.setFastDeliveryPrice(!0):t.model.setFastDeliveryPrice(!1),t.setDeliveryPrice(),t.model.trigger("deliveryPriceUpdate")},setDeliveryCoupon:function(e,t){this.model.set("deliveryCoupon",e,t)},removeDeliveryCoupon:function(e){this.model.set("deliveryCoupon",null,e)},setDeliveryPrice:function(){this.model.setDeliveryPrice()},quantityOnSelectHn:function(e){e.preventDefault(),e.stopPropagation();var t=this,r=$(e.currentTarget),o=r.data("unitcode"),n=r.val();setTimeout(function(){t.model.trigger("quantityChange",{deliveryCostGroupCode:t.model.get("deliveryPolicyModel").get("deliveryCostGroupCode"),$select:r,unitCode:o,quantity:n,model:t.model,multipleIndex:t.model.get("multipleIndex"),success:function(){t.model.setItemQuantity(o,n)},fail:function(){r.prop("selectedIndex",0),t.model.setItemQuantity(o,0)}})},100)},changeAddress:function(e){var t=this;1==$("._fastDeliveryCheckbox").is(":checked")&&t.model.setFastDeliveryPrice(!0),t.model.setDeliveryPrice()},getData:function(){var e=this,t=[],r=0;return e.model.get("orderItemPriceCollection").each(function(o){var n=o.get("selectQuantity");if(0!==n&&"0"!==n){var l={unitCode:o.get("unitCode"),quantity:n,deliveryIndex:e.model.get("multipleIndex")-1,orderDeliveryFeeForm:e.getDeliveryFeeForm(r)};t.push(l),r+=1}}),t},getDeliveryFeeForm:function(e){var t=this,r=t.model.get("selectedAddressModel"),o=e;return{jejuAddCost:0===o&&"01"===r.get("areaCls")?t.model.get("jejuAddCost"):0,islandAddCost:0===o&&"02"===r.get("areaCls")?t.model.get("landAddCost"):0,fastDeliveryReqYn:0===o&&t.model.get("fastDeliveryReqYn"),fastAddCost:0===o?t.model.get("fastAddCost"):0,deliveryFee:0===o?t.getDeliveryFee():0,deliveryCouponAmt:0===o&&!0==!!t.model.get("deliveryCoupon")?t.model.get("discountDeliveryFee"):0,deliveryCouponForm:0===o?t.getDeliveryCouponForm():null}},getDeliveryFee:function(){var e=this;return e.model.get("deliveryCoupon")?e.model.get("deliveryPolicyModel").get("deliveryPrice"):e.model.get("deliveryFee")},getDeliveryCouponForm:function(){var e=this,t=e.model.get("deliveryCoupon");return t?{offerCode:t.offerCode,giveSeq:t.giveSeq,date:t.giveDateString}:null},getSelectedPriceManagers:function(){var e=this,t=[];return e.model.get("orderItemPriceCollection").forEach(function(e){Number(e.get("selectQuantity"))>0&&t.push(e.toJSON())}),t}})}),define("page/cjmall/order/sheet/view/deliveryAddressItemView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/helper/deliveryAddressHelper"],function(e,t,r,o,n){return Backbone.View.extend({template:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/deliveryAddressItem"),notModifyAddressTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/notModifyAddressItem"),isPostChanged:!1,tag:"div",className:"item_addr_wrap",events:{"click ._address_edit":"edit","click ._address_delete":"delete","click ._address_edit_cancel":"editCancel","click ._address_edit_confirm":"editConfirm","click .inp_place":"select","click .lab_addr":"select","click .info_addr":"select","click .info_tel":"select","click .btn_post":"postFindOnClickHn"},initialize:function(){var e=this,t=e.model.get("dawnDeliveryArea");e.model.get("dawnDeliveryAreaDisplay")&&(t?e.model.set("dawnDeliveryAreaText","새벽배송 가능지역"):e.model.set("dawnDeliveryAreaText","새벽배송 불가지역"))},render:function(){var e=this,t=e.$el;return t.html(e.template(e.model.toJSON())),!0===e.model.get("isChecked")&&t.find(".item_addr").addClass("selected"),e.renderAfterInit(),e},renderAfterInit:function(){var e=this,t=e.$el.find("[data-modelIndex=cellno1]"),r=e.$el.find("[data-modelIndex=ddd]"),o=e.model.get("cellno1"),n=e.model.get("ddd");t.find("option").each(function(e){$(this).val()===o&&$(this).attr("selected",!0)}),r.find("option").each(function(e){$(this).val()===n&&$(this).attr("selected",!0)})},select:function(e){e.preventDefault();var t=this;!0!==t.model.get("isChecked")&&t.model.trigger("selected",t.model)},edit:function(e){e&&(e.originalEvent&&o.splunkClickLog("ODIN____delivery__addmod__"),e.preventDefault());var t=this,r=t.$el,n=r.find(".fld_write").is(":visible"),l=r.find("._btn_wrap"),i=r.find("._modify_btn_wrap");n||(l.hide(),i.show(),r.find(".fld_write:visible").slideUp(),r.find(".fld_write").slideDown(function(){$("html,body").animate({scrollTop:r.offset().top-$("#header").height()},500)}))},"delete":function(e){e&&(e.originalEvent&&o.splunkClickLog("ODIN____delivery__adddel__"),e.preventDefault());var t=this;_.defer(function(){t.deleteAddress()})},deleteAddress:function(){var e=this;window.confirm("삭제하시겠습니까?")&&e.model.destroy({xhrFields:{withCredentials:!0},url:e.model.url+e.model.get("deliv_plc_seq"),success:function(t,r){if(0===r.jsonTuple.code)return void alert(r.jsonTuple.message);t.trigger("delete",t),e.remove()},error:function(e,t){alert("배송지 삭제처리가 실패되었습니다. 잠시 후에 다시 시도해 주시기 바랍니다. 지속적으로 문제발생시 고객센터(1644-2525)로 연락주시기 바랍니다.")}})},editCancel:function(e){if(e){var t;$(e.target).is("button")?t="ODIN____delivery__addcan__":$(e.target).is("input")&&(t="ODIN____delivery__modcan__"),e.originalEvent&&t&&o.splunkClickLog(t),e.preventDefault()}var r=this,n=r.$el,l=n.find("._btn_wrap"),i=n.find("._modify_btn_wrap");r.isPostChanged&&(r.model.set(r.model.previousAttributes()),r.isPostChanged=!1),l.show(),i.hide(),n.find(".fld_write").slideUp(function(){r.render()})},validate:function(){var e=this,t=e.$el.find(".fld_write"),r=(e.model.get("isChecked"),window._cjmallOrderValidator),o=t.find(".tf_place"),n=e.$el.find("[data-modelindex=cellno1]"),l=e.$el.find("._cellno"),i=e.$el.find("[data-modelindex=ddd]"),a=t.find("._telno"),d=t.find(".tf_addr2"),s=!!r.validate(o),c=!(!r.validate(n)||!r.validate(l)),u=!(!r.validate(i)||!r.validate(a)),p=!!r.validate(d);if(!s)return alert("수령인 이름을 입력해 주세요"),o.focus(),!1;if(s){if(!0===r.isOverMaxlength(o))return alert("수령인은 "+o.data().maxlength+"자까지 입력가능합니다."),o.focus(),!1;if(!0===r.isHasSpecialChar(o.val()))return alert("특수문자입력은 불가합니다"),o.focus(),!1}if(!p)return alert("건물명을 포함한 상세 주소를 입력하세요"),d.focus(),!1;if(p&&!0===r.isOverMaxlength(d))return alert("상세주소는 "+d.data().maxlength+"자까지 입력가능합니다."),d.focus(),!1;if(!c&&!u)return!c&&!1==!!r.validate(n)&&r.validate(l)?(alert("전화 번호를 정확하게 입력해 주세요"),n.focus(),!1):!c&&!1==!!r.validate(l)&&r.validate(n)?(alert("전화 번호를 정확하게 입력해 주세요"),l.focus(),!1):(alert("한 개 이상의 전화번호를 입력하셔야 합니다"),n.focus(),!1);if(c){if(!1===r.isNumber(l.val()))return alert("전화 번호는 숫자만 입력해주세요"),l.focus(),!1;if(l.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),l.focus(),!1;if(!0===r.isOverMaxlength(l))return alert("전화 번호는 "+l.data().maxlength+"자까지 입력가능합니다."),l.focus(),!1}if(u){if(!1===r.isNumber(a.val()))return alert("전화 번호는 숫자만 입력해주세요"),l.focus(),!1;if(a.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),a.focus(),!1;if(!0===r.isOverMaxlength(a))return alert("전화 번호는 "+a.data().maxlength+"자까지 입력가능합니다."),a.focus(),!1}if(!c&&(r.validate(n)||r.validate(l)))return alert("전화 번호를 정확하게 입력해 주세요"),n.focus(),!1;if(!u){if(!1===r.validate(i)&&r.validate(a))return alert("전화 번호를 정확하게 입력해 주세요"),i.focus(),!1;if(!1===r.validate(a)&&r.validate(i))return alert("전화 번호를 정확하게 입력해 주세요"),a.focus(),!1}},editConfirm:function(e){if(e){var t;$(e.target).is("button")?t="ODIN____delivery__addok__":$(e.target).is("input")&&(t="ODIN____delivery__modok__"),e.originalEvent&&t&&o.splunkClickLog(t),e.preventDefault()}var r=this;if(!1!==r.validate()){var l=r.$el.find("._address_edit_confirm"),i=r.$el.find(".fld_write"),a=(r.model.get("isChecked"),window._cjmallOrderValidator,i.find(".tf_place")),d=r.$el.find("[data-modelindex=cellno1]"),s=r.$el.find("._cellno"),c=r.$el.find("[data-modelindex=ddd]"),u=i.find("._telno");i.find(".tf_addr2");r.model.set("delivPlcAlias",""),r.model.set("nm",a.val()),"0"===r.model.get("addressType")?r.model.set("addr",i.find(".tf_addr2").val()):r.model.set("roadAddr",i.find(".tf_addr2").val()),r.model.set("cellno1",d.val()),r.model.set("cellno2",r.subStringNo(s.val(),"first")),r.model.set("cellno3",r.subStringNo(s.val(),"second")),r.model.set("ddd",c.val()),r.model.set("telno1",r.subStringNo(u.val(),"first")),r.model.set("telno2",r.subStringNo(u.val(),"second")),Backbone.sync("update",r.model,{xhrFields:{withCredentials:!0},beforeSend:function(){l.attr("disabled",!0)},success:function(e,t,o){if(0===e.jsonTuple.code)return void alert(e.jsonTuple.message);if(r.model.set(e.jsonTuple.result.updateDeliveryAddresses),n.isDawnDeliveryItemIncluded()){var l="새벽배송 불가지역";r.model.set("dawnDeliveryAreaDisplay",!0);var i=n.isDawnDeliveryAbled(r.model);i&&(l="새벽배송 가능지역"),r.model.set("dawnDeliveryArea",i),r.model.set("dawnDeliveryAreaText",l)}r.model.trigger("selected",r.model),r.isPostChanged=!1},error:function(e,t,r){alert("배송지 수정이 실패되었습니다. 잠시 후에 다시 시도해 주시기 바랍니다. 지속적으로 문제발생시 고객센터(1644-2525)로 연락주시기 바랍니다.")},complete:function(){l.attr("disabled",!1)}})}},postFindOnClickHn:function(e){var r,o=this,n=t.get(t.APPLICATION_TYPE);switch(n){case"p":r="page/cjmall/postcode/p/pcPostPopupView";break;case"m":r="page/cjmall/postcode/m/mobilePostLayerView"}require([r],function(e){new e({afterSelectAddress:function(e,t){var r,n,l,i;"ADDRESS_ROAD_NAME"===t&&(r=e.ZIPNO5,n=e.ROAD_ADDR,l=e.BLD_NAME,i="1"),"ADDRESS_JIBUN"===t&&(r=e.ZIPNO,n=e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,l=e.ZIP_APT_BLD,i="0"),o.model.set({addressType:i,areaCls:e.AREA_CLS,fastAreaCls:e.FAST_AREA_CLS,roadBldDtlNm:e.BLD_NAME,roadAddr1:e.ROAD_ADDR,roadAddr:e.BLD_NAME,roadAddrId:e.ROAD_ADDR_ID,roadAddrSeq:e.ROAD_ADDR_SEQ,zipno:e.ZIPNO,zipno_seq:e.ZIPNO_SEQ,roadZipno:e.ZIPNO,roadZipnoSeq:e.ZIPNO_SEQ,newZipno:e.ZIPNO5,post_name:e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM}),o.$el.find(".tf_post").val(r),o.$el.find(".tf_addr1").val(n),o.$el.find(".tf_addr2").val(l),o.isPostChanged=!0}})})},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}}})}),define("page/cjmall/order/sheet/view/deliveryAddressView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/models/orderPriceGroupModel","page/cjmall/order/sheet/models/deliveryPolicyModel","page/cjmall/order/sheet/models/deliveryGroupItemModel","page/cjmall/order/sheet/collections/orderItemPriceCollection","page/cjmall/order/sheet/collections/deliveryGroupItemCollection","page/cjmall/order/sheet/collections/deliveryAddressCollection","page/cjmall/order/sheet/view/deliveryAddressItemView","page/cjmall/order/sheet/view/deliveryAddressGroupView","page/cjmall/order/sheet/models/deliveryAddressItemModel","page/cjmall/order/sheet/helper/deliveryAbleHelper","page/cjmall/order/sheet/view/p/otherDeliveryView","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil","common/cjmall/ui/calendar/views/calendarView","page/cjmall/order/sheet/models/deliveryHopeMainModel","page/cjmall/order/sheet/helper/orderSheetHelper","page/cjmall/order/sheet/helper/deliveryAddressHelper"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m,f,g,v,y,h,C){return Backbone.View.extend({template:f.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/deliveryAddress"),className:"order_dely",constructorName:"DeliveryAddressView",isNotHasAddress:!1,isMultiple:!1,multipleIndex:0,orderPriceModel:{},isMoreAddress:!0,isAbleSelectDeliveryDay:!0,currentTab:"SELECT_ADDRESS",isVenDeliveryOrder:!1,isAbleSelectDeliveryDay:!1,isDuplicateSelectDelivery:!1,isCookitDeliveryItem:!1,isDawnDeliveryItem:!1,isDawnDeliveryAreaDisplay:!1,isNewAddressDawnDeliveryAreaChecked:!0,venDeliveryOrderStatus:{isDeliveryOrder:!1,isNormalDeliveryItem:!1},events:{"click #_delivery":"showDeliveryOnClickHn","click #_new_address":"showNewAddressOnClickHn","click #_show_other_delivery":"showOtherDeliveryOnClickHn","click .addr_make .btn_post":"postFindOnClickHn","change ._hopedelyday":"hopeDeliveryDayOnChangeHn","change [name=basic_addr]":"setDefaultOnChangeHn","click #basic_addr_chk":"defaultDeliveryClickHn","click .date_ask":"hopeFixedCalenderCall","blur #doorPassword":"doorPasswordOnBlur","focusin #doorPassword":"doorPasswordOnFocusIn","change #doorPasswordType":"doorPasswordTypeOnChange","click #btnDawnDeliveryAreaCheck":"isDawnDeliveryAreaCheck"},initialize:function(e){var t=this;t.$el;t.deliveryAddressCollection=new d,t.deliveryAddressGroupViews=[],t.orderPriceModelGroupArray=[],t.deliveryGroupItemCollection=new a,t.deliveryAbleData={},t.isAbleSelectDeliveryDay=C.isAbleSelectDeliveryDay(),t.isAbleSelectDeliveryDay&&(t.isDuplicateSelectDelivery=C.getIsDuplicateSelectDelivery()),t.isCookitDeliveryItem=C.isCookitDeliveryItem(),t.isDawnDeliveryItem=C.isDawnDeliveryItem(),(t.isCookitDeliveryItem||t.isDawnDeliveryItem)&&(t.isDawnDeliveryAreaDisplay=!0),t.venDeliveryOrderStatus=C.getVenDeliveryOrderStatus(),t.setDeliveryVendorDates();var o=t.model.get("orderAddressType");"LATELY"===o?t.model.set("selectedAddressModel",t.model.get("latelyAddressModel")):"BASIC"===o?t.model.set("selectedAddressModel",t.model.get("basicAddressModel")):"NONE"===o&&(t.isNotHasAddress=!0,t.model.set("selectedAddressModel",new Backbone.Model)),t.model.set("SELECT_ADDRESS_selectedAddressModel",t.model.get("selectedAddressModel")),t.model.get("selectedAddressModel").set({isChecked:!0}),t.model.has("multipleIndex")&&(t.multipleIndex=t.model.get("multipleIndex"),t.isMultiple=!0),t.orderPriceModel=t.model.get("orderPriceModel"),t.orderPriceModelGroupArray=t.getOrderPriceModelGroupArray(),t.recentDeliveryMessages=t.model.get("recentDeliveryMessages"),t.model.set("isCookit",h.isCookitItemIncluded()),t.model.set("isDawn",h.isDawnItemIncluded()),t.setListener(),t.newAddressModel=new u,window._cjmallOrderObserver.setListeningCallback(t,"changeAddress",t.checkDeliveryAble),window._cjmallOrderObserver.setListeningCallback(t,"changeAddress",t.renderGroupView),window._cjmallOrderObserver.setListeningCallback(t,"checkHopeDeliveryDay",t.validateHopeDelivery),t.isDawnDeliveryAreaDisplay&&r.get("orderDoorPasswordModel").set("getOrderDoorPasswordDataCallback",$.proxy(t.getOrderDoorPasswordDataCallback,t)),t.render()},render:function(){var e=this,t=e.$el,o=e.model.get("selectedAddressModel").get("fastAreaCls");return e.isMultiple?(t.html(e.template({isMultiple:e.isMultiple,multipleIndex:e.model.get("multipleIndex"),orderPriceModelGroupArray:e.getTemplateJSON(),totalDeliveryCost:0,isAbleSelectDeliveryDay:!1,recentDeliveryMessages:e.recentDeliveryMessages})),e.renderGroupView(),t.find("dely_prod").removeClass("plural_order")):(t.html(e.template({orderPriceModelGroupArray:e.getTemplateJSON(),fastAreaCls:o,totalDeliveryCost:0,isAbleSelectDeliveryDay:e.isAbleSelectDeliveryDay,isDuplicateSelectDelivery:e.isDuplicateSelectDelivery,venDeliveryOrderStatus:e.venDeliveryOrderStatus,recentDeliveryMessages:e.recentDeliveryMessages,isCookitDeliveryItem:e.isCookitDeliveryItem,isDawnDeliveryItem:e.isDawnDeliveryItem,isDawnDeliveryAreaDisplay:e.isDawnDeliveryAreaDisplay,cookitIntersectionDateList:h.getCookitIntersectionDateList(),doorOptionList:e.model.get("orderPriceModel").get("doorOptionList"),orderSheetType:r.get("orderSheetType")})),t.find("dely_prod").addClass("plural_order")),!0===e.isNotHasAddress?(e.showNewAddressOnClickHn(),alert("기본 배송지 정보가 없습니다. 주소를 입력해주세요.")):(t.find(".addr_select").append(new s({model:e.model.get("selectedAddressModel")}).render().$el),e.showDeliveryOnClickHn()),e},manuallyClickCodeHn:function(e){g.splunkClickLog($(e.target).attr("data-click"))},setDeliveryVendorDates:function(){var t=this;if(t.isAbleSelectDeliveryDay&&t.venDeliveryOrderStatus.isDeliveryOrder&&t.venDeliveryOrderStatus.isNormalDeliveryItem){var o=r.get("orderPriceModel").get("orderPriceManagers"),n=[];_.forEach(o,function(t){var r={};r.modelCode=t.venModelCode,r.venCode=t.mainVenCode,r.qty=t.quantity,r.itemCode=t.itemCode,r.unitCode=t.unitCode,r.tempOrderNo=e.get("tempOrderNo"),n.push(r)});var l={};l.venDeliveryRequestDetailCriteria=n,t.deliveryHopeMainModel=new y,t.deliveryHopeMainModel.fetch({dataType:"json",contentType:"application/json;charset=utf-8",timeout:3e3,data:JSON.stringify(l),type:"POST",xhrFields:{withCredentials:!0},complete:function(e){var r=!1
;if("200"==e.status&&!_.isUndefined(e.responseJSON)&&e.responseJSON.jsonTuple.result.length>0&&(r=!0),r){t.$el.find(".date_ask").show()}else t.removeHopeDateCalendar()}})}},removeHopeDateCalendar:function(){this.$el.find(".date_ask").remove()},removeGroupViews:function(){var e=this;_.forEach(e.deliveryAddressGroupViews,function(e){e.remove()}),e.deliveryAddressGroupViews=[]},removeDeliveryCoupon:function(){var e=this;_.forEach(e.deliveryAddressGroupViews,function(e){e.removeDeliveryCoupon()})},renderGroupView:function(){var e=this,t=e.$el,r=(e.model.get("selectedAddressModel"),t.find("._group_box"));if(!1!==e.isMultiple){e.removeGroupViews(),r.empty(),e.deliveryGroupItemCollection.each(function(t,o){t.set({multipleIndex:e.multipleIndex,index:o});var n=new c({model:t});r.append(n.$el),e.deliveryAddressGroupViews.push(n)});var o="00"!==e.model.get("selectedAddressModel").get("areaCls"),n=e.$el.find("._landtext");o?n.show():n.hide()}},setListener:function(){var e=this;this.listenTo(this.model.get("selectedAddressModel"),"selected",this.deliveryAddressOnSelectedHn),this.listenTo(this.model.get("basicAddressModel"),"selected",this.deliveryAddressOnSelectedHn),this.listenTo(this.model.get("latelyAddressModel"),"delete",this.deliveryAddressOnDeleteHn),this.deliveryAddressCollection.on("add",this.deliveryAddressCollectionOnAddHn,this),e.orderPriceModel.on("change:totalOrderPriceTuple",function(){var t=this.get("totalOrderPriceTuple").totalDeliveryPrice,r=e.numberMasking(t);e.$el.find('[data-modelindex="totalDeliveryPrice"]').text(r)}),e.listenTo(e.deliveryGroupItemCollection,"deliveryPriceUpdate",e.renderDeliveryPrice),e.listenTo(e.deliveryGroupItemCollection,"quantityChange",e.throughEventToOrderSheetAddressView),e.listenTo(e.model,"change:selectedAddressModel",e.setAddressToDeliveryGroupView)},renderDeliveryPrice:function(e){var t=this,r=t.getTotalDeliveryPrice();t.$el.find('[data-modelindex="totalDeliveryPrice"]').text(t.numberMasking(r)),t.model.trigger("deliveryPriceUpdate"),t.checkDeliveryAbleByMulti()},updateDeliveryPrice:function(){var e=this,t=e.getTotalDeliveryPrice();e.$el.find('[data-modelindex="totalDeliveryPrice"]').text(e.numberMasking(t))},getTotalDeliveryPrice:function(){var e=this,t=0;return _.forEach(e.deliveryAddressGroupViews,function(e){t+=e.model.getDeliveryFee()}),t},getAddCostGroupView:function(){var e=this,t=0;if(!r.get("orderAddressModel").get("isMultiple"))throw new Error("복수배송지만 가능");return _.forEach(e.deliveryAddressGroupViews,function(e){t+=e.model.getFastAddCost(),t+=e.model.getRegionalAddPrice()}),t},getRegionalCostGroupView:function(){var e=this,t=0;return r.get("orderAddressModel").get("isMultiple")&&_.forEach(e.deliveryAddressGroupViews,function(e){t+=e.model.getRegionalAddPrice()}),t},setAddressToDeliveryGroupView:function(){var e=this;if(e.isMultiple){var t=e.model.get("selectedAddressModel");_.forEach(e.deliveryAddressGroupViews,function(e){e.model.set("selectedAddressModel",t)})}},uncheckDefaultAddress:function(){this.$el.find("[name=basic_addr]").prop("checked",!1)},throughEventToOrderSheetAddressView:function(e){this.model.trigger("quantityChange",e)},showDeliveryOnClickHn:function(e){e&&(e.originalEvent&&g.splunkClickLog("ODIN____delivery__seladd__"),e.preventDefault());var t=this,r=t.$el;if(t.isNotHasAddress)return void alert("저장된 배송지 정보가 없습니다");r.find("#_new_address").removeClass("on"),r.find("#_delivery").addClass("on"),r.find(".addr_select").show(),!0===t.isMoreAddress&&r.find("#_show_other_delivery").show(),r.find(".addr_make").hide(),t.currentTab="SELECT_ADDRESS",r.find("#basic_addr_chk").length>0?r.find(".dely_prod").removeClass("plural_order"):r.find(".dely_prod").addClass("plural_order"),t.newAddressTabInputReset(),t.model.set("selectedAddressModel",t.model.get("SELECT_ADDRESS_selectedAddressModel")),window._cjmallOrderObserver.eventTrigger("changeAddress",t)},showNewAddressOnClickHn:function(e){e&&(e.originalEvent&&g.splunkClickLog("ODIN____delivery__newadd__"),e.preventDefault());var t=this,r=t.$el;r.find("#_delivery").removeClass("on"),r.find("#_new_address").addClass("on"),r.find(".addr_select").hide(),r.find("#_show_other_delivery").hide(),r.find(".addr_make").show().css("display","block"),t.currentTab="NEW_ADDRESS",r.find(".dely_prod").removeClass("plural_order")},showOtherDeliveryOnClickHn:function(e){e&&e.originalEvent&&g.splunkClickLog("ODIN____delivery__viewadd__");var r=this,o=t.get(t.APPLICATION_TYPE);"m"===o&&r.mobileShowOtherDeliveryOnClickHn(e),"p"===o&&r.pcShowOtherDeliveryOnClickHn(e)},pcShowOtherDeliveryOnClickHn:function(e){e.preventDefault();var t=this,r=(t.$el,$(e.currentTarget)),o=0===t.deliveryAddressCollection.length,n=Number(t.model.get("selectedAddressModel").get("totalCount"));if(!0===o&&1===n)return alert("저장된 배송지 정보가 없습니다."),void(t.isMoreAddress=!1);new m({model:t.model,deliveryAddressCollection:new d,totalCount:n,otherDeliveryBtn:r,onClose:function(e){if(t.isCookitDeliveryItem||t.isDawnDeliveryItem){var r="새벽배송 불가지역";e.set("dawnDeliveryAreaDisplay",!0);var o=C.isDawnDeliveryAbled(e);o&&(r="새벽배송 가능지역"),e.set("dawnDeliveryArea",o),e.set("dawnDeliveryAreaText",r)}t.model.set("selectedAddressModel",e),t.model.set("SELECT_ADDRESS_selectedAddressModel",e),t.listenTo(e,"selected",t.deliveryAddressOnSelectedHn),t.listenTo(e,"delete",t.deliveryAddressOnDeleteHn),t.setDeliveryVendorDates(),t.render()}})},mobileShowOtherDeliveryOnClickHn:function(e){e.preventDefault();var t=this,r=(t.$el,$(e.currentTarget)),o=0===t.deliveryAddressCollection.length,n=Number(t.model.get("selectedAddressModel").get("totalCount"));if(!0===o&&1===n)return alert("저장된 배송지 정보가 없습니다."),void(t.isMoreAddress=!1);var l=t.deliveryAddressCollection.length+1,i=l+5,a=t.model.get("selectedAddressModel").get("deliv_plc_seq"),d=1,s=(n-1)%5==0?parseInt((n-1)/5):parseInt((n-1)/5)+1,c="";t.deliveryAddressCollection.fetch({remove:!1,data:{addressType:"LIST",startIndex:l,endIndex:i,delivPlcSeq:a},xhrFields:{withCredentials:!0},beforeSend:function(){r.attr("disabled",!0)},success:function(e,n,l){if(0===n.jsonTuple.code)return void alert(n.jsonTuple.message);var i=Number(e.models[0].get("totalCount"))-1;e.length>=i&&(r.hide(),t.isMoreAddress=!1),d=parseInt((n.jsonTuple.result[n.jsonTuple.result.length-1].rowNum-1)/5),c='<span class="num_count">(<em class="num_emph">'+d+"</em>/"+s+")</span>",o?(r.html("주소 더보기"+c),r.addClass("btn_more"),r.removeClass("btn_other")):r.html("주소 더보기"+c)},error:function(){},complete:function(){r.attr("disabled",!1)}})},deliveryAddressOnSelectedHn:function(e){event&&event.type&&"click"==event.type&&g.splunkClickLog("ODIN____delivery__addradio__");var t=this;e.set({isChecked:!0}),t.model.set("selectedAddressModel",e),t.model.set("SELECT_ADDRESS_selectedAddressModel",e),t.deliveryAddressCollection.reset(),t.isMoreAddress=!0,t.setDeliveryVendorDates(),t.render(),$("html,body").animate({scrollTop:t.$el.offset().top-$("#header").height()},500)},deliveryAddressOnDeleteHn:function(e){var t=this;if(!0==(!0===e.get("isChecked"))){var r=t.model.get("basicAddressModel");if("0"===r.get("default_yn"))return t.isNotHasAddress=!0,t.model.set("SELECT_ADDRESS_selectedAddressModel",null),void t.showNewAddressOnClickHn();var o=r;o.set({isChecked:!0}),t.model.set("selectedAddressModel",o),t.model.set("SELECT_ADDRESS_selectedAddressModel",o),t.setDeliveryVendorDates(),t.render()}},checkDeliveryAble:function(){var e=this;e.isMultiple?e.checkDeliveryAbleByMulti():e.checkDeliveryAbleBySingle()},checkDeliveryAbleBySingle:function(){var e=this,t=e.model.get("selectedAddressModel"),r=t.get("zipno")||t.get("zipNo"),o=t.get("zipno_seq");if(!1!=!!o){var n=e.model.get("orderPriceModel").get("orderPriceManagers");new p(r,o,n).checkDeliveryAble(function(t){e.deliveryAbleData=t,t.result.deliveryAble?window._cjmallOrderObserver.eventTrigger("checkDeliveryAble",!0):(alert(t.result.resultMessage),window._cjmallOrderObserver.eventTrigger("checkDeliveryAble",!1))})}},checkDeliveryAbleByMulti:function(){var e=this,t=e.model.get("selectedAddressModel"),r=t.get("zipno")||t.get("zipNo"),o=t.get("zipno_seq");if(!1!=!!o){var n=[];if(_.forEach(e.deliveryAddressGroupViews,function(e){var t=e.getSelectedPriceManagers();_.forEach(t,function(e){n.push(e)})}),0===n.length)return void(e.deliveryAbleData=null);new p(r,o,n).checkDeliveryAble(function(t){e.deliveryAbleData=t,t.result.deliveryAble?window._cjmallOrderObserver.eventTrigger("checkDeliveryAble",!0):(alert(t.result.resultMessage),window._cjmallOrderObserver.eventTrigger("checkDeliveryAble",!1))})}},deliveryAddressCollectionOnAddHn:function(e){var t=this;if(t.isCookitDeliveryItem||t.isDawnDeliveryItem){var r="새벽배송 불가지역";e.set("dawnDeliveryAreaDisplay",!0);var o=C.isDawnDeliveryAbled(e);o&&(r="새벽배송 가능지역"),e.set("dawnDeliveryArea",o),e.set("dawnDeliveryAreaText",r)}this.listenTo(e,"selected",this.deliveryAddressOnSelectedHn),this.listenTo(e,"delete",this.deliveryAddressOnDeleteHn),this.$el.find(".addr_select").append(new s({model:e}).render().$el)},getTemplateJSON:function(){var e=this,t=r.createDeliveryPolicyCollection(),o=e.model.get("orderPriceModel").get("orderPriceManagers"),n=e.model.get("selectedAddressModel"),a=[];return e.deliveryGroupItemCollection.reset(),_.forEach(t.models,function(t){var r=$.extend(!0,{fastDeliveryAddPrice:t.get("fastDeliveryAddPrice"),priceManagers:[]},t.toJSON());r.priceManagers=$.grep(o,function(e){return e.orderDeliveryTuple.deliveryCostGrpCode===r.deliveryCostGroupCode}),a.push(r);var d=new l;d.set({selectedAddressModel:n,deliveryPolicyModel:t,orderItemPriceCollection:new i(r.priceManagers)}),e.deliveryGroupItemCollection.add(d)}),a},getOrderPriceModelGroupArray:function(){var e=this,t=r.createDeliveryPolicyCollection(),o=[],n=e.model.get("orderPriceModel").get("orderPriceManagers");return _.forEach(t.models,function(e){var t=new Backbone.Model($.extend(!0,{},e.toJSON()));t.set({fastDeliveryAddPrice:e.get("fastDeliveryAddPrice"),priceManagers:[]});var r=$.grep(n,function(e){return e.orderDeliveryTuple.deliveryCostGrpCode===t.get("deliveryCostGroupCode")});t.set("priceManagers",r),o.push(t)}),o},updateTotalPrice:function(){var e=this.getTotaldeliveryPrice();this.orderPriceModel.get("totalOrderPriceTuple").totalDeliveryPrice=e,this.orderPriceModel.trigger("change:totalOrderPriceTuple")},getTotaldeliveryPrice:function(){var e=this,t=0;return _.forEach(e.deliveryAddressGroupViews,function(e){t+=e.getDeliveryPrice()}),t},postFindOnClickHn:function(e){var r,o=this,n=t.get(t.APPLICATION_TYPE);switch(n){case"p":r="page/cjmall/postcode/p/pcPostPopupView";break;case"m":r="page/cjmall/postcode/m/mobilePostLayerView"}require([r],function(e){new e({afterSelectAddress:function(e,t){var r,n,l,i;"ADDRESS_ROAD_NAME"===t&&(r=e.ZIPNO5,n=e.ROAD_ADDR,l=e.BLD_NAME,i="1"),"ADDRESS_JIBUN"===t&&(r=e.ZIPNO,n=e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,l=e.ZIP_APT_BLD,i="0"),o.$el.find(".addr_make .tf_post").val(r),o.$el.find(".addr_make .tf_addr1").val(n),o.$el.find(".addr_make .tf_addr2").val(l);var a={addressType:i,areaCls:e.AREA_CLS,fastAreaCls:e.FAST_AREA_CLS,roadBldDtlNm:e.BLD_NAME,roadAddr1:e.ROAD_ADDR,roadAddr:e.BLD_NAME,roadAddrId:e.ROAD_ADDR_ID,roadAddrSeq:e.ROAD_ADDR_SEQ,zipno:e.ZIPNO,zipno_seq:e.ZIPNO_SEQ,roadZipno:e.ZIPNO,roadZipnoSeq:e.ZIPNO_SEQ,newZipno:e.ZIPNO5,post_name:e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,addr:e.ZIP_APT_BLD,fullAddress:n+" "+l};o.newAddressModel.set(a),o.model.set("selectedAddressModel",o.newAddressModel),window._cjmallOrderObserver.eventTrigger("changeAddress",o)}})})},deliMsgSelectOnChangeHn:function(e){var t=this,r=$(e.currentTarget),o=t.$el.find(r.data().delimsgTargetSelector);0==r.prop("selectedIndex")?o.val("").blur():o.val(r.val()).blur()},newAddressTabInputReset:function(){var e=this;e.$el.find(".addr_make").find(":input").not(":button").each(function(){"SELECT"===this.nodeName&&(this.selectedIndex=0),"INPUT"===this.nodeName&&(this.value="")}),e.isDawnDeliveryAreaDisplay&&$("#dawn_area_text").hide()},setSelectedAddresByDefault:function(){var e=this;e.$el;0==!!e.model.get("basicAddressModel").get("default_yn")?e.deliveryAddressOnSelectedHn(e.model.get("basicAddressModel")):(e.isNotHasAddress=!0,e.showNewAddressOnClickHn())},getHasDeliveryFeeGroup:function(){var e=this,t=[];return _.forEach(e.deliveryAddressGroupViews,function(e){e.model.get("deliveryFee")>0&&t.push(e)}),t},getAddressData:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=(e.isMultiple,e.model.get("orderSheetType")),n=t.find("._hopedelyday"),l=t.find("._fixeddelyday"),i=t.find("textarea._delimsg");if(e.deliveryAbleData&&e.deliveryAbleData.result&&!1===e.deliveryAbleData.result.deliveryAble)return alert(e.deliveryAbleData.result.resultMessage),!1;if(!0==!!i.val()&&!0===r.isOverMaxlength(i))return alert("배송메세지는 "+i.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(i),!1;if(!0==!!n.length&&!1==!!n.val())return alert("배송희망일을 선택해주세요"),e.scrollTo(n.parent()),!1;if("SELECT_ADDRESS"===e.currentTab){if(("NORMAL"===o||"OLIVEYOUNG"===o)&&!e.validateSelectAddress())return!1;var a=$.extend(e.model.get("selectedAddressModel").toJSON(),{message:i.val(),customerHopeDate:n.length?n.val():null,customerApptDate:l.length?l.val():null,deliveryIndex:!0===e.isMultiple?e.multipleIndex-1:0});if(a.defaultDelivFlag=$("#basic_addr_chk").is(":checked")?"1":"0",!1==!!e.model.get("basicAddressModel").get("deliv_plc_seq")&&(a.defaultDelivFlag="1"),e.isMultiple){var d=[];return _.forEach(e.deliveryAddressGroupViews,function(e){var t=e.getData();!0==!!t.length&&(d=_.union(d,t))}),{deliveryAddressData:a,deliveryGroupOrderItems:d}}return a}if("NEW_ADDRESS"===e.currentTab){if(e.validateNewAddress()){e.setNewAddressModel();var a=$.extend(e.newAddressModel.toJSON(),{message:i.val(),customerHopeDate:n.length?n.val():null,customerApptDate:l.length?l.val():null,deliveryIndex:!0===e.isMultiple?e.multipleIndex-1:0});if(a.defaultDelivFlag=$("#basic_addr_chk").is(":checked")?"1":"0",!1==!!e.model.get("basicAddressModel").get("deliv_plc_seq")&&(a.defaultDelivFlag="1"),e.isMultiple){var d=[];_.forEach(e.deliveryAddressGroupViews,function(e){var t=e.getData();!0==!!t.length&&(d=_.union(d,t))})}return e.isMultiple?{deliveryAddressData:a,deliveryGroupOrderItems:d}:a}return!1}},validateSelectAddress:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=t.find(".addr_select"),n=o.find(".tf_post"),l=o.find(".tf_addr1"),i=o.find(".tf_addr2");if(!r.validate(n)||!r.validate(l))return alert("배송지 정보가 없습니다. 주소를 입력해주세요"),e.scrollTo(o),!1;if(!1===r.validate(i))return alert("건물명을 포함한 상세 주소를 입력하세요"),e.scrollTo(o),!1;if(!0===r.isOverMaxlength(i))return alert("상세주소는 "+i.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(o),!1;if(e.isCookitDeliveryItem||e.isDawnDeliveryItem){var a="새벽배송 불가지역";e.model.get("selectedAddressModel").set("dawnDeliveryAreaDisplay",!0),e.model.get("selectedAddressModel").set("fullAddress",l.val()+" "+i.val()),e.model.get("selectedAddressModel").set("dawnDeliveryArea",!1),e.model.get("selectedAddressModel").set("dawnDeliveryAreaText",a);if(!C.isDawnDeliveryAbled(e.model.get("selectedAddressModel")))return alert("새벽배송 불가지역으로 주문이 불가합니다."),!1;a="새벽배송 가능지역",e.model.get("selectedAddressModel").set("dawnDeliveryArea",!0),e.model.get("selectedAddressModel").set("dawnDeliveryAreaText",a)}return!0},setNewAddressModel:function(){var e=this,t=e.$el,r=e.newAddressModel,o=t.find(".addr_make"),n=o.find(".tf_place"),l=(o.find(".tf_post"),o.find(".tf_addr1")),i=o.find(".tf_addr2"),a=o.find("._cellno1"),d=o.find("._cellno"),s=o.find("._telno1"),c=o.find("._telno");r.set("delivPlcAlias",n.val()),r.set("nm",n.val()),r.set("cellno1",a.val()),r.set("cellno2",C.subStringNo(d.val(),"first")),r.set("cellno3",C.subStringNo(d.val(),"second")),r.set("ddd",s.val()),r.set("telno1",C.subStringNo(c.val(),"first")),r.set("telno2",C.subStringNo(c.val(),"second")),r.set("addr",i.val()),r.set("roadAddr",i.val()),r.set("fullAddress",l.val()+" "+i.val())},validateNewAddress:function(){var e=this,t=e.$el,r=t.find(".addr_make"),o=window._cjmallOrderValidator,n=r.find(".tf_place"),l=r.find(".tf_post"),i=r.find(".tf_addr1"),a=r.find(".tf_addr2"),d=r.find("._cellno1"),s=r.find("._cellno"),c=r.find("._telno1"),u=r.find("._telno"),p=!!o.validate(n),m=!(!o.validate(l)||!o.validate(i)),f=!(!o.validate(d)||!o.validate(s)),g=!(!o.validate(c)||!o.validate(u));if(!p)return alert("수령인 이름을 입력해 주세요."),e.scrollTo(n),!1;if(p){if(!0===o.isOverMaxlength(n))return alert("수령인은 "+n.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(n),!1;if(!0===o.isHasSpecialChar(n.val()))return alert("특수문자입력은 불가합니다"),e.scrollTo(n),!1}if(!m)return alert("기본배송지 정보가 없습니다. 주소를 입력해주세요"),e.scrollTo(l),!1;if(m){if(!1===o.validate(a))return alert("건물명을 포함한 상세 주소를 입력하세요"),e.scrollTo(a),!1;if(!0===o.isOverMaxlength(a))return alert("상세주소는 "+a.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(a),!1;if(e.isCookitDeliveryItem||e.isDawnDeliveryItem){var v="새벽배송 불가지역";e.newAddressModel.set("dawnDeliveryAreaDisplay",!0),e.newAddressModel.set("fullAddress",i.val()+" "+a.val()),e.newAddressModel.set("dawnDeliveryArea",!1),e.newAddressModel.set("dawnDeliveryAreaText",v);if(!C.isDawnDeliveryAbled(e.newAddressModel))return alert("새벽배송 불가지역으로 주문이 불가합니다."),!1;v="새벽배송 가능지역",e.newAddressModel.set("dawnDeliveryArea",!0),e.newAddressModel.set("dawnDeliveryAreaText",v)}}if(!f&&!g)return!f&&!1==!!o.validate(d)&&o.validate(s)?(alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(d),!1):!f&&!1==!!o.validate(s)&&o.validate(d)?(alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(s),!1):(alert("한개 이상의 전화번호를 입력하셔야 합니다"),e.scrollTo(d),!1);if(f){if(!1===o.isNumber(s.val()))return alert("전화번호를 정확하게 입력해 주세요"),e.scrollTo(s),!1;if(s.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(s),!1;if(!0===o.isOverMaxlength(s))return alert("전화 번호는 "+s.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(s),!1}if(g){if(!1===o.isNumber(u.val()))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(u),!1;if(u.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(u),!1;if(!0===o.isOverMaxlength(u))return alert("전화 번호는 "+u.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(u),!1}if(!f&&(o.validate(d)||o.validate(s)))return alert("전화 번호를 정확하게 입력해 주세요"),!1;if(!g){if(!1===o.validate(c)&&o.validate(u))return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(c),!1;if(!1===o.validate(u)&&o.validate(c))return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(u),!1}return!0},validateHopeDelivery:function(e){var t,o,n=this,l=n.$el.find("._hopedelyday"),i=l.val(),a=r.get("orderPaymentModel"),d=a.get("_paymentDueDate");"NOBANKBOOK"===a.get("_payType")&&!0==!!i&&!0==!!d&&(t=C.makeDate(i),o=C.makeDate(d),(t.getTime()-o.getTime())/1e3/60/60/24<3&&(alert("배송희망일 이전에 결제가 완료되어야합니다. 입금예정일을 다시 선택해주세요."),e.prop("selectedIndex",0)))},hopeDeliveryDayOnChangeHn:function(e){var t=this,r=t.$el.find("._hopedelyday");window._cjmallOrderObserver.eventTrigger("checkHopeDeliveryDay",r)},defaultDeliveryClickHn:function(e){var t,r=this;e&&("SELECT_ADDRESS"===r.currentTab?t="ODIN____delivery__resadd":"NEW_ADDRESS"===r.currentTab&&(t="ODIN____delivery__nresadd"),$(e.target).is(":checked")?t+="on__":t+="off__",e.originalEvent&&g.splunkClickLog(t))},setDefaultOnChangeHn:function(e){var t=this;$(e.currentTarget).is(":checked")&&t.model.trigger("setdefault",t.multipleIndex)},hopeFixedCalenderCall:function(e){if(e.preventDefault(),!h.isCookitItemIncluded()){var o=this,n=o.$el,l=r.get("orderPriceModel").get("orderPriceManagers"),i="",a=[],d=1,s=1,c=new Array,u={};if(l[0].isCustHopeDelyYn?(i="배송희망일",a=l[0].isCustHopeDelyDateList):l[0].isCustFixedDelyYn&&(i="지정배송일",a=l[0].isCustFixedDelyDateList),s=Number(a[a.length-1].yyyymmdd.substring(4,6))-Number(a[0].yyyymmdd.substring(4,6)),s>0?d=s+1:s<0&&(d=s+13),_.forEach(a,function(e){"0"==e.isHolyYesterday||"1"==e.isHolyYesterday?l[0].isCustHopeDelyYn&&l[0].orderItemTypeTuple.dawn?"1"!=e.isHolyYesterday&&c.push(e.yyyymmdd):l[0].isCustFixedDelyYn&&"55"==l[0].itemLgrpCode?"1"!=e.isHolyYesterday&&c.push(e.yyyymmdd):c.push(e.yyyymmdd):u[e.yyyymmdd]=e.isHolyYesterday}),a[0].yyyymmdd.length<8)return void alert("날짜 선택에 문제가 있어 선택이 불가능 합니다.");var p,m=t.get(t.APPLICATION_TYPE);"m"===m?p="common/cjmall/ui/m/layerPopups/views/layerPopupContainerView":"p"===m&&(p="common/cjmall/ui/p/layerPopups/views/layerPopupContainerView"),o.venDeliveryOrderStatus.isDeliveryOrder&&o.deliveryHopeMainModel.getHasDate()&&(c=o.deliveryHopeMainModel.getVenAvailableDate(),a[0].yyyymmdd=c[0],d=2),require([p],function(e){o.layerPopupView=new e({title:i,content:new v({year:a[0].yyyymmdd.substring(0,4),month:Number(a[0].yyyymmdd.substring(4,6))+"",date:"1",numberOfMonths:d,isSelectable:!1,holidays:u,excludes:{dates:c,holiday:!1},isMultiple:!1,onSelect:function(e){var t=new Array("일","월","화","수","목","금","토"),r=Number(e.month)>9?e.month:"0"+e.month,i=Number(e.date)>9?e.date:"0"+e.date,a=e.year+"."+r+"."+i+"("+t[new Date(e.year,e.month-1,e.date).getDay()]+")",d=""+e.year+r+i;l[0].isCustHopeDelyYn?(n.find("#hopedelydayDisplay").html(a),n.find("#hopedelydayValue").val(d)):l[0].isCustFixedDelyYn&&(n.find("#fixeddelydayDisplay").html(a),n.find("#fixeddelydayValue").val(d)),setTimeout(function(){o.layerPopupView.hide()},200)}})}),o.layerPopupView.show()})}},validateOrderDoorPasswordForm:function(){var e=this,t=$("#hopedelydayValue"),r=$("#doorPasswordType"),o=$("#doorPassword"),n=$("#doorPasswordAgree");return _.isEmpty(t.val())?(alert("배송희망일을 선택하세요."),e.scrollTo(t),!1):_.isEmpty(r.val())?(alert("공동현관 출입방법을 선택하세요."),e.scrollTo(r),!1):"03"!=r.val()&&_.isEmpty($.trim(o.val()))?(alert("공동현관 비밀번호를 입력하세요."),e.scrollTo(o),!1):0!=n.is(":checked")||(alert("출입정보 저장 동의는 필수입니다."),e.scrollTo(n),!1)},getOrderDoorPasswordDataCallback:function(){var e=this;return 0!=e.validateOrderDoorPasswordForm()&&e.getOrderDoorPasswordData()},getOrderDoorPasswordData:function(){var e=$("#doorPasswordType"),t=$("#doorPassword"),r=e.val(),o=t.val();"03"==r&&(o="비밀번호 없음");var n=new Backbone.Model;return n.set("doorPasswordType",e.val()),n.set("doorPassword",o),n},doorPasswordOnFocusIn:function(e){$(e.currentTarget).siblings(".lab_cont").hide()},doorPasswordOnBlur:function(e){var t=$(e.currentTarget),r=t.siblings(".lab_cont");0==$.trim(t.val()).length&&r.show()},doorPasswordTypeOnChange:function(e){var t=$(e.currentTarget),r=$("#doorPassword"),o=r.siblings(".lab_cont"),n=t.val();r.val(""),"03"==n?(r.prop("disabled",!0),r.parent().hide()):(""==n?o.text("공동현관 비밀번호를 입력해주세요"):"01"==n?o.text("예: #1234*"):"02"==n?o.text("경비실 호출 방법을 입력해주세요."):"04"==n&&o.text("기타사항을 입력해주세요."),0==$.trim(r.val()).length&&o.show(),r.prop("disabled",!1),r.parent().show())},isDawnDeliveryAreaCheck:function(e){var t=this,r=t.$el,o=r.find(".addr_make"),n=window._cjmallOrderValidator,l=o.find(".tf_post"),i=o.find(".tf_addr1"),a=o.find(".tf_addr2"),d=!(!n.validate(l)||!n.validate(i));if(!d)return alert("주소를 입력하세요."),t.scrollTo(l),!1;if(d){if(!1===n.validate(a))return alert("건물명을 포함한 상세 주소를 입력하세요"),t.scrollTo(a),!1;if(!0===n.isOverMaxlength(a))return alert("상세주소는 "+a.data().maxlength+"자까지 입력가능합니다."),t.scrollTo(a),!1}if(t.isCookitDeliveryItem||t.isDawnDeliveryItem){var s="새벽배송 불가지역";t.newAddressModel.set("dawnDeliveryAreaDisplay",!0),t.newAddressModel.set("fullAddress",i.val()+" "+a.val());var c=C.isDawnDeliveryAbled(t.newAddressModel);console.log("isDawnDeliveryAreaCheck() : "+c),c?(s="새벽배송 가능지역",alert("새벽배송 가능지역입니다.")):alert("새벽배송 불가지역으로 주문이 불가합니다."),t.newAddressModel.set("dawnDeliveryArea",c),t.newAddressModel.set("dawnDeliveryAreaText",s)}}})}),define("page/cjmall/order/sheet/view/latelyChargeDiscountExpectPriceView",["common/cjos/util/handlebarsHelper","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/sheet/models/orderSheetMainModel"],function(e,t,r){return Backbone.View.extend({id:"_latelyChargeExpectPrice",template:e.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===t.get(t.APPLICATION_TYPE)?"p":"m")+"/latelyCardChargeDiscount"),events:{},render:function(e){var t=this,r=t.$el;if(e===undefined||null===e||e<0)return null;var o={chargeExpectPrice:e};return r.append(t.template(o)),t},getExpectedPrice:function(){var e=this,r=e.model.chargeDiscountList,o=e.model._payType;if(r===undefined||null===r||0===r.length)return 0;if("SMILEPAY"===o||"KAKAOTALKPAY"===o||"PAYCO"===o)return 0;for(var n=0,l=t.userAgent,i=0;i<r.length;i++)if(r[i].payType===o){if(l.get(l.IS_OSHOPPING_APP)){n=e.calculateExpectPrice(r[i]);break}if("N"===r[i].appYn){n=e.calculateExpectPrice(r[i]);break}}return n},calculateExpectPrice:function(e){var t=r.get("orderBenefitModel").get("_paymentAmount"),o=e.strAmt;if(null===o||o>t)return 0;var n=e.dcRc,l=e.limitCd,i=e.limitAmt;if(null===n||n<=0)return 0;var a=0;if(null===l||null===i||i<=0)a=10*Math.floor(t*n/1e3);else if("01"===l){var d=t;t>i&&(d=i),a=10*Math.floor(d*n/1e3)}else"02"===l&&(a=10*Math.floor(t*n/1e3))>i&&(a=i);return t-a}})}),define("page/cjmall/order/sheet/view/orderAgreeView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/inflowInfo/inflowInfo","common/cjos/logger/utils/loggerUtil","common/cjos/util/handlebarsHelper"],function(e,t,r,o){return Backbone.View.extend({el:"#orderAgree",template:o.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===t.get(t.APPLICATION_TYPE)?"p":"m")+"/orderAgree"),model:null,asianaSaveYn:null,okCashBagSaveYn:null,isAgreeSavePersonalClearance:null,isChangedCustomsIdNum:!1,templateData:undefined,events:{"focus [data-placeholder]":"inputOnFocusHn","blur [data-placeholder]":"inputOnBlurHn","focus #customs_id_num":"customIdNumFocusHn","change #asiana_num_save":"asianaNumSaveChangeHn","change #okcashback_save":"okCashBagSaveChangeHn","click #asiana_chk_btn":"asianaChkBtnOnClickHn","click #hanssemInteriorPackageAgree":"hanssemInteriorPackageAgreeClickHn","keydown #customs_id_num":"changedCustomsIdNum","change #agr_customs":"customsIdNumReuseSaveChangeHn"},initialize:function(){var t=this;t.model=e.get("orderPriceModel"),t.priceManagers=t.model.get("orderPriceManagers"),t.orderSheetMainModel=e,t.setHandlebarsHelper(),t.render(),e.get("orderPaymentModel").set("getOrderEtcFormCallback",$.proxy(t.getData,t))},render:function(){var e=this,t=e.$el;e.templateData={freshFood:e.getFreshFood(),orderMaking:e.getOrderMaking(),abroad:e.getAbroad(),asiana:e.getAsiana(),okCashBag:e.getOkCashBag(),hanssemInteriorPackage:e.getHanssemInteriorPackage(),customsIdNumber:e.getCustomsIdNumber(),installationDelivery:e.getIsInstallationDelivery()},t.html(e.template(e.templateData))},setHandlebarsHelper:function(){Handlebars.registerHelper("_getAsianaLinkHelper",function(e){var r,o=t.get(t.APPLICATION_TYPE);return"m"===o&&(r="https://m.flyasiana.com/I/KO/GetMemberInformation.do?mobile=y&opentarget=new"),"p"===o&&(r="http://flyasiana.com/I/ko/MyAsianaMain.do"),new Handlebars.SafeString(r)}),Handlebars.registerHelper("_getCountHelper",function(e){return++e})},getFreshFood:function(){var e=this,t=[];return _.forEach(e.priceManagers,function(e){e.orderItemTypeTuple.freshFood&&t.push(e)}),t},getOrderMaking:function(){var e=this,t=[];return _.forEach(e.priceManagers,function(e){e.orderItemTypeTuple.orderMaking&&t.push(e)}),t},getAbroad:function(){var e=this,t=[];return _.forEach(e.priceManagers,function(e){e.orderItemTypeTuple.internationalClearance&&t.push(e)}),t},getAsiana:function(){var e=this,t=[];return _.forEach(e.priceManagers,function(e){e.asiana&&t.push(e)}),t.length?t[0]:null},getOkCashBag:function(){var e=this,t=[];return _.forEach(e.priceManagers,function(e){e.okCashBag&&t.push(e)}),t.length?t[0]:null},getHanssemInteriorPackage:function(){var e=this,t=[];return _.forEach(e.priceManagers,function(e){e.hanssemInteriorPackage&&t.push(e)}),t.length?t[0]:null},getCustomsIdNumber:function(){var e=this,t=e.orderSheetMainModel.get("customsIdNumber");return(_.isUndefined(t)||_.isNull(t))&&(t=""),t},changedCustomsIdNum:function(e){var t=this;t.$el.find("#agreeReuseCustomsIdNumber").find("input[type=checkbox]").prop("checked",!1),t.$el.find("#agreeReuseCustomsIdNumber").show(),t.isChangedCustomsIdNum=!0},getIsInstallationDelivery:function(){for(var e=this,t="",r=e.priceManagers.length,o=0;o<r;o++)!0===e.priceManagers[o].orderItemTypeTuple.installationDelivery&&(o>0&&(t+=" + "),t+=e.priceManagers[o].itemName);return{isInstallationDelivery:e.model.get("totalOrderItemTypeTuple").installationDelivery,itemNames:t}},numberOnKeyDownHn:function(e){e.keyCode>47&&e.keyCode<58||32===e.keyCode||8===e.keyCode||37===e.keyCode||39===e.keyCode||9===e.keyCode||16===e.keyCode||e.preventDefault()},inputOnFocusHn:function(e){$(e.currentTarget).siblings(".lbl").hide()},inputOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lbl");0==$.trim(t.val()).length?r.show():r.hide()},customIdNumFocusHn:function(e){$(e.currentTarget);$("#custom_collect_agree").prop("checked",!0)},asianaNumSaveChangeHn:function(e){var t=this,r=$(e.currentTarget);r.is(":checked")?(alert("아시아나클럽 제휴링크를 통해 방문시,\n현재 입력하신 적립카드번호가 저장되어 다시 입력하지 않으셔도 되며 추후 삭제를 희망하실 경우 저장 체크박스를 해제해주시면 삭제됩니다."),t.asianaSaveYn=!0):confirm("제휴적립정보를 더이상 저장하지 않으시겠습니까?\n금번 주문까지만 저장된 적립정보로 적립되고 다음번 주문부터는 적립정보를 새로 입력하셔야 합니다.")?t.asianaSaveYn=!1:(t.asianaSaveYn=!0,r.prop("checked",!0))},okCashBagSaveChangeHn:function(e){var t=this,r=$(e.currentTarget);r.is(":checked")?(alert("OK캐쉬백 제휴링크를 통해 방문시,\n현재 입력하신 적립카드번호가 저장되어 다시 입력하지 않으셔도 되며 추후 삭제를 희망하실 경우 저장 체크박스를 해제해주시면 삭제됩니다."),t.okCashBagSaveYn=!0):confirm("제휴적립정보를 더이상 저장하지 않으시겠습니까?\n금번 주문까지만 저장된 적립정보로 적립되고 다음번 주문부터는 적립정보를 새로 입력하셔야 합니다.")?t.okCashBagSaveYn=!1:(t.okCashBagSaveYn=!0,r.prop("checked",!0))},asianaMileNumCheck:function(){var e=this;if(!1==!!e.templateData.asiana)return!0;var t=e.$el.find("#asiana_milieage_num"),r=e.$el.find("#asiana_agree"),o=r.is(":checked"),n=e.$el.find("#asiana_num_save"),l=n.is(":checked"),i=t.val();if(!0===o){if(""==$.trim(i))return alert("아시아나 회원번호를 입력해 주세요."),!1;if(l&&""==$.trim(i))return alert("아시아나 회원번호를 입력해 주세요."),!1;if($.trim(i).length<9)return alert("아시아나 회원번호 9자리를 정확하게 입력해 주세요."),!1;if(0==e.getAsianaVariable().checkForAsiana(i))return alert("아시아나 회원번호 9자리를 정확하게 입력해 주세요.\n\n아시아나 회원번호는 아시아나 고객센터로 문의하시기 바랍니다."),!1}else if(""!=$.trim(i))return alert("아시아나 정보제공에 동의해주시기 바랍니다"),!1;return!0},asianaChkBtnOnClickHn:function(){var e=this,t=e.$el.find("#asiana_milieage_num"),r=t.val();0==e.getAsianaVariable().checkForAsiana(r)?alert("아시아나 회원번호 9자리를 정확하게 입력해 주세요.\n\n아시아나 회원번호는 아시아나 고객센터로 문의하시기 바랍니다."):alert("아시아나 회원번호가 확인되었습니다.")},hanssemInteriorPackageAgreeClickHn:function(e){e&&e.originalEvent&&r.splunkClickLog("ODIN__clause_agree__")},okCashBagNumCheck:function(){var e=this,t=window._cjmallOrderValidator;if(!1==!!e.templateData.okCashBag)return!0;var r=e.$el.find("#okcashbag_num"),o=e.$el.find("#okcashback_agree"),n=o.is(":checked"),l=e.$el.find("#okcashback_save"),i=l.is(":checked"),a=r.val();return n&&""==$.trim(a)?(alert("OK캐쉬백 카드번호를 입력해 주세요."),!1):i&&""==$.trim(a)?(alert("OK캐쉬백 카드번호를 입력해 주세요."),!1):n&&$.trim(a).length<16?(alert("OK캐쉬백 카드번호 16자리를 정확하게 입력해 주세요."),!1):!n||!1!==t.isNumber(a)||(alert("OK캐쉬백 카드번호는 숫자만 입력가능합니다."),!1)},customIdNumCheck:function(){var e=this;if(0==e.templateData.abroad.length)return!0;var t=e.$el.find("#customs_id_num"),r=e.$el.find("#custom_collect_agree"),o=r.is(":checked"),n=t.val();return!1===o?(alert("주문상품에 대한 동의여부를 확인해주세요."),!1):null==n.match("[pP][0-9]{12}")||n.length<13?(alert("개인통관고유부호를 정확히 입력해주세요."),!1):(t.val(n.toUpperCase()),!0)},customsIdNumReuseSaveChangeHn:function(e){var t=this,r=$(e.currentTarget);r.is(":checked")?(t.isAgreeSavePersonalClearance=!0,r.prop("checked",!0)):(t.isAgreeSavePersonalClearance=!1,r.prop("checked",!1))},getReuseAgreeCustomsIdNumber:function(){var e=this;return!(!e.getCustomsIdNumber()||!1!==e.isChangedCustomsIdNum)||e.isAgreeSavePersonalClearance},freshFoodCheck:function(){var e=this;return 0==e.templateData.freshFood.length||(!1!==e.$el.find("#freshagree").is(":checked")||(alert("주문상품에 대한 동의여부를 확인해주세요."),!1))},orderMakingCheck:function(){var e=this;return 0==e.templateData.orderMaking.length||(!1!==e.$el.find("#customagree").is(":checked")||(alert("주문상품에 대한 동의여부를 확인해주세요."),!1))},installationDeliveryAgreeCheck:function(){var e=this
;return!e.templateData.installationDelivery.isInstallationDelivery||(!!e.$el.find("#install_provide").is(":checked")||(alert("설치상품에 대한 동의여부를 확인해주세요."),!1))},hanssemInteriorPackageCheck:function(){var e=this;return null==e.templateData.hanssemInteriorPackage||0==e.templateData.hanssemInteriorPackage.length||(!1!==e.$el.find("#hanssemInteriorPackageAgree").is(":checked")||(alert("주문상품에 대한 동의여부를 확인해주세요."),!1))},orderAgreeCheck:function(){return!!$("#order_agree").is(":checked")||(alert("주문상품에 대한 동의여부를 확인해주세요."),!1)},getAsianaVariable:function(){return"p"===t.get(t.APPLICATION_TYPE)?document.getElementById("affiliateHeaderIframe").contentWindow.AsianaSavingMall:AsianaSavingMall},getData:function(){var e=this;if(!1===e.freshFoodCheck())return!1;if(!1===e.orderMakingCheck())return!1;if(!1===e.customIdNumCheck())return!1;if(!1===e.installationDeliveryAgreeCheck())return!1;if(!1===e.okCashBagNumCheck())return!1;if(!1===e.asianaMileNumCheck())return!1;if(!1===e.hanssemInteriorPackageCheck())return!1;if(!1===e.orderAgreeCheck())return!1;var t={isSaveOkcashBag:e.okCashBagSaveYn,isSaveAsianaClub:e.asianaSaveYn,okcashBagCardNo:e.$el.find("#okcashbag_num").val(),asianaClubCustomerNo:e.$el.find("#asiana_milieage_num").val(),customsIdNumber:e.$el.find("#customs_id_num").val(),isAgreeSavePersonalClearance:e.getReuseAgreeCustomsIdNumber()};return t}})}),define("page/cjmall/order/sheet/view/orderBenefitView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","page/cjmall/order/sheet/models/orderBenefitModel","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/inflowInfo/inflowInfo","page/cjmall/order/payment/helper/paymentHelper","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l,i,a){return Backbone.View.extend({el:"#order_benefit",constructorName:"OrderBenefitView",template:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderBenefit"),model:o.get("orderBenefitModel"),popup:null,initialize:function(){var e=this;e.model=o.get("orderBenefitModel"),e.model.set("popup","0"),1==e.model.get("usedCjGiftCardNamed")?e.model.set("cjGiftCardBtnCtr","AMT_SEARCH"):e.model.set("cjGiftCardBtnCtr","CARD_SEARCH2"),e.model.set("appType",n.get(n.APPLICATION_TYPE)),e.listenTo(e.model,"change",e.render);var t=o.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice;e.setTotalAmount(t),e.render(),window._cjmallOrderObserver.setListeningCallback(e,"changeTotalAmount",e.setTotalAmount),o.get("orderBenefitModel").set("getOrderBenefitFormsCallback",$.proxy(e.getData,e))},events:{"focus .num_value input":"pointActive","focusout .num_value input":"pointDeActive","change #_use_saved_money":"useSavedMoney","change #_use_giftcard_amount":"useCjGiftCardAmount","change #_use_cjone_point":"useCjonePoint","change #_use_cj_gift_amount":"useCjGiftAmount","change #_use_deposit_amount":"useDepositAmount","change #_use_cafeteria_point":"useCafeteriaPoint","change #_booknlifeInputNumber":"useBooknLifeAmount","click #_saved_money":"allSavedMoney","click #_gift_card":"allCjGiftCardAmount","click #_cjone_point":"allCjonePoint","click #_cj_gift_amount":"allCjGiftAmount","click #_deposit_amount":"allDepositAmount","click #_cafeteria_point":"allCafeteriaPoint","click #_otour_cafeteria_point":"otourEmployeeUsePointCheck","click #_checkbox_cultureland":"cultureLandCheck","click #_btn_cultureland_login":"cultureLandLogin","click #_btn_cultureland_join":"cultureLandJoin","click #_btn_cultureland_cancel":"cultureLandCancel","click #_btn_happymoney_login":"happyMoneyLogin","click #_btn_happymoney_cancel":"happyMoneyCancel","click #_checkbox_happymoney":"happyMoneyCheck","click #_checkbox_booknlife":"booknLifeCheck","click #_btn_booknlife_login":"booknLifeLogin","click #_btn_booknlife_join":"booknLifeJoin","click #_btn_booknlife_cancel":"booknLifeCancel","focus #_cultureland_id":"cultureLandIdFocus","blur #_cultureland_id":"cultureLandIdBlur","focus #_cultureland_password":"cultureLandPasswordFocus","blur #_cultureland_password":"cultureLandPasswordBlur","click #_btn_cultureland_apply":"culturelandApply","focus #_booknlife_id":"booknLifeIdFocus","blur #_booknlife_id":"booknLifeIdBlur","focus #_booknlife_password":"booknLifePasswordFocus","blur #_booknlife_password":"booknLifePasswordBlur","keyup #_booknlife_password":"booknLifePasswordKeyup","click #_btn_booknlife_apply":"booknLifeApply","keyup #_booknlifeInputNumber":"booknlifeInputNumberKeyup","click #_btn_giftcard_amt_search":"giftcardAmtSearch","click #_btn_giftcardList_popup":"showGiftCardInfo","click #_btn_giftcard_popup":"showGiftCardSearch","click #_btn_giftcard_charge":"showGiftCardCharge","click #_cultureland_id":"manuallyClickCodeHn","click #_cultureland_password":"manuallyClickCodeHn"},render:function(){var e=this,t=e.$el;e.setTotalAmount(),e.model.initBenefitAmount(),"NON_CUSTOMER"!=o.get("orderSheetType")&&(e.model.set("isOrderSheetNoticeAble",e.model.get("orderNoticeTuple").isOrderSheetNoticeAble),e.model.set("orderNoticeMessage",e.model.get("orderNoticeTuple").noticeMsg),e.model.set("displayMedia",e.model.get("orderNoticeTuple").dispMedia)),t.html(e.template(e.model.toJSON())),0===o.get("orderPriceModel").get("totalOrderPriceTuple").totalPrice&&t.hide(),e.model.isUsedAllBenefit()||t.hide(),e.initOtour()},manuallyClickCodeHn:function(e){a.splunkClickLog($(e.target).attr("data-click"))},useCjGiftCardAmount:function(e){var r=this,o=$(e.currentTarget),n=o.val(),l=t.wonFloor(n),i=r.model.get("_useCjGiftCardAmount");if(!n||0===l)return r.model.set("_useCjGiftCardAmount",0),void o.val(0);r.model.set("_useCjGiftCardAmount",l,{validate:!0})||o.val(i),l===i&&o.val(i),r.render()},giftcardAmtSearch:function(t){var r=this,o=(r.$el,"");o=!0===r.model.get("usedCjGiftCardNamed")?"1":"2";var n={tempOrderNo:e.get("tempOrderNo"),registrationStatus:o,cardNo:""};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/giftcard/balanceLookup",type:"post",data:n,success:function(e){if(""==e.jsonTuple.resCode)if("0000"==e.jsonTuple.result.niceCommonResponseTuple.responseCode){var t=e.jsonTuple.result.conBalanceAmount;if(t<=0)return void alert("잔액이 0원입니다.");r.model.set("cjGiftCardAmount",t),r.model.set("cjGiftCardBtnCtr","CARD_SEARCH1")}else alert(e.jsonTuple.result.niceCommonResponseTuple.responseMessage+"("+e.jsonTuple.result.niceCommonResponseTuple.responseCode+")");else alert(e.jsonTuple.resMsg)},error:function(e){alert("CJ기프트카드 잔액조회에 실패 하였습니다.")}})},showGiftCardInfo:function(t){t&&(t.originalEvent&&a.splunkClickLog("ODIN____mempoint__giftserch__"),t.preventDefault());var r=this;if("1"==r.model.get("popup")&&0==r.popup.closed)return void r.popup.focus();switch(n.get(n.APPLICATION_TYPE)){case"p":var o=screen.availHeight-100;o>=550&&(o=550);var l="/p/order/cjGiftCard/info/"+e.get("tempOrderNo"),i="width=520, height="+o+", resizable=no, scrollbars=yes, status=no;",d=window.open(l,"",i);r.popup=d,r.model.set("popup","1");break;case"m":require(["page/cjmall/order/giftcard/cjGiftCardInfoLayerView"],function(e){new e({})})}},showGiftCardSearch:function(){var e=this;if("1"==e.model.get("popup")&&0==e.popup.closed)return void e.popup.focus();var t,r=n.get(n.APPLICATION_TYPE);switch(r){case"p":t="page/cjmall/order/giftcard/pcCjGiftCardSearchPopupView";break;case"m":t="page/cjmall/order/giftcard/cjGiftCardSearchLayerView"}require([t],function(t){new t({afterSearchInfo:function(t){e.model.set("cjGiftCardAmount",t.cardAmt),e.model.set("cjGiftCardNo",t.cardNo),e.model.set("cjGiftCardPinNo",t.pinNo)},resetGiftCard:function(){e.model.set("_useCjGiftCardAmount",0),e.model.set("cjGiftCardAmount",0),e.model.set("cjGiftCardNo",""),e.model.set("cjGiftCardPinNo","")},openPopup:function(t){e.popup=t,e.model.set("popup","1")}})})},showGiftCardCharge:function(t){var r=this;r.model.set("_useCjGiftCardAmount",0),r.model.set("cjGiftCardAmount",0),r.model.set("cjGiftCardBtnCtr","AMT_SEARCH");var o=e.get("cjGiftCard"),l=n.get(n.APPLICATION_TYPE),i=n.userAgent;switch(l){case"p":var a="/p/page/account/cjOneLoginGate?returnUrl="+encodeURIComponent(o.pcUrlCharge+"&agent=web"),d=window.open(a,"popupGiftCardCharge");d.focus();break;case"m":var s=i.get(i.OS_NAME),c=i.get(i.OSHOPPING_APP_VERSION),u=o.chargeInApp.androidAppVersion,p=o.chargeInApp.iosAppVersion,a="";i.get(i.IS_OSHOPPING_APP)?"true"==o.chargeInApp.enabled&&("android"==s&&""!=u&&c>=u||"ios"==s&&""!=p&&c>=p)?(a+="/m/page/account/cjOneLoginGate",a+="?returnUrl="+encodeURIComponent(o.mUrlCharge+"&agent=wv&coop_url="+encodeURIComponent("cjoshopping://popupWebview=")),a+="&opentarget=new"):(a+=o.mUrlCharge+"&agent=web",a+="&opentarget=blank"):(a+="/m/page/account/cjOneLoginGate",a+="?returnUrl="+encodeURIComponent(o.mUrlCharge+"&agent=web"),a+="&opentarget=blank");var d=window.open(a,"popupGiftCardCharge");d.focus()}},cultureLandCancel:function(e){e.preventDefault();var t=this;$el=t.$el,e&&e.originalEvent&&a.splunkClickLog("ODIN____culture__chkculoff__"),$el.find("#_btn_cultureland_cancel").text("조회"),$el.find("#_btn_cultureland_cancel").prop("id","_btn_cultureland_login"),$el.find("#_layer_cultureland_join").hide(),$el.find("#_layer_cultureland_point").hide(),t.model.set("_useCulturelandAmount",0)},culturelandApply:function(e){e.preventDefault();var r=this,o=r.$el;e&&e.originalEvent&&a.splunkClickLog("ODIN____culture__chkculput__");var n=o.find("#_layer_cultureland_point input").val(),l=t.wonFloor(n);if(l<10)return alert("컬쳐랜드 사용금액은 10원 이상부터 사용 가능합니다."),void o.find("#_cultureInputNumber").val("0");if(!$.isNumeric(l))return alert("숫자로만 입력해 주세요."),void o.find("#_cultureInputNumber").val("0");r.model.set("_useCulturelandAmount",l,{validate:!0})},cultureLandCheck:function(e){var t=this;t.$el;!1===$(e.currentTarget).find("input[type=checkbox]").prop("checked")||t.model.set("_useCulturelandAmount",0)},cultureLandLogin:function(t){var r=this,o=r.$el;if(t&&(t.originalEvent&&a.splunkClickLog("ODIN____culture__chkculon__"),t.preventDefault()),!0===e.get("simpleAccountCustomer"))return void alert("간편회원은 제휴결제수단 사용이 불가합니다. CJONE회원으로 전환해주세요.");var n=r.model.get("_culturelandId"),l=r.model.get("_culturelandPassword");""==n&&""==l?(o.find("#_btn_cultureland_login").text("취소"),o.find("#_btn_cultureland_login").prop("id","_btn_cultureland_cancel"),o.find("#_layer_cultureland_join").show()):(o.find("#_btn_cultureland_login").text("취소"),o.find("#_btn_cultureland_login").prop("id","_btn_cultureland_cancel"),r.cultureLandJoin())},cultureLandJoin:function(t){var r=this,o=r.$el;t&&t.originalEvent&&a.splunkClickLog("ODIN____culture__chkculsearch__");var n=o.find("#_cultureland_id").val(),l=o.find("#_cultureland_password").val(),i=r.model.get("_culturelandId"),d=r.model.get("_culturelandPassword");if(""==i&&""==d){if(0==n.length)return void alert("컬쳐랜드 아이디를 입력하세요.");if(n.length>20&&$("#_cultureland_id").val(n.substr(0,20)),!r.whitespaceCheck(o.find("#_cultureland_id"),"입력한 ID에 공백이 있습니다. 제거해 주십시오."))return;if(0==l.length)return void alert("컬쳐랜드 비밀번호를 입력하세요.");if(l.length>50&&$("#_cultureland_password").val(l.substr(0,50)),!r.whitespaceCheck(o.find("#_cultureland_password"),"입력한 패스워드에 공백이 있습니다. 제거해 주십시오."))return}else n=i,l=d;var s={culturelandId:n,culturelandPassword:l};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/cultureland/login",type:"post",data:s,xhrFields:{withCredentials:!0},success:function(e){"0000"==e.jsonTuple.result.resCd?($("#_cultureland_id").val(""),$("#_cultureland_password").val(""),$("#_cultureland_id_label").show(),$("#_cultureland_password_label").show(),$("#_layer_cultureland_join").hide(),$("#_layer_cultureland_point").show(),$("#cultureAmt1").html(r.numberMasking(new Number(e.jsonTuple.result.amt1))),r.model.set({culturelandAmount:new Number(e.jsonTuple.result.amt1),culturelandResHeadNo:e.jsonTuple.result.resHeadNo,culturelandCustId:e.jsonTuple.result.custId,_culturelandId:n,_culturelandPassword:l},{silent:!0})):"9999"==e.jsonTuple.result.resCd?(alert(e.jsonTuple.result.resMsg),$("#_cultureland_id").val(""),$("#_cultureland_password").val(""),r.cultureLandIdBlur(),r.cultureLandPasswordBlur()):(alert("컬쳐랜드 아이디와 패스워드를 확인해주세요."),$("#_cultureland_id").val(""),$("#_cultureland_password").val(""),r.cultureLandIdBlur(),r.cultureLandPasswordBlur())},error:function(e){alert("컬쳐랜드 로그인에 실패 하였습니다.")}})},happyMoneyLogin:function(t){var r=this;r.$el;if(t&&t.originalEvent&&a.splunkClickLog("ODIN____happym__chkhmon__"),!0===e.get("simpleAccountCustomer"))return void alert("간편회원은 제휴결제수단 사용이 불가합니다. CJONE회원으로 전환해주세요.");l.happymoney.call(this,o.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice,_.first(o.get("orderPriceModel").get("orderItemPriceCollection").toArray()).get("displayItemName"))},happyMoneyCancel:function(e){e.preventDefault();var t=this,r=t.$el;e&&e.originalEvent&&a.splunkClickLog("ODIN____happym__chkhmoff__"),r.find("#_btn_happymoney_cancel").text("조회"),r.find("#_btn_happymoney_cancel").prop("id","_btn_happymoney_login"),t.model.set("_useHappyMoneyAmount",0)},happyMoneyApply:function(e){var t=this,r=t.$el;t.model.set({happyMoneyAmount:new Number(e.resRemAmt),happyMoneyEncodeData:e.EncodeData},{silent:!0});var o=new Number(e.resOrderAmt);if(o<=0)return void alert("해피머니 사용금액은 10원 이상부터 사용 가능합니다.");o>=10&&(r.find("#_btn_happymoney_login").text("취소"),r.find("#_btn_happymoney_login").prop("id","_btn_happymoney_cancel")),t.model.set("_useHappyMoneyAmount",t.model.getAvaliableHappyMoneyAmount(o)),t.model.isValid()||(t.model.set("_useHappyMoneyAmount",0),alert(t.model.validationError))},happyMoneyCheck:function(e){var t=this;t.$el;!1===$(e.currentTarget).find("input[type=checkbox]").prop("checked")||t.model.set("_useHappyMoneyAmount",0)},booknLifeLogin:function(t){var r=this,o=r.$el;if(t&&t.originalEvent&&a.splunkClickLog("ODIN____bookca__chkbcon__"),!0===e.get("simpleAccountCustomer"))return void alert("간편회원은 제휴결제수단 사용이 불가합니다. CJONE회원으로 전환해주세요.");""==r.model.get("_booknLifeId")&&""==r.model.get("_booknLifePassword")?(o.find("#_btn_booknlife_login").text("취소"),o.find("#_btn_booknlife_login").prop("id","_btn_booknlife_cancel"),o.find("#_layer_booknlife_join").show()):(o.find("#_btn_booknlife_login").text("취소"),o.find("#_btn_booknlife_login").prop("id","_btn_booknlife_cancel"),r.booknLifeJoin())},booknLifeCancel:function(e){e.preventDefault();var t=this;$el=t.$el,e&&e.originalEvent&&a.splunkClickLog("ODIN____bookca__chkbcoff__"),$el.find("#_btn_booknlife_cancel").text("조회"),$el.find("#_btn_booknlife_cancel").prop("id","_btn_booknlife_login"),$el.find("#_layer_booknlife_join").hide(),$el.find("#_layer_booknlife_point").hide(),t.model.set("_useBooknLifeAmount",0)},booknLifeJoin:function(t){var r=this,o=r.$el;t&&t.originalEvent&&a.splunkClickLog("ODIN____bookca__chkbcsearch__");var n=""==r.model.get("_booknLifeId")?o.find("#_booknlife_id").val():r.model.get("_booknLifeId"),l=""==r.model.get("_booknLifePassword")?o.find("#_booknlife_password").val():r.model.get("_booknLifePassword");if(0==n.length)return void alert("북앤라이프 아이디를 입력하세요.");if(n.length>20&&$("#_booknlife_id").val(n.substr(0,20)),0==l.length)return void alert("북앤라이프 비밀번호를 입력하세요.");l.length>50&&$("#_booknlife_password").val(l.substr(0,50));var i={booknLifeId:n,booknLifePassword:l};$.ajax({url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/booknlife/login",type:"post",data:i,xhrFields:{withCredentials:!0},success:function(e){r.booknLifeJoinCallBack(e,n,l)},error:function(e){alert("북앤라이프 로그인에 실패 하였습니다.")}})},booknLifeJoinCallBack:function(e,t,r){var o=this,n=o.$el;"SCE000000"==e.jsonTuple.result.resCd?($("#_booknlife_id").val(""),$("#_booknlife_password").val(""),$("#_booknlife_id_label").show(),$("#_booknlife_password_label").show(),$("#_layer_booknlife_join").hide(),$("#_layer_booknlife_point").show(),$("#booknlifeAmt1").html(o.numberMasking(new Number(e.jsonTuple.result.amt1))),o.model.set({booknLifeAmount:new Number(e.jsonTuple.result.amt1),_booknLifeId:t,_booknLifePassword:r},{silent:!0}),n.find("#_booknlifeInputNumber").focus()):(alert(e.jsonTuple.result.resMsg),$("#_booknlife_id").val(""),$("#_booknlife_password").val(""),o.booknLifeIdBlur(),o.booknLifePasswordBlur())},booknLifeIdFocus:function(e){$("#_booknlife_id_label").hide()},booknLifeIdBlur:function(e){0==$("#_booknlife_id").val().length?$("#_booknlife_id_label").show():$("#_booknlife_id_label").hide()},booknLifePasswordFocus:function(e){$("#_booknlife_password_label").hide()},booknLifePasswordBlur:function(e){0==$("#_booknlife_password").val().length?$("#_booknlife_password_label").show():$("#_booknlife_password_label").hide()},booknLifePasswordKeyup:function(e){var t=this;13==e.keyCode&&(e.preventDefault(),t.booknLifeJoin(e))},booknlifeInputNumberKeyup:function(e){var t=this;13==e.keyCode&&(e.preventDefault(),t.booknLifeApply(e))},booknLifeApply:function(e){e.preventDefault();var r=this,o=r.$el,n=o.find("#_layer_booknlife_point input").val();if(t.wonFloor(n)<10)return o.find("#_booknlifeInputNumber").val(""),void o.find("#_booknlifeInputNumber").focus()},booknLifeCheck:function(e){var t=this;t.$el;!1===$(e.currentTarget).find("input[type=checkbox]").prop("checked")||t.model.set("_useBooknLifeAmount",0)},allSavedMoney:function(e){e.preventDefault();var t,r=this,o=$(e.currentTarget),n=o.find("input[type=checkbox]"),l=r.model.get("_useSavedMoney");!0!==n.is(":disabled")&&(!1===n.prop("checked")?(r.model.set("_useSavedMoney",r.model.getAvaliableSavedMoney()),r.model.isValid()||(r.model.set("_useSavedMoney",l),alert(r.model.validationError)),t="ODIN____mempoint__chkpointon__"):(r.model.set("_useSavedMoney",0),t="ODIN____mempoint__chkpointoff__"),e.originalEvent&&a.splunkClickLog(t))},allCjGiftCardAmount:function(e){e.preventDefault();var t,r=this,o=$(e.currentTarget),n=o.find("input[type=checkbox]"),l=r.model.get("_useCjGiftCardAmount");!0!==n.is(":disabled")&&(!1===n.prop("checked")?(r.model.set("_useCjGiftCardAmount",r.model.getAvaliableCjGiftCardAmount()),r.model.isValid()||(r.model.set("_useCjGiftCardAmount",l),alert(r.model.validationError)),t="ODIN____mempoint__chkgifton__"):(r.model.set("_useCjGiftCardAmount",0),t="ODIN____mempoint__chkgiftoff__"),e.originalEvent&&a.splunkClickLog(t))},allCjonePoint:function(e){e.preventDefault();var t,r=this,o=$(e.currentTarget),n=o.find("input[type=checkbox]"),l=r.model.get("_useCjonePoint");if(!0!==n.is(":disabled")){if(0===r.model.get("cjonePoint")&&!0===r.model.get("usedCjonePoint"))return void alert("CJONE.COM 홈페이지에서 카드번호를 등록하셔야 포인트 사용이 가능합니다");!1===n.prop("checked")?(r.model.set("_useCjonePoint",r.model.getAvaliableCjonePoint()),r.model.isValid()||(r.model.set("_useCjonePoint",l),alert(r.model.validationError)),t="ODIN____mempoint__chkoneon__"):(r.model.set("_useCjonePoint",0),t="ODIN____mempoint__chkoneoff__"),e.originalEvent&&a.splunkClickLog(t)}},allCjGiftAmount:function(e){e.preventDefault();var t,r=this,o=$(e.currentTarget),n=o.find("input[type=checkbox]"),l=r.model.get("_useCjGiftAmount");!0!==n.is(":disabled")&&(!1===n.prop("checked")?(r.model.set("_useCjGiftAmount",r.model.getAvaliableCjGiftAmount()),r.model.isValid()||(r.model.set("_useCjGiftAmount",l),alert(r.model.validationError)),t="ODIN____mempoint__cjticketon__"):(r.model.set("_useCjGiftAmount",0),t="ODIN____mempoint__cjticketoff__"),e.originalEvent&&a.splunkClickLog(t))},allDepositAmount:function(e){e.preventDefault();var t=this;$target=$(e.currentTarget),checkbox=$target.find("input[type=checkbox]");var r,o=t.model.get("_useDepositAmount");!0!==checkbox.is(":disabled")&&(!1===checkbox.prop("checked")?(t.model.set("_useDepositAmount",t.model.getAvaliableDepositAmount()),t.model.isValid()||(t.model.set("_useDepositAmount",o),alert(t.model.validationError)),r="ODIN____mempoint__depositon__"):(t.model.set("_useDepositAmount",0),r="ODIN____mempoint__depositoff__"),e.originalEvent&&a.splunkClickLog(r))},allCafeteriaPoint:function(e){e.preventDefault();var t,r=this,o=$(e.currentTarget),n=o.find("input[type=checkbox]"),l=r.model.get("_useCafeteriaPoint");!0!==n.is(":disabled")&&(!1===n.prop("checked")?(r.model.set("_useCafeteriaPoint",r.model.getAvaliableCafeteriaPoint()),r.model.isValid()||(r.model.set("_useCafeteriaPoint",l),alert(r.model.validationError)),t="ODIN____mempoint__chkcafeon__"):(r.model.set("_useCafeteriaPoint",0),t="ODIN____mempoint__chkcafeoff__"),e.originalEvent&&a.splunkClickLog(t))},useSavedMoney:function(e){var r=this,o=$(e.currentTarget),n=o.val(),l=t.wonFloor(n),i=r.model.get("_useSavedMoney");if(!n||0===l)return r.model.set("_useSavedMoney",0),void o.val(0);r.model.set("_useSavedMoney",l,{validate:!0})||o.val(i),l===i&&o.val(i)},useBooknLifeAmount:function(e){var r=this,o=$(e.currentTarget),n=o.val();$el=r.$el,$el.find("#_booknlifeInputNumber").val(n);var l=t.wonFloor(n),i=r.model.get("_useBooknLifeAmount");if(a.splunkClickLog("ODIN____bookca__chkbclput__"),!n||l<10)return r.model.set("_useBooknLifeAmount",0),o.val(0),void alert("북앤캐시 사용금액은 10원 이상부터 사용 가능합니다.");r.model.set("_useBooknLifeAmount",l,{validate:!0})||o.val(i),l===i&&o.val(i)},useCjonePoint:function(e){var r=this,o=$(e.currentTarget),n=o.val(),l=t.wonFloor(n),i=r.model.get("_useCjonePoint");if(!n||0===l)return r.model.set("_useCjonePoint",0),void o.val(0);r.model.set("_useCjonePoint",l,{validate:!0})||o.val(i),l===i&&o.val(i)},useCjGiftAmount:function(e){var r=this,o=$(e.currentTarget),n=o.val(),l=t.wonFloor(n),i=r.model.get("_useCjGiftAmount");if(!1==!!n||0===l)return r.model.set("_useCjGiftAmount",0),void o.val(0);r.model.set("_useCjGiftAmount",l,{validate:!0})||o.val(i),l===i&&o.val(i)},useDepositAmount:function(e){var r=this,o=$(e.currentTarget),n=o.val(),l=t.wonFloor(n),i=r.model.get("_useDepositAmount");if(!1==!!n||0===l)return r.model.set("_useDepositAmount",0),void o.val(0);r.model.set("_useDepositAmount",l,{validate:!0})||o.val(i),l===i&&o.val(i)},useCafeteriaPoint:function(e){var r=this,o=$(e.currentTarget),n=o.val(),l=t.wonFloor(n),i=r.model.get("_useCafeteriaPoint");if(!0!==o.is(":disabled")){if(!1==!!n||0===l)return r.model.set("_useCafeteriaPoint",0),void o.val(0);r.model.set("_useCafeteriaPoint",l,{validate:!0})||o.val(i),l===i&&o.val(i)}},cultureLandIdFocus:function(e){$("#_cultureland_id_label").hide()},cultureLandIdBlur:function(e){0==$("#_cultureland_id").val().length?$("#_cultureland_id_label").show():$("#_cultureland_id_label").hide()},cultureLandPasswordFocus:function(e){$("#_cultureland_password_label").hide()},cultureLandPasswordBlur:function(e){0==$("#_cultureland_password").val().length?$("#_cultureland_password_label").show():$("#_cultureland_password_label").hide()},setTotalAmount:function(e){var r=this;e!==undefined&&r.model.set("_totalAmount",e);var n=r.model.get("_totalAmount")-r.model.get("_useSavedMoney")-r.model.get("_useCjGiftCardAmount")-r.model.get("_useCjonePoint")-r.model.get("_useCjGiftAmount")-r.model.get("_useDepositAmount")-r.model.get("_useCafeteriaPoint")-r.model.get("_useCulturelandAmount")-r.model.get("_useBooknLifeAmount")-r.model.get("_useHappyMoneyAmount")-r.model.get("_useOtourCafeteriaPoint")-r.model.get("_useSalarySubtractAmount")-r.model.get("_useCompanySupportAmount");if(r.model.set("_paymentAmount",n),o.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice=n,"OLIVEYOUNG"===o.get("orderSheetType")){var l=o.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice,i=o.get("orderPriceModel").get("totalOrderPriceTuple").currentTotalDeliveryPrice,a=o.get("orderPriceModel").get("totalOrderPriceTuple").cjCardDiscountRate,d=0,s=l-i;i>0?(s<=0?d=0:(d=s-s*(a/100),d=10*Math.ceil(.1*d)),$("#_select_card_lst").next().text("* CJ카드"+a+"%  즉시할인 예상가 "+t.formatNumber(d)+"원(배송비 별도)")):(d=s-s*(a/100),d=10*Math.ceil(.1*d),$("#_select_card_lst").next().text("* CJ카드"+a+"%  즉시할인 예상가 "+t.formatNumber(d)+"원"))}},convertCafeteriaPoint:function(e){var t=parseInt(e/1e3);return cafeteriaPoint%1e3>=500&&(t+=1),t},initOtour:function(){var e=this,r=e.model.get("otourCafeteriaPoint"),o=e.model.get("salarySubtractAmount"),n=e.model.get("companySupportAmount");!0==!!e.model.get("otourCafeteriaPoint")&&!0==!!r&&(e.model.set("_useOtourCafeteriaPoint",t.wonFloor(r),{history:!1}),e.$el.find("#_otour_cafeteria_point").on("click",function(){return alert("임직원 여행지원을 받은 상품은 카페테리아 결제를 수정하실수 없습니다."),!1})),!0==!!e.model.get("salarySubtractAmount")&&!0==!!o&&e.model.set("_useSalarySubtractAmount",t.wonFloor(o),{history:!1}),!0==!!e.model.get("companySupportAmount")&&!0==!!n&&e.model.set("_useCompanySupportAmount",t.wonFloor(n),{history:!1})},otourEmployeeUsePointCheck:function(){var e=this,t=e.model.get("otourCafeteriaPoint");return e.$el.find("#_otour_cafeteria_point").on("click",function(){return alert("임직원 여행지원을 받은 상품은 카페테리아 결제를 수정하실수 없습니다."),!1}),!0==!!e.model.get("otourCafeteriaPoint")&&!0==!!t},isOtourEmployeeUsePoint:function(){var e=this,t=e.model.get("otourCafeteriaPoint");return!0==!!e.model.get("otourCafeteriaPoint")&&!0==!!t},getData:function(){var e=this,t=e.model.get("_useSavedMoney"),r=e.model.get("_useCjGiftCardAmount"),n=e.model.get("_useDepositAmount"),l=e.model.get("_useCjGiftAmount"),i=e.model.get("_useCjonePoint"),a=e.model.get("_useCafeteriaPoint"),d=(e.model.getUseCafeteriaPoint(),e.model.get("_useCulturelandAmount")),s=e.model.get("_useBooknLifeAmount"),c=e.model.get("_useHappyMoneyAmount"),u=e.model.get("_useOtourCafeteriaPoint"),p=e.model.get("_useSalarySubtractAmount"),m=e.model.get("_useCompanySupportAmount"),f=e.model.get("cjoneEssetialPoint"),g=[];if(f>0&&i<f){var v=[];_.forEach(e.model.get("cjoneEssetialPointUnitCodeList"),function(e){v.push(_.findWhere(o.get("orderPriceModel").get("orderPriceManagers"),{unitCode:e}))});var y="";return _.forEach(v,function(e){y+=e.unitName+"\n"}),alert(y+"위 상품은 CJone포인트 결제가 필수인 상품입니다. 총 "+f+"포인트 이상 결제수단으로 사용해야 주문이 가능합니다."),!1}if(t>0&&g.push({benefitCodeType:"SAVED_MONEY",useAmount:t}),n>0&&g.push({benefitCodeType:"DEPOSIT",useAmount:n}),l>0&&g.push({benefitCodeType:"CJ_GIFT",useAmount:l}),i>0&&g.push({benefitCodeType:"CJONE_POINT",useAmount:i}),a>0&&g.push({benefitCodeType:"CAFETERIA",useAmount:a}),r>0&&g.push({benefitCodeType:"CJ_GIFTCARD",useAmount:r,cjGiftCardNo:e.model.get("cjGiftCardNo"),cjGiftCardPinNo:e.model.get("cjGiftCardPinNo")}),d>0&&g.push({benefitCodeType:"CULTURE_CASH",useAmount:d,culturelandId:e.model.get("_culturelandId"),culturelandPassword:e.model.get("_culturelandPassword"),culturelandResHeadNo:e.model.get("culturelandResHeadNo"),culturelandCustId:e.model.get("culturelandCustId")}),s>0&&g.push({benefitCodeType:"BOOK_CASH",useAmount:s,booknLifeId:e.model.get("_booknLifeId"),booknLifePassword:e.model.get("_booknLifePassword")}),c>0&&g.push({benefitCodeType:"HAPPY_MONEY",useAmount:c,happyMoneyEncodeData:e.model.get("happyMoneyEncodeData")}),u>0||p>0||m>0){var h=u+p+m;g.push({benefitCodeType:"OTOUR",useAmount:h})}return g},pointActive:function(e){var t=$(e.currentTarget),r=t.parent(".num_value");switch(e.currentTarget.id){case"_use_saved_money":a.splunkClickLog("ODIN____mempoint__pointinput__");break;case"_use_giftcard_amount":a.splunkClickLog("ODIN____mempoint__giftinput__");break;case"_use_cjone_point":a.splunkClickLog("ODIN____mempoint__oneinput__");break;case"_use_cj_gift_amount":a.splunkClickLog("ODIN____mempoint__cjticketinput__");break;case"_use_deposit_amount":a.splunkClickLog("ODIN____mempoint__depositinput__");break;case"_use_cafeteria_point":a.splunkClickLog("ODIN____mempoint__cafeinput__")}r.addClass("active"),0===Number(t.val())&&t.val("")},pointDeActive:function(e){var t=$(e.currentTarget),r=t.parent(".num_value");Number(t.val())>0||(r.removeClass("active"),t.val("0"))},whitespaceCheck:function(e,t){return!(e.val().split(" ").length>1&&(alert(t),1))}})}),define("page/cjmall/order/sheet/view/orderCardEventNoticeView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper"],function(e,t,r){return Backbone.View.extend({el:"._card_event_notice",orderCardEventNoticeTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===t.get(t.APPLICATION_TYPE)?"p":"m")+"/orderCardEventNotice"),initialize:function(e){this.render(e)},render:function(t){var r=this,o=r.$el;r.norestNoticeList=e.get("orderCardEventNoticeTuple").get("orderNoRestNoticeTupleList"),r.billingDiscountList=e.get("orderCardEventNoticeTuple").get("billingDiscountTupleList"),r.billingDiscountSimplePayList=e.get("orderCardEventNoticeTuple").get("billingDiscountSimplePayTupleList"),r.norestNoticeEtcList=e.get("orderCardEventNoticeTuple").get("orderNoRestNoticeEtcTupleList"),r.model=new Backbone.Model({orderSheetType:t,norestNoticeList:r.norestNoticeList,norestNoticeEtcList:r.norestNoticeEtcList,billingDiscountList:r.billingDiscountList,billingDiscountSimplePayList:r.billingDiscountSimplePayList}),o.append(r.orderCardEventNoticeTemplate(r.model.toJSON()))}})}),define("page/cjmall/order/sheet/view/orderCashReceiptView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/models/orderCashReceiptModel","page/cjmall/order/sheet/helper/payTypeHelper","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o,n,l){return Backbone.View.extend({el:"#order_cash_receipt",model:new t,orderBenefitModel:null,orderPaymentModel:null,orderAddressModel:null,device:null,deductTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/deduct"),evidenceTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/evidence"),initialize:function(){var t=this;t.$el;t.orderBenefitModel=e.get("orderBenefitModel"),t.orderPaymentModel=e.get("orderPaymentModel"),t.orderAddressModel=e.get("orderAddressModel"),t.device=o.get(o.APPLICATION_TYPE),t.listenTo(t.orderBenefitModel,"change",t.render),t.listenTo(t.orderPaymentModel,"change",t.render),r.isNobankbook(t.orderPaymentModel.get("_payType"))&&t.render(),e.get("orderPaymentModel").set("getOrderCashReceiptFormCallback",$.proxy(t.getData,t))},events:{"change ._deduct":"showDeduct","change ._evidence":"showEvidence","change ._unissue":"showUnissue","change #_btn_cash_receipt_issue_way_type":"showDeductIssueWayType","click #_btn_cash_receipt_issue_way_type":"manuallyClickCodeHn","click #_biz3":"manuallyClickCodeHn","keyup #_receipt_card_num1":"changeCardNumberValid","keyup #_receipt_card_num2":"changeCardNumberValid","keyup #_receipt_card_num3":"changeCardNumberValid","keyup #_receipt_card_num4":"changeCardNumberValid","click #_receipt_card_num4":"manuallyClickCodeHn","keyup #_credit_card_num1":"changeCardNumberValid","keyup #_credit_card_num2":"changeCardNumberValid","keyup #_credit_card_num3":"changeCardNumberValid","keyup #_credit_card_num4":"changeCardNumberValid","click #_credit_card_num4":"manuallyClickCodeHn","keyup #_cellno2":"changePhoneNumberValid","click #_cellno2":"manuallyClickCodeHn","keyup #_biz1":"changeBisinessNumberValid","keyup #_biz2":"changeBisinessNumberValid","keyup #_biz3":"changeBisinessNumberValid"},render:function(){var t=this,r=t.$el;if(t.isUseBenefitCheck(t.orderBenefitModel)||t.isUsePaymentCheck(t.orderPaymentModel)){if("block"===r.css("display"))return;var o=e.get("orderPriceModel").get("orderPriceManagers")[0].itemTypeCode,n=e.get("orderPriceModel").get("orderPriceManagers")[0].mdCode;if(o.indexOf("8002")>-1||o.indexOf("8018")>-1||"1497"===n||"1531"===n)return;r.show(),t.showDeduct(),t.showLatelyCashReceipt()}else r.hide()},manuallyClickCodeHn:function(e){l.splunkClickLog($(e.target).attr("data-click"))},showLatelyCashReceipt:function(){var e=this,t=e.$el;e.orderPaymentModel.get("orderCashReceiptTuple");t.find("._deduct").prop("checked",!0),t.find("#_btn_cash_receipt_issue_way_type").val(e.model.PHONE),t.find(".phone_num").show(),t.find("._receipt_card_num").hide(),t.find("._credit_card_num").hide(),e.orderAddressModel&&"NON_CUSTOMER"!=e.orderAddressModel.get("orderSheetType")&&(t.find("#_cellno1").val(e.orderAddressModel.get("celno1")),t.find("#_cellno2").val(e.orderAddressModel.get("celno2")+e.orderAddressModel.get("celno3")))},showDeductIssueWayType:function(e){var t=this,r=t.$el
;t.model.set("orderCashReceiptIssueWayType",e.target.value),"PHONE"===e.currentTarget.value?(r.find(".phone_num").show(),r.find("._receipt_card_num").hide(),r.find("._credit_card_num").hide(),t.orderAddressModel&&"NON_CUSTOMER"!=t.orderAddressModel.get("orderSheetType")&&(r.find("#_cellno1").val(t.orderAddressModel.get("celno1")),r.find("#_cellno2").val(t.orderAddressModel.get("celno2")+t.orderAddressModel.get("celno3")))):"CASH_RECEIPT_CARD_NO"===e.currentTarget.value?(r.find(".phone_num").hide(),r.find("._receipt_card_num").show(),r.find("._credit_card_num").hide()):"CARD_NO"===e.currentTarget.value&&(r.find(".phone_num").hide(),r.find("._receipt_card_num").hide(),r.find("._credit_card_num").show())},showDeduct:function(){var e=this,t=e.$el;t.find(".edit_addr").remove(),t.find("#_order_cash_receipt_detail").after(e.deductTemplate({device:e.device})),e.model.set("orderCashReceiptIssueUseType",e.model.DEDUCT),e.orderAddressModel&&"NON_CUSTOMER"!=e.orderAddressModel.get("orderSheetType")&&(t.find("#_cellno1").val(e.orderAddressModel.get("celno1")),t.find("#_cellno2").val(e.orderAddressModel.get("celno2")+e.orderAddressModel.get("celno3")))},showEvidence:function(){var e=this,t=e.$el;t.find(".edit_addr").remove(),t.find("#_order_cash_receipt_detail").after(e.evidenceTemplate({device:e.device})),e.model.set("orderCashReceiptIssueUseType",e.model.EVIDENCE)},showUnissue:function(){var e=this,t=e.$el;e.model.set("orderCashReceiptIssueUseType",null),t.find(".edit_addr").remove()},isUsePaymentCheck:function(e){var t=this;return!(!$("._NOBANKBOOK").is(":checked")&&!r.isNobankbook(t.orderPaymentModel.get("_payType")))},isUseBenefitCheck:function(e){var t=e.get("_useCjGiftAmount"),r=e.get("_useDepositAmount"),o=e.get("_useCafeteriaPoint"),n=e.get("_useCulturelandAmount"),l=e.get("_useBooknLifeAmount"),i=e.get("_useHappyMoneyAmount"),a=(e.get("_useOtourCafeteriaPoint"),e.get("_useSalarySubtractAmount"),e.get("_useCompanySupportAmount"),e.get("_useCjGiftCardAmount"));return t>0||r>0||a>0||o>0||n>0||l>0||i>0},changeCardNumberValid:function(e){if(e.target.value){e.preventDefault();var t=window._cjmallOrderValidator,r=this;return!0===t.isHasSpecialChar(e.target.value)||!1===t.isNumber(e.target.value)?(r.alertAndFocusMove(e.target,"1"),!1):void 0}},changePhoneNumberValid:function(e){if(e.target.value){e.preventDefault();var t=window._cjmallOrderValidator,r=this;return e.target.value&&!0===t.isHasSpecialChar(e.target.value)||!1===t.isNumber(e.target.value)?(r.alertAndFocusMove(e.target,"2"),!1):void 0}},changeBisinessNumberValid:function(e){if(e.target.value){e.preventDefault();var t=window._cjmallOrderValidator,r=this;return e.target.value&&!0===t.isHasSpecialChar(e.target.value)||!1===t.isNumber(e.target.value)?(r.alertAndFocusMove(e.target,"3"),!1):void 0}},alertAndFocusMove:function(e,t){"1"==t?alert("현금영수증 발행 카드번호를 정확하게 입력해주세요"):"2"==t?alert("현금영수증 발행 휴대폰번호를 정확하게 입력해 주세요"):alert("현금영수증 발행 사업자번호를 정확하게 입력해주세요"),$(e).val(""),$(e).focus()},getData:function(){var e,t=this,r=t.$el,o="";return"block"===$("#order_cash_receipt").css("display")&&(t.model.get("orderCashReceiptIssueUseType")===t.model.DEDUCT&&(e=r.find("#_btn_cash_receipt_issue_way_type").val(),e===t.model.PHONE&&(o=r.find("#_cellno1").val()+r.find("#_cellno2").val()),e===t.model.CASH_RECEIPT_CARD_NO&&(o=r.find("#_receipt_card_num1").val()+r.find("#_receipt_card_num2").val()+r.find("#_receipt_card_num3").val()+r.find("#_receipt_card_num4").val()),e===t.model.CARD_NO&&(o=r.find("#_credit_card_num1").val()+r.find("#_credit_card_num2").val()+r.find("#_credit_card_num3").val()+r.find("#_credit_card_num4").val())),t.model.get("orderCashReceiptIssueUseType")===t.model.EVIDENCE&&(e=t.model.BIZ,o=r.find("#_biz1").val()+r.find("#_biz2").val()+r.find("#_biz3").val()),{orderCashReceiptIssueWayType:e,orderCashReceiptIssueUseType:t.model.get("orderCashReceiptIssueUseType"),issueNo:o})}})}),define("page/cjmall/order/sheet/view/orderChangeDiscountView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","common/cjmall/util/cjmallUtil","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper","common/cjos/util/urlUtil","common/cjos/logger/utils/loggerUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r,o,n,l,i,a){return Backbone.View.extend({el:"._change_discount_popup",template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderChangeDiscount"),initialize:function(){this.render()},events:{"click ._change_confirm":"changeDiscountTempOrder","click ._change_cancel":"closeChangeDiscountPopup"},render:function(){var e=this,t=e.$el,r=o.get("orderPriceModel"),n=!1,l="";_.forEach(r.get("orderPriceManagers"),function(t){if(!0===n)return!0;_.forEach(t.discountPriceTuple.discountDetails,function(t){"EMPLOYEE"==t.category&&(e.model=new Backbone.Model({cjMemberDiscountTuple:t.cjMemberDiscountTuple}),l=t.cjMemberDiscountTuple.cjDcGbnType,n=!0)})}),t.append(e.template(e.model.toJSON())),""!==l&&e.$el.find("._"+l).prop("checked",!0)},changeDiscountTempOrder:function(){var t=this,r=t.$el.find('input:radio[name="checkStaff"]:checked').val();$.ajax({type:"GET",xhrFields:{withCredentials:!0},url:e.get("ecBaseSslUrl")+"/c/rest/order/cjMemberSelectDcTempOrder?tempOrderNo="+e.get("tempOrderNo")+"&cjdcGubunType="+r,success:function(t){if(1==t.code&&""!=t.result){var r=t.result;location.href=e.get("ecBaseSslUrl")+"/"+a.get(a.APPLICATION_TYPE)+"/order/sheet/"+r}else alert("주문서로 이동할 수 없습니다. 잠시 후 다시 시도해주세요.")},error:function(e,t,r){alert("주문서로 이동할 수 없습니다. 잠시 후 다시 시도해주세요.")},complete:function(){"function"==typeof callback&&context&&callback.apply(context,[])}})},closeChangeDiscountPopup:function(){this.$el.hide()}})}),define("page/cjmall/order/sheet/view/orderCjCardPaymethodView",["common/cjos/util/configUtil","common/cjos/util/urlUtil","common/cjmall/util/cjmallUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","page/cjmall/order/sheet/models/orderSheetMainModel"],function(e,t,r,o,n,l){return Backbone.View.extend({template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderCjCardPayment"),model:l,initialize:function(){this.render()},render:function(){var e=this,t=e.$el,r=e.model.get("orderPriceModel").get("totalOrderPriceTuple"),o=e.model.get("orderSheetType"),n={discountRate:r.cjCardDiscountRate,orderSheetType:o};t.append(e.template(n)),"NON_CUSTOMER"===o&&t.find("#radioCJCard").attr("disabled","disabled")},events:{"click .u_btn.btn_done":"doneHandler","click .u_btn.btn_cancel":"cancelHandler"},doneHandler:function(e){var t=this;$("input[name=opt_pay]:checked").each(function(){"normal"==$(this).val()?t.normalCardPayment():t.cjCardPayment()})},cancelHandler:function(e){e.preventDefault(),r.alertAndRedirect()},setOrderItemForm:function(e){var t=e.totalGiftTuples,r=[],o=[];if(!_.isEmpty(t))for(var n=0;n<t.length;n++){var l=t[n],i=l.itemEtcType;if(null!=t[n].giftcartSeq)switch(i){case"ONE_GIFT":case"ADD_GIFT":o.push(l)}}if(!_.isEmpty(o))for(var n=0;n<o.length;n++){var l=o[n],a={itemCode:l.giftItemCode,channelCode:l.channelCode,unitCode:l.giftUnitCode,promotionNo:l.tpromofferEntityKey.promNo,promotionSeq:l.tpromofferEntityKey.promSeq,offerSeq:l.tpromofferEntityKey.offerSeq};r.push(a)}return{itemCode:e.itemCode,itemName:e.itemName,channelCode:e.channelCode,unitCode:e.unitCode,unitName:e.unitName,unitPrice:e.salePrice,quantity:e.quantity,shopId:e.shopId,giftItemForms:e.totalGiftTupls,cartKey:e.cartKey,categoryId:e.categoryId}},normalCardPayment:function(){var e=this;$(".wrap_payment_methods").hide(),$(document).scrollTop(0),cjosLogUtil.log("click Normal card"),e.trigger("clickNormalCard")},cjCardPayment:function(){var e=this,t=l.get("orderPriceModel"),r=[];t.get("orderPriceManagers").forEach(function(t,o){"OLIVEYOUNG"==t.orderItemTypeTuple.orderItemType&&r.push(e.setOrderItemForm(t))}),e.requestOrder(r)},el:"#container",requestOrder:function(t){var r=JSON.stringify({orderFormType:"CART",paymentMethodType:"CJCARD",orderItemForms:t}),n=e.get("ecBaseSslUrl")+"/c/rest/order/tempOrder",l="";switch(o.get(o.APPLICATION_TYPE)){case"p":l=e.get("ecBaseSslUrl")+"/p/order/sheet/";break;case"m":l=e.get("ecBaseSslUrl")+"/m/order/sheet/"}$.ajax({url:n,type:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:r,xhrFields:{withCredentials:!0},success:function(e){if(1!=e.code)return void alert("잠시 후 다시 시도해주세요.");var t=e.result,r=l+t;location.href=r},error:function(e,t,r){alert("잠시 후 다시 시도해주세요."),cjosLogUtil.log("CJ 카드 선택 실패 : response ",e)}})}})}),define("page/cjmall/order/sheet/view/orderItemGroupView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/view/orderItemView","page/cjmall/order/sheet/helper/payTypeHelper","page/cjmall/order/sheet/view/orderItemOtourBillLayerView","common/cjos/util/handlebarsHelper","page/cjmall/order/sheet/helper/orderSheetHelper"],function(e,t,r,o,n,l){return Backbone.View.extend({tag:"div",className:"group_view_box",fastDeliveryTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItemGroupFastDelivery"),orderItemOtourBillTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItemOtourBill"),orderItemOtourBillLayerPopTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItemOtourBillLayerPop"),fastDeliveryCost:0,isTopDeliveryCost:!1,model:null,isFastDeliveryAble:!1,events:{"change ._fastDeliveryCheckbox":"fastDeliveryCheckOnHn","click #otourlayer":"openOtourBillLayer"},initialize:function(){var e=this;e.orderItemViews=[],e.render()},render:function(){var r=this,o=r.$el,n=undefined,i=e.get("orderAddressModel"),a=i.get("basicAddressModel"),n=i.get("selectedAddressModel");o.append('<div class="disct_item"></div>');var d=e.get("orderPriceModel").get("orderItemPriceCollection"),s=l.isDisplayCellNoWhenCpnItem(),c="",u="",p="";return s&&(c=a.get("fullAddress"),u=a.get("road")?a.get("newZipno"):a.get("zipno"),p="("+u+") "+c),_.forEach(d.models,function(e,t){e.get("discountPriceTuple").couponTuples=$.extend(!0,{},e.get("discountPriceTuple").orgCouponTuples)}),_.forEach(r.model.get("unitCodeList"),function(e,l){var i=d.findWhere({unitCode:e}),a=r.model,c=new Backbone.Model($.extend(!0,i.toJSON(),{deliveryPolicy:a.toJSON(),fastAreaCls:n?n.get("fastAreaCls"):"00",areaCls:n?n.get("areaCls"):"00",isDisplayCellNoWhenCpnItem:s,defaultDeliveryAddress:p,index:l})),u=new t({model:c});o.find(".disct_item").append(u.$el),r.listenTo(c,"discountUpdate",function(){r.model.trigger("discountUpdate")}),r.listenTo(c,"requestDeliveryFeeForm",r.throwDeliveryFeeForm),r.orderItemViews.push(u)}),r.getIsFastDeliveryAble()&&(o.append(r.fastDeliveryTemplate({groupCode:r.model.get("deliveryCostGroupCode"),fastDeliveryObj:r.model.get("fastDeliveryObj")})),r.model.get("fastDeliveryObj")&&!0===r.model.get("fastDeliveryObj").fastDeliveryFree&&r.checkFastDelivery()),r.getIsOtourEmployeeBill()&&o.find(".disct_item").append(r.orderItemOtourBillTemplate()),r},getCurrentDeliveryCost:function(){var e=this,t=e.getCurrentFastdeliveryCost(),r=e.getJejulandDeliveryCost(),o=e.model.get("groupDeliveryPrice");return"04"===e.model.get("deliveryType")?0:t+r+o},getCurrentFastdeliveryCost:function(){var t=this;if(!1===t.model.get("isFastChecked"))return 0;var r=e.get("orderAddressModel").get("selectedAddressModel"),o=0;return!1==!!r?0:("01"===r.get("fastAreaCls")?o=t.model.get("fastDeliveryAddPrice").capCost:"02"===r.get("fastAreaCls")&&(o=t.model.get("fastDeliveryAddPrice").allCost),o)},getFastdeliveryCost:function(){var t=this,r=e.get("orderAddressModel").get("selectedAddressModel"),o=0;return!1==!!r?0:("01"===r.get("fastAreaCls")?o=t.model.get("fastDeliveryAddPrice").capCost:"02"===r.get("fastAreaCls")&&(o=t.model.get("fastDeliveryAddPrice").allCost),o)},getJejulandDeliveryCost:function(){var t=this,r=e.get("orderAddressModel").get("selectedAddressModel"),o=0;return!1==!!r?0:("01"===r.get("areaCls")&&t.model.get("regionalAddPrice")&&"04"!==t.model.get("deliveryType")?o=t.model.get("regionalAddPrice").jejuAddCost:"02"===r.get("areaCls")&&t.model.get("regionalAddPrice")&&"04"!==t.model.get("deliveryType")&&(o=t.model.get("regionalAddPrice").landAddCost),o)},getOrderItemTotalPrice:function(){var e=this,t=0;return _.forEach(e.orderItemViews,function(e){var r=e.model.get("totalCustomerPrice");t+=r}),t},itemViewUnSetLump:function(){var e=this;_.forEach(e.orderItemViews,function(e){e.unSetLump()})},getLumpPrice:function(){var e=this,t=0;return _.forEach(e.orderItemViews,function(e){t+=e.getLumpPrice()}),t},getIsFastDeliveryAble:function(){var t=this,r=e.get("orderAddressModel").get("selectedAddressModel"),o=!0;r&&r.get("fastAreaCls");return 0!=!!t.model.get("fastDeliveryObj")&&(_.forEach(t.orderItemViews,function(e){var t=e.model.get("orderDeliveryTuple").fastDeliveryInfoTuple,r=!!t&&!!t.fastDelivMsgInfo,n=!!t&&t.fastDelivery,l=!0===e.model.get("orderItemTypeTuple").bookingOrder,i="true"==e.model.get("isCustHopeDelyYn"),a="true"==e.model.get("isCustFixedDelyYn");(!1===r||!1===n||l||i||a)&&(o=!1)}),o)},getIsOtourEmployeeBill:function(){var t=!1;return!0==!!e.get("otourEmployeeTuple")&&e.get("otourEmployeeTuple").has("employeeName")&&(t=!0),t},diabledFastDelivery:function(){this.$el.find("._fastDeliveryCheckbox").prop("checked",!1).attr("disabled",!0)},enabledFastDelivery:function(){this.$el.find("._fastDeliveryCheckbox").attr("disabled",!1)},hideDeliveryInfo:function(){var e=this;e.$el.find("._delivery_info").hide(),e.diabledFastDelivery()},showDeliveryInfo:function(){var e=this;e.enabledFastDelivery(),e.$el.find("._delivery_info").show()},isNoBankBook:function(){var t=e.get("orderPaymentModel");return!!r.isNobankbook(t.get("_payType"))},fastDeliveryCheckOnHn:function(e){var t,r=this,o=$(e.currentTarget),n=o.is(":checked");n?!0===r.isNoBankBook()?(alert("[ 빠른배송 ]서비스의 경우 현금 결제 (무통장입금, 실시간계좌이체)가 불가능 합니다.\n다른 결제수단으로 변경 후 주문해주세요."),o.prop("checked",!1),r.model.set("isFastChecked",!1)):r.model.set("isFastChecked",!0):r.model.set("isFastChecked",!1),t=r.numberMasking(r.getCurrentFastdeliveryCost()),r.$el.find("[data-modelindex=fastDeliveryCost]").text(t),r.model.trigger("fastDeliveryCheck")},updateFastDeliveryCostText:function(){var e=this;e.numberMasking(e.getFastdeliveryCost());e.$el.find("[data-modelindex=fastDeliveryCostText]").text(fastdeliveryCostText)},checkFastDelivery:function(){this.$el.find("._fastDeliveryCheckbox").prop("checked",!0).trigger("change")},unCheckFastDelivery:function(){this.$el.find("._fastDeliveryCheckbox").prop("checked",!1).trigger("change")},getOrderItemData:function(){var t=this,r=[],o=e.get("orderPaymentModel");return _.forEach(t.orderItemViews,function(e){r.push(e.getData())}),!0!==t.model.get("isFastChecked")||"NOBANKBOOK"!==o.get("_payType")&&"REALTIME_ACCOUNT_TRANSFER"!==o.get("_payType")?r:(alert("[ 빠른배송 ]서비스의 경우 현금 결제 (무통장입금, 실시간계좌이체)가 불가능 합니다.\n다른 결제수단으로 변경 후 주문해주세요."),!1)},throwDeliveryFeeForm:function(t){var r=this,o=e.get("orderAddressModel").get("selectedAddressModel"),n=e.get("orderAddressModel").get("isConvenience");if(o){var l=t.model.get("index");t.setDeliveryFeeForm({jejuAddCost:0===l&&"01"===o.get("areaCls")&&"04"!==r.model.get("deliveryType")?r.model.get("regionalAddPrice").jejuAddCost:0,islandAddCost:0===l&&"02"===o.get("areaCls")&&"04"!==r.model.get("deliveryType")?r.model.get("regionalAddPrice").landAddCost:0,fastDeliveryReqYn:0===l&&r.model.get("isFastChecked"),fastAddCost:0===l?r.getCurrentFastdeliveryCost():0,deliveryFee:0===l?r.getDeliveryFee():0,deliveryCouponAmt:0===l&&r.isTopDeliveryCost?e.get("orderPriceModel").get("totalOrderPriceTuple").totalDiscountDeliveryPrice:0,deliveryCouponForm:0===l&&r.isTopDeliveryCost?r.getDeliveryCouponForm():null})}else t.setDeliveryFeeForm({jejuAddCost:0,islandAddCost:0,fastDeliveryReqYn:!1,fastAddCost:0,deliveryFee:!0===n?r.getDeliveryFee():0,deliveryCouponAmt:0,deliveryCouponForm:r.getDeliveryCouponForm()})},getDeliveryFee:function(){var e=this;return"04"===e.model.get("deliveryType")?0:e.model.get("groupDeliveryPrice")},getDeliveryCouponForm:function(){var e=this;e.model.trigger("requestDeliveryCoupon",e);var t=e.model.get("deliveryCoupon");return t?{offerCode:t.offerCode,giveSeq:t.giveSeq,date:t.giveDateString}:null},setDeliveryCoupon:function(e){this.model.set("deliveryCoupon",e)},childrenViewDestroy:function(){var e=this;_.forEach(e.orderItemViews,function(e){e.remove()})},openOtourBillLayer:function(t){t.preventDefault(),this.$el.append(new o({model:e.get("otourEmployeeTuple")}).$el)}})}),define("page/cjmall/order/sheet/view/orderItemListView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/view/orderItemGroupView","page/cjmall/order/sheet/models/deliveryPolicyModel","page/cjmall/order/sheet/view/orderItemView","page/cjmall/order/sheet/helper/fastDeliveryHelper","common/cjos/util/noImageReplaceUtil","common/cjos/util/handlebarsHelper","page/cjmall/order/sheet/models/deliveryAddressItemModel","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/view/orderChangeDiscountView"],function(e,t,r,o,n,l,i,a,d,s){return Backbone.View.extend({el:"#order_item_list",constructorName:"OrderItemListView",linkGiftTemplate:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/linkGift"),template:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItemListView"),templateFooter:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItemListViewFooter"),model:null,deliveryCouponList:[],orderItemGroupViews:[],multipleDeliveryData:{},selectedDeliveryCoupon:!1,isTicket:!1,events:{"click ._delivery_coupon_btn":"deliveryCouponBtnOnClickHn","change ._delivery_coupon_list":"setDeliveryCoupon","click ._btn_change_discount_show":"oshoppingMemeberChangeDiscountShow","click ._btn_change_discount_hide":"oshoppingMemeberChangeDiscountHide"},initialize:function(){var t=this;t.model=e.get("deliveryPolicyCollection"),t.setHandlebarsHelper(),t.deliveryCouponList=e.get("orderPriceModel").get("deliveryCouponList");var r=e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice;e.get("orderPriceModel").get("totalOrderPriceTuple").totalPrice=r;var o=e.get("orderPriceModel").get("orderItemPriceCollection");_.forEach(o.models,function(e,t){e.get("discountPriceTuple").orgCouponTuples=$.extend(!0,{},e.get("discountPriceTuple").couponTuples)}),t.isTicket=t.isTicket();var n=__cjos_config__.isCjosMemberYn;t.$el.html(t.template({isTicket:t.isTicket,isCjosMemberYn:n})),"true"===n&&t.changeDiscountLayerRender(),t.render(),e.get("orderPriceModel").set("getOrderItemDataCallback",$.proxy(t.getOrderItemData,t)),window._cjmallOrderObserver.setListeningCallback(t,"changeAddress",t.render),window._cjmallOrderObserver.setListeningCallback(t,"paymentIsNotLump",t.cancelLump),window._cjmallOrderObserver.setListeningCallback(t,"selectNoBankBook",t.unCheckFastDelivery),window._cjmallOrderObserver.setListeningCallback(t,"checkDeliveryAble",t.setDeliveryAble),window._cjmallOrderObserver.setListeningCallback(t,"isMultipleAddress",t.setMultiple),window._cjmallOrderObserver.setListeningCallback(t,"multipleDeliveryPriceUpdate",t.updateMultipleTotalPrice),window._cjmallOrderObserver.setListeningCallback(t,"reponseMultipleDeliveryInfomation",t.setMultipleDelivery)},setDefaultImg:function(){var e=$(".link_thumb img").toArray();l.add(e,"//image.cjmall.net/mcom_web/images/mobile/no_img.gif")},setDeliveryAble:function(t){if(!e.get("orderAddressModel").get("isMultiple")){var r=this;_.forEach(r.orderItemGroupViews,function(e){e.model.set("deliveryAble",t),!1===t&&e.diabledFastDelivery()})}},setMultipleDelivery:function(e){this.multipleDeliveryData=e},setHandlebarsHelper:function(){Handlebars.registerHelper("isAbleDiscount",function(e){var t=e.data.root.discountPriceTuple;return t.showDiscount||t.showCjMember||t.showVipDc?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isHasCoupon",function(e){var t=e.data.root.discountPriceTuple,r=t.couponTuples,o=!!r.couponList.length,n=!!r.spCouponList.length;return o||n?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isMinordPossible",function(e){var t=e.data.root,r=t.deliveryPolicy.minordAmount,o=t.deliveryPolicy.minordQuantity,n=!1;return!0==!!r&&!0==!!o&&t.deliveryPolicy.totalSalePrice>=r&&t.deliveryPolicy.totalQuantity>=o&&(n=!0),!0==!!r&&!1==!!o&&t.deliveryPolicy.totalSalePrice>=r&&(n=!0),!1==!!r&&!0==!!o&&t.deliveryPolicy.totalQuantity>=o&&(n=!0),n?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isFreeDeliveryBySingle",function(e){var t=e.data.root,r=t.deliveryPolicy.minordAmount,o=t.deliveryPolicy.minordQuantity,n=!1;return!0==!!r&&!0==!!o&&t.salePrice*t.quantity>=r&&t.quantity>=o&&(n=!0),!0==!!r&&!1==!!o&&t.salePrice*t.quantity>=r&&(n=!0),!1==!!r&&!0==!!o&&t.quantity>=o&&(n=!0),n?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("getDeliveryCost",function(e){var t=e.data.root.deliveryPolicy.deliveryPrice,r=e.data.root.deliveryPolicy.freeDelivery;return result=r?" 무료":'<span class="num_price">'+t.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")+"</span>원",new Handlebars.SafeString(result)}),Handlebars.registerHelper("hasPackage",function(e){var t=e.data.root.packUnitItemTuples;return t&&t.length?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("hasGift",function(e){return e.data.root.totalGiftTuples.length?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("priceHasLinkGift",function(e){var t=e.data.root.totalGiftTuples,r=!1;return _.forEach(t,function(e){"LINK_GIFT"===e.itemEtcType&&(r=!0)}),r?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("orderHasLinkGift",function(e){var t=e.data.root.orderPriceManagers,r=!1;return _.forEach(t,function(e){_.forEach(e.totalGiftTuples,function(e){"LINK_GIFT"===e.itemEtcType&&(r=!0)})}),r?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("numberMasking",function(e,t){return e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}),Handlebars.registerHelper("test",function(e,t){cjosLogUtil.log("########test#############",e)})},render:function(){if(!e.get("orderAddressModel").get("isMultiple")){var l,i=this,d=i.$el,s=e.get("orderPriceModel");l=1==!!e.get("orderAddressModel").get("selectedAddressModel")?e.get("orderAddressModel").get("selectedAddressModel"):new a,d.css("height",d.height()),i.childrenViewDestroy(),i.orderItemGroupViews=[],i.deliveryCouponReset(),o.prototype.shareUsedCouponArray=[],o.prototype.shareUsedSpCouponArray=[],o.prototype.shareIssuAbleCouponArray=[],o.prototype.shareIssuAbleSpCouponArray=[],d.find(".group_disct").empty(),d.find(".group_disct").siblings().remove(),_.forEach(i.model.toArray(),function(e){if(l){var r=l.get("fastAreaCls"),o=new n(r,e),a=o.getFastDeliveryObj();e.set("fastDeliveryObj",a)}var s=new t({model:e});d.find(".group_disct").append(s.$el),i.listenTo(e,"fastDeliveryCheck",i.updateTotalPrice),i.listenTo(e,"discountUpdate",i.updateTotalPrice),i.listenTo(e,"requestDeliveryCoupon",i.throwCurrentDeliveryCoupon),i.orderItemGroupViews.push(s)}),_.forEach(s.get("orderPriceManagers"),function(e){if("NONE"===e.orderDeliveryTuple.deliveryCostGrpCode){var o=new r;o.set("unitCodeList",[]),o.get("unitCodeList").push(e.unitCode);var n=new t({model:o});d.find(".group_disct").append(n.$el),i.listenTo(o,"discountUpdate",i.updateTotalPrice),i.listenTo(o,"requestDeliveryCoupon",i.throwCurrentDeliveryCoupon),i.orderItemGroupViews.push(n)}});var c={deliveryCouponList:i.deliveryCouponList,linkGiftGroup:i.getLinkGiftGroup(),orderSheetType:e.get("orderSheetType")};d.find(".group_disct").append(i.linkGiftTemplate(_.extend(s.toJSON(),c))),!0!==i.isTicket&&d.find(".order_disct").append(i.templateFooter(_.extend(s.toJSON(),c))),d.css("height",""),i.setTopDeliveryCostGroup(),i.fireFastDeliveryAlertMsg(),i.setDefaultImg()}},setTopDeliveryCostGroup:function(){this.getTopPriceDeliveryPriceGroupView().isTopDeliveryCost=!0},fireFastDeliveryAlertMsg:function(){var e=this,t=e.getFastDeliveryAlertMsgArray();t.length&&alert(t[0])},getFastDeliveryAlertMsgArray:function(){var e=this,t=[];return _.forEach(e.orderItemGroupViews,function(e){var r=e.model.get("fastDeliveryObj");r&&r.fastDeliveryAlertMsg&&t.push(r.fastDeliveryAlertMsg)}),t},childrenViewDestroy:function(){var e=this;_.forEach(e.orderItemGroupViews,function(e){e.childrenViewDestroy(),e.remove()})},unCheckFastDelivery:function(){var e=this,t=!1;_.forEach(e.orderItemGroupViews,function(e){!0===e.model.get("isFastChecked")&&(t=!0)}),!0===t&&!0===e.getIsAllGroupFastDeliveryAble()&&(alert("[ 빠른배송 ]서비스의 경우 현금 결제 (무통장입금, 실시간계좌이체)가 불가능 합니다.\n다른 결제수단으로 변경 후 주문해주세요."),_.forEach(e.orderItemGroupViews,function(e){!0===e.model.get("fastDeliveryObj").fastDeliveryFree||e.unCheckFastDelivery()}))},getLinkGiftGroup:function(){var t=e.get("orderPriceModel").get("orderPriceManagers"),r=[];_.forEach(t,function(e){var t=e.totalGiftTuples;t&&_.forEach(t,function(t){t.priceManager=e,"LINK_GIFT"===t.itemEtcType&&r.push(t)})});var o=_.groupBy(r,function(e){return e.tpromofferEntityKey.promNo}),n=[];_.forEach(o,function(e){var t=_.groupBy(e,function(e){return e.tpromofferEntityKey.promSeq});for(var r in t)n.push(t[r])});var l=[];return _.forEach(n,function(e){var t={priceNames:[],applyTypeCode:e[0].applyTypeCode,orderAmount:e[0].orderAmount,orderQty:e[0].orderQty,gifts:[]},r=_.groupBy(e,function(e){return e.tpromofferEntityKey.offerSeq}),o=[];for(var n in r){var i=_.groupBy(r[n],function(e){return e.priceManager.unitCode});o.push(i)}_.forEach(o,function(e,r){if(0===r)for(var o in e)t.priceNames.push(e[o][0].priceManager.unitName)});for(var n in r){var a=r[n][0];t.gifts.push(a)}l.push(t)}),l},cancelLump:function(){var e=this,t=e.getTotalLumpPrice();0!==t&&(window.confirm("일시불 할인 해제시 "+t+"원 할인이 취소됩니다. 할부 결제를 하시겠습니까?")?_.forEach(e.orderItemGroupViews,function(t){t.itemViewUnSetLump(),e.updateTotalPrice()}):window._cjmallOrderObserver.eventTrigger("cancelInstallment"))},getTotalLumpPrice:function(){var e=this,t=0;return _.forEach(e.orderItemGroupViews,function(e){t+=e.getLumpPrice()}),t},updateTotalPrice:function(){if(e.get("orderAddressModel").get("isMultiple"))return void window._cjmallOrderObserver.eventTrigger("requestMultipleDeliveryFee");var t=this;t.deliveryPriceUpdate();var r=t.getTotalSalePrice();r+=e.get("orderPriceModel").get("totalOrderPriceTuple").currentTotalDeliveryPrice,e.get("orderPriceModel").get("totalOrderPriceTuple").totalPrice=r,e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice=r,$('[data-modelindex="totalSalePrice"]').text(t.numberMasking(r)),window._cjmallOrderObserver.eventTrigger("changeTotalAmount",r)},updateMultipleTotalPrice:function(t){var r=this;e.get("orderPriceModel").get("totalOrderPriceTuple").currentTotalDeliveryPrice=t;var o=r.getTotalSalePrice(),n=e.get("orderPriceModel").get("totalOrderPriceTuple").currentTotalDeliveryPrice;o+=n,e.get("orderPriceModel").get("totalOrderPriceTuple").totalPrice=o,e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice=o,$("[data-modelindex=currentTotalDeliveryPrice]").text(r.numberMasking(n)),$('[data-modelindex="totalSalePrice"]').text(r.numberMasking(o)),window._cjmallOrderObserver.eventTrigger("changeTotalAmount",o)},setMultiple:function(e){var t=this;e?t.hideDeliveryInfo():t.showDeliveryInfo()},showDeliveryInfo:function(){var e=this;_.forEach(e.orderItemGroupViews,function(e){e.showDeliveryInfo()})},hideDeliveryInfo:function(){var e=this;_.forEach(e.orderItemGroupViews,function(e){e.hideDeliveryInfo()})},getTotalSalePrice:function(){var e=this,t=0;return _.forEach(e.orderItemGroupViews,function(e){t+=e.getOrderItemTotalPrice()}),t},getTotalDeliveryPrice:function(){var e=this,t=0;return _.forEach(e.orderItemGroupViews,function(e){t+=e.getCurrentDeliveryCost()}),t},getTopPriceByDeliveryPrice:function(){var e=this,t=0;return _.forEach(e.orderItemGroupViews,function(e){var r=e.model.get("groupDeliveryPrice");t<r&&(t=r)}),t},getTopPriceDeliveryPriceGroupView:function(){var e,t=this,r=0;return _.forEach(t.orderItemGroupViews,function(t,o){var n=t.model.get("groupDeliveryPrice");0===o&&(e=t),r<n&&(r=n,e=t)}),e},multipleDeliveryCouponBtnOnClickHn:function(e){var t=this,r=t.$el.find("._delivery_coupon_btn"),o=t.multipleDeliveryData;if(0===o.multipleTotalDeliveryFee)return void alert("할인을 적용할 배송비가 없습니다.");if(null===t.deliveryCouponList)return void alert("배송비쿠폰이 없습니다.");if(o.multipleAddCost===o.multipleTotalDeliveryFee){var n=!0;return _.forEach(o.deliveryAddressViews,function(e){var t=e.model.get("selectedAddressModel");"00"===t.get("areaCls")&&"00"===t.get("fastAreaCls")||(n=!1)}),void(!1===n&&alert("기본 배송비에만 적용됩니다. (도서산간배송비 빠른배송비 할인 불가)"))}var l=t.$el.find("._deliveryCouponWrap");l.is(":visible")?(r.removeClass("open"),l.slideUp()):(l.slideDown(),r.addClass("open"))},deliveryCouponBtnOnClickHn:function(t){t&&t.originalEvent&&d.splunkClickLog("ODIN____prddis__dcoumod__");var r=this;if(e.get("orderAddressModel").get("isMultiple"))return window._cjmallOrderObserver.eventTrigger("requestMultipleDeliveryInfomation"),void r.multipleDeliveryCouponBtnOnClickHn(t);var o=r.$el.find("._delivery_coupon_btn"),n=e.get("orderAddressModel").get("selectedAddressModel");if(0===r.getTotalDeliveryPrice())return alert("할인을 적용할 배송비가 없습니다."),r.selectedDeliveryCoupon=!1,void r.updateTotalPrice();if(null===r.deliveryCouponList)return void alert("배송비쿠폰이 없습니다.");if(!0==!!n){if("00"!==n.get("areaCls")&&0===r.getTopPriceByDeliveryPrice())return void alert("기본 배송비에만 적용됩니다. (도서산간배송비 빠른배송비 할인 불가)");if("00"!==n.get("fastAreaCls")&&0===r.getTopPriceByDeliveryPrice())return void alert("기본 배송비에만 적용됩니다. (도서산간배송비 빠른배송비 할인 불가)")}var l=r.$el.find("._deliveryCouponWrap");l.is(":visible")?(o.removeClass("open"),l.slideUp()):(l.slideDown(),o.addClass("open"))},setDeliveryCoupon:function(t){var r=this,o=(r.$el,$(t.currentTarget)),n=e.get("orderAddressModel").get("isMultiple"),l=o.prop("selectedIndex");r.selectedDeliveryCoupon=!!l&&r.deliveryCouponList[l-1],n?window._cjmallOrderObserver.eventTrigger("throwDeliveryCoupon",r.selectedDeliveryCoupon):r.updateTotalPrice()},deliveryCouponReset:function(){var e=this;e.$el;e.selectedDeliveryCoupon=!1},throwCurrentDeliveryCoupon:function(e){var t=this;e.setDeliveryCoupon(t.selectedDeliveryCoupon)},throwIsAllGroupFastDeliveryAble:function(e){var t=this;e.model.set("IsAllGroupFastDeliveryAble",t.getIsAllGroupFastDeliveryAble())},deliveryPriceUpdate:function(){var t=this,r=t.getTotalDeliveryPrice(),o=t.getTopPriceByDeliveryPrice(),n=0;if(t.selectedDeliveryCoupon&&("1"===t.selectedDeliveryCoupon.dcClsCode&&(n=t.selectedDeliveryCoupon.dcAmount),"2"===t.selectedDeliveryCoupon.dcClsCode)){var l=t.selectedDeliveryCoupon.maxDcAmount,i=t.selectedDeliveryCoupon.dcRate;n=99===i?o:t.cutUnderTen(o*i/100),l&&(n=n>l?l:n)}r-=n,e.get("orderPriceModel").get("totalOrderPriceTuple").currentTotalDeliveryPrice=r,e.get("orderPriceModel").get("totalOrderPriceTuple").totalDiscountDeliveryPrice=n,$("[data-modelindex=currentTotalDeliveryPrice]").text(t.numberMasking(r)),0===n?$("[data-modelindex=totalDiscountDeliveryPrice]").text(t.numberMasking(n)):$("[data-modelindex=totalDiscountDeliveryPrice]").text("-"+t.numberMasking(n))},isTicket:function(){var t=!1,r=e.get("orderPriceModel").get("orderPriceManagers");e.get("orderSheetType");return 1===r.length&&!0===r[0].orderItemTypeTuple.mobileZeroWon&&(t=!0),"OTOUR"===r[0].orderItemTypeTuple.orderItemType&&(t=!0),t},getIsAllGroupFastDeliveryAble:function(){var e=this,t=!0;return _.forEach(e.orderItemGroupViews,function(e){!1!==t&&!1===e.getIsFastDeliveryAble()&&(t=!1)}),t},getOrderItemData:function(){var e=this,t=[];return _.forEach(e.orderItemGroupViews,function(e){if(!1!==t){var r=e.getOrderItemData();!1===r?t=!1:_.forEach(r,function(e){t.push(e)})}}),t},oshoppingMemeberChangeDiscountShow:function(){this.$el.find("._change_discount_popup").show()},oshoppingMemeberChangeDiscountHide:function(){var e=this,t=e.$el;d.splunkClickLog("ODIN____prddis__staffclose__"),t.find("._change_discount_popup").hide()},changeDiscountLayerRender:function(){var t=this,r=e.get("orderPriceModel"),o=r.get("totalOrderPriceTuple").totalSalePrice,n="",l="",i=!1
;if(_.forEach(r.get("orderPriceManagers"),function(e){if(!0===i)return!0;_.forEach(e.discountPriceTuple.discountDetails,function(e){"EMPLOYEE"==e.category&&(i=!0,n=e.cjMemberDiscountTuple.firstAllDcAmt,l=e.cjMemberDiscountTuple.secondAllDcAmt)})}),""==n||""==l||"0"==n&&"0"==l)t.$el.find("._btn_change_discount_show").remove();else{new s}0===o&&t.$el.find("._btn_change_discount_show").remove()}})}),define("page/cjmall/order/sheet/view/orderItemOtourBillLayerView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t){return Backbone.View.extend({tag:"div",className:"lay_wrap billing_details",orderItemOtourBillLayerPopTemplate:t.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItemOtourBillLayerPop"),events:{"click ._closebtn":"close"},initialize:function(){this.render()},render:function(){var e=this;e.$el.html(e.orderItemOtourBillLayerPopTemplate(e.model.toJSON()))},close:function(e){e.preventDefault(),this.remove()}})}),define("page/cjmall/order/sheet/view/orderItemView",["common/cjos/util/configUtil","common/cjos/util/currencyUtil","common/cjmall/util/cjmallUtil","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper","common/cjos/util/urlUtil","common/cjos/logger/utils/loggerUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t,r,o,n,l,i,a){return Backbone.View.extend({$wnd:$(window),className:"wrap_item",shareUsedCouponArray:[],shareUsedSpCouponArray:[],shareIssuAbleCouponArray:[],shareIssuAbleSpCouponArray:[],template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderItem"),employeeDiscountLayerTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===a.get(a.APPLICATION_TYPE)?"p":"m")+"/employeeDiscountLayer"),selectedDiscountModel:{},lumpSum:{},events:{"click ._item_detail_link":"moveItemDetail","click #_discount":"showDiscount","click #_lump_sum_btn":"lumpToggle","click ._promotion_now":"promotionNowToggle","click #_btn_toggle_employee_help":"showEmployeeHelpLayer","click #_btn_close_employee_help":"closeEmployeeHelpLayer","click #_coupon_list":"openCouponList","click #_sp_coupon_list":"openSpCouponList","click ._choice_coupon":"setCoupon","click ._choice_spcoupon":"setSpCoupon"},initialize:function(){var e=this;e.setSelectedDiscountModel(),e.setSelectedDiscountModelListener(),o.get("orderAddressModel")&&(e.model.set("celno1",o.get("orderAddressModel").get("celno1")),e.model.set("celno2",o.get("orderAddressModel").get("celno2")),e.model.set("celno3",o.get("orderAddressModel").get("celno3"))),e.render()},render:function(){var e=this,t=e.$el;return t.html(e.template(e.model.toJSON())),!1===e.hasLumpSum()?t.addClass("no_disc"):t.removeClass("no_disc"),e.setViewApplicationType(),e.setViewDiscountArea(),_.defer($.proxy(e.discountPriceUpdate,e)),_.defer($.proxy(e.setCouponDiscountPriceText,e)),e},setViewApplicationType:function(){var e=this,t=e.$el;switch(a.get(a.APPLICATION_TYPE)){case"p":t.find("._employee_pc").removeAttr("style");break;case"m":t.find("._employee_mobile").removeAttr("style")}},setViewDiscountArea:function(){var e=this,t=e.$el;t.find("#_discount").length>0&&(t.find("#_discount").attr("aria-expanded","true"),t.find("._box_layer").show(),t.find("#_discount").addClass("open"))},deliveryCostHide:function(){this.$el.find("._delivery_info").hide()},deliveryCostShow:function(){this.$el.find("._delivery_info").show()},hasLumpSum:function(){var e=this,t=e.model.get("discountPriceTuple").discountDetails,r=!1;return _.forEach(t,function(e){"LUMP_SUM"===e.category&&!0===e.immediatelyDiscount&&(r=!0)}),r},getSelectedAddressAreaCls:function(){var e=this,t=o.get("orderAddressModel").get("selectedAddressModel");t&&(e.model.set("fastAreaCls",t.get("fastAreaCls")),e.model.set("areaCls",t.get("areaCls")))},setSelectedDiscountModelListener:function(){var e=this;e.selectedDiscountModel.on("change.discountUpdate",function(){for(key in this.attributes){var t=this.attributes[key];if(t&&t.currentDiscountPrice){var r=e.numberMasking(t.currentDiscountPrice);0==t.currentDiscountPrice?e.$el.find("[data-modelIndex="+key+"]").text(r):("coupon"==key?e.$el.find("._selected_coupon_name").text(t.offerName):"spCoupon"==key&&e.$el.find("._selected_spcoupon_name").text(t.offerName),e.$el.find("[data-modelIndex="+key+"]").text("-"+r))}else!1===t&&e.$el.find("[data-modelIndex="+key+"]").text("0")}var o=this.attributes.totalDiscountPrice,n=e.numberMasking(o);0===o?e.$el.find("[data-modelIndex=totalDiscountPrice]").text(n):e.$el.find("[data-modelIndex=totalDiscountPrice]").text("-"+n)})},setSelectedDiscountModel:function(){var e=this;e.selectedDiscountModel=new Backbone.Model({employee:!1,vip:!1,priceDiscount:!1,coupon:!1,spCoupon:!1,arsTvShopping:!1,promotionNow:!1,lumpSum:!1,salePrice:e.model.get("salePrice"),discountPrice:null,totalDiscountPrice:e.model.get("discountPriceTuple").totalDiscountPrice});var t=e.model.get("discountPriceTuple").couponTuples,r=e.model.get("discountPriceTuple").discountDetails,o=[],n=[];if(t&&(o=t.couponList,n=t.spCouponList),_.forEach(r,function(t){"EMPLOYEE"===t.category&&e.selectedDiscountModel.set("employee",t),"VIP"===t.category&&e.selectedDiscountModel.set("vip",t),"PRICE_DISCOUNT"===t.category&&e.selectedDiscountModel.set("priceDiscount",t),"ARS_TV_SHOPPING"===t.category&&e.selectedDiscountModel.set("arsTvShopping",t),"PROMOTION_NOW"===t.category&&(e.selectedDiscountModel.set("promotionNow",t),e.promotionNow=t),"LUMP_SUM"===t.category&&!0===t.immediatelyDiscount&&(e.selectedDiscountModel.set("lumpSum",t),e.lumpSum=t)}),o.length){var l=!1;_.forEach(o,function(t){!0!==l&&!0!=!!t.giveSeq&&e.setCouponData(t,{silent:!0})&&(e.selectedDiscountModel.set("coupon",t),t.isSelected=!0,l=!0)})}if(n.length){var i=!1;_.forEach(n,function(t){!0!==i&&!0!=!!t.giveSeq&&e.setSpCouponData(t,{silent:!0})&&(e.selectedDiscountModel.set("spCoupon",t),t.isSelected=!0,i=!0)})}},discountPriceUpdate:function(){var e=this,t=e.setDiscountUpdateCost();e.model.set("totalCustomerPrice",t),e.selectedDiscountModel.trigger("change.discountUpdate"),e.model.trigger("discountUpdate"),e.setCouponDiscountPriceText()},setDiscountUpdateCost:function(){var e=this,r=e.selectedDiscountModel.get("salePrice"),o=e.model.get("quantity"),n=e.selectedDiscountModel.get("salePrice")*o,l=0,i=0;if(e.selectedDiscountModel.get("employee")){if("AMT"===e.selectedDiscountModel.get("employee").type&&(i=e.selectedDiscountModel.get("employee").discountPrice),"RATE"===e.selectedDiscountModel.get("employee").type){var a=Number(e.selectedDiscountModel.get("employee").cjMemberDiscountTuple.cjDcRate);i=10*Math.floor(r*o*(a/1e3))}e.selectedDiscountModel.get("employee").currentDiscountPrice=i,n-=i,l+=i}var d=0;e.selectedDiscountModel.get("vip")&&("AMT"===e.selectedDiscountModel.get("vip").type&&(d=e.selectedDiscountModel.get("vip").discountPrice),e.selectedDiscountModel.get("vip").currentDiscountPrice=d,n-=d,l+=d);var s=0;if(e.selectedDiscountModel.get("priceDiscount")){if("AMT"===e.selectedDiscountModel.get("priceDiscount").type&&(s=e.selectedDiscountModel.get("priceDiscount").discountPrice),"RATE"===e.selectedDiscountModel.get("priceDiscount").type){var c=e.selectedDiscountModel.get("priceDiscount").discountRate;s=10*Math.floor(r*(c/1e3))*o}e.selectedDiscountModel.get("priceDiscount").currentDiscountPrice=s,n-=s,l+=s}var u=0,p=0,m=0;if(e.selectedDiscountModel.get("coupon")){if("1"===e.selectedDiscountModel.get("coupon").dcClsCode&&(u=10*Math.floor(e.selectedDiscountModel.get("coupon").dcAmount/10)*o,p=10*Math.floor(e.selectedDiscountModel.get("coupon").dcAmount/10)*1,(m=e.selectedDiscountModel.get("coupon").maxDcAmount)>0&&(p=p>m?m:p)),"2"===e.selectedDiscountModel.get("coupon").dcClsCode){var f=e.selectedDiscountModel.get("coupon").maxDcAmount*o,c=e.selectedDiscountModel.get("coupon").dcRate;u=10*Math.floor((r-i/o-d/o-s/o)*c/1e3)*o,p=10*Math.floor(r*c/1e3)*1,m=e.selectedDiscountModel.get("coupon").maxDcAmount,m>0&&(p=p>m?m:p),f&&u>f&&(u=f)}u>n&&(u=n);var g=e.selectedDiscountModel.get("coupon"),v=e.selectedDiscountModel.get("coupon").ordMinAmount;v>0&&v>r&&(alert("본 쿠폰은 상품금액이 "+t.formatNumber(v)+"원 이상이어야 사용가능합니다."),_.delay(function(){e.$el.find("._selected_coupon_name").text("쿠폰을 선택 해 주세요."),e.$el.find("._choice_coupon").removeClass("on")},100),e.selectedDiscountModel.set("coupon",!1),e.removeCouponData(g),u=0),e.selectedDiscountModel.get("coupon").currentDiscountPrice=u,n-=u,l+=u}var y=0;if(e.selectedDiscountModel.get("spCoupon")){if("1"===e.selectedDiscountModel.get("spCoupon").dcClsCode&&(y=10*Math.floor(e.selectedDiscountModel.get("spCoupon").dcAmount/10)*o),"2"===e.selectedDiscountModel.get("spCoupon").dcClsCode){var f=e.selectedDiscountModel.get("spCoupon").maxDcAmount*o,c=e.selectedDiscountModel.get("spCoupon").dcRate;y=10*Math.floor((r-i/o-d/o-s/o-u/o)*c/1e3)*o,f&&y>f&&(y=f)}y>n&&(y=n);var h=e.selectedDiscountModel.get("spCoupon"),v=e.selectedDiscountModel.get("spCoupon").ordMinAmount;v>0&&v>r-p&&(alert("본 쇼핑플러스쿠폰은 할인쿠폰적용 후 한 상품당 "+t.formatNumber(v)+"원 이상이어야 사용가능합니다."),_.delay(function(){e.$el.find("._selected_spcoupon_name").text("쇼핑플러스쿠폰을 선택 해 주세요."),e.$el.find("._choice_spcoupon").removeClass("on")},100),e.selectedDiscountModel.set("spCoupon",!1),e.removeSpCouponData(h),y=0),e.selectedDiscountModel.get("spCoupon").currentDiscountPrice=y,n-=y,l+=y}var C=0;e.selectedDiscountModel.get("arsTvShopping")&&(C=e.selectedDiscountModel.get("arsTvShopping").discountPrice,e.selectedDiscountModel.get("arsTvShopping").currentDiscountPrice=C,n-=C,l+=C);var P=0;if(e.selectedDiscountModel.get("promotionNow")){if("AMT"===e.selectedDiscountModel.get("promotionNow").type&&(P=e.selectedDiscountModel.get("promotionNow").discountPrice),"RATE"===e.selectedDiscountModel.get("promotionNow").type){var c=e.selectedDiscountModel.get("promotionNow").discountRate;P=10*Math.floor((r-i/o-d/o-s/o-u/o-y/o-C/o)*c*.8/1e3)*o}e.selectedDiscountModel.get("promotionNow").currentDiscountPrice=P,n-=P,l+=P}var A=0;if(e.selectedDiscountModel.get("lumpSum")){if("AMT"===e.selectedDiscountModel.get("lumpSum").type&&(A=e.selectedDiscountModel.get("lumpSum").discountPrice),"RATE"===e.selectedDiscountModel.get("lumpSum").type){var c=e.selectedDiscountModel.get("lumpSum").discountRate;A=10*Math.floor((r-i/o-d/o-s/o-u/o-y/o-C/o-P/o)*c/1e3)*o}e.selectedDiscountModel.get("lumpSum").currentDiscountPrice=A,n-=A}return n<0&&(n=0),e.selectedDiscountModel.set("discountPrice",n),e.selectedDiscountModel.set("totalDiscountPrice",l),n},getLumpSumRate:function(){var e=this,t=o.get("orderPriceModel").get("totalOrderItemTypeTuple").minLumpSumMonth;e.getLumpSumRate(t);e.getPayTypeMonthList()},getPayTypeMonthList:function(){var e=o.get("orderPaymentModel"),t=e.get("_payType");if(t){return _.findWhere(e.get("cardPaymentTuples"),{payType:t}).norestMonth.split(":")}return!1},IsissuAbleCoupon:function(e){var t=!1;return null!==e.issuableCouponCount&&(t=!0),t},removeIssuAbleCoupon:function(e){var t=this;_.forEach(t.shareIssuAbleCouponArray,function(t){t.offerCode===e.offerCode&&(t.issuableCouponCount=t.issuableCouponCount+1)})},removeIssuAbleSpCoupon:function(e){var t=this;_.forEach(t.shareIssuAbleSpCouponArray,function(t){t.offerCode===e.offerCode&&(t.issuableCouponCount=t.issuableCouponCount+1)})},setIssuAbleCoupon:function(e){var t=this,r=!1,o=!0;return 0===t.shareIssuAbleCouponArray.length?(e.issuableCouponCount=e.issuableCouponCount-1,t.shareIssuAbleCouponArray.push(e)):(_.forEach(t.shareIssuAbleCouponArray,function(t){if(t.offerCode===e.offerCode){r=!0;var n=t.issuableCouponCount-1;n<0?o=!1:t.issuableCouponCount=n}}),!1===r&&(e.issuableCouponCount=e.issuableCouponCount-1,t.shareIssuAbleCouponArray.push(e))),o},setIssuAbleSpCoupon:function(e){var t=this,r=!1,o=!0;return 0===t.shareIssuAbleSpCouponArray.length?(e.issuableCouponCount=e.issuableCouponCount-1,t.shareIssuAbleSpCouponArray.push(e)):(_.forEach(t.shareIssuAbleSpCouponArray,function(t){if(t.offerCode===e.offerCode){r=!0;var n=t.issuableCouponCount-1;n<0?(alert("사용 횟수를 초과하였습니다."),o=!1):t.issuableCouponCount=n}}),!1===r&&(e.issuableCouponCount=e.issuableCouponCount-1,t.shareIssuAbleSpCouponArray.push(e))),o},setCouponData:function(e,t){var r=this;return!0===r.IsissuAbleCoupon(e)?!!r.setIssuAbleCoupon(e)||(t&&!0===t.silent||alert("사용 횟수를 초과하였습니다."),!1):!0===r.isUsedCoupon(e)?(t&&!0===t.silent||alert("이미 사용된 쿠폰입니다."),!1):(r.shareUsedCouponArray.push(e),!0)},setSpCouponData:function(e,t){var r=this;return!0===r.IsissuAbleCoupon(e)?!!r.setIssuAbleSpCoupon(e)||(t&&!0===t.silent||alert("사용 횟수를 초과하였습니다."),!1):!0===r.isUsedSpCoupon(e)?(t&&!0===t.silent||alert("이미 사용된 쿠폰입니다."),!1):(r.shareUsedSpCouponArray.push(e),!0)},removeCouponData:function(e){var t=this;!0===t.IsissuAbleCoupon(e)?t.removeIssuAbleCoupon(e):t.unUsedCoupon(e)},removeSpCouponData:function(e){var t=this;!0===t.IsissuAbleCoupon(e)?t.removeIssuAbleSpCoupon(e):t.unUsedSpCoupon(e)},setCoupon:function(e){var t=this,r=(t.$el,$(e.currentTarget));if(!0===r.hasClass("on"))t.$el.find("._selected_coupon_name").text("쿠폰을 선택 해 주세요."),r.removeClass("on");else{r.siblings().removeClass("on");var o=r.find(".option_item").text();t.$el.find("._selected_coupon_name").text(o),r.addClass("on")}var n=r.index(),l=t.selectedDiscountModel.get("coupon"),i=t.model.get("discountPriceTuple").couponTuples.couponList[n];if(!1===t.$el.find("._choice_coupon").hasClass("on"))return l&&(t.removeCouponData(l),t.selectedDiscountModel.set("coupon",!1)),void t.discountPriceUpdate();l&&t.removeCouponData(l),t.setCouponData(i)?t.selectedDiscountModel.set("coupon",i):(t.$el.find("._selected_coupon_name").text("쿠폰을 선택 해 주세요."),r.removeClass("on"),t.selectedDiscountModel.set("coupon",!1)),t.discountPriceUpdate()},isUsedCoupon:function(e){var t=this,r=!1;return _.forEach(t.shareUsedCouponArray,function(t){t.offerCode==e.offerCode&&t.giveSeq==e.giveSeq&&(r=!0)}),r},unUsedCoupon:function(e){var t=this;_.forEach(t.shareUsedCouponArray,function(r,o){r.offerCode==e.offerCode&&r.giveSeq==e.giveSeq&&t.shareUsedCouponArray.splice(o,1)})},isUsedSpCoupon:function(e){var t=this,r=!1;return _.forEach(t.shareUsedSpCouponArray,function(t){t.offerCode==e.offerCode&&t.giveSeq==e.giveSeq&&(r=!0)}),r},unUsedSpCoupon:function(e){var t=this;_.forEach(t.shareUsedSpCouponArray,function(r,o){r.offerCode==e.offerCode&&r.giveSeq==e.giveSeq&&t.shareUsedSpCouponArray.splice(o,1)})},setSpCoupon:function(e){var t=this,r=(t.$el,$(e.currentTarget));if(!0===r.hasClass("on"))t.$el.find("._selected_spcoupon_name").text("쇼핑플러스쿠폰을 선택 해 주세요."),r.removeClass("on");else{r.siblings().removeClass("on");var o=r.find(".option_item").text();t.$el.find("._selected_spcoupon_name").text(o),r.addClass("on")}var n=r.index(),l=t.selectedDiscountModel.get("spCoupon"),i=t.model.get("discountPriceTuple").couponTuples.spCouponList[n];if(!1===t.$el.find("._choice_spcoupon").hasClass("on"))return t.removeSpCouponData(l),t.selectedDiscountModel.set("spCoupon",!1),void t.discountPriceUpdate();l&&t.removeSpCouponData(l),t.setSpCouponData(i)?t.selectedDiscountModel.set("spCoupon",i):(t.$el.find("._selected_spcoupon_name").text("쇼핑플러스쿠폰을 선택 해 주세요."),r.removeClass("on"),t.selectedDiscountModel.set("spCoupon",!1)),t.discountPriceUpdate()},showEmployeeHelpLayer:function(e){if(e&&e.originalEvent){e.preventDefault();var t=this,r=t.$el,o=a.userAgent;o.get(o.OS_NAME);switch(a.get(a.APPLICATION_TYPE)){case"p":var n=r.find("._tooltip_wrap");n.hasClass("open")?n.removeClass("open"):n.addClass("open");break;case"m":var l=Backbone.View.extend({el:t.employeeDiscountLayerTemplate(),events:{"click .btn_lyclr":"closeBtnClick"},closeBtnClick:function(e){e.preventDefault(),this.remove()}});$("#content").append((new l).$el)}}},closeCardPointNotice:function(e){this.$el.find("._tooltip_wrap").removeClass("open")},closeEmployeeHelpLayer:function(e){if(e&&e.originalEvent){e.preventDefault();this.$el.find("._tooltip_wrap").removeClass("open")}},lumpToggle:function(e){var t,r=this,o=(r.$el,$(e.currentTarget));r.selectedDiscountModel.get("lumpSum")?(t="ODIN____prddis__sumdisoff__",window.confirm("일시불할인 선택을 정말 해제하시겠습니까?")&&(r.selectedDiscountModel.set("lumpSum",!1),o.text("적용"))):(t="ODIN____prddis__sumdison__",r.selectedDiscountModel.set("lumpSum",r.lumpSum),o.text("적용 취소"),window._cjmallOrderObserver.eventTrigger("cancelInstallment")),e&&e.originalEvent&&i.splunkClickLog(t),r.discountPriceUpdate()},unSetLump:function(){var e=this,t=e.$el.find("#_lump_sum_btn");e.selectedDiscountModel.get("lumpSum")&&(e.selectedDiscountModel.set("lumpSum",!1),t.text("적용"));var r=e.setDiscountUpdateCost();e.model.set("totalCustomerPrice",r),e.selectedDiscountModel.trigger("change.discountUpdate")},getLumpPrice:function(){var e=this,t=0;return e.selectedDiscountModel.get("lumpSum")&&(t=e.selectedDiscountModel.get("lumpSum").currentDiscountPrice),t},promotionNowToggle:function(e){var t=this;t.$el;$(e.currentTarget).prop("checked")?t.selectedDiscountModel.set("promotionNow",t.promotionNow):t.selectedDiscountModel.set("promotionNow",!1),t.discountPriceUpdate()},moveItemDetail:function(e){var t=this;if("OTOUR"!==t.model.get("orderItemTypeTuple").orderItemType){var o=r.getLinkUrl(t.model.get("itemCode"),t.model.get("channelCode"));if(e){var n="";$(e.target).is("img")?n="ODIN____prddis__prdimg__":$(e.target).is("a")&&(n="ODIN____prddis__prdname__"),n&&i.splunkClickLog(n),e.preventDefault()}location.href=o}},showDiscount:function(e){e&&e.originalEvent&&i.splunkClickLog("ODIN____prddis__coupmod__");var t=this,r=t.$el,o=$(e.currentTarget),n=r.find("._box_layer");n.is(":visible")?(n.slideUp(),o.removeClass("open"),o.attr("aria-expanded","false")):(o.addClass("open"),n.slideDown(function(){$("html,body").animate({scrollTop:r.offset().top-$("#header").height()},500)}),o.attr("aria-expanded","true"))},getData:function(){var e=this;return{itemCode:e.model.get("itemCode"),channelCode:e.model.get("channelCode"),unitCode:e.model.get("unitCode"),unitPrice:e.selectedDiscountModel.get("discountPrice"),quantity:e.model.get("quantity"),itemName:e.model.get("itemName"),unitName:e.model.get("dispUnitName"),orderItemType:e.model.get("orderItemTypeTuple").orderItemType,shopId:e.model.get("shopId"),marketCode:e.model.get("marketCode"),mainVenCode:e.model.get("mainVenCode"),moCode:null,etvItemStatus:e.model.get("etvItemStatusCode")?e.model.get("etvItemStatusCode"):null,salePrice:e.model.get("salePrice"),deliveryIndex:e.getDeliveryIndex(),arsDiscountAmount:e.selectedDiscountModel.get("arsTvShopping")?e.selectedDiscountModel.get("arsTvShopping").currentDiscountPrice:null,norestDiscountAmount:e.selectedDiscountModel.get("lumpSum")?e.selectedDiscountModel.get("lumpSum").currentDiscountPrice:null,norestDiscountRate:e.selectedDiscountModel.get("lumpSum")?e.selectedDiscountModel.get("lumpSum").discountRate:null,lumpSavePointDcAmount:e.selectedDiscountModel.get("promotionNow")?e.selectedDiscountModel.get("promotionNow").currentDiscountPrice:null,isCJMemberExcept:e.getCJMemberExcept(),cartKey:e.model.get("cartKey"),cjMemberDiscountAmount:e.getCjMemberDiscountAmount(),discountAllAmtYn:e.getDiscountAllAmtYn(),packItemForms:e.getPackItemForms(),giftItemForms:e.getGiftItemForms(),orderCouponForm:e.getCouponForm(),orderSpCouponForm:e.getSpCouponForm(),orderDeliveryFeeForm:e.getDeliveryFeeForm(),linkGiftItems:e.getLinkGiftItems(),itemTypeCode:e.model.get("itemTypeCode"),vipDiscountAmount:e.getVipDiscountAmount(),isVipDiscountExcept:e.getVipDiscountExcept()}},getLinkGiftItems:function(){var e=this,t=e.model.get("totalGiftTuples"),r=[];return t&&_.forEach(t,function(e){if("LINK_GIFT"===e.itemEtcType){var t=[];_.forEach(e.giftUnitItems,function(e){t.push({itemCode:e.itemCode,unitCode:e.unitCode})}),r.push({tpromofferEntityKey:e.tpromofferEntityKey?e.tpromofferEntityKey:null,channelCode:e.channelCode?e.channelCode:null,payQty:e.payQty?e.payQty:null,giftUnitItems:0==t.length?null:t})}}),0==r.length?null:r},getDeliveryFeeForm:function(){var e=this;return e.model.trigger("requestDeliveryFeeForm",e),e.model.get("deliveryFeeForm")},setDeliveryFeeForm:function(e){this.model.set("deliveryFeeForm",e)},getCouponForm:function(){var e=this,t=e.selectedDiscountModel.get("coupon");return t?{offerCode:t.offerCode,giveSeq:t.giveSeq,date:t.giveDateString}:null},getSpCouponForm:function(){var e=this,t=e.selectedDiscountModel.get("spCoupon");return t?{offerCode:t.offerCode,giveSeq:t.giveSeq,date:t.giveDateString}:null},getDeliveryIndex:function(){return 0},getDiscountAllAmtYn:function(){var e=this,t=null,r=e.model.get("discountPriceTuple").discountDetails;return _.forEach(r,function(e){"EMPLOYEE"===e.category&&(t=e.cjMemberDiscountTuple.discountAllAmtYn)}),t},getCjMemberDiscountAmount:function(){var e=this,t=null,r=e.model.get("discountPriceTuple").discountDetails;return _.forEach(r,function(e){"EMPLOYEE"===e.category&&(t=e.discountPrice)}),t},getVipDiscountAmount:function(){var e=this,t=null,r=e.model.get("discountPriceTuple").discountDetails;return _.forEach(r,function(e){"VIP"===e.category&&(t=e.discountPrice)}),t},getPackItemForms:function(){var e=this,t=[];return e.model.get("packUnitItemTuples")&&e.model.get("packUnitItemTuples").length?_.forEach(e.model.get("packUnitItemTuples"),function(e){t.push({itemSequence:e.itemSequence,unitSequence:e.unitSequence,configItemCode:e.configItemCode,configUnitCode:e.unitItemCode,packUnitName:e.packUnitName})}):t=null,t},getGiftItemForms:function(){var e=this,t=[];return e.model.get("totalGiftTuples").length?(_.forEach(e.model.get("totalGiftTuples"),function(e){"LINK_GIFT"!==e.itemEtcType&&t.push({promotionNo:e.tpromofferEntityKey?e.tpromofferEntityKey.promNo:null,promotionSeq:e.tpromofferEntityKey?e.tpromofferEntityKey.promSeq:null,offerSeq:e.tpromofferEntityKey?e.tpromofferEntityKey.offerSeq:null,giftcartSeq:e.giftcartSeq,itemCode:e.giftItemCode,channelCode:e.channelCode,unitCode:e.giftUnitCode,quantity:e.payQty})}),0==t.length?null:t):null},getCJMemberExcept:function(){var e=this,t=!1,r=e.model.get("discountPriceTuple").discountDetails;return _.forEach(r,function(e){"EMPLOYEE_EXCEPT"===e.category&&(t=!0)}),t},getVipDiscountExcept:function(){var e=this,t=!1,r=e.model.get("discountPriceTuple").discountDetails;return _.forEach(r,function(e){"VIP_EXCEPT"===e.category&&(t=!0)}),t},setCouponDiscountPriceText:function(){var e=this,r=e.model.get("discountPriceModel").get("couponTuples").couponList,o=e.model.get("discountPriceModel").get("couponTuples").spCouponList,n=e.selectedDiscountModel.get("salePrice"),l=e.model.get("quantity"),i=e.selectedDiscountModel.get("salePrice")*l,a=0;if(e.selectedDiscountModel.get("employee")){if("AMT"===e.selectedDiscountModel.get("employee").type&&(a=e.selectedDiscountModel.get("employee").discountPrice),"RATE"===e.selectedDiscountModel.get("employee").type){var d=Number(e.selectedDiscountModel.get("employee").cjMemberDiscountTuple.cjDcRate);a=10*Math.floor(n*l*(d/1e3))}i-=a}var s=0;e.selectedDiscountModel.get("vip")&&("AMT"===e.selectedDiscountModel.get("vip").type&&(s=e.selectedDiscountModel.get("vip").discountPrice),i-=s);var c=0;if(e.selectedDiscountModel.get("priceDiscount")){if("AMT"===e.selectedDiscountModel.get("priceDiscount").type&&(c=e.selectedDiscountModel.get("priceDiscount").discountPrice),"RATE"===e.selectedDiscountModel.get("priceDiscount").type){var u=e.selectedDiscountModel.get("priceDiscount").discountRate;c=10*Math.floor(n*(u/1e3))*l}i-=c}_.forEach(r,function(t){e.calculateCouponDiscountPrice(t,i,n,a,s,c,l)});var p=e.selectedDiscountModel.get("coupon"),m=e.calculateCouponDiscountPrice(p,i,n,a,s,c,l);i-=m;var f=0;_.forEach(o,function(r){if(r){if("1"===r.dcClsCode&&(f=10*Math.floor(r.dcAmount/10)*l),"2"===r.dcClsCode){var o=r.maxDcAmount*l,d=r.dcRate;f=10*Math.floor((n-a/l-s/l-c/l-m/l)*d/1e3)*l,o&&f>o&&(f=o)}f>i&&(f=i),0==f?e.$el.find("[data-offerIndex="+r.offerCode+"]").text(t.formatNumber(f)+"원"):e.$el.find("[data-offerIndex="+r.offerCode+"]").text("-"+t.formatNumber(f)+"원")}})},calculateCouponDiscountPrice:function(e,r,o,n,l,i,a){var d=this,s=0,c=0,u=0;if(e){if("1"===e.dcClsCode&&(s=10*Math.floor(e.dcAmount/10)*a,c=10*Math.floor(e.dcAmount/10)*1,(u=e.maxDcAmount)>0&&(c=c>u?u:c)),"2"===e.dcClsCode){var p=e.maxDcAmount*a,m=e.dcRate;s=10*Math.floor((o-n/a-l/a-i/a)*m/1e3)*a,c=10*Math.floor(o*m/1e3)*1,u=e.maxDcAmount,u>0&&(c=c>u?u:c),p&&s>p&&(s=p)}s>r&&(s=r),0==s?d.$el.find("[data-offerIndex="+e.offerCode+"]").text(t.formatNumber(s)+"원"):d.$el.find("[data-offerIndex="+e.offerCode+"]").text("-"+t.formatNumber(s)+"원")}return s},openCouponList:function(e){e.preventDefault(),e&&e.originalEvent&&i.splunkClickLog("ODIN____prddis__prdcoup__");var t=this,r=$(e.currentTarget);t.$el.find("#_sp_coupon_list").hasClass("open")&&(t.$el.find("._spcoupon_wrapper").hide(),t.$el.find("#_sp_coupon_list").removeClass("open")),!0===r.hasClass("open")?(t.$el.find("._coupon_wrapper").hide(),r.removeClass("open")):(t.$el.find("._coupon_wrapper").show(),r.addClass("open"))},openSpCouponList:function(e){e.preventDefault(),e&&e.originalEvent&&i.splunkClickLog("ODIN____prddis__pluscoup__");var t=this,r=$(e.currentTarget);t.$el.find("#_coupon_list").hasClass("open")&&(t.$el.find("._coupon_wrapper").hide(),t.$el.find("#_coupon_list").removeClass("open")),!0===r.hasClass("open")?(t.$el.find("._spcoupon_wrapper").hide(),r.removeClass("open")):(t.$el.find("._spcoupon_wrapper").show(),r.addClass("open"))}})}),define("page/cjmall/order/sheet/view/orderNoticeView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t){return Backbone.View.extend({el:"#order_noitce",orderNoticeTemplate:t.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderSheetTopNotice"),dispMedia:null,noticeMsg:null,isOrderSheetNoticeAble:!1,initialize:function(){this.render()},render:function(){var t=this,r=t.$el;return t.dispMedia=e.get("orderNoticeTuple").get("dispMedia"),t.noticeMsg=e.get("orderNoticeTuple").get("noticeMsg"),t.isOrderSheetNoticeAble=e.get("orderNoticeTuple").get("isOrderSheetNoticeAble"),t.model=new Backbone.Model({isOrderSheetTopNoticeAble:t.isOrderSheetNoticeAble,displayMedia:t.dispMedia,orderNoticeMessage:t.noticeMsg}),r.html(t.orderNoticeTemplate(t.model.toJSON())),this}})}),define("page/cjmall/order/sheet/view/orderPaymentControlView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/helper/payTypeAttributeHelper","common/cjos/util/handlebarsHelper"],function(e,t,r){return Backbone.View.extend({el:"#_method_lst",template:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderPaymentControlPromotion"),templateOthers:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderPaymentControlOthers"),templateShowMore:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderPaymentControlShowMore"),initialize:function(){},events:{"click .btn_different_payment":"showDifferentPayment"},isPromotionPaymentByClassName:function(e){return"1"===this.$el.find(e).attr("categoryLevel")},isNormalPaymentByClassName:function(e){return"2"===this.$el.find(e).attr("categoryLevel")},isDifferentPaymentByClassName:function(e){return"3"===this.$el.find(e).attr("categoryLevel")},showDifferentPayment:function(){var e=this,t=e.$el;t.find(".paymentEtc").show(),t.find(".differentPayment").hide()},isAvailablePayment:function(t){var r=e.get("orderPaymentModel"),o=r.get("orderPaymentControlTuple"),n=o.orderPaymentControlDetailTuples,l=!1;return n&&_.forEach(n,function(e){if(e.available&&(e.paymentName===t&&(l=!0),l))return!1}),l},render:function(){var r=this,o=r.$el,n=e.get("orderPaymentModel"),l=n.get("orderPaymentControlTuple"),i=l.orderPaymentControlDetailTuples;if(i){var a=!0;_.forEach(i,function(e,n){e.available&&(e.Icon=t.getPayTypeIcon(e.paymentName),e.SpcId=t.getPayTypeSpcId(e.paymentName),e.ClassName=t.getPayTypeClass(e.paymentName),e.paymentTitle=t.getPayTypeName(e.paymentName),1==e.categoryLevel?(e.categoryClass="first_entry",o.append(r.template(e))):2==e.categoryLevel?o.append(r.template(e)):3==e.categoryLevel&&(a&&(o.append(r.templateShowMore()),a=!1),o.append(r.templateOthers(e))))})}}})}),define("page/cjmall/order/sheet/view/orderPaymentView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/helper/payTypeHelper","page/cjmall/order/sheet/helper/payTypeAttributeHelper","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil","common/cjos/util/dateUtil","common/cjos/util/configUtil","page/cjmall/order/sheet/view/chargeDiscountEventView","page/cjmall/order/sheet/view/chargeDiscountExpectPriceView","page/cjmall/order/sheet/view/latelyChargeDiscountExpectPriceView","page/cjmall/order/sheet/view/orderPaymentControlView","page/cjmall/order/sheet/view/orderCardEventNoticeView"],function(e,t,r,o,n,l,i,a,d,s,c,u,p){return Backbone.View.extend({el:"#order_payment",constructorName:"OrderPaymentView",isLatelyPayment:!1,template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/orderPaymentInfo"),oliveyoungTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/oliveyoungOrderPaymentInfo"),cardPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/cardPayment"),cardPaymentInstallmentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/cardPaymentInstallment"),noBankbookPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/noBankbookPayment"),realTimeAccountTransferTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/realTimeAccountTransfer"),latelyNoBankbookPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelyNoBankbookPayment"),latelyCardPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/latelyCardPayment"),latelyPaynowPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelyPaynowPayment"),latelyPaycoPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelyPaycoPayment"),latelyKakaopayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelyKakaopayPayment"),latelySyruppayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelySyruppayPayment"),latelySamsungpayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelySamsungpayPayment"),latelyNaverpayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelyNaverpayPayment"),latelyKakaotalkpayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelyKakaotalkpayPayment"),latelySmilepayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelySmilepayPayment"),latelySettlebankPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/latelySettlebankPayment"),mobilePaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/mobilePayment"),paynowPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/paynowPayment"),kakaopayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/kakaopayPayment"),paycoPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/paycoPayment"),syruppayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/syruppayPayment"),naverpayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/naverpayPayment"),samsungpayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/samsungpayPayment"),cardPointNoticeTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/cardPointNotice"),kakaotalkpayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/kakaotalkpayPayment"),
smilepayPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/smilepayPayment"),settlebankPaymentTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/settlebankPayment"),model:e.get("orderPaymentModel"),orderBenefitModel:null,initialize:function(t){var r=this;r.model=e.get("orderPaymentModel"),r.orderBenefitModel=e.get("orderBenefitModel"),r.isLatelyPayment=!!r.model.get("orderLatelyPaymentTuple"),r.listenTo(r.orderBenefitModel,"change",r.showOrHideOrderPaymentView),r.setHandlebarsHelper(),r.render(t),r.setDefaultNobankbook(),window._cjmallOrderObserver.setListeningCallback(r,"changeTotalAmount",function(){if(!0===r.isLatelyPayment&&0==$("#_select_installment option:selected").val()){var e=r.model.get("orderLatelyPaymentTuple").creditCardCompany;r.resetSelectInstallment(e)}}),window._cjmallOrderObserver.setListeningCallback(r,"cancelInstallment",r.resetInstallment),e.get("orderPaymentModel").set("getOrderPaymentFormCallback",$.proxy(r.getData,r))},render:function(t){var r,o=this,n=o.$el;switch(o.model.get("orderLatelyPaymentTuple")&&(r=o.model.get("orderLatelyPaymentTuple").creditCardCompany,o.setPayTypeName(r)),"NON_CUSTOMER"!=e.get("orderSheetType")&&(o.model.set("isOrderSheetNoticeAble",o.model.get("orderNoticeTuple").isOrderSheetNoticeAble),o.model.set("orderNoticeMessage",o.model.get("orderNoticeTuple").noticeMsg),o.model.set("displayMedia",o.model.get("orderNoticeTuple").dispMedia)),t){case"OLIVEYOUNG":o.model.setAddOliveyoung(e),n.html(o.oliveyoungTemplate(o.model.toJSON())),o.OrderPaymentControlView=new u,o.OrderCardEventNoticeView=new p(t),o.showPaymentTab();break;default:n.html(o.template(o.model.toJSON())),o.OrderPaymentControlView=new u,o.OrderCardEventNoticeView=new p(t),o.OrderPaymentControlView.render(),o.isLaytelyPaymentUsable(r)?o.showLaytelyPayment(r):o.showPaymentTab()}0===e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice&&(n.find("._order_method_title").hide(),n.find("._order_norest_popup").hide(),n.find("._order_method").hide(),n.find("._order_cash_receipt").hide(),o.model.set("_payType","NOPAY")),o.showOrHideOrderPaymentView()},events:{"click ._CARD":"cardTabView","click ._NOBANKBOOK":"nobankTabView","click ._REALTIMEACCOUNTTRANSFER":"realtimeAccountTransferTabView","click ._MOBILE":"mobileTabView","click ._SAMSUNGPAY":"samsungpayTabView","click ._PAYCO":"paycoTabView","click ._PAYNOW":"paynowTabView","click ._KAKAOPAY":"kakaotalkpayTabView","click ._SYRUPPAY":"syruppayTabView","click ._NAVERPAY":"naverpayTabView","click ._SMILEPAY":"smilepayTabView","click ._SETTLEBANK":"settlebankTabView","click #_btn_change_payment":"showPaymentTab","click #_card_point_notice":"showCardPointNotice","click #_close_card_point_notice":"closeCardPointNotice","click #_paynow_app_install":"paynowAppInstall","click #_card_point_usable input[type=checkbox]":"clickCardPointCheckBox","change #_payment_due_date":"selectPaymentDueDate","change #_depositor_text":"setPositor","change #_select_installment":"selectinstallment","click #_select_installment":"manuallyClickCodeHn","change #_select_card_lst":"selectCard","click #_select_card_lst":"manuallyClickCodeHn","change #_select_nobankbook":"selectNobankbook","click #_select_nobankbook":"manuallyClickCodeHn","change #_polaris_card_detail":"selectPolarisDetail","change #_samsung_card_detail_pay_type":"selectSamsungCardDetailType","change #_bc_card_detail_pay_type":"selectBcCardDetailPayType","change #_kb_card_detail_pay_type":"selectKbCardDetailPayType","change [name=rdbx3]":"changeKbcardRadio","click #_depositor_text":"setDepositorClickHn","click #_payment_due_date":"paymentDueDateClickHn","click ._order_norest_popup":"cardEventNoticeShow","click ._close_card_event_notice":"cardEventNoticeHide","click ._cj_card_detail":"clickCjCardDetail","click ._cj_card_detail_popup_close":"clickCjCardDetail"},paynowAppInstall:function(e){var t=o.userAgent,r=t.get(t.OS_NAME);switch(o.get(o.APPLICATION_TYPE)){case"p":window.open("http://www.paynow.co.kr","_blank");break;case"m":if("ios"===r)return void $(location).attr("href","https://itunes.apple.com/kr/app/paynow/id760098906?l=en&mt=8");if("android"===r)return void $(location).attr("href","market://details?id=com.lguplus.paynow")}},manuallyClickCodeHn:function(e){l.splunkClickLog($(e.target).attr("data-click"))},showLaytelyPayment:function(e){var r=this,o=r.$el;r.model.set("_payType",e),o.find("#_lately_payment").show(),t.isCard(e)&&(r.chargeDiscountExpectPrice(),r.latelyChargeDiscountExpectPrice(),o.find("#_order_method_detail").html(r.latelyCardPaymentTemplate(r.model.toJSON())),r.resetSelectInstallment(e),r.showOrHidePolarisCardDetailPayType(e),r.showOrHideBcCardDetailPayType(e),r.showOrHideKbCardDetailPayType(e),r.showOrdHideSamsungCardDetailPayType(e),r.showOrHideCardPointUsable(e)),t.isNobankbook(e)&&o.find("#_order_method_detail").html(r.latelyNoBankbookPaymentTemplate(r.model.toJSON())),"PAYNOW"===e&&o.find("#_order_method_detail").html(r.latelyPaynowPaymentTemplate()),"PAYCO"===e&&o.find("#_order_method_detail").html(r.latelyPaycoPaymentTemplate()),"KAKAOPAY"===e&&o.find("#_order_method_detail").html(r.latelyKakaopayPaymentTemplate()),"SYRUPPAY"===e&&o.find("#_order_method_detail").html(r.latelySyruppayPaymentTemplate()),"SAMSUNGPAY"===e&&o.find("#_order_method_detail").html(r.latelySamsungpayPaymentTemplate()),"NAVERPAY"===e&&o.find("#_order_method_detail").html(r.latelyNaverpayPaymentTemplate()),"KAKAOTALKPAY"===e&&o.find("#_order_method_detail").html(r.latelyKakaotalkpayPaymentTemplate()),"SMILEPAY"===e&&o.find("#_order_method_detail").html(r.latelySmilepayPaymentTemplate()),"SETTLEBANK"===e&&o.find("#_order_method_detail").html(r.latelySettlebankPaymentTemplate())},isLaytelyPaymentUsable:function(r){var o=this,n=o.model.get("orderLatelyPaymentTuple"),l=o.model.get("nobankbookPaymentTuple");if(n){if(t.isCard(r)){return _.find(o.model.get("cardPaymentTuples"),{payType:r})?o.OrderPaymentControlView.isAvailablePayment("CARD"):o.OrderPaymentControlView.isAvailablePayment(r)}return t.isNobankbook(r)&&l.receiptHopeDates.length>3?o.OrderPaymentControlView.isAvailablePayment("NOBANKBOOK"):("MOBILE"===r&&e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice,o.OrderPaymentControlView.isAvailablePayment(r))}return!1},resetInstallment:function(e){var t=this,r=t.$el;_.delay(function(){r.find("#_select_installment").trigger("blur").prop("selectedIndex",0).trigger("change")},100)},selectinstallment:function(e){cjosLogUtil.log("+++++++++++++++++++++ orderPaymentView.selectinstallment() start ++++++++++++++++++++++++++++++++"),e.preventDefault();var t=this,r=t.$el;0!=e.currentTarget.value&&window._cjmallOrderObserver.eventTrigger("paymentIsNotLump"),e.currentTarget.value>12?(r.find("._bc_point").hide(),r.find("._woori_point").hide(),$("input[name=bcpoint]").prop("checked",!1),r.find("#_card_point_usable input").removeAttr("checked"),r.find("#_card_point_usable input").attr("disabled","disalbed")):r.find("#_card_point_usable input").removeAttr("disabled"),t.model.set("_installmentMonth",e.currentTarget.value);var o=t.model.get("_payType");cjosLogUtil.log("tempPayType : "+o),"KMOTION"===o?o="KB_CARD":"PAYALL"===o&&(o="BC_CARD");var n=_.findWhere(t.model.get("cardPaymentTuples"),{payType:o}),l=_.find(n.interestTupleList,function(t){return t.interestMonth==e.currentTarget.value});l&&t.model.set("_interestType",l.interestType),cjosLogUtil.log("_installmentMonth : "+t.model.get("_installmentMonth")),cjosLogUtil.log("_interestType : "+t.model.get("_interestType")),cjosLogUtil.log("+++++++++++++++++++++ orderPaymentView.selectinstallment() end ++++++++++++++++++++++++++++++++")},setPositor:function(e){e.preventDefault();var t=this,r=$(e.currentTarget),o=r.val();if(r.val().length>10)return r.val(r.val().substring(0,10)),void alert("입금자명은 최대 10자리까지 입력 가능합니다.");t.model.set("_depositor",o)},setDepositorClickHn:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____payment__bankown__")},setPayTypeName:function(e){this.model.set("payTypeName",t.getPayTypeName(e))},setDefaultNobankbook:function(){var e=this;e.$el;e.model.set("_depositor",e.model.get("nobankbookPaymentTuple").depositor),e.model.set("_paymentDueDate",e.model.get("nobankbookPaymentTuple").receiptHopeDates[2])},setHandlebarsHelper:function(){Handlebars.registerHelper("receiptHopeDateFormat",function(e,t){return e&&8==e.toString().length?e.toString().substr(0,4)+"년 "+e.toString().substr(4,2)+"월 "+e.toString().substr(6,2)+"일":""}),Handlebars.registerHelper("isPromotionPeriod",function(t){var r=!1;return $.each(e.responseData.result.orderPaymentTuple.orderPaymentControlTuple.orderPaymentControlDetailTuples,function(){if(this.paymentName==t&&1==this.promotionPeriod)return r=!0,!1}),r})},selectPaymentDueDate:function(e){e.preventDefault();var t=this,r=(t.$el,$(e.currentTarget));t.model.set("_paymentDueDate",e.target.value),window._cjmallOrderObserver.eventTrigger("checkHopeDeliveryDay",r)},paymentDueDateClickHn:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____payment__bankdate__")},showOrHideOrderPaymentView:function(){var t=this,r=t.$el,o=t.orderBenefitModel.get("_paymentAmount"),n=t.model.get("_payType");if(t.chargeDiscountExpectPrice(),t.latelyChargeDiscountExpectPrice(),0===o&&(r.find("._order_method_title").hide(),r.find("._order_norest_popup").hide(),r.find("._order_method").hide(),r.find("input[type=checkbox]").prop("checked",!1),t.model.set("_payType","NOPAY")),o>0){if("block"===$("._order_method_title").css("display"))return;if(r.find("._order_method_title").show(),r.find("._order_norest_popup").show(),r.find("._order_method").show(),!t.model.isUsedAllPayment())return r.find("._order_method_title").hide(),r.find("._order_norest_popup").hide(),r.find("._order_method").hide(),void r.find("._order_cash_receipt").hide();if("block"===r.find("#_lately_payment").css("display")){var n=e.get("orderPaymentModel").get("orderLatelyPaymentTuple").creditCardCompany;return void t.model.set("_payType",n)}r.find("._order_method li").first().find("input").click()}},clickCardPointCheckBox:function(e){if(e){var t;t=$(e.target).is(":checked")?"ODIN____payment__cardpointon__":"ODIN____payment__cardpointoff__",e.originalEvent&&l.splunkClickLog(t)}var r=this,n=r.$el,i=r.model.get("_payType");switch(o.get(o.APPLICATION_TYPE)){case"p":case"m":"BC_CARD"===i&&$(e.target).is(":checked")?$("input[name=bcpoint]").eq(0).prop("checked",!0):"WOORI_CARD"===i&&$(e.target).is(":checked")?($("input[name=bcpoint]").eq(0).prop("checked",!0),n.find("._bc_point").show(),n.find("._woori_point").show()):(n.find("._bc_point").hide(),n.find("._woori_point").hide(),$("input[name=bcpoint]").prop("checked",!1))}},showCardPointNotice:function(e){e.preventDefault();var t=this,r=t.$el,n=o.userAgent;n.get(n.OS_NAME);switch(o.get(o.APPLICATION_TYPE)){case"p":r.find(".tooltip_wrap").addClass("open");var l=new Date,a=i.getDateFromString(__cjos_config__.hyundaiEventStartDate),d=i.getDateFromString(__cjos_config__.hyundaiEventEndDate);l>a&&l<d&&r.find(".list_point li span:eq(2)").text("결제금액의 50%까지 1점 단위 사용");break;case"m":var s=Backbone.View.extend({el:t.cardPointNoticeTemplate(),events:{"click .btn_lyclr":"closeBtnClick"},initialize:function(){var e=this,t=new Date,r=i.getDateFromString(__cjos_config__.hyundaiEventStartDate),o=i.getDateFromString(__cjos_config__.hyundaiEventEndDate);t>r&&t<o&&$(e.el).find(".list_point li span:eq(2)").text("결제금액의 50%까지 1점 단위 사용")},closeBtnClick:function(e){e.preventDefault(),this.remove()}});$("#content").append((new s).$el)}},closeCardPointNotice:function(e){e.preventDefault(),this.$el.find(".tooltip_wrap").removeClass("open")},showPaymentTab:function(e){e&&(e.originalEvent&&l.splunkClickLog("ODIN____payment__chanpay__"),e.preventDefault());var t=this,r=t.$el;r.find("#_order_method_detail").html(""),r.find("#_lately_payment").hide(),r.find("#_method_lst").show(),t.showLatelyPaymentTypeTab(),t.isLatelyPayment=!1,t.chargeDiscountExpectPrice()},showLatelyPaymentTypeTab:function(){var e,t=this,r=t.$el;if(t.model.get("orderLatelyPaymentTuple")){var o=t.model.get("orderLatelyPaymentTuple").latelyPaymentType,n=[];n["01"]="._CARD",n["02"]="._NOBANKBOOK",n[15]="._MOBILE",n[35]="._PAYCO",n[25]="._KAKAOPAY",n[26]="._SMILEPAY",n[27]="._SETTLEBANK",n[37]="._SYRUPPAY",n[38]="._PAYNOW",n[24]="._NAVERPAY",n[o]&&(e=n[o]),$.each(t.model.get("orderPaymentControlTuple").orderPaymentControlDetailTuples,function(){if(1==this.promotionPeriod)return e="."+this.ClassName,!1})}if(r.find(e).length>0)r.find(e).click(),t.OrderPaymentControlView.isDifferentPaymentByClassName(e)&&t.OrderPaymentControlView.showDifferentPayment();else{r.find("li").first().find("input").click()}},seleteLatelyCardCompany:function(){var e=this,t=e.$el;if(e.model.get("orderLatelyPaymentTuple")){var r=e.model.get("orderLatelyPaymentTuple").defaultCardCompany;t.find("#_select_card_lst option[value="+r+"]").prop("selected",!0).change()}},seleteLatelyBankCompany:function(){var e=this,t=e.$el;if(e.model.get("orderLatelyPaymentTuple")){var r=e.model.get("orderLatelyPaymentTuple").defaultBankCompany;t.find("#_select_nobankbook option[value="+r+"]").prop("selected",!0).change()}},selectPolarisDetail:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____payment__cardmeth__");var t=this;t.$el;cjosLogUtil.log(e.target.value),t.model.set("_polarisDetailPayType",e.target.value),t.model.get("",e.target.value)},selectSamsungCardDetailType:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____payment__cardmeth__");var t=this;t.$el;t.model.set("_polarisDetailPayType",e.target.value)},selectKbCardDetailPayType:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____payment__cardmeth__");var t=this;$el=t.$el,t.model.set("_payType",e.target.value)},selectBcCardDetailPayType:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____payment__cardmeth__");var t=this;$el=t.$el,t.model.set("_payType",e.target.value)},selectCard:function(e){var t=this,r=(t.$el,e.currentTarget.value);t.model.set("_payType",r),t.restPolarisCardDetail(),t.showOrHidePolarisCardDetailPayType(r),t.restBcCardDetail(),t.showOrHideBcCardDetailPayType(r),t.showOrHideKbCardDetailPayType(r),t.restSamsungCardDetail(),t.showOrdHideSamsungCardDetailPayType(r),t.resetCardPointUsable(),t.showOrHideCardPointUsable(r),t.resetSelectInstallment(r),t.chargeDiscountExpectPrice()},chargeDiscountExpectPrice:function(){var e=this,t=e.$el;if("OLIVEYOUNG"!==e.model.get("orderSheetType")){var r=t.find("#_select_card_lst").val();if(r!==undefined&&null!==r){var o=e.model.get("paymentEtc");o._payType=r,e.chargeDiscountExpectPriceView=new s({model:o});var n=e.chargeDiscountExpectPriceView.getExpectedPrice(),l=e.chargeDiscountExpectPriceView.render(n);if(null!==l){var i=l.$el;t.find("#_chargeExpectPriceArea").html(i),0===n?t.find("#_chargeExpectPriceArea").css("display","none"):t.find("#_chargeExpectPriceArea").css("display","")}}}},latelyChargeDiscountExpectPrice:function(){var e=this,t=e.$el;if("OLIVEYOUNG"!==e.model.get("orderSheetType")){var r=e.model.get("_payType");if(r!==undefined&&null!==r){var o=e.model.get("paymentEtc");o._payType=r,e.latelyChargeDiscountExpectPriceView=new c({model:o});var n=e.latelyChargeDiscountExpectPriceView.getExpectedPrice(),l=e.latelyChargeDiscountExpectPriceView.render(n);if(null!==l){var i=l.$el;t.find("#_latelyChargeExpectPriceArea").html(i),0===n?t.find("#_latelyChargeExpectPriceArea").css("display","none"):t.find("#_latelyChargeExpectPriceArea").css("display","")}}}},selectNobankbook:function(e){this.model.set("_payType",e.currentTarget.value)},showOrdHideSamsungCardDetailPayType:function(e){var r=this,o=r.$el;t.isSamsungCard(e)?(o.find("#_samsung_card_detail_pay_type").show(),o.find("#_polaris_card_detail").hide(),r.model.set("_polarisDetailPayType","APP_PAYMENT")):(o.find("#_samsung_card_detail_pay_type").hide(),r.model.set("_polarisDetailPayType","ANSIM_CLICK"))},showOrHidePolarisCardDetailPayType:function(e){var r=this,o=r.$el;t.isPolrarisCard(e)?o.find("#_polaris_card_detail").show():o.find("#_polaris_card_detail").hide(),"HYUNDAI_CARD"===e?(o.find("#_payShotPayment").show(),o.find("#_simplePayment").hide()):(o.find("#_payShotPayment").hide(),o.find("#_simplePayment").show())},showOrHideScbcCardDetailPayType:function(e){var t=this,r=t.$el;"SCBC_CARD"===e?r.find("#_scbc_card_detail_pay_type").show():r.find("#_scbc_card_detail_pay_type").hide()},showOrHideWoriCardDetailPayType:function(e){var t=this,r=t.$el;"WORI_CARD"===e?r.find("#_wori_card_detail_pay_type").show():r.find("#_wori_card_detail_pay_type").hide()},showOrHideKbCardDetailPayType:function(e){var t=this,r=t.$el;"KB_CARD"===e?r.find("#_kb_card_detail_pay_type").show():r.find("#_kb_card_detail_pay_type").hide()},showOrHideCardPointUsable:function(e){var t=this,r=t.$el,n=t.model.get("orderPaymentControlTuple").hyundaiPointCheck;switch(o.get(o.APPLICATION_TYPE)){case"p":case"m":r.find("._bc_point").hide(),r.find("._woori_point").hide(),$("input[name=bcpoint]").prop("checked",!1)}"SHINHAN_CARD"===e||"HYUNDAI_CARD"===e||"SAMSUNG_CARD"===e||"BC_CARD"===e||"CITI_CARD"===e||"HANA_KEB_CARD"===e||"WOORI_CARD"===e?(r.find("#_card_point_usable").show(),n&&$("#_card_point_usable input[type=checkbox]").click()):r.find("#_card_point_usable").hide()},showOrHideBcCardDetailPayType:function(e){var t=this,r=t.$el;"BC_CARD"===e?r.find("#_bc_card_detail_pay_type").show():r.find("#_bc_card_detail_pay_type").hide()},resetCardPointUsable:function(){var e=this,t=e.$el;t.find("#_card_point_usable input").prop("checked",!1),t.find("#_card_point_usable input").removeAttr("disabled")},createSelectInstallment:function(e){cjosLogUtil.log("+++++++++ orderPaymentView.createSelectInstallment() start ++++++++");var t=this,r=t.$el;_.forEach(t.model.get("cardPaymentTuples"),function(t){t.payType===e&&_.forEach(t.interestTupleList,function(e){0===e.interestMonth?r.find("#_select_installment").append($("<option>").attr("value",e.interestMonth).text("일시불")):r.find("#_select_installment").append($("<option>").attr("value",e.interestMonth).text(e.interestMonth+"개월"))})}),cjosLogUtil.log("+++++++++ orderPaymentView.createSelectInstallment() end ++++++++")},resetSelectInstallment:function(t){cjosLogUtil.log("+++++++++ orderPaymentView.resetSelectInstallment() start ++++++++");var r=this,o=r.$el,n=o.find("._sub_select_installment_edit"),l=r.model.get("cardPaymentTuples"),i=_.find(l,{payType:t});e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice<5e4&&(i=null),r.model.set("_installmentMonth",0),n.html(r.cardPaymentInstallmentTemplate(i)),cjosLogUtil.log("+++++++++ orderPaymentView.resetSelectInstallment() end ++++++++")},restPolarisCardDetail:function(){this.$el.find("#rdbx8").prop("checked",!0)},restSamsungCardDetail:function(){this.$el.find("#rdbx_ss_app").prop("checked",!0)},restBcCardDetail:function(){this.$el.find("#rdbx10").prop("checked",!0)},cardTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","CARD"),r.find("#_order_method_detail").html(t.cardPaymentTemplate(t.model.toJSON())),t.seleteLatelyCardCompany(),t.chargeDiscountExpectPrice()},nobankTabView:function(t){var r=this,o=r.$el,n=$(t.currentTarget);r.tabViewChecked(o,n);var l=e.get("orderSheetType");"NON_CUSTOMER"==l?r.model.set("_payType","CITI_NOBANKBOOK"):r.model.set("_payType","NOBANKBOOK");var i=r.model.get("nobankbookPaymentTuple");_.extend(i,{orderSheetType:l});var a=e.get("orderPriceModel").get("orderPriceManagers");if(1===_.size(a)){var d="Y"===a[0].venDeliveryApplyYn;_.extend(i,{isVenDeliveryApply:d})}o.find("#_order_method_detail").html(r.noBankbookPaymentTemplate(i)),window._cjmallOrderObserver.eventTrigger("selectNoBankBook"),r.seleteLatelyBankCompany()},realtimeAccountTransferTabView:function(t){var r=this,o=r.$el,n=$(t.currentTarget);r.tabViewChecked(o,n);var l=e.get("orderSheetType");r.model.set("_payType","REALTIME_ACCOUNT_TRANSFER");var i=r.model.get("nobankbookPaymentTuple");_.extend(i,{orderSheetType:l}),o.find("#_order_method_detail").html(r.realTimeAccountTransferTemplate(i)),window._cjmallOrderObserver.eventTrigger("selectNoBankBook")},mobileTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","MOBILE");var n=new Date,l=i.getDateFromString(__cjos_config__.mpSamsungPayEventStartDate),a=i.getDateFromString(__cjos_config__.mpSamsungPayEventEndDate);r.find("#_order_method_detail").html(t.mobilePaymentTemplate()),n>l&&n<a?(r.find("#_order_method_detail ._samsungPayEvent").css("display",""),r.find("#_order_method_detail ._samsungPayEventMobile").css("display","none")):(r.find("#_order_method_detail ._samsungPayEvent").css("display","none"),r.find("#_order_method_detail ._samsungPayEventMobile").css("display",""))},realTimeAccountTransferTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),r.find("#_order_method_detail").html(t.realTimeAccountTransferPaymentTemplate())},paynowTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","PAYNOW"),r.find("#_order_method_detail").html(t.paynowPaymentTemplate())},kakaopayTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","KAKAOPAY"),r.find("#_order_method_detail").html(t.kakaopayPaymentTemplate())},kakaotalkpayTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","KAKAOTALKPAY"),r.find(".order_method").css("display"),r.find("#_order_method_detail").html(t.kakaotalkpayPaymentTemplate())},smilepayTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","SMILEPAY"),r.find(".order_method").css("display"),r.find("#_order_method_detail").html(t.smilepayPaymentTemplate())},settlebankTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","SETTLEBANK"),r.find("#_order_method_detail").html(t.settlebankPaymentTemplate())},samsungpayTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","SAMSUNGPAY"),r.find("#_order_method_detail").html(t.samsungpayPaymentTemplate())},paycoTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","PAYCO"),r.find("#_order_method_detail").html(t.paycoPaymentTemplate())},syruppayTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","SYRUPPAY"),r.find("#_order_method_detail").html(t.syruppayPaymentTemplate())},naverpayTabView:function(e){var t=this,r=t.$el,o=$(e.currentTarget);t.tabViewChecked(r,o),t.model.set("_payType","NAVERPAY"),r.find(".order_method").css("display"),r.find("#_order_method_detail").html(t.naverpayPaymentTemplate())},tabViewChecked:function(e,t){var r=this;e.find("input[type=checkbox]").prop("checked",!1),t.prop("checked",!0),_.defer($.proxy(r.tabChangeAfter,r),e,t)},tabChangeAfter:function(e,t){var r=this;t.hasClass("_NOBANKBOOK")?(r.$el.find("._order_method").addClass("virtual_account"),r.$el.find("#_order_method_detail").addClass("virtual_account")):(r.$el.find("._order_method").removeClass("virtual_account"),r.$el.find("#_order_method_detail").removeClass("virtual_account")),t.hasClass("_CARD")?(r.$el.find("#_order_method_detail").addClass("selected_card"),r.$el.find("#_select_card").addClass("my_card"),$("#_select_installment_edit").addClass("my_installment")):(r.$el.find("#_order_method_detail").removeClass("selected_card"),r.$el.find("#_select_card").removeClass("my_card"),$("#_select_installment_edit").removeClass("my_installment"))},appendDiscountEvent:function(e){var t=this,r=t.$el;if(e.hasClass("_CARD")){var n=t.model.get("paymentEtc");n.appType=o.get(o.APPLICATION_TYPE),e.hasClass("_PAYNOW")?n.isPaynow=!0:n.isPaynow=!1,t.chargeDiscountEventView=new d({model:n});var l,i=null;e.hasClass("_CARD")?i='<strong class="txt_blue">KB국민카드 2~5개월 무이자 특별행사 (~11/30)</strong><ul class="txt_lst"><li>최종 결제금액 5만원 이상인 경우 무이자 할부 결제 가능</li><li>BC/체크/법인/기프트/선불 카드 적용 불가</li></ul><strong class="txt_blue">신한카드 2~7개월 무이자 특별행사 (~11/30)</strong><ul class="txt_lst"><li>최종 결제금액 5만원 이상인 경우 무이자 할부 결제 가능</li><li>BC/체크/법인/기프트/선불 카드 적용 불가</li></ul><strong class="txt_blue">씨티카드 2~6개월 무이자 특별행사 (~11/30)</strong><ul class="txt_lst"><li>최종 결제금액 5만원 이상인 경우 무이자 할부 결제 가능</li><li>BC/체크/법인/기프트/선불 카드 적용 불가</li></ul><strong class="txt_blue">NH농협카드 2~6개월 무이자 특별행사 (~11/30)</strong><ul class="txt_lst"><li>최종 결제금액 5만원 이상인 경우 무이자 할부 결제 가능</li><li>BC/체크/법인/기프트/선불 카드 적용 불가</li></ul>':e.hasClass("_PAYCO")&&(i='<strong class="txt_blue">PAYCO 1만원 이상 3,500원 할인</strong><ul class="txt_lst"><li>생애 첫 결제시 할인 적용</li><li>순금, 상품권 등 일부 상품 제외</li><li>최종할인금액은 페이코 홈페이지에서 확인가능</li></ul>'),null!==i&&(l=t.chargeDiscountEventView.renderAdditionEvent(i).$el,r.find("#_card_event_area").append(l));if("OLIVEYOUNG"!==t.model.get("orderSheetType")){var a=t.chargeDiscountEventView.render();l=null===a?"":a.$el,r.find("#_card_event_area").append(l)}}},changeKbcardRadio:function(e){var t=this;t.$el;$("#_select_installment").change()},getBcPointType:function(){var e=this;e.$el},getData:function(){var r=this,n=r.$el,l=e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice,i=r.model.get("_payType"),d="block"===n.find(".order_method").css("display"),s="NOT_CHOOSING",c=r.model.get("_installmentMonth"),u=(r.model.get("_interestType"),a.get("simplePaymentMinimumAmount")),p=r.commaStringStr(u);if(d&&n.find("._CARD").is(":checked")&&!n.find("#_select_card_lst").val())return alert("카드를 선택해주세요."),!1;if(t.isCard(i)){if(l<1e3)return alert("신용카드 최저 결제금액은 1,000원 이상입니다."),!1;if(l<5e4&&0!=c)return alert("신용카드 할부는 50,000원 이상 사용이 가능합니다."),!1;if("KB_CARD"===i&&c>=48&&l<5e5)return alert("48개월, 60개월 무이자 할부는 신용카드 결제금액이 500,000원 이상인 경우에만 가능합니다."),!1;if(cjosLogUtil.log("_card_point_usable : "+n.find("#_card_point_usable input[type=checkbox]").is(":checked")),cjosLogUtil.log("payType : "+i),n.find("#_card_point_usable input[type=checkbox]").is(":checked")&&("BC_CARD"===i||"WOORI_CARD"===i))switch(o.get(o.APPLICATION_TYPE)){case"p":case"m":s="WOORI_CARD"===i?n.find("input[name=bcpoint]:checked").val():"BC_TOP_POINT"}}if(d&&n.find("._NOBANKBOOK").is(":checked")){if(!n.find("#_select_nobankbook").val())return alert("은행을 선택해주세요."),!1;if(!r.model.get("_depositor"))return alert("입금자명을 입력해주세요."),!1}if("REALTIME_ACCOUNT_TRANSFER"===i){if(l<1e3)return alert("실시간 계좌이체는 1,000원 이상 주문시 가능합니다."),!1;if(l>1e6)return alert("실시간 계좌이체 한도는 100만원 입니다. \n다른 결제수단을 선택해주세요."),!1}if("MOBILE"===i&&l<1e3)return alert("휴대폰결제 최저 결제금액은 1,000원 이상입니다."),!1;if("PAYNOW"===i&&l<1e3)return alert("페이나우 최저 결제금액은 1,000원 이상입니다."),!1;if("PAYCO"===i&&l<u)return alert("페이코는 "+p+"원 이상부터 결제 가능합니다."),!1;if("KAKAOPAY"===i){if(l<1e3)return alert("카카오페이 최저 결제금액은 1,000원 이상입니다."),!1;if(l>99999999)return alert("카카오페이 결제수단은 1억 미만 상품만 결제 가능합니다."),!1}return"KAKAOTALKPAY"===i&&l<u?(alert("카카오페이는 "+p+"원 이상부터 결제 가능합니다."),!1):"SYRUPPAY"===i&&l<1e3?(alert("11Pay 최저 결제금액은 1,000원 이상입니다."),!1):"NAVERPAY"===i&&l<100?(alert("네이버페이 최저 결제금액은 100원 이상입니다."),!1):"SMILEPAY"===i&&l<100?(alert("스마일페이 최저 결제금액은 100원 이상입니다."),!1):!i&&l>0?(alert("총 결제금액이 일치하지 않습니다."),!1):{paymentAmount:l,depositor:r.model.get("_depositor"),paymentDueDate:r.model.get("_paymentDueDate"),isCardPointUse:!0===n.find("#_card_point_usable input[type=checkbox]").prop("checked"),bcPointType:s,isNoInterest:"NO_INTEREST"===r.model.get("_interestType"),installmentMonth:r.model.get("_installmentMonth"),polarisDetailPayType:r.model.get("_polarisDetailPayType")}},cardEventNoticeShow:function(){this.$el.find("._card_event_notice").show()},cardEventNoticeHide:function(){this.$el.find("._card_event_notice").hide()},clickCjCardDetail:function(){"block"===$("._cj_card_detail_popup").css("display")?$("._cj_card_detail_popup").hide():$("._cj_card_detail_popup").show()},commaStringStr:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),define("page/cjmall/order/sheet/view/orderRegularPaymentAgreeView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/view/orderRegularPaymentTermView","common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","common/cjos/util/handlebarsHelper","page/cjmall/order/payment/helper/popupWindowCheckHelper"],function(e,t,r,o,n,l,i,a){return Backbone.View.extend({el:"#orderAgree",template:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderRegularPaymentAgree"),termApprovalView:null,termCollectionView:null,termServiceView:null,model:null,events:{"click #check_all_regular_payment_agreement":"clickAllRegularPaymentAgree","click ._regularPaymentAgreementCheckbox":"checkRegularPaymentAgree","click ._termShowBtn":"termShow"},initialize:function(){var t=this;t.render(),e.get("orderRegularPaymentModel").set("getRegularPaymentAgreeCallback",$.proxy(t.getData,t))},render:function(){var e=this;e.$el.html(e.template())},clickAllRegularPaymentAgree:function(e){var t=$(e.currentTarget),r=$("._regularPaymentAgreementCheckbox");$(t).is(":checked")?r.each(function(){$(this).prop("checked",!0)}):r.each(function(){$(this).prop("checked",!1)})},checkRegularPaymentAgree:function(e){var t=this,r=$(e.currentTarget),o=$("#check_all_regular_payment_agreement");0==$(r).is(":checked")?o.prop("checked",!1):t.isCheckedTermAll()&&o.prop("checked",!0)},isCheckedTermAll:function(){var e=$("._regularPaymentAgreementCheckbox"),t=!0;return e.each(function(){0==$(this).is(":checked")&&(t=!1)}),t},termShow:function(e){var t=this,n=$(e.currentTarget),l=$(n).data("doctype"),i=r.get("ecBaseSslUrl")+("p"==o.get(o.APPLICATION_TYPE)?"/p":"/m")+"/order/sheet/regularpayment/term/"+l;if("p"===o.get(o.APPLICATION_TYPE))t.createPopup(i,"popupRegularPaymentTerm");else{var a;switch(l){case"approval":a="정기결제 승인 동의";break;case"collection":a="개인정보 수집 및 이용동의";break;case"service":a="정기배송 서비스 이용 동의"}t.createLayerpopup(i,a)}},createPopup:function(e,t,r,o){var n=r!=undefined?r:800,l=o!=undefined?o:750;t=t!=undefined?t:"";var i=window._regularPaymentTermPopup,d=a.popupCheck(i);if(""!==d){var s=screen.availWidth/2-n/2,c=screen.availHeight/2-l/2-30;t=t!=undefined?t:"",i=window.open(e,t,"width="+n+", height="+l+", left="+s+", top="+c+", scrollbars=yes, resizable=no"),d=a.popupCheck(i)}if(""!=d)return alert(d),void(i!==undefined&&null!==i&&i.close());i!==undefined&&null!==i&&(i.resizeTo(n,l),i.location.href=e,i.focus())},createLayerpopup:function(e,t){require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(r){var o=new r({title:t,container:"body",iframeContent:e});n.set("regularPaymentTermLayerViewClose",function(){o.destroy(),$("#wrap").show(),n.remove("regularPaymentTermLayerViewClose")},!0),o.show()})},getData:function(){return 0==this.isCheckedTermAll()?(alert("정기배송 약관을 동의해 주세요."),!1):0==$("#order_agree").is(":checked")?(alert("정기배송 상품, 가격, 할인, 배송정보에 대한 동의여부를 확인해주세요."),!1):{isSaveOkcashBag:null,isSaveAsianaClub:null,isAgreeSavePersonalClearance:null}}})}),define("page/cjmall/order/sheet/view/orderRegularPaymentTermView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper"],function(e,t,r){return Backbone.View.extend({model:null,approvalTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderRegularPaymentTermApproval"),collectionTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderRegularPaymentTermCollection"),serviceTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderRegularPaymentTermService"),events:{},initialize:function(){var t=this;t.model=new Backbone.Model,t.model.set("docType",e.get("docType")),t.model.set("pageTitle",e.get("pageTitle")),t.render()},render:function(){var e=this,t=(e.$el,$(".regular_agree_cont"));switch(e.model.get("docType")){case"approval":t.html(e.approvalTemplate());break;case"collection":t.html(e.collectionTemplate());break;case"service":t.html(e.serviceTemplate())}}})}),
define("page/cjmall/order/sheet/view/orderRegularPaymentView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/helper/payTypeHelper","page/cjmall/order/sheet/helper/payTypeAttributeHelper","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil","common/cjos/util/dateUtil","page/cjmall/order/sheet/view/orderPaymentControlView"],function(e,t,r,o,n,l,i,a){return Backbone.View.extend({el:"#order_payment",constructorName:"OrderRegularPaymentView",isLatelyPayment:!1,template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderRegularPaymentInfo"),model:e.get("orderRegularPaymentModel"),orderBenefitModel:null,initialize:function(t){var r=this;r.model=e.get("orderRegularPaymentModel"),r.model.set("period",""),r.model.set("cycle",""),r.model.set("periodInfos",r.getPeriodInfos()),r.model.set("cycleInfos",r.getCycleInfos()),r.render(),r.validator=window._cjmallOrderValidator,e.get("orderRegularPaymentModel").set("getOrderRegularPaymentFormCallback",$.proxy(r.getData,r))},render:function(){var e=this,t=e.$el;t.html(e.template(e.model.toJSON()))},events:{"change #regular_payment_cycle":"regularPaymentCycleOnChange","change #regular_payment_period":"regularPaymentPeriodOnChange"},regularPaymentPeriodOnChange:function(e){e.preventDefault();var t=this,r=$(e.currentTarget),o=r.val();_.isEmpty(o)&&t.resetCycle()},regularPaymentCycleOnChange:function(e){e.preventDefault();var t=this,r=$(e.currentTarget),o=$("#regular_payment_period").val(),n=r.val();if(_.isEmpty(o))return alert("이용기간을 선택해주세요."),void r.val("");_.isEmpty(n)?t.resetCycle():(t.model.set("cycle",parseInt(n)),t.renderNextPayDay())},renderNextPayDay:function(){var e=this,t=$("<span>").addClass("next_payday").attr("id","nextPayDay"),r=$("#regular_payment_period").val(),o=$("#regular_payment_cycle").val(),n=e.getCycleMultiply(),l=(parseInt(r),parseInt(o)*n),i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate()+l),d=a.getFullYear()+"년 "+(a.getMonth()+1)+"월 "+a.getDate()+"일",s="<em>*</em> 다음 결제 예정일 : "+d;t.html(s),$("#nextPayDay").length>0?$("#nextPayDay").html(t):$(".select_condition_wrap",".set_regular_delivery").find("li:eq(1)").append(t)},resetCycle:function(){this.model.set("cycle",$("#regular_payment_cycle").val()),$("#regular_payment_cycle").val(""),$("#nextPayDay").remove()},getCycleMultiply:function(){var e,t=this,r=t.model.get("cycleType");switch(r){case"DAY":e=1;break;case"WEEK":e=7;break;case"MONTH":e=30}return e},validateRegularPaymentData:function(){var t=this,r=t.$el,o=e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice,n=t.model.get("_payType"),l=r.find(".set_regular_delivery"),i=l.find("#regular_payment_period"),a=l.find("#regular_payment_cycle");return t.validator.validate(i)?t.validator.validate(a)?!(!n&&o>0)||(alert("총 결제금액이 일치하지 않습니다."),!1):(alert("정기배송 자동결제 정보를 입력해주세요."),t.scrollTo(a),!1):(alert("정기배송 자동결제 정보를 입력해주세요."),t.scrollTo(i),!1)},getRegularPaymentData:function(){var t=this,r=(t.$el,e.get("orderPriceModel").get("totalOrderPriceTuple").totalSalePrice),o=(t.model.get("_payType"),t.model.get("_installmentMonth"),t.model.get("_interestType"),parseInt($("#regular_payment_period").val())),n=parseInt($("#regular_payment_cycle").val()),l=new Backbone.Model;return l.set("period",o),l.set("cycle",n),l.set("cycleType",t.model.get("cycleType")),{paymentAmount:r,depositor:e.get("orderPaymentModel").get("nobankbookPaymentTuple").depositor,paymentDueDate:e.get("orderPaymentModel").get("nobankbookPaymentTuple").receiptHopeDates[2],isCardPointUse:!1,bcPointType:"NOT_CHOOSING",isNoInterest:!1,installmentMonth:0,polarisDetailPayType:"ANSIM_CLICK",orderRegularPaymentForm:l}},getPeriodInfos:function(){var e=this,t=e.model.get("periodes"),r=[];return $.each(t,function(e,t){if(0!=e){var o={key:t,name:t+"개월"};r.push(o)}}),r},getCycleInfos:function(){var e=this,t=e.getCycleMultiply(),r=e.model.get("cycles"),o=[];return $.each(r,function(e,r){if(0!=e){var n={key:r,name:r+"개월",cycleMultiplyDay:r*t+"일"};o.push(n)}}),o},getData:function(){var e=this;$("#regular_payment_period").val();return 0!=e.validateRegularPaymentData()&&e.getRegularPaymentData()}})}),define("page/cjmall/order/sheet/view/orderSheetAddressView",["common/cjos/inflowInfo/inflowInfo","common/cjos/util/configUtil","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/view/deliveryAddressView","page/cjmall/order/sheet/models/cvsModel","page/cjmall/order/sheet/models/womanSafeModel","page/cjmall/order/sheet/models/deliveryAddressItemModel","page/cjmall/order/sheet/collections/orderDeliveryAddressCollection","page/cjmall/order/sheet/models/orderMultipleDeliveryAddressModel","page/cjmall/order/sheet/helper/deliveryAbleHelper","common/cjos/util/handlebarsHelper","page/cjmall/order/sheet/helper/orderSheetHelper"],function(e,t,r,o,n,l,i,a,d,s,c,u,p,m){return Backbone.View.extend({el:"#order_ct",template:p.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/ordererInfo"),legendTemplate:p.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/ordererInfoLegend"),convenienceAddressTemplate:p.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/convenienceInput"),referralAddressTemplate:p.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/womanSafeDeliv"),isSafeDeliveryChecked:!1,isWomanSafeOrCvsChecked:null,cvsAddressModel:null,cvsModel:null,womanAddressModel:null,womanSafeModel:null,isAbleMultiple:!1,isAbleConvenience:!1,multipleCount:1,multipleSyncModelSet:{},topPriceDeliveryGroup:null,deliveryCoupon:null,orderDeliveryAddressCollection:{},deliveryAbleCheck:!1,deliveryAbleCheckMessage:null,events:{"change ._convenience_checkbox #ckbx2":"safeDeliveryOnCheckHn","click #_convinience_find":"convinienceFindOnClickHn","click #_womanSafeDeliv_find":"womanSafeDelivFindOnClickHn","change ._multipledelivery":"multipledeliveryOnChangeHn","blur ._reciever":"disableSpecialCharOnBlurHn","blur ._cellno":"telnumOnBlurHn","blur ._telno":"telnumOnBlurHn","focusin .order_dely ._delimsg":"delimsgOnFocusInHn","blur .order_dely ._delimsg":"delimsgOnBlurHn","change ._delimsgselect":"deliMsgSelectOnChangeHn","click ._delimsgselect":"deliMsgSelectOnClickHn","click ._safeDeliveryCancel":"safeDeliveryCancelHn","click ._safeDeliverySubmit":"safeDeliverySubmitHn","keydown #_choose_dely":"safeDeliveryTrapKeyDown","click ._odin_reciever":"manuallyClickCodeHn","click ._odin_tf_place":"manuallyClickCodeHn","click ._odin_tf_addr2":"manuallyClickCodeHn","click ._odin_cellno":"manuallyClickCodeHn","click ._odin_telno":"manuallyClickCodeHn","click ._odin_delimsg":"manuallyClickCodeHn"},initialize:function(){var e=this,t=e.$el;e.isAbleConvenience=n.get("orderPriceModel").get("totalOrderItemTypeTuple").convenienceStoreDelivery,e.isAbleMultiple=e.getIsAbleMultiple(),e.model=new Backbone.Model({orderSheetType:n.get("orderSheetType"),isAbleMultiple:e.isAbleMultiple,ableMultipleCount:e.getAbleMultipleCount(),isAbleConvenience:e.isAbleConvenience}),e.deliveryAddressViews=[],e.orderDeliveryAddressCollection=new s,e.setListener(),n.get("orderAddressModel").set("getAddressDataCallback",$.proxy(e.getOrderAddressData,e)),t.html(e.template(e.model.toJSON())),e.render(),window._cjmallOrderObserver.setListeningCallback(e,"requestMultipleDeliveryInfomation",e.throwMultipleDeliveryInfomation),window._cjmallOrderObserver.setListeningCallback(e,"requestMultipleDeliveryFee",e.throwMultipleTotalDeliveryFee),window._cjmallOrderObserver.setListeningCallback(e,"throwDeliveryCoupon",e.setDeliveryCoupon)},render:function(){var e=this,t=e.$el,r=t.find("form > fieldset");if(e.isSafeDeliveryChecked)return"cvsGs"==e.isWomanSafeOrCvsChecked||"cvsCu"==e.isWomanSafeOrCvsChecked?(n.get("orderAddressModel").set("getAddressCvsDataCallback",$.proxy(e.getOrderAddressCvsData,e)),r.html(e.convenienceAddressTemplate())):"safe"==e.isWomanSafeOrCvsChecked&&(n.get("orderAddressModel").set("getAddressSafeDelivDataCallback",$.proxy(e.getOrderAddressWomanSafeData,e)),r.html(e.referralAddressTemplate())),e.resetDeliveryAddressViews(),e.orderDeliveryAddressCollection.reset(),n.get("orderAddressModel").set("selectedAddressModel",null),t.find(".dely_prod").removeClass("plural_order"),window._cjmallOrderObserver.eventTrigger("changeAddress",e),this;if(n.get("orderAddressModel").set("getAddressCvsDataCallback",null),n.get("orderAddressModel").set("getAddressSafeDelivDataCallback",null),t.find(".dely_prod").addClass("plural_order"),e.resetDeliveryAddressViews(),e.orderDeliveryAddressCollection.reset(),e.multipleCount>1){for(e.convenienceCheckHide(),n.get("orderAddressModel").set("isMultiple",!0),r.empty(),r.html(e.legendTemplate({isMultiple:!0})),e.multipleSyncModelSet={orderPriceModel:n.createOrderPriceModel(),orderPriceCloneModels:[]},index=0;index<e.multipleCount;index++){var o=n.createOrderPriceModel(),i=n.createOrderAddressModel(),a=new c(i.toJSON());a.set({orderPriceModel:o,multipleIndex:index+1});var d=new l({model:a});r.append(d.$el),e.orderDeliveryAddressCollection.add(a),e.deliveryAddressViews.push(d),index===e.multipleCount-1&&(window._cjmallOrderObserver.eventTrigger("isMultipleAddress",!0),e.throwMultipleTotalDeliveryFee(),e.checkAddDeliveryCost())}e.listenTo(e.orderDeliveryAddressCollection,"deliveryPriceUpdate",e.throwMultipleTotalDeliveryFee),e.listenTo(e.orderDeliveryAddressCollection,"setdefault",e.setDefault)}else{e.convenienceCheckShow(),r.html(e.legendTemplate({isMultiple:!1})),n.get("orderAddressModel").set("isMultiple",!1);var s=n.get("orderAddressModel");s.set({orderPriceModel:n.createOrderPriceModel()});var d=new l({model:s});r.append(d.$el),e.deliveryAddressViews.push(d),window._cjmallOrderObserver.eventTrigger("isMultipleAddress",!1)}return this},setListener:function(){var e=this;e.orderDeliveryAddressCollection.on("add",function(t,r){e.listenTo(t,"quantityChange",e.quantityChangeHn)}),e.orderDeliveryAddressCollection.on("reset",function(t,r){t.forEach(function(t){e.stopListening(t)})})},throwMultipleDeliveryInfomation:function(){var e=this,t={multipleTotalDeliveryFee:e.getMultipleTotalDeliveryFee(),multipleAddCost:e.getDeliveryAddCost(),deliveryAddressViews:e.deliveryAddressViews};window._cjmallOrderObserver.eventTrigger("reponseMultipleDeliveryInfomation",t)},throwMultipleTotalDeliveryFee:function(){var e=this;_.forEach(e.deliveryAddressViews,function(e){e.updateDeliveryPrice()}),window._cjmallOrderObserver.eventTrigger("multipleDeliveryPriceUpdate",e.getMultipleTotalDeliveryFee())},setDefault:function(e){var t=this;_.forEach(t.deliveryAddressViews,function(t){t.multiplIndex!==e&&t.uncheckDefaultAddress()})},setDeliveryCoupon:function(e){var t=this;t.deliveryCoupon=e;var r=t.topPriceDeliveryGroup,e=t.deliveryCoupon;!0==!!e?(r&&r.removeDeliveryCoupon(),r=t.getTopPriceDeliveryGroup(),1==!!r&&(r.setDeliveryCoupon(e),t.topPriceDeliveryGroup=r),t.throwMultipleTotalDeliveryFee()):(r&&r.removeDeliveryCoupon(),t.topPriceDeliveryGroup=null,t.throwMultipleTotalDeliveryFee())},getTopPriceDeliveryGroup:function(){var e=this,t=0,r=null,o=[];return _.forEach(e.deliveryAddressViews,function(e){o=_.union(o,e.getHasDeliveryFeeGroup())}),_.forEach(o,function(e){var o=e.model.get("deliveryFee");o>t&&(t=o,r=e)}),r},resetDeliveryAddressViews:function(){var e=this;_.forEach(e.deliveryAddressViews,function(e){window._cjmallOrderObserver.removeListeningCallback(e)}),_.forEach(e.deliveryAddressViews,function(e){e.remove()}),e.deliveryAddressViews=[]},checkAddDeliveryCost:function(){this.getDeliveryAddCost()>0&&alert("복수 배송지 지정시 배송비, 빠른배송비, 도서산간배송비가 발생하는 경우 배송지별로 부과 됩니다.")},getDeliveryAddCost:function(){var e=this,t=0;return _.forEach(e.deliveryAddressViews,function(e){t+=e.getAddCostGroupView()}),t},getMultipleTotalDeliveryFee:function(){var e=this,t=0;return _.forEach(e.deliveryAddressViews,function(e){t+=e.getTotalDeliveryPrice()}),t},getMaxQuantity:function(e){var t=this,r=t.multipleSyncModelSet.orderPriceModel,o=0;return $.each(r.get("orderPriceManagers"),function(t){this.unitCode==e&&(o=this.quantity)}),o},getOtherSelectedQuantity:function(e){var t=this,r=e.multipleIndex,o=e.unitCode,n=0;return $.each(t.deliveryAddressViews,function(){r!==this.multiplIndex&&_.forEach(this.deliveryAddressGroupViews,function(e){e.model.get("orderItemPriceCollection").each(function(e){e.get("unitCode")===o.toString()&&(n+=Number(e.get("selectQuantity")))})})}),n},getIsAbleMultiple:function(){var e=!1,t=m.getOrderPriceManagers();return e=t.length>1||t[0].quantity>1,m.isNoDeliveryItemIncluded()&&(e=!1),m.isPackageItemIncluded()&&(e=!1),m.isLinkGiftItemIncluded()&&(e=!1),m.isLumpSumDiscountItemIncluded()&&(e=!1),m.isMemberShipPointDiscountItemIncluded()&&(e=!1),m.isHyundaiStoreItemIncluded()&&(e=!1),m.isOliveyoungItemIncluded()&&(e=!1),m.isHanssemDeliveryItemIncluded()&&(e=!1),m.isCookitItemIncluded()&&(e=!1),m.isDawnItemIncluded()&&(e=!1),m.isNotAllSaleEmployeeOrVIP()&&(e=!1),e},getAbleMultipleCount:function(){var e=0,t=0,r=m.getOrderPriceManagers();return 1==r.length&&(t=r[0].quantity>2?3:2),r.length>1&&(_.forEach(r,function(t){e+=t.quantity}),t=2==e?2:3),t},quantityChangeHn:function(e){var t=this,r=(e.$select,e.multipleIndex,e.unitCode),o=Number(e.quantity),n=t.getMaxQuantity(r);t.getOtherSelectedQuantity(e)+o>n?(e.fail(),e.model.trigger("deliveryPriceUpdate"),alert("선택하신 상품의 총 주문수량은 "+n+"개 입니다.\n다시 설정해주세요")):(e.success(),t.setDeliveryCoupon(t.deliveryCoupon),e.model.trigger("deliveryPriceUpdate"))},convenienceCheckHide:function(){this.$el.find("._convenience_checkbox").hide()},convenienceCheckShow:function(){this.$el.find("._convenience_checkbox").show()},safeDeliveryOnCheckHn:function(e){e.preventDefault();var t,r=this,l=$(e.currentTarget).prop("checked");r.cvsModel=null,r.womanSafeModel=null,l?(r.hideAria(),r.$el.find("#_safeDelivery").css("display","block"),setTimeout(function(){r.$el.find("#dialog_label").focus()},500),r.isSafeDeliveryChecked=!0,n.get("orderAddressModel").set("isConvenience",!0),$("#multiple_select").hide(),r.$el.find("select._multipledelivery").prop("selectedIndex",0),r.multipleCount=1,t="ODIN____delivery__etcdelion__",e&&e.originalEvent&&o.splunkClickLog(t)):(r.showAria(),r.$el.find("#_safeDelivery").css("display","none"),r.isSafeDeliveryChecked=!1,n.get("orderAddressModel").set("isConvenience",!1),$("#multiple_select").show(),t="ODIN____delivery__etcdelioff__",e&&e.originalEvent&&o.splunkClickLog(t),r.render())},hideAria:function(){$("#header").attr("aria-hidden","true"),$("#off_canvas").attr("aria-hidden","true"),$(".sub_title").attr("aria-hidden","true"),$("#order_noitce").attr("aria-hidden","true"),$("._loadmask_order").attr("aria-hidden","true"),$("._notice_full").attr("aria-hidden","true"),$('form[name="_orderinfo_member"]').attr("aria-hidden","true"),$('form[name="_orderinfo_nonmember"]').attr("aria-hidden","true"),$("#order_item_price").attr("aria-hidden","true"),$("#order_item_list").attr("aria-hidden","true"),$("#order_benefit").attr("aria-hidden","true"),$("#order_payment").attr("aria-hidden","true"),$("#footer").attr("aria-hidden","true"),$(".toast_message").attr("aria-hidden","true")},showAria:function(){$("#header").removeAttr("aria-hidden"),$("#off_canvas").removeAttr("aria-hidden"),$(".sub_title").attr("aria-hidden","true"),$("#order_noitce").removeAttr("aria-hidden"),$("._loadmask_order").removeAttr("aria-hidden"),$("._notice_full").removeAttr("aria-hidden"),$('form[name="_orderinfo_member"]').removeAttr("aria-hidden"),$('form[name="_orderinfo_nonmember"]').removeAttr("aria-hidden"),$("#order_item_price").removeAttr("aria-hidden"),$("#order_item_list").removeAttr("aria-hidden"),$("#order_benefit").removeAttr("aria-hidden"),$("#order_payment").removeAttr("aria-hidden"),$("#footer").removeAttr("aria-hidden"),$(".toast_message").removeAttr("aria-hidden")},safeDeliveryTrapKeyDown:function(e){var t=this;27===e.keyCode&&(e.preventDefault(),t.safeDeliveryCancelHn(e)),9===e.keyCode&&$(e.target).hasClass("_safeDeliverySubmit")&&$("#dialog_label").focus()},manuallyClickCodeHn:function(e){o.splunkClickLog($(e.target).attr("data-click"))},safeDeliveryCancelHn:function(e){e.preventDefault(),e.stopPropagation();var t=this;t.showAria(),t.$el.find("#_safeDelivery").css("display","none"),t.$el.find("#ckbx2").prop("checked",!1),t.$el.find("#_safeDelivery").css("display","none"),t.isSafeDeliveryChecked=!1,n.get("orderAddressModel").set("isConvenience",!1),$("#multiple_select").show(),setTimeout(function(){$("#ckbx2").focus()},500),t.render()},safeDeliverySubmitHn:function(e){e.preventDefault();var t=this;t.showAria(),"cvsGs"==t.$el.find('input:radio[name="safe_dely"]:checked').val()?t.isWomanSafeOrCvsChecked="cvsGs":"safe"==t.$el.find('input:radio[name="safe_dely"]:checked').val()?t.isWomanSafeOrCvsChecked="safe":"cvsCu"==t.$el.find('input:radio[name="safe_dely"]:checked').val()&&(t.isWomanSafeOrCvsChecked="cvsCu"),t.$el.find("#_safeDelivery").css("display","none"),setTimeout(function(){$("#ckbx2").focus()},500),t.render()},convinienceFindOnClickHn:function(){var o=this,l=o.$el,a=t.get("ecBaseSslUrl")+"/"+e.get(e.APPLICATION_TYPE)+"/order/delivery/convenience/popUp?cvsDiv="+o.isWomanSafeOrCvsChecked,d="menubar=no, scrollbars=no, resizable=no, fullscreen=yes",s=function(e){var t=e.codeName,r=e.address+" "+e.addressDetail+" / "+e.codeTel;l.find("._cvsName").val(t),l.find("._cvsInfo").text(r),l.find("._cvsInfoBox").show(),o.cvsModel=new i(e),n.get("orderAddressModel").set("selectedAddressModel",o.cvsModel),window._cjmallOrderObserver.eventTrigger("changeAddress",o),o.checkDeliveryAbleBySafe(o.cvsModel)};switch(r.set("cvsReturn",s,!0),e.get(e.APPLICATION_TYPE)){case"p":;d="width=1025, height=650, left="+(screen.availWidth/2-512.5)+", top="+(screen.availHeight/2-325-30)+", menubar=no, scrollbars=no, resizable=no",window.open(a,"편의점 팝업",d);break;case"m":require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(e){var t=new e({title:"편의점 찾기",container:"body",iframeContent:a,iframeAttributes:{allow:"geolocation *;",title:"편의점찾기"}});r.set("cvsLayerViewClose",function(){t.destroy(),$("#wrap").show(),r.remove("cvsLayerViewClose")},!0),t.show()})}},setCvsAddressModel:function(){var e=this,t=e.cvsModel.toJSON(),r=e.$el.find(".order_dely"),o=r.find(".tf_place"),n=t.zipCode,l=t.address,i=t.addressDetail+" "+t.codeName,a=r.find("._cellno1"),s=r.find("._cellno"),c=r.find("._telno1"),u=r.find("._telno"),p=r.find("textarea._delimsg"),m=t.addressType,f=t.areaCls;return e.cvsAddressModel=new d({delivPlcAlias:"",nm:o.val(),cellno1:a.val(),cellno2:e.subStringNo(s.val(),"first"),cellno3:e.subStringNo(s.val(),"second"),ddd:c.val(),telno1:e.subStringNo(u.val(),"first"),telno2:e.subStringNo(u.val(),"second"),addressType:m,areaCls:f,zipno:n,zipno_seq:t.zipNoSeq,post_name:l,addr:i,message:p.val(),customerHopeDate:null,customerApptDate:null,roadAddr1:l,roadAddr:i,roadZipno:t.newZipCode,roadZipnoSeq:t.newZipNoSeq,roadAddrSeq:t.roadAddrSeq,roadAddrId:t.buildingManageNo,deliveryIndex:0}),e.cvsAddressModel.toJSON()},womanSafeDelivFindOnClickHn:function(l){var i=this;l&&l.originalEvent&&o.splunkClickLog("ODIN____delivery__ansimdel__");var d=i.$el,s=t.get("ecBaseSslUrl")+"/"+e.get(e.APPLICATION_TYPE)+"/order/delivery/popUp",c="menubar=no, scrollbars=no, resizable=no, fullscreen=yes",u=function(e){document.getElementById("_delivAddr").style.display="block";var t=e.address+" "+e.addressDetail;d.find("._safeDeliveryName").val(e.safeBoxNm),d.find("._womanSafeInfo").text(t),i.womanSafeModel=new a(e),n.get("orderAddressModel").set("selectedAddressModel",i.womanSafeModel),window._cjmallOrderObserver.eventTrigger("changeAddress",i),i.checkDeliveryAbleBySafe(i.womanSafeModel)};switch(r.set("womanSafeReturn",u,!0),e.get(e.APPLICATION_TYPE)){case"p":;c="width=570, height=650, left="+(screen.availWidth/2-285)+", top="+(screen.availHeight/2-325-30)+", menubar=no, scrollbars=no, resizable=no",window.open(s,"안심택배함 팝업",c);break;case"m":require(["common/cjmall/ui/m/fullLayer/views/fullLayerView"],function(e){var t=new e({title:"안심택배함찾기",container:"body",iframeContent:s,clickCodes:{closeBtn:"ODIN____delivery__ansimclose__"}});r.set("womanSafeLayerViewClose",function(){t.destroy(),$("#wrap").show(),r.remove("womanSafeLayerViewClose")},!0),t.show()})}},setSafeDeliveryAddressModel:function(){var e=this,t=e.womanSafeModel.toJSON(),r=e.$el.find(".order_dely"),o=r.find(".tf_place"),n=(t.zipNo,t.address),l=t.addressDetail,i=r.find("._cellno1"),a=r.find("._cellno"),s=r.find("._telno1"),c=r.find("._telno"),u=r.find("textarea._delimsg"),p=t.addressType,m=t.areaCls;return e.womanAddressModel=new d({delivPlcAlias:"",nm:o.val(),cellno1:i.val(),cellno2:e.subStringNo(a.val(),"first"),cellno3:e.subStringNo(a.val(),"second"),ddd:s.val(),telno1:e.subStringNo(c.val(),"first"),telno2:e.subStringNo(c.val(),"second"),addressType:p,areaCls:m,zipno:t.zipNo,zipno_seq:t.zipNoSeq,roadAddr1:n,roadAddr:l,roadZipno:t.newZipCode,roadZipnoSeq:t.newZipNoSeq,post_name:n,addr:l,message:u.val(),customerHopeDate:null,customerApptDate:null,roadAddrId:t.buildingManageNo,deliveryIndex:0}),e.womanAddressModel.toJSON()},multipledeliveryOnChangeHn:function(e){var t=this;t.multipleCount=Number($(e.currentTarget).val()),t.render()},disableSpecialCharOnBlurHn:function(e){var t=this,r=(t.$el,window._cjmallOrderValidator),o=$(e.currentTarget),n=o.val();if(n.length>0&&!1===r.isHangulEngText(n))return alert("특수문자입력은 불가합니다"),o.val(""),o.focus(),!1},telnumOnBlurHn:function(e){var t=window._cjmallOrderValidator,r=$(e.currentTarget),o=r.val();if(!1===t.isNumber(o))return alert("전화번호는 숫자만 입력해주세요"),r.val(""),r.focus(),!1},delimsgOnFocusInHn:function(e){$(e.currentTarget).siblings(".lab_cont").hide()},delimsgOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lab_cont");0==$.trim(t.val()).length&&r.show()},deliMsgSelectOnClickHn:function(e){e&&e.originalEvent&&o.splunkClickLog("ODIN____delivery__delreq__")},deliMsgSelectOnChangeHn:function(e){var t=$(e.currentTarget),r=t.siblings().find(".lab_cont"),o=t.siblings().find("._delimsg"),n=t.prop("selectedIndex"),l=t.val();0===n&&(l=""),l?r.hide():r.show(),o.val(l)},byteCheckOnkeyDownHn:function(e){var t=$(e.currentTarget),r=t.val(),o=t.data().maxlength;(function(e){for(var t=0,r=0;r<e.length;r++)t+=e.charCodeAt(r)>>11?2:1;return t})(r)==o&&8!==e.keyCode&&e.preventDefault()},getReceiverInfos:function(){var e=$(".receiver_info"),t=[],r=["FIRST","SECOND","THIRD"];return $.each(e,function(e,o){var n=$(o),l={receiverAddressType:"MULTIPLE",receiverAddressSeq:r[e],receiverNm:n.attr("data-receiver-nm")};t.push(l)}),t},getOrderAddressCvsData:function(){var e=this;return 0==e.isSafeDeliveryChecked||e.cvsModel.toJSON()},getOrderAddressWomanSafeData:function(){var e=this;return 0==e.isSafeDeliveryChecked||e.womanSafeModel.toJSON()},getOrderAddressData:function(){var e=this,t=[],r=!0;if(e.isSafeDeliveryChecked){if("cvsCu"==e.isWomanSafeOrCvsChecked||"cvsGs"==e.isWomanSafeOrCvsChecked){if(!e.validateCvsInfo())return!1;if(0==e.checkDeliveryAbleBySafe(e.cvsModel))return!1;var o=e.setCvsAddressModel();t.push(o)}else if("safe"==e.isWomanSafeOrCvsChecked){if(!e.validateSafeDeliveryInfo())return!1;if(0==e.checkDeliveryAbleBySafe(e.womanSafeModel))return!1;var n=e.setSafeDeliveryAddressModel();t.push(n)}return t}if(e.multipleCount>1){if(_.forEach(e.deliveryAddressViews,function(e){var o=e.getAddressData();!1===o&&(r=!1),t.push(o)}),!1===r)return;if(!1===e.isMultipleDuplicateAddress(t))return alert("동일한 주소정보가 있습니다. 수정해주세요."),!1;if(!1===e.multipleValidateQuantity(t))return!1}else _.forEach(e.deliveryAddressViews,function(e){var o=e.getAddressData();!1===o&&(r=!1),t.push(o)});return!1!==r&&t},isMultipleDuplicateAddress:function(e){var t=!0,r={};return _.forEach(e,function(e){if(!1!=!!e.deliveryAddressData.deliv_plc_seq){var o=e.deliveryAddressData.deliv_plc_seq;!0==!!r[o]?t=!1:r[o]=!0}}),t},multipleValidateQuantity:function(e){var t=!0,r=n.get("orderPriceModel").get("orderPriceManagers"),o={};_.forEach(r,function(e){o[e.unitCode]={},o[e.unitCode].quantity=e.quantity,o[e.unitCode].orderPriceManager=e}),_.forEach(e,function(e){_.forEach(e.deliveryGroupOrderItems,function(e){var t=o[e.unitCode].quantity;o[e.unitCode].quantity=t-Number(e.quantity)})});for(unitCode in o)if(0!==o[unitCode].quantity&&!0===t){t=!1;var l=o[unitCode].orderPriceManager.quantity,i=o[unitCode].orderPriceManager.displayItemName;alert(i+" 상품의 총 주문수량은 "+l+"개 입니다.\n다시 설정해주세요.")}return t},validateDeliveryInfo:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=t.find(".order_dely"),n=o.find(".tf_place"),l=o.find("._cellno1"),i=o.find("._cellno"),a=o.find("._telno1"),d=o.find("._telno"),s=o.find("textarea._delimsg");if(!r.validate(n))return alert("받는분 이름을 입력해 주세요."),e.scrollTo(n),!1;if(!0===r.isOverMaxlength(n))return alert("받는분 이름은 "+n.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(n),!1;if(n.length>0&&!1===r.isHangulEngText(n.val()))return alert("특수문자입력은 불가합니다"),e.scrollTo(n),!1;var c=!(!r.validate(l)||!r.validate(i)),u=!(!r.validate(a)||!r.validate(d));if(!c&&!u)return!c&&!1==!!r.validate(l)&&r.validate(i)?(alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(l),!1):!c&&!1==!!r.validate(i)&&r.validate(l)?(alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(i),!1):(alert("한개 이상의 전화번호를 입력하셔야 합니다"),e.scrollTo(l),!1);if(u){if(!1===r.isNumber(d.val()))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(d),!1;if(d.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(d),!1;if(!0===r.isOverMaxlength(d))return alert("전화 번호는 "+d.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(d),!1}if(c){if(!1===r.isNumber(i.val()))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(i),!1;if(i.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(i),!1;if(!0===r.isOverMaxlength(i))return alert("전화 번호는 "+i.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(i),!1}if(!c&&(r.validate(l)||r.validate(i)))return alert("전화 번호를 정확하게 입력해 주세요"),!1;if(!u){if(!1===r.validate(a)&&r.validate(d))return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(a),!1;if(!1===r.validate(d)&&r.validate(a))return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(d),!1}return!0!==r.isOverMaxlength(s)||(alert("배송메세지는 "+s.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(s),!1)},validateCvsInfo:function(){var e=this,t=e.$el,r=t.find(".order_dely"),o=r.find("._cvsName");return!(!e.validateDeliveryInfo()||(e.cvsModel?!e.deliveryAbleCheck&&(alert(e.deliveryAbleCheckMessage),1):(alert("편의점을 조회해주세요."),e.scrollTo(o),1)))},validateSafeDeliveryInfo:function(){var e=this,t=e.$el,r=t.find(".order_dely"),o=r.find("._safeDeliveryName");return!(!e.validateDeliveryInfo()||(e.womanSafeModel?!e.deliveryAbleCheck&&(alert(e.deliveryAbleCheckMessage),1):(alert("여성안심택배를 조회해주세요."),e.scrollTo(o),1)))},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}},checkDeliveryAbleBySafe:function(e,t){var r=this;if(null==e&&("cvsCu"==r.isWomanSafeOrCvsChecked||"cvsGs"==r.isWomanSafeOrCvsChecked))return alert("편의점을 조회해주세요."),!1;if(null==e&&"safe"==r.isWomanSafeOrCvsChecked)return alert("여성안심택배를 조회해주세요."),!1;var o=e.toJSON(),l=n.get("orderPriceModel").get("orderPriceManagers");new u(o.zipCode,o.zipNoSeq,l).checkDeliveryAble(function(e){r.deliveryAbleData=e,e.result.deliveryAble?(window._cjmallOrderObserver.eventTrigger("checkDeliveryAble",!0),r.deliveryAbleCheck=!0):(alert(e.result.resultMessage),r.deliveryAbleCheckMessage=e.result.resultMessage,window._cjmallOrderObserver.eventTrigger("checkDeliveryAble",!1),r.deliveryAbleCheck=!1)})},setCss:function(){}})}),define("page/cjmall/order/sheet/view/orderSheetEcouponRecipientView",["common/cjos/inflowInfo/inflowInfo","common/cjos/util/configUtil","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n,l){return Backbone.View.extend({el:"#order_ct",template:l.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderSheetEcouponRecipient"),events:{"keypress ._ecouponReceiver":"disableSpecialCharOnkeyPressHnReceiver","keypress ._cellno":"telnumOnKeyPressHn","focusin .order_gift ._ecouponReceiver":"ecouponReceiverOnFocusInHn","blur .order_gift ._ecouponReceiver":"ecouponReceiverOnBlurHn"},initialize:function(){var e=this;e.$el;n.get("orderEcouponDeliveryModel").set("getEcouponDeliveryDataCallback",$.proxy(e.getEcouponDeliveryDataCallback,e)),e.render(),e.validator=window._cjmallOrderValidator},render:function(){var e=this,t=e.$el;t.html(e.template()),t.find(".order_gift").find("._cellno1>option").eq(1).prop("selected",!0)},setListener:function(){},disableSpecialCharOnkeyPressHnReceiver:function(e){var t=this,r=e.keyCode;t.validator.isSpecialCharKeyCode(r)&&(e.preventDefault(),alert("특수문자입력은 불가합니다."))},telnumOnKeyPressHn:function(e){e.keyCode>47&&e.keyCode<58||e.preventDefault()},ecouponReceiverOnFocusInHn:function(e){$(e.currentTarget).siblings(".lbl").hide()},ecouponReceiverOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lbl");0==$.trim(t.val()).length&&r.show()},ecouponmsgOnFocusInHn:function(e){$(e.currentTarget).siblings(".lab_cont").hide()},ecouponmsgOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lab_cont");0==$.trim(t.val()).length&&r.show()},getEcouponDeliveryDataCallback:function(){var e=this;return!!e.validateEcouponDeliveryInfo()&&e.setEcouponDeliveryData()},validateEcouponDeliveryInfo:function(){var e=this,t=e.$el,r=t.find(".order_gift"),o=r.find("#ecouponReceiver"),n=r.find("._cellno1"),l=r.find("._cellno");return e.validator.validate(o)?!0===e.validator.isOverMaxlength(o)?(alert("받는분 이름은 "+o.data().maxlength+"자까지 입력가능합니다."),o.focus(),!1):o.length>0&&!1===e.validator.isHangulEngText(o.val())?(alert("특수문자입력은 불가합니다"),e.scrollTo(o),!1):e.validator.validate(n)?e.validator.validate(l)?e.validator.isNumber(l.val())?!0===e.validator.isMinerMinlength(l)?(alert("휴대폰 번호는 "+l.data().minlength+"자 이상 입력하셔야 합니다."),l.focus(),!1):!0!==e.validator.isOverMaxlength(l)||(alert("휴대폰 번호는 "+l.data().maxlength+"자까지 입력가능합니다."),l.focus(),!1):(alert("숫자만 입력해주세요."),l.focus(),!1):(alert("연락처를 정확하게 입력해 주세요."),l.focus(),!1):(alert("연락처를 정확하게 입력해 주세요."),n.focus(),!1):(alert("받는분 이름을 입력해 주세요."),o.focus(),!1)},setEcouponDeliveryData:function(){var e=this,t=e.$el,r=t.find(".order_gift"),o=r.find("#ecouponReceiver"),n=r.find("._cellno1"),l=r.find("._cellno"),i=new Backbone.Model;return i.set("nm",o.val()),i.set("cellno1",n.val()),i.set("cellno2",e.subStringNo(l.val(),"first")),i.set("cellno3",e.subStringNo(l.val(),"second")),i},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}}})}),
define("page/cjmall/order/sheet/view/orderSheetMainView",["common/cjos/util/configUtil","common/cjos/util/appInterfaceUtil","common/cjos/inflowInfo/inflowInfo","common/cjmall/util/cjmallUtil","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/models/orderCertainFormModel","page/cjmall/order/sheet/view/orderNoticeView","page/cjmall/order/sheet/view/orderSheetAddressView","page/cjmall/order/sheet/view/orderSheetNonCustomerAddressView","page/cjmall/order/sheet/view/orderSheetPresentDeliveryView","page/cjmall/order/sheet/view/orderSheetEcouponRecipientView","page/cjmall/order/sheet/view/orderBenefitView","page/cjmall/order/sheet/view/orderPaymentView","page/cjmall/order/sheet/view/orderRegularPaymentView","page/cjmall/order/sheet/view/orderCashReceiptView","page/cjmall/order/sheet/view/orderItemListView","page/cjmall/order/sheet/view/orderTourItemInfoView","page/cjmall/order/sheet/util/observer","page/cjmall/order/sheet/util/validator","page/cjmall/order/payment/helper/paymentHelper","page/cjmall/order/sheet/view/travelerInfoView","page/cjmall/order/sheet/view/orderAgreeView","page/cjmall/order/sheet/view/orderRegularPaymentAgreeView","page/cjmall/order/sheet/helper/payTypeHelper","common/cjos/logger/utils/loggerUtil","common/cjos/logger/models/fdsConstantsModel","common/cjos/util/globalVariables","common/cjos/util/handlebarsHelper","page/cjmall/order/sheet/view/orderCjCardPaymethodView","page/cjmall/order/sheet/helper/hanssemDeliveryHelper","common/cjos/util/currencyUtil","page/cjmall/order/sheet/helper/orderSheetHelper"],function(e,t,r,o,n,l,a,d,s,c,u,p,m,f,g,v,y,h,C,P,A,T,I,w,k,b,D,M,O,S,N,j){return Backbone.View.extend({el:"#wrap",model:n,noMemberOrderPopupTemplate:M.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/noMemberOrderPopup"),$wnd:$(window),checkNaverApp:function(){var e=this,t=r.get(r.APPLICATION_TYPE),o=r.userAgent,n=o.get("appName"),l=o.get("osName"),i=new RegExp("[?&amp;]isNaverApp=([^&amp;#]*)").exec(location.href);"m"===t&&"android"===l&&"naver"===n&&opener&&(null!==i&&"true"===i[1]||e.redirectNaverInAppView())},redirectNaverInAppView:function(){var e=location.href;e.indexOf("?")>0?e+="&isNaverApp=true":e+="?isNaverApp=true";var t=encodeURIComponent(e),r="Intent://inappbrowser?url="+t+"&target=inpage&version=6#Intent;scheme=naversearchapp;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=com.nhn.android.search;end";window.location.href=r},initialize:function(){var e=this,t=e.$el;e.checkNaverApp(),e.setLoggerKey(),e.setHandlebarsHelper();e.model.fetch({timeout:6e4,dataType:"json",xhrFields:{withCredentials:!0},success:function(){switch(r.get(r.APPLICATION_TYPE)){case"p":t.find("#container").removeClass("is_loadmask"),t.find(".loadmask_order").hide();break;case"m":t.find(".notice_full").hide()}t.find("#order_item_list").show(),e.render(),e.setLoggerValue()},error:function(e,t,r){r&&"timeout"===r.textStatus&&(alert("주문서 불러오기 실패 하였습니다."),history.back())}});window._cjmallOrderObserver=h,window._cjmallOrderValidator=C,e.callToApplicationForGetCartCount(),D.set("authLayerCloseFn",e.authLayerCloseFn,!0)},callToApplicationForGetCartCount:function(){var r=e.get("ecBaseSslUrl")+"/c/rest/cart/cartListCount";$.ajax({url:r,type:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},data:"",xhrFields:{withCredentials:!0},success:function(e){if(1==e.code){var r=e.result;t.setCartCount(r.siteType,r.customerNo,r.cartCount)}},error:function(e,t,r){cjosLogUtil.log("장바구니 개수 조회 실패 : response ",e)}})},events:{"click #_buy":"buy"},renderOrderSheet:function(){var e=this,o=e.model.get("orderSheetType"),l=n.get("orderPriceModel");if("NORMAL"===o)e.orderNoticeView=new a,!0===l.getIsDeliveryTravelProduct()?e.travelerInfoView=new A:!1===l.getIsNoDeliveryProduct()?e.orderSheetAddressView=new d:!0===l.getIsCpnProduct()?j.isGiftItemPromotion()?j.isGiftItemCpn()&&(e.orderSheetEcouponRecipientView=new u):e.orderSheetEcouponRecipientView=new u:!1===l.getIsCpnProduct()&&!0===l.getIsEcouponProduct()&&(e.orderSheetEcouponRecipientView=new u),e.orderItemListView=new v,e.orderBenefitView=new p,e.orderPaymentView=new m,e.orderCashReceiptView=new g,e.orderAgreeView=new T;else if("NON_CUSTOMER"===o)e.orderSheetNonCustomerAddressView=new s,e.orderItemListView=new v,e.orderBenefitView=new p,e.orderPaymentView=new m,e.orderCashReceiptView=new g,e.orderAgreeView=new T,e.showNoMemberOrderPopup();else if("OTOUR"===o)e.orderSheetAddressView=new d,e.orderItemListView=new v,e.orderBenefitView=new p,e.orderPaymentView=new m,e.orderCashReceiptView=new g,e.orderAgreeView=new T;else if("PRESENT_DELIVERY"===o)e.orderNoticeView=new a,!0===l.getIsDeliveryTravelProduct()?e.travelerInfoView=new A:!1===l.getIsNoDeliveryProduct()&&(e.orderSheetAddressView=new d),e.orderSheetPresentDeliveryView=new c,e.orderItemListView=new v,e.orderBenefitView=new p,e.orderPaymentView=new m(o),e.orderCashReceiptView=new g,e.orderAgreeView=new T;else if("OLIVEYOUNG"===o)e.orderNoticeView=new a,!1===l.getIsNoDeliveryProduct()&&(e.orderSheetAddressView=new d),e.orderItemListView=new v,e.orderBenefitView=new p,e.orderPaymentView=new m(o),e.orderCashReceiptView=new g,e.orderAgreeView=new T;else if("REGULAR_PAYMENT"===o){$("head").find("title").text("정기배송 신청"),"p"===r.get(r.APPLICATION_TYPE)?$("#order_sheet_title").html('정기배송 신청<span class="blind _blind">작성하기</span>'):($("#header").find(".tit").text("정기배송 신청"),1==r.userAgent.get("isOshoppingApp")&&t.setPageTitle("정기배송 신청")),e.orderNoticeView=new a,e.orderSheetAddressView=new d,e.orderItemListView=new v,e.OrderRegularPaymentView=new f,e.orderRegularPaymentAgreeView=new I}else if("TRAVEL"===o){var i=l.getTourItemType();e.orderSheetAddressView=new d,e.OrderTourItemInfoView=new y(i),e.orderItemListView=new v,e.orderBenefitView=new p,e.orderPaymentView=new m,e.orderCashReceiptView=new g,e.orderAgreeView=new T}},render:function(){var e=this,t=e.model.get("orderSheetType");n.get("orderPriceModel");if(j.isOliveyoungItemIncluded()&&"OLIVEYOUNG"!==t){var r=new O;e.listenTo(r,"clickNormalCard",e.renderOrderSheet)}else e.renderOrderSheet()},showNoMemberOrderPopup:function(){var t=this;t.hideAria();var n=Backbone.View.extend({el:t.noMemberOrderPopupTemplate(),events:{"click .link_policy":"golinkPolicy","click ._ok_btn":"okBtnOnClickHn","click ._cancel_btn":"cancelBtnOnClickHn"},golinkPolicy:function(t){t.preventDefault();var o=(r.get(r.APPLICATION_TYPE),e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/footer/contents/personalInfoProcPolicy?opentarget=new");window.open(o)},okBtnOnClickHn:function(e){if(e.preventDefault(),!this.$el.find("#nomemberorder").is(":checked"))return void alert("주문 필수 사항에 동의해주세요");$("html, body").css({overflow:""}).unbind("touchmove"),t.showAria(),this.remove()},cancelBtnOnClickHn:function(e){e.preventDefault(),o.alertAndRedirect()}});$("#content").append((new n).$el),$("html, body").css({overflow:"hidden"}).bind("touchmove")},hideAria:function(){$("#cj_index").attr("aria-hidden","true"),$("#header").attr("aria-hidden","true"),$("#off_canvas").attr("aria-hidden","true"),$("._wrap_order").attr("aria-hidden","true"),$("#footer").attr("aria-hidden","true")},showAria:function(){$("#cj_index").removeAttr("aria-hidden"),$("#header").removeAttr("aria-hidden"),$("#off_canvas").removeAttr("aria-hidden"),$("._wrap_order").removeAttr("aria-hidden"),$("#footer").removeAttr("aria-hidden")},buy:function(e){e.preventDefault();var t=this;t.$el;if(t.model.get("isProgress"))return void alert("결제 진행중입니다. 잠시만 기다려주세요.");t.model.set("isProgress",!0),_.isUndefined(D.get("createPrePaymentPopup"))&&D.set("createPrePaymentPopup",function(){if("p"===r.get(r.APPLICATION_TYPE)){var e=t.model.get("orderPaymentModel").get("_payType");if(w.isPolrarisCard(e)||"MOBILE"===e||"PAYCO"===e||"PAYNOW"===e||"PAYALL"===e){var o=screen.availWidth/2-200,n=screen.availHeight/2-200-30,l="width=400, height=400, left="+o+", top="+n+", scrollbars=yes",i=window.open("about:blank","payment",l);window._paymentPopup=i}}},!0),(new l).submit(t.model,t.orderCertain,t.callPayTypeHelper)},orderCertain:function(e,t){if(window._cjmallOrderObserver.setContent({index:"orderCertainResult",content:e.result}),S.checkHanssemDeliveryAble(e))return n.set("isProgress",!1),window._cjmallOrderObserver.setContent({index:"callPayTypeHelper",content:t}),createPrePaymentPopup(),void S.call(e);createPrePaymentPopup(),t(e)},callPayTypeHelper:function(t){var o=t.result.payType,l=t.result.preOrderNo;if(w.isIspCard(o))n.set("isProgress",!1),P.isp.call(t.result.isp);else if(w.isIlkCard(o))n.set("isProgress",!1),P.ilk.call(t.result.ilk);else if(w.isPolrarisCard(o))n.set("isProgress",!1),P.polaris.call(t.result.polaris,o);else if("PAYALL"===o)n.set("isProgress",!1),P.payall.call(t.result.payall);else if("KMOTION"===o)n.set("isProgress",!1),P.kmotion.call(t.result.kmotion);else if("KAKAOPAY"===o)n.set("isProgress",!1),P.kakaopay.call(t.result.kakaopay);else if("KAKAOTALKPAY"===o)n.set("isProgress",!1),P.kakaotalkpay.call(t.result.kakaotalkpay);else if("SMILEPAY"===o)n.set("isProgress",!1),P.smilepay.call(t.result.smilepay);else if("SETTLEBANK"===o)n.set("isProgress",!1),P.settlebank.call(t.result.settlebank);else if("REGULARPAYMENT"===o)n.set("isProgress",!1),P.regularpayment.call(t.result.regularpayment);else if("PAYCO"===o)n.set("isProgress",!1),P.payco.call(t.result.payco);else if("SYRUPPAY"===o)n.set("isProgress",!1),P.syruppay.call(t.result.syruppay);else if("NAVERPAY"===o)n.set("isProgress",!1),P.naverpay.call(t.result.naverpay);else if("PAYNOW"===o)n.set("isProgress",!1),P.paynow.call(t.result.paynow);else if("MOBILIANS"===o)n.set("isProgress",!1),P.mobilians.call(t.result.mobilians);else if(w.isNobankbook(o)||"NOPAY"===o||"REALTIME_ACCOUNT_TRANSFER"===o){var i=$("<form></form>"),a=e.get("rPIC");a!==undefined&&null!==a&&""!==a&&i.append($("<input>").attr("type","hidden").attr("name","rPIC").val(a));var d=e.get("ecBaseSslUrl")+"/"+r.get(r.APPLICATION_TYPE)+"/order/approval/"+e.get("tempOrderNo")+"/"+l;i.attr({action:d,method:"get"}),$("body").append(i),i.submit()}else"DANAL"===o&&(n.set("isProgress",!1),P.danal.call(t.result.danal))},paynow:function(e){location.href=e.startPaynowUrl},cultureLandPC:function(){var t=this,r=t.model.get("orderPriceModel"),o=$("#cultureLandForm");o.find("input[name=MemberCode]").val("P012405"),o.find("input[name=Amount]").val(r.get("sumTotalPrice")),o.find("input[name=ReturnUrl]").val(e.get("ecBaseUrl")+"/c/rest/order/payment/cultureLandRst"),o.attr({action:"https://www.cultureland.co.kr/CashPay/Shopping_step01.asp",method:"post"}),o.submit()},happyMoney:function(){var t=this,r=t.model.get("orderPriceModel"),o=$("happyMoneyForm");o.find("input[name=purchase_amount]").val(r.get("sumTotalPrice"));var n={totalPrice:r.get("sumTotalPrice"),prodName:r.get("orderPriceManagers")[0].itemName};$.ajax({type:"GET",data:n,dataType:"json",url:e.get("ecBaseSslUrl")+"/c/rest/order/payment/happyMoney",xhrFields:{withCredentials:!0},success:function(e){if(""==e.ciValue||"null"==e.ciValue)return void alert("세션이 끊어졌거나 CI인증 값이 필요합니다. \n다시 로그인하거나 CJONE에서 통합 계정 발급 후 이용하십시오.");o.attr({action:"https://twebpg.happymoney.co.kr/external/cashquery/index.hm?EncodeData="+encodeURIComponent(e.strReqPacket),method:"post"}),o.submit()}})},authLayerCloseFn:function(){n.set("isProgress",!1)},getStringValue:function(e){var t="";return _.isEmpty(e)||(t=e),t},setHandlebarsHelper:function(){Handlebars.registerHelper("makeMultipleOption",function(e){var t=this.ableMultipleCount,r="";for(i=1;i<t+1;i++)r+='<option value="'+i+'">'+i+"곳</option>";return new Handlebars.SafeString(r)}),Handlebars.registerHelper("makeSelectQuantity",function(e){var t=this.quantity,r=(this.selectQuantity,"");for(i=0;i<t+1;i++)0==i?r+='<option value="'+i+'" selected="selected">'+i+"</option>":r+='<option value="'+i+'">'+i+"</option>";return new Handlebars.SafeString(r)}),Handlebars.registerHelper("isFastDeliveryPossible",function(e){var t=e.data.root.fastAreaCls,r=!0;return _.forEach(this.priceManagers,function(e){r=!!e.orderDeliveryTuple.fastDeliveryInfoTuple&&!!e.orderDeliveryTuple.fastDeliveryInfoTuple.fastDelivery}),"00"!==t&&!0===r?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("numberMasking",function(e,t){return e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}),Handlebars.registerHelper("makePossibleDay",function(e){var t=this.possibleDay.length,r="";for(i=0;i<t;i++)r+='<option value="'+this.possibleDay[i]+'">'+this.possibleDay[i]+"</option>";return new Handlebars.SafeString(r)}),Handlebars.registerHelper("makeStaticPossibleDay",function(e){var t=this.staticPossibleDay.length,r="";for(i=0;i<t;i++)r+='<option value="'+this.staticPossibleDay[i]+'">'+this.staticPossibleDay[i]+"</option>";return new Handlebars.SafeString(r)}),Handlebars.registerHelper("makeTravelerCountSelect",function(e){var t=this.travelerCount,r="";for(i=1;i<t+1;i++)i!==t?r+='<option value="'+i+'">'+i+"</option>":r+='<option selected="selected" value="'+i+'">'+i+"</option>";return new Handlebars.SafeString(r)}),Handlebars.registerHelper("receiptHopeDateFormat",function(e,t){return e&&8==e.toString().length?e.toString().substr(0,4)+"년 "+e.toString().substr(4,2)+"월 "+e.toString().substr(6,2)+"일":""})},setLoggerKey:function(){k.setSplunkKey("customPI"),k.setSplunkKey("searchWord"),k.setSplunkKey("productType"),k.setSplunkKey("orderProductCode"),k.setSplunkKey("orderProductName"),k.setSplunkKey("orderProductUnitCode"),k.setSplunkKey("shopCode"),k.setSplunkKey("orderAmount"),k.setSplunkKey("orderProductCount"),k.setSplunkKey("mdCode"),k.setSplunkKey("employeeYN"),k.setSplunkKey("employeeSaleItemYN"),k.setSplunkKey("gCateCd"),k.setSplunkKey("lCateCd"),k.setSplunkKey("mCateCd"),k.setSplunkKey("sCateCd"),k.setSplunkKey("pgmCd"),k.setSplunkKey("IpgmCd"),k.setSplunkKey("partnerCd"),k.setSplunkKey("orderFormType"),k.setSplunkKey("orderSheetType")},setLoggerValue:function(){var e=this,t=e.model;if(null!=t){try{for(var r=t.get("orderPriceModel"),o=r.get("orderPriceManagers"),n=t.get("orderSheetType"),l="",i="",a=t.get("keyword"),d=t.get("orderFormType"),s="",c="",u="",p="",m="",f="",g="",v="",y="",h="",C="",P="",A="",T="",I="",w=0;w<o.length;w++)if(0==w)l=o[w].itemCode,i=o[w].itemName,s=o[w].unitCode,c=o[w].shopId,p=o[w].salePrice,m=o[w].quantity,f=o[w].mdCode,g=r.get("employeeYn")?"Y":"N",h=e.getStringValue(o[w].programCode),y=e.getStringValue(o[w].internetLiveProgramCode),C=e.getStringValue(o[w].llargeCategoryId),P=e.getStringValue(o[w].largeCategoryId),A=e.getStringValue(o[w].middleCategoryId),T=e.getStringValue(o[w].smallCategoryId),I=o[w].mainVenCode,v="N",_.forEach(o[w].discountPriceTuple.discountDetails,function(e,t){"EMPLOYEE_EXCEPT"===e.category&&(v="Y")});else{l=l+";"+o[w].itemCode,i=i+";"+o[w].itemName,s=s+";"+o[w].unitCode,c=c+";"+o[w].shopId,p=p+";"+o[w].salePrice,m=m+";"+o[w].quantity,f=f+";"+o[w].mdCode,g=g+";"+(r.get("employeeYn")?"Y":"N"),h=h+";"+e.getStringValue(o[w].programCode),y=y+";"+e.getStringValue(o[w].internetLiveProgramCode),C=C+";"+e.getStringValue(o[w].llargeCategoryId),P=P+";"+e.getStringValue(o[w].largeCategoryId),A=A+";"+e.getStringValue(o[w].middleCategoryId),T=T+";"+e.getStringValue(o[w].smallCategoryId),I=I+";"+o[w].mainVenCode;var b="N";_.forEach(o[w].discountPriceTuple.discountDetails,function(e,t){"EMPLOYEE_EXCEPT"===e.category&&(b="Y")}),v=v+";"+b}u="CART"==d?"CA":"DE"}catch(D){cjosLogUtil.log("[orderSheetMainView.setLoggerValue setting error]",D)}k.setSplunkValue("customPI","ODF"),k.setSplunkValue("searchWord",a),k.setSplunkValue("productType",u),k.setSplunkValue("orderProductCode",l),k.setSplunkValue("orderProductName",i),k.setSplunkValue("orderProductUnitCode",s),k.setSplunkValue("shopCode",c),k.setSplunkValue("orderAmount",p),k.setSplunkValue("orderProductCount",m),k.setSplunkValue("mdCode",f),k.setSplunkValue("employeeYN",g),k.setSplunkValue("employeeSaleItemYN",v),k.setSplunkValue("gCateCd",C),k.setSplunkValue("lCateCd",P),k.setSplunkValue("mCateCd",A),k.setSplunkValue("sCateCd",T),k.setSplunkValue("pgmCd",h),k.setSplunkValue("IpgmCd",y),k.setSplunkValue("partnerCd",I),k.setSplunkValue("orderFormType",d),k.setSplunkValue("orderSheetType",n)}}})}),Backbone.View.prototype.scrollTo=function(e){var t=$(e);$("html,body").animate({scrollTop:t.offset().top-$("#header").height()-3},500,function(){t.focus()})},Backbone.View.prototype.numberMasking=function(e){return e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},Backbone.Model.prototype.numberMasking=function(e){return e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},Backbone.View.prototype.cutUnderTen=function(e){return e!==undefined&&"number"==typeof e&&e-e%10},Backbone.Model.prototype.cutUnderTen=function(e){return e!==undefined&&"number"==typeof e&&e-e%10},define("page/cjmall/order/sheet/view/orderSheetNonCustomerAddressView",["common/cjos/util/configUtil","common/cjos/util/globalVariables","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/models/orderNoMemberInfoFormModel","page/cjmall/order/sheet/models/deliveryAddressItemModel","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n,l,i){return Backbone.View.extend({el:"#order_ct",template:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/ordererInfo"),ordererInfoTemplate:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/ordererNoMemberInfo"),receiverInfoTemplate:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/recieverNoMemberInfo"),events:{"keypress ._receive":"disableSpecialCharOnkeyPressHnReceiver","keypress ._password":"disableSpecialCharOnkeyPressHn","keypress ._cellno":"telnumOnKeyPressHn","keypress ._telno":"telnumOnKeyPressHn","change #copy_addr":"copyOrdererOnChangeHn","change ._domainselect":"domainSelectOnChangeHn","click #deliveryinfo .btn_post":"postFindOnClickHn","focusin .order_dely ._delimsg":"delimsgOnFocusInHn","blur .order_dely ._delimsg":"delimsgOnBlurHn","change ._delimsgselect":"deliMsgSelectOnChangeHn"},initialize:function(){var e=this,t=e.$el;e.orderNoMemberInfo=new o,e.noMemberAddressModel=new n,t.html(e.template()),e.render(),r.get("orderNoMemberModel").set("getNoMemberInfomationCallback",$.proxy(e.getNoMemberData,e)),r.get("orderAddressModel").set("selectedAddressModel",e.noMemberAddressModel).set("getAddressDataCallback",$.proxy(e.getOrderAddressData,e))},render:function(){var e=this,t=e.$el,r=t.find("form > fieldset");return r.empty(),r.append(e.ordererInfoTemplate()),r.append(e.receiverInfoTemplate()),this},disableSpecialCharOnkeyPressHnReceiver:function(e){var t=e.keyCode;this.isSpecialCharKeyCode(t)&&(e.preventDefault(),alert("특수문자입력은 불가합니다."))},disableSpecialCharOnkeyPressHn:function(e){var t=e.keyCode;this.isSpecialCharKeyCode(t)&&(e.preventDefault(),alert("비밀번호는 영문,숫자만 허용됩니다."))},isSpecialCharKeyCode:function(e){return e>32&&e<48||(e>57&&e<65||(e>90&&e<97||e>122&&e<127))},isSpecialCharString:function(e){return!!/^[A-Za-z0-9+]*$/.test(e)},telnumOnKeyPressHn:function(e){e.keyCode>47&&e.keyCode<58||e.preventDefault()},byteCheckOnkeyDownHn:function(e){var t,r=$(e.currentTarget),o=r.val(),n=r.data().maxlength;(t=function(e,t,r,o){for(t=r=0;o=e.charCodeAt(r++);t+=o>>11?3:o>>7?2:1);return t}(o))==n&&8!==e.keyCode&&e.preventDefault()},copyOrdererOnChangeHn:function(e){var t=this,r=t.$el,o=$(e.currentTarget),n=r.find(".order_dely#deliveryinfo"),l=n.find(".tf_place"),i=n.find("._cellno1"),a=n.find("._cellno");if(o.is(":checked")){var d=r.find(".fld_write.fld_guest"),s=d.find(".tf_place#tfSend"),c=d.find(".u_d_sel._cellno1"),u=d.find(".tf_phone._cellno");l.val(s.val()),i.val(c.val()),a.val(u.val())}else l.val(""),i.val(""),a.val("")},domainSelectOnChangeHn:function(e){var t=this,r=(t.$el,$(e.currentTarget)),o=t.$el.find(r.data().domainTargetSelector),n=$(".cont_email");"etc"==r.val()?(n.addClass("self"),o.val("").focus()):(n.removeClass("self"),o.val(r.val()))},postFindOnClickHn:function(){var r=this;switch(l.get(l.APPLICATION_TYPE)){case"p":var o=e.get("ecBaseSslUrl")+"/p/common/searchPostCode/sheet",n=screen.availHeight-100;n>=880&&(n=880);var i="width=520, height="+n+", resizable=no, scrollbars=yes, status=no",a=window.open(o,"우편변호찾기",i),d={popUpClose:function(e,t){r.callBackFindPost(e,t),a&&a.close()}};t.set("__postPopUpView",d,!0);break;case"m":require(["page/cjmall/postcode/m/mobilePostLayerView"],function(e){new e({afterSelectAddress:function(e,t){r.callBackFindPost(e,t)}})})}},callBackFindPost:function(e,t){var r,o,n,l,i=this;"ADDRESS_ROAD_NAME"===t&&(r=e.ZIPNO5,o=e.ROAD_ADDR,n=e.BLD_NAME,l="1"),"ADDRESS_JIBUN"===t&&(r=e.ZIPNO,o=e.ZIP_ADDR,n=e.ZIP_APT_BLD,l="0"),i.$el.find("#deliveryinfo .tf_post").val(r),i.$el.find("#deliveryinfo .tf_addr1").val(o),i.$el.find("#deliveryinfo .tf_addr2").val(n);var a={addressType:l,areaCls:e.AREA_CLS,fastAreaCls:e.FAST_AREA_CLS,roadBldDtlNm:e.BLD_NAME,roadAddr1:e.ROAD_ADDR,roadAddr:e.BLD_NAME,roadAddrId:e.ROAD_ADDR_ID,roadAddrSeq:e.ROAD_ADDR_SEQ,zipno:e.ZIPNO,zipno_seq:e.ZIPNO_SEQ,roadZipno:e.ZIPNO,roadZipnoSeq:e.ZIPNO_SEQ,newZipno:e.ZIPNO5,post_name:e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,addr:e.ZIP_APT_BLD};i.noMemberAddressModel.set(a),selectedAddressModel=new Backbone.Model({}),selectedAddressModel.set("selectedAddressModel",i.noMemberAddressModel),window._cjmallOrderObserver.eventTrigger("changeAddress",selectedAddressModel)},getNoMemberData:function(){var e=this;return!!e.validateNoMemberInfo()&&e.setNoMemberData()},setNoMemberData:function(){var e=this,t=e.$el,r=t.find(".fld_write.fld_guest"),o=r.find(".tf_place#tfSend"),n=r.find(".u_d_sel._cellno1"),l=r.find(".tf_phone._cellno"),i=r.find(".tf_email"),a=r.find("._domaininput"),d=r.find("#tfPw"),s=r.find("#pwCheck"),c=e.orderNoMemberInfo;return c.set({name:o.val(),celno1:n.val(),celno2:e.subStringNo(l.val(),"first"),celno3:e.subStringNo(l.val(),"second"),passWord1:d.val(),passWord2:s.val(),emailId:i.val(),emailAddress:a.val()}),c.toJSON()},validateNoMemberInfo:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=t.find(".fld_write.fld_guest"),n=o.find(".tf_place#tfSend"),l=o.find(".u_d_sel._cellno1"),i=o.find(".tf_phone._cellno"),a=o.find(".tf_email"),d=o.find("._domaininput"),s=o.find("#tfPw"),c=o.find("#pwCheck");return r.validate(n)?!0===r.isOverMaxlength(n)?(alert("주문자 이름은 "+n.data().maxlength+"자까지 입력가능합니다."),n.focus(),!1):n.length>0&&!1===r.isHangulEngText(n.val())?(alert("특수문자입력은 불가합니다"),e.scrollTo(n),!1):r.validate(l)?r.validate(i)?r.isNumber(i.val())?!0===r.isOverMaxlength(i)?(alert("전화 번호는 "+i.data().maxlength+"자까지 입력가능합니다."),i.focus(),!1):r.validate(a)&&r.validate(d)?r.isDomain(d.val())?r.validate(s)?this.isSpecialCharString(s.val())?s.val().length<4||s.val().length>8?(alert("비밀번호는 4-8자리 내에서 입력해 주세요."),s.focus(),!1):s.val()==c.val()||(alert("비밀번호가 올바르지 않습니다. 확인란과 동일하게 입력해 주세요."),c.focus(),!1):(alert("비밀번호는 영문,숫자만 허용됩니다."),s.focus(),!1):(alert("비밀번호를 입력해 주세요."),s.focus(),!1):(alert("이메일 도메인 형식에 맞지 않습니다."),d.focus(),!1):(alert("주문자 이메일 정보를 입력하세요."),a.focus(),!1):(alert("숫자만 입력해주세요."),i.focus(),!1):(alert("연락처를 정확하게 입력해 주세요."),i.focus(),!1):(alert("연락처를 정확하게 입력해 주세요."),l.focus(),!1):(alert("주문자 이름을 입력해 주세요."),n.focus(),!1)},getOrderAddressData:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=t.find("._hopedelyday"),n=t.find("._fixeddelyday"),l=t.find("textarea._delimsg");if(!0==!!l.val()&&!0===r.isOverMaxlength(l))return alert("배송메세지는 "+l.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(l),!1;if(!0==!!o.length&&!1==!!o.val())return alert("배송희망일을 선택해주세요"),e.scrollTo(o),!1;if(e.validateNoMemberAddress()){e.setNoMemberAddressModel();var i=[],a=$.extend(e.noMemberAddressModel.toJSON(),{message:l.val(),customerHopeDate:o.length?o.val():null,customerApptDate:n.length?n.val():null,deliveryIndex:0});return a.defaultDelivFlag=$("#basic_addr_chk").is(":checked")?"1":"0",i.push(a),i}return!1},setNoMemberAddressModel:function(){var e=this,t=e.$el,r=t.find(".order_dely#deliveryinfo"),o=r.find(".tf_place"),n=(r.find(".tf_post"),r.find(".tf_addr1"),r.find(".tf_addr2")),l=r.find("._cellno1"),i=r.find("._cellno"),a=r.find("._telno1"),d=r.find("._telno");e.noMemberAddressModel.set("delivPlcAlias",""),e.noMemberAddressModel.set("nm",o.val()),e.noMemberAddressModel.set("cellno1",l.val()),e.noMemberAddressModel.set("cellno2",e.subStringNo(i.val(),"first")),e.noMemberAddressModel.set("cellno3",e.subStringNo(i.val(),"second")),e.noMemberAddressModel.set("ddd",a.val()),e.noMemberAddressModel.set("telno1",e.subStringNo(d.val(),"first")),e.noMemberAddressModel.set("telno2",e.subStringNo(d.val(),"second")),e.noMemberAddressModel.set("addr",n.val()),e.noMemberAddressModel.set("roadAddr",n.val())},validateNoMemberAddress:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=t.find(".order_dely#deliveryinfo"),n=o.find(".tf_place"),l=o.find(".tf_post"),i=o.find(".tf_addr1"),a=o.find(".tf_addr2"),d=o.find("._cellno1"),s=o.find("._cellno"),c=o.find("._telno1"),u=o.find("._telno"),p=!!r.validate(n),m=!(!r.validate(l)||!r.validate(i)),f=!(!r.validate(d)||!r.validate(s)),g=!(!r.validate(c)||!r.validate(u));if(!p)return alert("수령인 이름을 입력해 주세요."),e.scrollTo(n),!1;if(p){if(!0===r.isOverMaxlength(n))return alert("수령인은 "+n.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(n),!1;if(n.length>0&&!1===r.isHangulEngText(n.val()))return alert("특수문자입력은 불가합니다"),e.scrollTo(n),!1}if(!m)return alert("기본배송지 정보가 없습니다. 주소를 입력해주세요"),e.scrollTo(l),!1;if(m){if(!1===r.validate(a))return alert("건물명을 포함한 상세 주소를 입력하세요"),e.scrollTo(a),!1;if(!0===r.isOverMaxlength(a))return alert("상세주소는 "+a.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(a),!1}if(!f&&!g)return!f&&!1==!!r.validate(d)&&r.validate(s)?(alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(d),!1):!f&&!1==!!r.validate(s)&&r.validate(d)?(alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(s),!1):(alert("한개 이상의 전화번호를 입력하셔야 합니다"),e.scrollTo(d),!1);if(f){if(!1===r.isNumber(s.val()))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(s),!1;if(s.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(s),!1;if(!0===r.isOverMaxlength(s))return alert("전화 번호는 "+s.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(s),!1}if(g){if(!1===r.isNumber(u.val()))return alert("전화번호는 숫자만 입력해주세요"),e.scrollTo(u),!1;if(u.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(u),!1;if(!0===r.isOverMaxlength(u))return alert("전화 번호는 "+u.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(u),!1}if(!f&&(r.validate(d)||r.validate(s)))return alert("전화 번호를 정확하게 입력해 주세요"),!1;if(!g){if(!1===r.validate(c)&&r.validate(u))return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(c),!1;if(!1===r.validate(u)&&r.validate(c))return alert("전화 번호를 정확하게 입력해 주세요"),e.scrollTo(u),!1}return!0},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}},getIsAbleSelectDeliveryDay:function(){var e=!1,t=!1,o=r.get("orderPriceModel").get("orderPriceManagers");return _.forEach(o,function(r){r.isCustFixedDelyYn&&(t=!0),r.isCustHopeDelyYn&&(e=!0)}),!e||!t},getIsDuplicateSelectDelivery:function(){var e=!1,t=!1,o=!1,n=!1,l=r.get("orderPriceModel").get("orderPriceManagers");return _.forEach(l,function(r){r.isCustFixedDelyYn&&(t?n=!0:t=!0),r.isCustHopeDelyYn&&(e?o=!0:e=!0)}),!(!o&&!n)},validateHopeDelivery:function(e){var t,o,n=this,l=n.$el.find("._hopedelyday"),i=l.val(),a=r.get("orderPaymentModel"),d=a.get("_paymentDueDate");"NOBANKBOOK"===a.get("_payType")&&!0==!!i&&!0==!!d&&(t=n.makeDate(i),o=n.makeDate(d),(t.getTime()-o.getTime())/1e3/60/60/24<3&&(alert("배송희망일 이전에 결제가 완료되어야합니다. 입금예정일을 다시 선택해주세요."),e.prop("selectedIndex",0)))},hopeDeliveryDayOnChangeHn:function(e){var t=this,r=t.$el.find("._hopedelyday");window._cjmallOrderObserver.eventTrigger("checkHopeDeliveryDay",r)},makeDate:function(e){var t=Number(e.substring(0,4)),r=Number(e.substring(4,6))-1,o=Number(e.substring(6,8));return new Date(t,r,o)},delimsgOnFocusInHn:function(e){$(e.currentTarget).siblings(".lab_cont").hide()},delimsgOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lab_cont");0==$.trim(t.val()).length&&r.show()},deliMsgSelectOnChangeHn:function(e){var t=$(e.currentTarget),r=t.siblings().find(".lab_cont"),o=t.siblings().find("._delimsg"),n=t.val();n?r.hide():r.show(),o.val(n)}})}),define("page/cjmall/order/sheet/view/orderSheetPresentDeliveryView",["common/cjos/inflowInfo/inflowInfo","common/cjos/util/configUtil","common/cjos/util/globalVariables","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/models/orderPresentDeliveryModel","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n,l,i){return Backbone.View.extend({el:"#order_ct",template:i.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/orderSheetPresentDelivery"),events:{"keypress ._presentReceiver":"disableSpecialCharOnkeyPressHnReceiver","keypress ._cellno":"telnumOnKeyPressHn","focusin .order_gift ._presentReceiver":"presentReceiverOnFocusInHn","blur .order_gift ._presentReceiver":"presentReceiverOnBlurHn","focusin .order_gift ._presentMsg":"presentmsgOnFocusInHn","blur .order_gift ._presentMsg":"presentmsgOnBlurHn"},initialize:function(){var e=this;e.$el;n.get("orderPresentDeliveryModel").set("getPresentDeliveryDataCallback",$.proxy(e.getPresentDeliveryDataCallback,e)),e.render(),e.validator=window._cjmallOrderValidator},render:function(){var e=this,t=e.$el;t.html(e.template()),t.find(".order_gift").find("._cellno1>option").eq(1).prop("selected",!0)},setListener:function(){},disableSpecialCharOnkeyPressHnReceiver:function(e){var t=this,r=e.keyCode;t.validator.isSpecialCharKeyCode(r)&&(e.preventDefault(),alert("특수문자입력은 불가합니다."))},telnumOnKeyPressHn:function(e){e.keyCode>47&&e.keyCode<58||e.preventDefault()},presentReceiverOnFocusInHn:function(e){$(e.currentTarget).siblings(".lbl").hide()},presentReceiverOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lbl");0==$.trim(t.val()).length&&r.show()},presentmsgOnFocusInHn:function(e){$(e.currentTarget).siblings(".lab_cont").hide()},presentmsgOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lab_cont");0==$.trim(t.val()).length&&r.show()},getPresentDeliveryDataCallback:function(){var e=this;return!!e.validatePresentDeliveryInfo()&&e.setPresentDeliveryData()},validatePresentDeliveryInfo:function(){var e=this,t=e.$el,r=t.find(".order_gift"),o=r.find("#presentReceiver"),n=r.find("._cellno1"),l=r.find("._cellno"),i=r.find("textarea._presentMsg");if(!e.validator.validate(o))return alert("받는분 이름을 입력해 주세요."),o.focus(),!1;if(!0===e.validator.isOverMaxlength(o))return alert("받는분 이름은 "+o.data().maxlength+"자까지 입력가능합니다."),o.focus(),!1;if(o.length>0&&!1===e.validator.isHangulEngText(o.val()))return alert("특수문자입력은 불가합니다"),e.scrollTo(o),!1;if(!e.validator.validate(n))return alert("연락처를 정확하게 입력해 주세요."),n.focus(),!1;if(!e.validator.validate(l))return alert("연락처를 정확하게 입력해 주세요."),l.focus(),!1;if(!e.validator.isNumber(l.val()))return alert("숫자만 입력해주세요."),l.focus(),!1;if(!0===e.validator.isMinerMinlength(l))return alert("휴대폰 번호는 "+l.data().minlength+"자 이상 입력하셔야 합니다."),l.focus(),!1;if(!0===e.validator.isOverMaxlength(l))return alert("휴대폰 번호는 "+l.data().maxlength+"자까지 입력가능합니다."),l.focus(),!1;if(!0==!!i.val()){if(!0===e.validator.isOverMaxlength(i))return alert("메시지는 "+i.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(i),!1;if(!1===e.isCheckPresentMessage())return e.scrollTo(i),!1}return!0},setPresentDeliveryData:function(){var e=this,t=e.$el,r=t.find(".order_gift"),o=r.find("#presentReceiver"),n=r.find("._cellno1"),l=r.find("._cellno"),i=r.find("._presentMsg"),a=new Backbone.Model;return a.set("nm",o.val()),a.set("cellno1",n.val()),a.set("cellno2",e.subStringNo(l.val(),"first")),a.set("cellno3",e.subStringNo(l.val(),"second")),a.set("message",$.trim(i.val())),a},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}},isCheckPresentMessage:function(){
var e=this,r=e.$el,o=r.find(".order_gift"),n=o.find("._presentMsg"),l=!0,i={content:n.val()};return cjosLogUtil.log(i),e.ajax=Backbone.ajax({url:t.get("ecBaseSslUrl")+"/c/rest/order/present/delivery/taboo",contentType:"application/json;charset=utf-8",data:JSON.stringify(i),dataType:"json",xhrFields:{withCredentials:!0},type:"POST",async:!1,success:function(e,t,r){if(cjosLogUtil.log(e),1!==e.code&&(l=!1,e.resMsg)){var o=e.resMsg;e.description&&(o=o+"\n"+e.description),alert(o)}},error:function(e,t,r){cjosLogUtil.log(t),alert("통신이 원활하지 않습니다. 다시 시도해주시고 동일한 현상이 계속 발생시 고객센터로 문의해주세요.(CJmall 고객센터 1644-2525)")},complete:function(e,t,r){}}),l}})}),define("page/cjmall/order/sheet/view/orderTourItemInfoView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t){return Backbone.View.extend({el:"#order_ct",localItem:!1,overseasItem:!1,tourItemGbCd:"",template:t.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/tourItemInfoOverseas"),localTemplate:t.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/tourItemInfoLocal"),initialize:function(t){var r=this;r.tourItemGbCd=t,"N"===t||"D"===t?r.overseasItem=!0:"X"!==t&&"H"!==t||(r.localItem=!0),r.validator=window._cjmallOrderValidator,e.get("orderTourItemInfoModel").set("getTourItemInfoCallBack",$.proxy(r.getData,r)),r.render()},render:function(){var e=this;if($el=e.$el,e.localItem){for(var t=[],r=1;r<=20;r++)t.push(r);$el.html(e.localTemplate(t))}else e.overseasItem&&$el.html(e.template())},events:{"blur #tour_item_request":"labelBlur","focusin #tour_item_request":"labelFocusIn","blur #tour_item_birth":"labelBlur","focusin #tour_item_birth":"labelFocusIn","blur #tour_item_use_date":"labelBlur","focusin #tour_item_use_date":"labelFocusIn"},labelFocusIn:function(e){$(e.currentTarget).siblings(".lbl").hide()},labelBlur:function(e){var t=$(e.currentTarget),r=t.siblings(".lbl");0==$.trim(t.val()).length&&r.show()},getData:function(){var e=this;return e.overseasItem?e.getTourItemInfoOverseasData():!!e.localItem&&e.getTourItemInfoLocalData()},getTourItemInfoLocalData:function(){var e=this;if(0==e.checkLocalValidation())return!1;var t=$("#tour_item_count").val(),r=$("#tour_item_request").val(),o=new Backbone.Model,n=[{tourItemAttrCd:"011",tourItemAttrInsVal:r},{tourItemAttrCd:"012",tourItemAttrInsVal:t}];return o.set("tourItemAttrList",n),o.set("tourItemGbCd",e.tourItemGbCd),o},getTourItemInfoOverseasData:function(){var e=this;e.$el;if(0==e.checkOverseasValidation())return!1;var t=$("#tour_item_ko_name").val(),r=$("#tour_item_birth").val(),o=$("input[name=tour_item_sex]:checked").val(),n=$("#tour_item_en_last_name").val(),l=$("#tour_item_en_first_name").val(),i=$("#tour_item_tel_no").val(),a=$("#tour_item_cellNo").val(),d=$("#tour_item_email").val(),s=$("#tour_item_use_date").val(),c=new Backbone.Model,u=[{tourItemAttrCd:"001",tourItemAttrInsVal:s},{tourItemAttrCd:"002",tourItemAttrInsVal:t},{tourItemAttrCd:"003",tourItemAttrInsVal:o},{tourItemAttrCd:"004",tourItemAttrInsVal:n+" "+l},{tourItemAttrCd:"005",tourItemAttrInsVal:r},{tourItemAttrCd:"006",tourItemAttrInsVal:a+i},{tourItemAttrCd:"007",tourItemAttrInsVal:d}];return c.set("tourItemAttrList",u),c.set("tourItemGbCd",e.tourItemGbCd),c},checkLocalValidation:function(){return!0},checkOverseasValidation:function(){var e=this,t=e.$el,r=t.find("#tour_item_ko_name"),o=t.find("#tour_item_birth"),n=t.find("#tour_item_en_last_name"),l=t.find("#tour_item_en_first_name"),i=t.find("#tour_item_tel_no"),a=t.find("#tour_item_email"),d=t.find("#tour_item_use_date"),s=[];if(s.push(r),s.push(o),s.push(i),s.push(d),s.push(a),!e.validator.validate(r))return alert("한글명을 입력해주세요."),e.scrollTo(r),!1;if(!e.validator.validate(o))return alert("생년월일을 입력해주세요."),e.scrollTo(o),!1;if(!e.validator.validate(n))return alert("영문성을 입력해주세요."),e.scrollTo(n),!1;if(!e.validator.validate(l))return alert("영문명을 입력해주세요."),e.scrollTo(l),!1;if(!e.validator.validate(i))return alert("휴대번호를 입력해주세요."),e.scrollTo(i),!1;if(!e.validator.validate(a))return alert("이메일을 입력해주세요."),e.scrollTo(a),!1;if(!e.validator.validate(d))return alert("사용일자를 입력해주세요."),e.scrollTo(d),!1;if(!/^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i.test(a.val()))return alert("이메일을 확인해주세요."),e.scrollTo(a),!1;if(!1===e.validator.isNumber(i.val()))return alert("전화번호는 숫자만 입력해주세요."),e.scrollTo(i),!1;if((0===i.val().length||i.val().length<7)&&(alert("전화번호를 정확히 입력해주세요."),e.scrollTo(i)),!e.validator.isAlphabetText(l.val()))return alert("영문명은 영문만 허용됩니다."),e.scrollTo(l),!1;if(!e.validator.isAlphabetText(n.val()))return alert("영문명은 영문만 허용됩니다."),e.scrollTo(n),!1;var c=/^(19[0-9][0-9]|20\d{2})(0[0-9]|1[0-2])(0[1-9]|[1-2][0-9]|3[0-1])$/;if(!c.test(d.val()))return alert("날짜형식을 정확히 입력해주세요"),e.scrollTo(d),!1;if(!c.test(o.val()))return alert("날짜형식을 정확히 입력해주세요"),e.scrollTo(o),!1;return _.forEach(s,function(t,r){if(t.val().length>50)return alert("50자 이내로 입력해주세요."),e.scrollTo(t),!1}),(n.val()+l.val()).length>50?(alert("영문명은 50자를 넘길 수 없습니다. [영문성 + 영문이름]"),!1):void 0}})}),define("page/cjmall/order/sheet/view/p/deliveryAddressItemView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil"],function(e,t,r,o){return Backbone.View.extend({template:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/p/pcDeliveryAddressItem"),notModifyAddressTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/notModifyAddressItem"),isPostChanged:!1,tag:"div",className:"item_addr",events:{"click ._address_edit":"edit","click ._address_delete":"delete","click ._address_edit_confirm":"editConfirm","change [type=radio]":"radioOnchangeHn"},render:function(){var e=this,t=e.$el;return t.html(e.template(e.model.toJSON())),!0===e.model.get("isChecked")&&t.addClass("selected"),e},edit:function(e){e&&(e.originalEvent&&o.splunkClickLog("ODIN____delivery__addmod__"),e.preventDefault());var t=this;t.$el;t.model.trigger("modify",t.model)},"delete":function(e){e&&(e.originalEvent&&o.splunkClickLog("ODIN____delivery__adddel__"),e.preventDefault());var t=this;window.confirm("삭제하시겠습니까?")&&(t.model.url=t.model.url+t.model.get("deliv_plc_seq"),t.model.destroy({xhrFields:{withCredentials:!0},success:function(e,t){if(0===t.jsonTuple.code)return void alert(t.jsonTuple.message);e.trigger("delete",e,Number(t.jsonTuple.result.totalCount))},error:function(e,t){}}))},radioOnchangeHn:function(e){e&&e.originalEvent&&o.splunkClickLog("ODIN____delivery__addradio__");var t=this;$(e.currentTarget).is(":checked")&&t.model.trigger("checked",t.model)}})}),define("page/cjmall/order/sheet/view/p/orderProcessLoadingView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper"],function(e,t,r){return Backbone.View.extend({el:".wrap_order",pcOrderProcessLoadingTemplate:r.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/p/pcOrderProcessLoading"),initialize:function(){var e=this;e.$el;switch(t.get(t.APPLICATION_TYPE)){case"p":e.render()}},render:function(){var t=this,r=t.$el,o={ecBaseCjmallImageUrl:e.get("ecBaseCjmallImageUrl")};cjosLogUtil.log("data.ecBaseCjmallImageUrl : "+o.ecBaseCjmallImageUrl),r.html(t.pcOrderProcessLoadingTemplate(o))}})}),define("page/cjmall/order/sheet/view/p/otherDeliveryView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/view/p/deliveryAddressItemView","page/cjmall/order/sheet/models/deliveryAddressItemModel","common/cjos/inflowInfo/inflowInfo","common/cjos/util/handlebarsHelper","common/cjos/logger/utils/loggerUtil","page/cjmall/order/sheet/helper/orderSheetHelper","page/cjmall/order/sheet/helper/deliveryAddressHelper"],function(e,t,r,o,n,l,i,a){return Backbone.View.extend({tag:"div",className:"lay_wrap ly_open_addr",model:null,checkedModel:null,modifyModel:null,deliveryAddressCollection:null,totalCount:null,pageIdx:1,cntByPage:5,ajaxLoading:!1,isFirstLoading:!0,isPostChanged:!1,onCloseCallbackFn:null,template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/p/pcLayer"),pagingTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/"+("p"===o.get(o.APPLICATION_TYPE)?"p":"m")+"/pcOtherDeliveryPaging"),modifyTemplate:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/p/pcOtherDeliveryModify"),events:{"click ._closebtn":"onCloseHn","click ._cancelbtn":"onCloseHn","click ._submitbtn":"onSubmitHn","click .pagination_inner > a":"pageOnload","click ._modifycancelbtn":"modifyCancelHn","click ._modifysubmitbtn":"modifySubmitHn","click .btn_post":"postFindOnClickHn"},initialize:function(e){var t=this;t.otherDeliveryBtn=e.otherDeliveryBtn,t.onCloseCallbackFn=e.onClose,t.totalCount=e.totalCount,t.deliveryAddressCollection=e.deliveryAddressCollection,t.setListener(),t.render(),t.otherDeliveryBtn.attr("disabled",!0)},setListener:function(){},render:function(){var e=this;return e.$el.html(e.template()),e.renderPaging(),this},renderPaging:function(){var e=this,t=e.$el,r=$(e.pagingTemplate({pageInfo:e.getPageInfo()}));e.loadPage({ajaxOnLoadAfter:function(){e.isFirstLoading?(e.isFirstLoading=!1,e.otherDeliveryBtn.attr("disabled",!1),e.addDeliveryAddress(r),t.find("._container").html(r),$("#order_ct").append(e.$el)):(e.addDeliveryAddress(r),t.find("._container").html(r))}})},renderModify:function(e){var t=this;t.$el.find("._container").html(t.modifyTemplate(e.toJSON())),t.modifyRenderAfterInit(e)},addDeliveryAddress:function(e){var r=this;r.pageIdx,r.deliveryAddressCollection.forEach(function(o,n,l){o.set("index",n),r.listenTo(o,"checked",r.deliveryAddressOnCheckHn),r.listenTo(o,"modify",r.deliveryAddressOnModifyHn),r.listenTo(o,"delete",r.deliveryAddressOnDeleteHn),e.find("._addressbox").append(new t({model:o}).render().$el)})},loadPage:function(e){var t=this;t.$el;if(!0!==t.ajaxLoading){var r=t.model.get("selectedAddressModel"),o=null,n=(t.pageIdx-1)*t.cntByPage,l=n+t.cntByPage;t.deliveryAddressCollection.reset(),!0==!!r&&(o=r.get("deliv_plc_seq")),t.deliveryAddressCollection.fetch({remove:!1,data:{addressType:"LIST",startIndex:n,endIndex:l,delivPlcSeq:o},xhrFields:{withCredentials:!0},beforeSend:function(){t.ajaxLoading=!0},success:function(r,o,n){if(0===o.jsonTuple.code)return void alert(o.jsonTuple.message);t.totalCount=Number(r.models[0].get("totalCount")),1===t.pageIdx&&t.setSelectedAddressModel(r.models[0]),!0==!!e&&e.ajaxOnLoadAfter()},error:function(){t.ajaxLoading=!1,t.otherDeliveryBtn.attr("disabled",!1)},complete:function(){t.ajaxLoading=!1,t.otherDeliveryBtn.attr("disabled",!1)}})}},setSelectedAddressModel:function(e){var t=this;t.model.set("selectedAddressModel",e),e.set("isChecked",!0),t.checkedModel=e,t.onCloseCallbackFn(e)},pageOnload:function(e){e.preventDefault();var t=this,r=$(e.currentTarget),o=Number(r.data().page);t.pageIdx=o,t.renderPaging()},getPageInfo:function(e){var t=this,r=t.pageIdx,o=t.totalCount,n=Math.ceil(o/t.cntByPage),l=Math.ceil(n/10),i=Math.ceil(r/10),a=[];n<t.pageIdx&&(t.pageIdx=n,r=t.pageIdx,i=Math.ceil(r/10));var d,s,c=n>9?1:null,u=null;d=i>1&&n>9?2===i?1:10*(i-1-1)+1:null,s=i<l&&n>9?10*i+1:null;for(var p=10*(i-1)+1;p<=10*(i-1)+10;p++)p<=n&&a.push(p);return n>9&&(u=r===n?null:n),{firstPage:c,prevTenPage:d,nextTenPage:s,lastPage:u,pageArray:a,currentPage:r}},onCloseHn:function(e){e&&(e.originalEvent&&$(e.target).is("button")&&l.splunkClickLog("ODIN____delivery__modcan__"),e.preventDefault()),this.remove()},onSubmitHn:function(e){e&&(e.originalEvent&&l.splunkClickLog("ODIN____delivery__modok__"),e.preventDefault());var t=this;!0==!!t.checkedModel&&(t.checkedModel.set("isChecked",!0),t.onCloseCallbackFn(t.checkedModel)),t.remove()},deliveryAddressOnCheckHn:function(e){this.checkedModel=e},deliveryAddressOnModifyHn:function(e){var t=this;t.modifyModel=e,t.renderModify(e)},deliveryAddressOnDeleteHn:function(e,t){var r=this;r.totalCount=t,r.renderPaging()},modifyCancelHn:function(e){e&&(e.originalEvent&&l.splunkClickLog("ODIN____delivery__modcan__"),e.preventDefault());var t=this;t.renderPaging(),t.modifyModel=null},modifySubmitHn:function(e){e&&e.originalEvent&&l.splunkClickLog("ODIN____delivery__modok__");var t=this;t.editConfirm(e,{success:function(){t.isPostChanged=!1,t.modifyModel=null,t.pageIdx=1,t.renderPaging()}})},modifyRenderAfterInit:function(e){var t=this,r=t.$el.find("[data-modelIndex=cellno1]"),o=t.$el.find("[data-modelIndex=ddd]"),n=e.get("cellno1"),l=e.get("ddd");r.find("option").each(function(e){$(this).val()===n&&$(this).attr("selected",!0)}),o.find("option").each(function(e){$(this).val()===l&&$(this).attr("selected",!0)})},editConfirm:function(e,t){e.preventDefault();var o=this,n=o.$el;if(!1!==o.validate()){var l=o.modifyModel,i=$(e.currentTarget),a=n.find(".fld_write"),d=(window._cjmallOrderValidator,a.find(".tf_place")),s=o.$el.find("[data-modelindex=cellno1]"),c=o.$el.find("._cellno"),u=o.$el.find("[data-modelindex=ddd]"),p=a.find("._telno");a.find(".tf_addr2");l.set("delivPlcAlias",""),l.set("nm",d.val()),"0"===l.get("addressType")?l.set("addr",a.find(".tf_addr2").val()):l.set("roadAddr",a.find(".tf_addr2").val()),l.set("cellno1",s.val()),l.set("cellno2",o.subStringNo(c.val(),"first")),l.set("cellno3",o.subStringNo(c.val(),"second")),l.set("ddd",u.val()),l.set("telno1",o.subStringNo(p.val(),"first")),l.set("telno2",o.subStringNo(p.val(),"second")),cjosLogUtil.log("modifyModel",l),Backbone.sync("update",l,{xhrFields:{withCredentials:!0},beforeSend:function(){i.attr("disabled",!0)},success:function(e,n,l){if(0===e.jsonTuple.code)return void alert(e.jsonTuple.message);var i=new r;i.set(e.jsonTuple.result.updateDeliveryAddresses),o.setSelectedAddressModel(i),t.success()},error:function(e,t,r){alert(r),cjosLogUtil.log("jqXHR",e),cjosLogUtil.log("textStatus",t),cjosLogUtil.log("error",r)},complete:function(){i.attr("disabled",!1)}})}},validate:function(e){var t=this,r=t.$el.find(".fld_write"),o=window._cjmallOrderValidator,n=r.find(".tf_place"),l=t.$el.find("[data-modelindex=cellno1]"),i=t.$el.find("._cellno"),a=t.$el.find("[data-modelindex=ddd]"),d=r.find("._telno"),s=r.find(".tf_addr2"),c=!!o.validate(n),u=!(!o.validate(l)||!o.validate(i)),p=!(!o.validate(a)||!o.validate(d)),m=!!o.validate(s);if(!c)return alert("수령인 이름을 입력해 주세요"),n.focus(),!1;if(c){if(!0===o.isOverMaxlength(n))return alert("수령인은 "+n.data().maxlength+"자까지 입력가능합니다."),n.focus(),!1;if(!0===o.isHasSpecialChar(n.val()))return alert("특수문자입력은 불가합니다"),n.focus(),!1}if(!m)return alert("건물명을 포함한 상세 주소를 입력하세요"),s.focus(),!1;if(m&&!0===o.isOverMaxlength(s))return alert("상세주소는 "+s.data().maxlength+"자까지 입력가능합니다."),s.focus(),!1;if(!u&&!p)return!u&&!1==!!o.validate(l)&&o.validate(i)?(alert("전화 번호를 정확하게 입력해 주세요"),l.focus(),!1):!u&&!1==!!o.validate(i)&&o.validate(l)?(alert("전화 번호를 정확하게 입력해 주세요"),i.focus(),!1):(alert("한 개 이상의 전화번호를 입력하셔야 합니다"),l.focus(),!1);if(u){if(!1===o.isNumber(i.val()))return alert("전화 번호는 숫자만 입력해주세요"),i.focus(),!1;if(i.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),i.focus(),!1;if(!0===o.isOverMaxlength(i))return alert("전화 번호는 "+i.data().maxlength+"자까지 입력가능합니다."),i.focus(),!1}if(p){if(!1===o.isNumber(d.val()))return alert("전화 번호는 숫자만 입력해주세요"),i.focus(),!1;if(d.val().length<7)return alert("전화 번호를 정확하게 입력해 주세요"),d.focus(),!1;if(!0===o.isOverMaxlength(d))return alert("전화 번호는 "+d.data().maxlength+"자까지 입력가능합니다."),d.focus(),!1}if(!u&&(o.validate(l)||o.validate(i)))return alert("전화 번호를 정확하게 입력해 주세요"),l.focus(),!1;if(!p){if(!1===o.validate(a)&&o.validate(d))return alert("전화 번호를 정확하게 입력해 주세요"),a.focus(),!1;if(!1===o.validate(d)&&o.validate(a))return alert("전화 번호를 정확하게 입력해 주세요"),d.focus(),!1}},postFindOnClickHn:function(){var e,t=this,r=o.get(o.APPLICATION_TYPE);switch(r){case"p":e="page/cjmall/postcode/p/pcPostPopupView";break;case"m":e="page/cjmall/postcode/m/mobilePostLayerView"}require([e],function(e){new e({afterSelectAddress:function(e,r){var o,n,l,i;"ADDRESS_ROAD_NAME"===r&&(o=e.ZIPNO5,n=e.ROAD_ADDR,l=e.BLD_NAME,i="1"),"ADDRESS_JIBUN"===r&&(o=e.ZIPNO,n=e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,l=e.ZIP_APT_BLD,i="0"),t.modifyModel.set({addressType:i,areaCls:e.AREA_CLS,fastAreaCls:e.FAST_AREA_CLS,roadBldDtlNm:e.BLD_NAME,roadAddr1:e.ROAD_ADDR,roadAddr:e.BLD_NAME,roadAddrId:e.ROAD_ADDR_ID,roadAddrSeq:e.ROAD_ADDR_SEQ,zipno:e.ZIPNO,zipno_seq:e.ZIPNO_SEQ,roadZipno:e.ZIPNO,roadZipnoSeq:e.ZIPNO_SEQ,newZipno:e.ZIPNO5,post_name:e.ZIP_SI_NM.concat(" ")+e.ZIP_GU_NM.concat(" ")+e.ZIP_DONG_NM,addr:e.ZIP_APT_BLD}),t.$el.find(".tf_post").val(o),t.$el.find(".tf_addr1").val(n),t.$el.find(".tf_addr2").val(l),t.isPostChanged=!0}})})},subStringNo:function(e,t){if(e!==undefined){var r=e.trim(),o=r.length;if(!(o<7))return"first"===t?7==o?r.substring(0,3):r.substring(0,4):"second"===t?7==o?r.substring(3,e.length):r.substring(4,e.length):void 0}}})}),define("page/cjmall/order/sheet/view/polarisModalLayerView",["common/cjos/util/configUtil","common/cjos/inflowInfo/inflowInfo"],function(e,t){return Backbone.View.extend({el:null,tag:"div",id:"polarisModalLayer",events:{"click #basic-modal.basic":"createBasicModal"},initialize:function(){this.render()},render:function(){var e=this,t=e.$el;cjosLogUtil.log(t),cjosLogUtil.log(e.template()),$(t).length>0?cjosLogUtil.log("이미 레이아웃 html 존재함"):(cjosLogUtil.log("레이아웃 html 신규 생성"),$("body").append(e.template()))},createBasicModal:function(){var e=this,t=e.$el;cjosLogUtil.log(t),cjosLogUtil.log($("#basic-modal-content")),$("#basic-modal-content").modal({onClose:function(){$.modal.close(),$(t).remove()}})}})}),define("page/cjmall/order/sheet/view/sampleMainView",["common/cjos/util/configUtil"],function(e){return Backbone.View.extend({el:"#wrap",model:null,$wnd:$(window),initialize:function(){var e=this;e.$el},events:{"click #temp_order":"tempOrder"},render:function(){},tempOrder:function(){var t={keyword:"",noneCustomer:"",orderItemForms:[{orderItemType:"NORMAL",itemCode:35742973,itemName:"",channelCode:50001001,unitName:"대형",unitCode:10114185629,unitPrice:139800,quantity:"1",shopId:"false",giftItemForms:[{itemCode:32415613,channelCode:50001001,unitCode:10094221756,promotionNo:"R1509024745823",promotionSeq:1,offerSeq:1}]},{orderItemType:"NORMAL",itemCode:35862429,itemName:"",channelCode:50001002,unitName:"단일상품",unitCode:10114956352,unitPrice:187e3,quantity:"1",shopId:"false"}]},r=e.get("ecBaseSslUrl")+"/c/rest/order/tempOrder";$.ajax({url:r,method:"POST",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(t),success:function(e,t,r){cjosLogUtil.log("#ecOrder : ",e.result)}})}})}),define("page/cjmall/order/sheet/view/tourlistInfomationView",["page/cjmall/order/sheet/models/orderSheetMainModel","common/cjos/util/handlebarsHelper"],function(e,t){return Backbone.View.extend({tag:"div",model:null,isDomesticTravel:!1,template:t.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/tourlistInfomation"),events:{"focusin ._travelmsg":"delimsgOnFocusInHn","blur ._travelmsg":"delimsgOnBlurHn","focusin ._birthday":"delimsgOnFocusInHn","blur ._birthday":"delimsgOnBlurHn"},initialize:function(){var t=this;cjosLogUtil.log("tourlistInfomationView model",t.model),e.get("orderAddressModel")&&t.model.set("tel",e.get("orderAddressModel").get("celno1")+e.get("orderAddressModel").get("celno2")+e.get("orderAddressModel").get("celno3")),t.isDomesticTravel=!!t.model.get("domesticTravel"),t.render()},render:function(){var e=this;return e.$el.html(e.template(e.model.toJSON())),this},delimsgOnFocusInHn:function(e){$(e.currentTarget).siblings(".lbl").hide()},delimsgOnBlurHn:function(e){var t=$(e.currentTarget),r=t.siblings(".lbl");0==$.trim(t.val()).length&&r.show()},telnumOnKeyDownHn:function(e){e.keyCode>47&&e.keyCode<58||32===e.keyCode||8===e.keyCode||37===e.keyCode||39===e.keyCode||9===e.keyCode||16===e.keyCode||e.preventDefault()},onlyAlpabetKeyDownHn:function(e){$(e.currentTarget);e.keyCode>64&&e.keyCode<91||32===e.keyCode||8===e.keyCode||37===e.keyCode||39===e.keyCode||9===e.keyCode||16===e.keyCode||(alert("영문과 띄워쓰기만 입력가능합니다."),e.preventDefault())},validate:function(){var e=this,t=e.$el,r=window._cjmallOrderValidator,o=e.model.get("index"),n=e.model.get("isEtcType"),l=$.grep(t.find("[data-required]"),function(e){var t=$(e);return!1===r.validate(t)});if(l.length)return l[0].name==="agesStagesType"+o&&alert("성인여부를 확인해주세요."),l[0].name==="name"+o&&alert("한글성명을 입력해주세요."),l[0].name==="birthDay"+o&&alert("생년월일을 입력해주세요."),l[0].name==="sex"+o&&alert("성별을 확인해주세요."),l[0].name==="lastName"+o&&alert("영문성을 입력해주세요."),l[0].name==="firstName"+o&&alert("영문이름을 입력해주세요."),$("html,body").animate({scrollTop:$(l[0]).offset().top-$("#header").height()-3},500,function(){$(l[0]).focus()}),!1;var i=t.find("[name=name"+o+"]"),a=t.find("[name=birthDay"+o+"]"),d=t.find("[name=lastName"+o+"]"),s=t.find("[name=firstName"+o+"]"),c=t.find("[name=message"+o+"]");if(i.length){if(r.isOverMaxlength(i))return alert("한글성명은 "+i.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(i),!1;if(!1===r.isHangulText(i.val()))return alert("한글성명은 한글과 띄어쓰기만 입력가능합니다."),e.scrollTo(i),!1}if(a.length){if(r.isOverMaxlength(a))return alert("생년월일은 "+a.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(a),!1;if(!1===r.isNumber(a.val()))return alert("생년월일은 숫자만 입력가능합니다."),e.scrollTo(a),!1;if(8!=a.val().length)return alert("생년월일을 정확히 입력해주세요."),e.scrollTo(a),!1}if(d.length){if(r.isOverMaxlength(d))return alert("영문성은 "+d.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(d),!1;if(!1===r.isAlphabetText(d.val()))return alert("영문성은 영문과 띄어쓰기만 입력가능합니다."),e.scrollTo(d),!1}if(s.length){if(r.isOverMaxlength(s))return alert("영문이름은 "+s.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(s),!1;if(!1===r.isAlphabetText(s.val()))return alert("영문이름은 영문과 띄어쓰기만 입력가능합니다."),e.scrollTo(s),!1}return!0!==n&&!0!==e.isDomesticTravel||!c.length||0!==$.trim(c.val()).length?!(c.length&&c.val().length>0&&r.isOverMaxlength(c))||(alert("요청사항은 "+c.data().maxlength+"자까지 입력가능합니다."),e.scrollTo(c),!1):(alert("요청사항을 입력해주세요."),e.scrollTo(c),!1)},getTourlistInfomation:function(){var e=this;return!!e.validate()&&(e.setModel(),{agesStagesType:e.model.get("agesStagesType"),birthDay:e.model.get("birthDay"),firstName:e.model.get("firstName"),lastName:e.model.get("lastName"),message:e.model.get("message"),name:e.model.get("name"),sex:e.model.get("sex"),tel:e.model.get("tel")})},setModel:function(){var e=this,t=e.$el,r=e.model.get("index");e.model.set({agesStagesType:t.find("[name=agesStagesType"+r+"]").filter(":checked").val(),birthDay:t.find("[name=birthDay"+r+"]").val(),firstName:t.find("[name=firstName"+r+"]").val(),lastName:t.find("[name=lastName"+r+"]").val(),message:t.find("[name=message"+r+"]").val(),name:t.find("[name=name"+r+"]").val(),sex:t.find("[name=sex"+r+"]").filter(":checked").val()}),cjosLogUtil.log("tourlistInfomationView setModel",e.model)}})}),define("page/cjmall/order/sheet/view/travelerInfoView",["page/cjmall/order/sheet/models/orderSheetMainModel","page/cjmall/order/sheet/view/tourlistInfomationView","page/cjmall/order/sheet/models/tourlistInfomationModel","page/cjmall/order/sheet/models/orderCertainFormModel","common/cjos/util/handlebarsHelper"],function(e,t,r,o,n){return Backbone.View.extend({el:"#order_ct",model:null,tourlistCount:1,tourlistInfomationViews:[],isEtcType:!1,template:n.getPrecompiledTemplate("handlebars/page/cjmall/order/sheet/travelerInfo"),events:{"change ._tourlistcount":"tourlistCountOnChangeHn"},initialize:function(){var t=this,r=t.$el,o=e.get("orderPriceModel").get("totalOrderItemTypeTuple").orderItemType;t.orderItemType=null===o?e.get("orderPriceModel").get("orderPriceManagers")[0].orderItemTypeTuple.orderItemType:o,t.isEtcType=t.getIsEtcType(),t.tourlistCount=t.getTourlistCount(),r.html(t.template({travelerCount:t.tourlistCount,isEtcType:t.isEtcType})),t.render(),e.get("orderTourlistModel").set("getTravelerInfomationCallback",$.proxy(t.getData,t))},render:function(){var e=this,o=e.$el,n=o.find("form > fieldset");if(n.empty(),e.tourlistInfomationViews=[],!0===e.isEtcType){var l=new t({model:new r({index:1,orderItemType:e.orderItemType,isEtcType:!0})});n.append(l.$el),e.tourlistInfomationViews.push(l)}else for(var i=1;i<e.tourlistCount+1;i++){var l=new t({model:new r({index:i,orderItemType:e.orderItemType,isEtcType:!1})});n.append(l.$el),e.tourlistInfomationViews.push(l)}return e},getTourlistCount:function(){var t=e.get("orderPriceModel").get("orderPriceManagers"),r=0;return _.forEach(t,function(e){r+=Number(e.quantity)}),r},tourlistCountOnChangeHn:function(e){var t=this;$(e.currentTarget);t.tourlistCount=Number($(e.currentTarget).val()),t.render()},getIsEtcType:function(){var t=!1,r=e.get("orderPriceModel").get("orderPriceManagers");return _.forEach(r,function(e){"80040103"===e.itemTypeCode&&(t=!0)}),t},getData:function(){var e=this,t=[],r=!0;return _.forEach(e.tourlistInfomationViews,function(e){if(!1!==r){var o=e.getTourlistInfomation();!1==!!o?r=!1:t.push(o)}}),cjosLogUtil.log("getTravelerInfomation",t),!!r&&t}})});